{"version":3,"file":"Search.8bdb0640.js","sources":["../../node_modules/@vicons/antd/es/CloseCircleOutlined.js","../../node_modules/@vicons/antd/es/WarningOutlined.js","../../node_modules/seemly/es/dom/happens-in.js","../../node_modules/vooks/es/use-is-ios.js","../../node_modules/naive-ui/es/_utils/vue/get-slot.js","../../node_modules/naive-ui/es/_utils/vue/render.js","../../node_modules/naive-ui/es/_utils/naive/attribute.js","../../node_modules/naive-ui/es/_internal/icons/Checkmark.js","../../node_modules/naive-ui/es/_internal/icons/Close.js","../../node_modules/naive-ui/es/_internal/icons/Empty.js","../../node_modules/naive-ui/es/_internal/close/src/styles/index.cssr.js","../../node_modules/naive-ui/es/_internal/close/src/Close.js","../../node_modules/naive-ui/es/_internal/focus-detector/src/FocusDetector.js","../../node_modules/treemate/es/utils.js","../../node_modules/treemate/es/check.js","../../node_modules/treemate/es/path.js","../../node_modules/treemate/es/move.js","../../node_modules/treemate/es/flatten.js","../../node_modules/treemate/es/contains.js","../../node_modules/treemate/es/create.js","../../node_modules/vueuc/es/shared/finweck-tree.js","../../node_modules/vueuc/es/virtual-list/src/VirtualList.js","../../node_modules/vueuc/es/overflow/src/index.js","../../node_modules/naive-ui/es/empty/styles/_common.js","../../node_modules/naive-ui/es/empty/styles/light.js","../../node_modules/naive-ui/es/empty/src/styles/index.cssr.js","../../node_modules/naive-ui/es/empty/src/Empty.js","../../node_modules/naive-ui/es/_internal/scrollbar/styles/light.js","../../node_modules/naive-ui/es/_internal/scrollbar/src/styles/index.cssr.js","../../node_modules/naive-ui/es/_internal/scrollbar/src/ScrollBar.js","../../node_modules/naive-ui/es/_internal/select-menu/src/SelectOption.js","../../node_modules/naive-ui/es/_internal/select-menu/src/SelectGroupHeader.js","../../node_modules/naive-ui/es/_internal/select-menu/src/styles/index.cssr.js","../../node_modules/naive-ui/es/_internal/select-menu/styles/_common.js","../../node_modules/naive-ui/es/_internal/select-menu/styles/light.js","../../node_modules/naive-ui/es/_internal/select-menu/src/SelectMenu.js","../../node_modules/naive-ui/es/tag/styles/_common.js","../../node_modules/naive-ui/es/tag/styles/light.js","../../node_modules/naive-ui/es/tag/src/common-props.js","../../node_modules/naive-ui/es/tag/src/styles/index.cssr.js","../../node_modules/naive-ui/es/tag/src/Tag.js","../../node_modules/naive-ui/es/_internal/selection/styles/_common.js","../../node_modules/naive-ui/es/_internal/selection/styles/light.js","../../node_modules/naive-ui/es/_internal/selection/src/styles/index.cssr.js","../../node_modules/naive-ui/es/_internal/selection/src/Selection.js","../../node_modules/naive-ui/es/select/src/utils.js","../../node_modules/naive-ui/es/select/styles/light.js","../../node_modules/naive-ui/es/select/src/styles/index.cssr.js","../../node_modules/naive-ui/es/select/src/Select.js","../../node_modules/naive-ui/es/radio/src/styles/radio-group.cssr.js","../../node_modules/naive-ui/es/radio/src/RadioGroup.js","../../src/utils/dom.ts","../../src/components/ImageClip/ImageClip.ts?vue&type=script&src&lang.ts","../../src/components/ImageViewer/ImageViewer.ts?vue&type=script&src&lang.ts","../../src/utils/browser-support.ts","../../src/Search/impl/math.ts","../../src/Search/impl/MatchChest.ts","../../src/Search/impl/MatchCrotch.ts","../../src/Search/impl/MatchElbow.ts","../../src/Search/impl/MatchElbowCameraUnrelated.ts","../../src/Search/impl/MatchFace.ts","../../src/Search/impl/MatchHip.ts","../../src/Search/impl/MatchHipCameraUnrelated.ts","../../src/Search/impl/MatchKnee.ts","../../src/Search/impl/MatchKneeCameraUnrelated.ts","../../src/Search/impl/MatchShoulder.ts","../../src/Search/impl/MatchShoulderCameraUnrelated.ts","../../src/Search/impl/search.ts","../../src/Search/Search.ts?vue&type=script&src&lang.ts"],"sourcesContent":["import { createVNode as _createVNode, openBlock as _openBlock, createBlock as _createBlock, defineComponent } from 'vue'\nconst _hoisted_1 = {\n  xmlns: 'http://www.w3.org/2000/svg',\n  'xmlns:xlink': 'http://www.w3.org/1999/xlink',\n  viewBox: '0 0 1024 1024'\n}\nconst _hoisted_2 = /*#__PURE__*/ _createVNode(\n  'path',\n  {\n    d: 'M685.4 354.8c0-4.4-3.6-8-8-8l-66 .3L512 465.6l-99.3-118.4l-66.1-.3c-4.4 0-8 3.5-8 8c0 1.9.7 3.7 1.9 5.2l130.1 155L340.5 670a8.32 8.32 0 0 0-1.9 5.2c0 4.4 3.6 8 8 8l66.1-.3L512 564.4l99.3 118.4l66 .3c4.4 0 8-3.5 8-8c0-1.9-.7-3.7-1.9-5.2L553.5 515l130.1-155c1.2-1.4 1.8-3.3 1.8-5.2z',\n    fill: 'currentColor'\n  },\n  null,\n  -1\n  /* HOISTED */\n)\nconst _hoisted_3 = /*#__PURE__*/ _createVNode(\n  'path',\n  {\n    d: 'M512 65C264.6 65 64 265.6 64 513s200.6 448 448 448s448-200.6 448-448S759.4 65 512 65zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372s372 166.6 372 372s-166.6 372-372 372z',\n    fill: 'currentColor'\n  },\n  null,\n  -1\n  /* HOISTED */\n)\nexport default defineComponent({\n  name: 'CloseCircleOutlined',\n  render: function render(_ctx, _cache) {\n    return _openBlock(), _createBlock('svg', _hoisted_1, [_hoisted_2, _hoisted_3])\n  }\n})\n","import { createVNode as _createVNode, openBlock as _openBlock, createBlock as _createBlock, defineComponent } from 'vue'\nconst _hoisted_1 = {\n  xmlns: 'http://www.w3.org/2000/svg',\n  'xmlns:xlink': 'http://www.w3.org/1999/xlink',\n  viewBox: '0 0 1024 1024'\n}\nconst _hoisted_2 = /*#__PURE__*/ _createVNode(\n  'path',\n  {\n    d: 'M464 720a48 48 0 1 0 96 0a48 48 0 1 0-96 0zm16-304v184c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V416c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8zm475.7 440l-416-720c-6.2-10.7-16.9-16-27.7-16s-21.6 5.3-27.7 16l-416 720C56 877.4 71.4 904 96 904h832c24.6 0 40-26.6 27.7-48zm-783.5-27.9L512 239.9l339.8 588.2H172.2z',\n    fill: 'currentColor'\n  },\n  null,\n  -1\n  /* HOISTED */\n)\nexport default defineComponent({\n  name: 'WarningOutlined',\n  render: function render(_ctx, _cache) {\n    return _openBlock(), _createBlock('svg', _hoisted_1, [_hoisted_2])\n  }\n})\n","export function happensIn(e, dataSetPropName) {\n    let { target } = e;\n    while (target) {\n        if (target.dataset) {\n            if (target.dataset[dataSetPropName] !== undefined)\n                return true;\n        }\n        target = target.parentElement;\n    }\n    return false;\n}\n","export const isIos = (typeof window === 'undefined'\n    ? false\n    : /iPad|iPhone|iPod/.test(navigator.platform) ||\n        (navigator.platform === 'MacIntel' && navigator.maxTouchPoints > 1)) &&\n    // eslint-disable-next-line @typescript-eslint/strict-boolean-expressions\n    !window.MSStream;\nexport default function useIsIos() {\n    return isIos;\n}\n","export function getSlot(instance, slotName = 'default', fallback = []) {\n    const slots = instance.$slots;\n    const slot = slots[slotName];\n    if (slot === undefined)\n        return fallback;\n    return slot();\n}\n","import { createTextVNode } from 'vue';\nexport const render = (r, ...args) => {\n    if (typeof r === 'function') {\n        return r(...args);\n    }\n    else if (typeof r === 'string') {\n        return createTextVNode(r);\n    }\n    else if (typeof r === 'number') {\n        return createTextVNode(String(r));\n    }\n    else {\n        return null;\n    }\n};\n","export function getTitleAttribute(value) {\n    switch (typeof value) {\n        case 'string':\n            // The empty string should also be reset to undefined.\n            return value || undefined;\n        case 'number':\n            return String(value);\n        default:\n            return undefined;\n    }\n}\n","import { h, defineComponent } from 'vue';\nexport default defineComponent({\n    name: 'Checkmark',\n    render() {\n        return (h(\"svg\", { xmlns: \"http://www.w3.org/2000/svg\", viewBox: \"0 0 16 16\" },\n            h(\"g\", { fill: \"none\" },\n                h(\"path\", { d: \"M14.046 3.486a.75.75 0 0 1-.032 1.06l-7.93 7.474a.85.85 0 0 1-1.188-.022l-2.68-2.72a.75.75 0 1 1 1.068-1.053l2.234 2.267l7.468-7.038a.75.75 0 0 1 1.06.032z\", fill: \"currentColor\" }))));\n    }\n});\n","import { h } from 'vue';\nimport { replaceable } from './replaceable';\nexport default replaceable('close', h(\"svg\", { viewBox: \"0 0 12 12\", version: \"1.1\", xmlns: \"http://www.w3.org/2000/svg\" },\n    h(\"g\", { stroke: \"none\", \"stroke-width\": \"1\", fill: \"none\", \"fill-rule\": \"evenodd\" },\n        h(\"g\", { fill: \"currentColor\", \"fill-rule\": \"nonzero\" },\n            h(\"path\", { d: \"M2.08859116,2.2156945 L2.14644661,2.14644661 C2.32001296,1.97288026 2.58943736,1.95359511 2.7843055,2.08859116 L2.85355339,2.14644661 L6,5.293 L9.14644661,2.14644661 C9.34170876,1.95118446 9.65829124,1.95118446 9.85355339,2.14644661 C10.0488155,2.34170876 10.0488155,2.65829124 9.85355339,2.85355339 L6.707,6 L9.85355339,9.14644661 C10.0271197,9.32001296 10.0464049,9.58943736 9.91140884,9.7843055 L9.85355339,9.85355339 C9.67998704,10.0271197 9.41056264,10.0464049 9.2156945,9.91140884 L9.14644661,9.85355339 L6,6.707 L2.85355339,9.85355339 C2.65829124,10.0488155 2.34170876,10.0488155 2.14644661,9.85355339 C1.95118446,9.65829124 1.95118446,9.34170876 2.14644661,9.14644661 L5.293,6 L2.14644661,2.85355339 C1.97288026,2.67998704 1.95359511,2.41056264 2.08859116,2.2156945 L2.14644661,2.14644661 L2.08859116,2.2156945 Z\" })))));\n","import { h, defineComponent } from 'vue';\nexport default defineComponent({\n    name: 'Empty',\n    render() {\n        return (h(\"svg\", { viewBox: \"0 0 28 28\", fill: \"none\", xmlns: \"http://www.w3.org/2000/svg\" },\n            h(\"path\", { d: \"M26 7.5C26 11.0899 23.0899 14 19.5 14C15.9101 14 13 11.0899 13 7.5C13 3.91015 15.9101 1 19.5 1C23.0899 1 26 3.91015 26 7.5ZM16.8536 4.14645C16.6583 3.95118 16.3417 3.95118 16.1464 4.14645C15.9512 4.34171 15.9512 4.65829 16.1464 4.85355L18.7929 7.5L16.1464 10.1464C15.9512 10.3417 15.9512 10.6583 16.1464 10.8536C16.3417 11.0488 16.6583 11.0488 16.8536 10.8536L19.5 8.20711L22.1464 10.8536C22.3417 11.0488 22.6583 11.0488 22.8536 10.8536C23.0488 10.6583 23.0488 10.3417 22.8536 10.1464L20.2071 7.5L22.8536 4.85355C23.0488 4.65829 23.0488 4.34171 22.8536 4.14645C22.6583 3.95118 22.3417 3.95118 22.1464 4.14645L19.5 6.79289L16.8536 4.14645Z\", fill: \"currentColor\" }),\n            h(\"path\", { d: \"M25 22.75V12.5991C24.5572 13.0765 24.053 13.4961 23.5 13.8454V16H17.5L17.3982 16.0068C17.0322 16.0565 16.75 16.3703 16.75 16.75C16.75 18.2688 15.5188 19.5 14 19.5C12.4812 19.5 11.25 18.2688 11.25 16.75L11.2432 16.6482C11.1935 16.2822 10.8797 16 10.5 16H4.5V7.25C4.5 6.2835 5.2835 5.5 6.25 5.5H12.2696C12.4146 4.97463 12.6153 4.47237 12.865 4H6.25C4.45507 4 3 5.45507 3 7.25V22.75C3 24.5449 4.45507 26 6.25 26H21.75C23.5449 26 25 24.5449 25 22.75ZM4.5 22.75V17.5H9.81597L9.85751 17.7041C10.2905 19.5919 11.9808 21 14 21L14.215 20.9947C16.2095 20.8953 17.842 19.4209 18.184 17.5H23.5V22.75C23.5 23.7165 22.7165 24.5 21.75 24.5H6.25C5.2835 24.5 4.5 23.7165 4.5 22.75Z\", fill: \"currentColor\" })));\n    }\n});\n","import { cB, cM, c } from '../../../../_utils/cssr'; // vars:\n// --close-color\n// --close-color-hover\n// --close-color-pressed\n// --close-color-disabled\n\nexport default cB('base-close', `\n cursor: pointer;\n color: var(--close-color);\n`, [c('&:hover', {\n  color: 'var(--close-color-hover)'\n}), c('&:active', {\n  color: 'var(--close-color-pressed)'\n}), cM('disabled', {\n  cursor: 'not-allowed!important',\n  color: 'var(--close-color-disabled)'\n})]);","import { h, defineComponent, toRef } from 'vue';\nimport { useStyle } from '../../../_mixins';\nimport NBaseIcon from '../../icon';\nimport { CloseIcon } from '../../icons';\nimport style from './styles/index.cssr';\nexport default defineComponent({\n    name: 'BaseClose',\n    props: {\n        clsPrefix: {\n            type: String,\n            required: true\n        },\n        disabled: {\n            type: Boolean,\n            default: undefined\n        },\n        onClick: Function\n    },\n    setup(props) {\n        useStyle('BaseClose', style, toRef(props, 'clsPrefix'));\n        return () => {\n            const { clsPrefix, disabled } = props;\n            return (h(NBaseIcon, { role: \"button\", ariaDisabled: disabled, ariaLabel: \"close\", clsPrefix: clsPrefix, class: [\n                    `${clsPrefix}-base-close`,\n                    disabled && `${clsPrefix}-base-close--disabled`\n                ], onClick: disabled ? undefined : props.onClick }, {\n                default: () => h(CloseIcon, null)\n            }));\n        };\n    }\n});\n","import { h, defineComponent } from 'vue';\nexport default defineComponent({\n    props: {\n        onFocus: Function,\n        onBlur: Function\n    },\n    setup(props) {\n        return () => (h(\"div\", { style: \"width: 0; height: 0\", tabindex: 0, onFocus: props.onFocus, onBlur: props.onBlur }));\n    }\n});\n","export function toArray(arg) {\n    if (Array.isArray(arg))\n        return arg;\n    return [arg];\n}\n// Do not use enum for lint plugin has error\nexport const TRAVERSE_COMMAND = {\n    STOP: 'STOP'\n};\nexport function traverseWithCb(treeNode, callback) {\n    const command = callback(treeNode);\n    if (treeNode.children !== undefined && command !== TRAVERSE_COMMAND.STOP) {\n        treeNode.children.forEach((childNode) => traverseWithCb(childNode, callback));\n    }\n}\nexport function getNonLeafKeys(treeNodes, options = {}) {\n    const { preserveGroup = false } = options;\n    const keys = [];\n    const cb = preserveGroup\n        ? (node) => {\n            if (!node.isLeaf) {\n                keys.push(node.key);\n                traverse(node.children);\n            }\n        }\n        : (node) => {\n            if (!node.isLeaf) {\n                if (!node.isGroup)\n                    keys.push(node.key);\n                traverse(node.children);\n            }\n        };\n    function traverse(nodes) {\n        nodes.forEach(cb);\n    }\n    traverse(treeNodes);\n    return keys;\n}\nexport function isLeaf(rawNode, getChildren) {\n    const { isLeaf } = rawNode;\n    if (isLeaf !== undefined)\n        return isLeaf;\n    else if (!getChildren(rawNode))\n        return true;\n    return false;\n}\nexport function defaultGetChildren(node) {\n    return node.children;\n}\nexport function defaultGetKey(node) {\n    return node.key;\n}\nexport function isIgnored() {\n    return false;\n}\nexport function isShallowLoaded(rawNode, getChildren) {\n    const { isLeaf } = rawNode;\n    if (isLeaf === false && !Array.isArray(getChildren(rawNode)))\n        return false;\n    return true;\n}\nexport function isDisabled(rawNode) {\n    return rawNode.disabled === true;\n}\nexport function isExpilicitlyNotLoaded(rawNode, getChildren) {\n    return (rawNode.isLeaf === false && !Array.isArray(getChildren(rawNode)));\n}\nexport function isNodeInvalid(rawNode, getChildren) {\n    return rawNode.isLeaf === true && Array.isArray(getChildren(rawNode));\n}\nexport function unwrapCheckedKeys(result) {\n    var _a;\n    if (result === undefined || result === null)\n        return [];\n    if (Array.isArray(result))\n        return result;\n    return (_a = result.checkedKeys) !== null && _a !== void 0 ? _a : [];\n}\nexport function unwrapIndeterminateKeys(result) {\n    var _a;\n    if (result === undefined || result === null || Array.isArray(result)) {\n        return [];\n    }\n    return (_a = result.indeterminateKeys) !== null && _a !== void 0 ? _a : [];\n}\nexport function merge(originalKeys, keysToAdd) {\n    const set = new Set(originalKeys);\n    keysToAdd.forEach((key) => {\n        if (!set.has(key)) {\n            set.add(key);\n        }\n    });\n    return Array.from(set);\n}\nexport function minus(originalKeys, keysToRemove) {\n    const set = new Set(originalKeys);\n    keysToRemove.forEach((key) => {\n        if (set.has(key)) {\n            set.delete(key);\n        }\n    });\n    return Array.from(set);\n}\nexport function isGroup(rawNode) {\n    return (rawNode === null || rawNode === void 0 ? void 0 : rawNode.type) === 'group';\n}\nexport function createIndexGetter(treeNodes) {\n    const map = new Map();\n    treeNodes.forEach((treeNode, i) => {\n        map.set(treeNode.key, i);\n    });\n    return (key) => { var _a; return (_a = map.get(key)) !== null && _a !== void 0 ? _a : null; };\n}\n","import { isExpilicitlyNotLoaded, merge, minus, traverseWithCb, TRAVERSE_COMMAND } from './utils';\nexport class SubtreeNotLoadedError extends Error {\n    constructor() {\n        super();\n        this.message =\n            'SubtreeNotLoadedError: checking a subtree whose required nodes are not fully loaded.';\n    }\n}\nfunction getExtendedCheckedKeySetAfterCheck(checkKeys, currentCheckedKeys, treeMate) {\n    return getExtendedCheckedKeySet(currentCheckedKeys.concat(checkKeys), treeMate);\n}\nfunction getAvailableAscendantNodeSet(uncheckedKeys, treeMate) {\n    const visitedKeys = new Set();\n    uncheckedKeys.forEach((uncheckedKey) => {\n        const uncheckedTreeNode = treeMate.treeNodeMap.get(uncheckedKey);\n        if (uncheckedTreeNode !== undefined) {\n            let nodeCursor = uncheckedTreeNode.parent;\n            while (nodeCursor !== null) {\n                if (nodeCursor.disabled)\n                    break;\n                if (visitedKeys.has(nodeCursor.key))\n                    break;\n                else {\n                    visitedKeys.add(nodeCursor.key);\n                }\n                nodeCursor = nodeCursor.parent;\n            }\n        }\n    });\n    return visitedKeys;\n}\nfunction getExtendedCheckedKeySetAfterUncheck(uncheckedKeys, currentCheckedKeys, treeMate) {\n    const extendedCheckedKeySet = getExtendedCheckedKeySet(currentCheckedKeys, treeMate);\n    const extendedKeySetToUncheck = getExtendedCheckedKeySet(uncheckedKeys, treeMate, true);\n    const ascendantKeySet = getAvailableAscendantNodeSet(uncheckedKeys, treeMate);\n    const keysToRemove = [];\n    extendedCheckedKeySet.forEach((key) => {\n        if (extendedKeySetToUncheck.has(key) || ascendantKeySet.has(key)) {\n            keysToRemove.push(key);\n        }\n    });\n    keysToRemove.forEach((key) => extendedCheckedKeySet.delete(key));\n    return extendedCheckedKeySet;\n}\nexport function getCheckedKeys(options, treeMate) {\n    const { checkedKeys, keysToCheck, keysToUncheck, indeterminateKeys, cascade, leafOnly, checkStrategy } = options;\n    if (!cascade) {\n        if (keysToCheck !== undefined) {\n            return {\n                checkedKeys: merge(checkedKeys, keysToCheck),\n                indeterminateKeys: Array.from(indeterminateKeys)\n            };\n        }\n        else if (keysToUncheck !== undefined) {\n            return {\n                checkedKeys: minus(checkedKeys, keysToUncheck),\n                indeterminateKeys: Array.from(indeterminateKeys)\n            };\n        }\n        else {\n            return {\n                checkedKeys: Array.from(checkedKeys),\n                indeterminateKeys: Array.from(indeterminateKeys)\n            };\n        }\n    }\n    const { levelTreeNodeMap } = treeMate;\n    let extendedCheckedKeySet;\n    if (keysToUncheck !== undefined) {\n        extendedCheckedKeySet = getExtendedCheckedKeySetAfterUncheck(keysToUncheck, checkedKeys, treeMate);\n    }\n    else if (keysToCheck !== undefined) {\n        extendedCheckedKeySet = getExtendedCheckedKeySetAfterCheck(keysToCheck, checkedKeys, treeMate);\n    }\n    else {\n        extendedCheckedKeySet = getExtendedCheckedKeySet(checkedKeys, treeMate);\n    }\n    const checkStrategyIsParent = checkStrategy === 'parent';\n    const checkStrategyIsChild = checkStrategy === 'child' || leafOnly;\n    const syntheticCheckedKeySet = extendedCheckedKeySet;\n    const syntheticIndeterminateKeySet = new Set();\n    const maxLevel = Math.max.apply(null, Array.from(levelTreeNodeMap.keys()));\n    // cascade check\n    // 1. if tree is fully loaded, it just works\n    // 2. if the tree is not fully loaded, we assume that keys which is in not\n    //    loaded tree are not in checked keys\n    //    for example:\n    //    a -- b(fully-loaded)   -- c(fully-loaded)\n    //      |- d(partial-loaded) -- ?e(not-loaded)\n    //    in the case, `e` is assumed not to be checked, nor we can't calc `d`'s\n    //    and `a`'s status\n    for (let level = maxLevel; level >= 0; level -= 1) {\n        const levelIsZero = level === 0;\n        // it should exists, nor it is a bug\n        const levelTreeNodes = levelTreeNodeMap.get(level);\n        for (const levelTreeNode of levelTreeNodes) {\n            if (levelTreeNode.isLeaf)\n                continue;\n            const { key: levelTreeNodeKey, shallowLoaded } = levelTreeNode;\n            if (checkStrategyIsChild && shallowLoaded) {\n                // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n                levelTreeNode.children.forEach((v) => {\n                    if (!v.disabled &&\n                        !v.isLeaf &&\n                        v.shallowLoaded &&\n                        syntheticCheckedKeySet.has(v.key)) {\n                        syntheticCheckedKeySet.delete(v.key);\n                    }\n                });\n            }\n            if (levelTreeNode.disabled || !shallowLoaded) {\n                continue;\n            }\n            let fullyChecked = true;\n            let partialChecked = false;\n            let allDisabled = true;\n            // it is shallow loaded, so `children` must exist\n            for (const childNode of levelTreeNode.children) {\n                const childKey = childNode.key;\n                if (childNode.disabled)\n                    continue;\n                if (allDisabled)\n                    allDisabled = false;\n                if (syntheticCheckedKeySet.has(childKey)) {\n                    partialChecked = true;\n                }\n                else if (syntheticIndeterminateKeySet.has(childKey)) {\n                    partialChecked = true;\n                    fullyChecked = false;\n                    break;\n                }\n                else {\n                    fullyChecked = false;\n                    if (partialChecked) {\n                        break;\n                    }\n                }\n            }\n            if (fullyChecked && !allDisabled) {\n                if (checkStrategyIsParent) {\n                    // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n                    levelTreeNode.children.forEach((v) => {\n                        if (!v.disabled && syntheticCheckedKeySet.has(v.key)) {\n                            syntheticCheckedKeySet.delete(v.key);\n                        }\n                    });\n                }\n                syntheticCheckedKeySet.add(levelTreeNodeKey);\n            }\n            else if (partialChecked) {\n                syntheticIndeterminateKeySet.add(levelTreeNodeKey);\n            }\n            if (levelIsZero &&\n                checkStrategyIsChild &&\n                syntheticCheckedKeySet.has(levelTreeNodeKey)) {\n                syntheticCheckedKeySet.delete(levelTreeNodeKey);\n            }\n        }\n    }\n    return {\n        checkedKeys: Array.from(syntheticCheckedKeySet),\n        indeterminateKeys: Array.from(syntheticIndeterminateKeySet)\n    };\n}\n// unchecking is safe when doing cascade uncheck in async mode\nexport function getExtendedCheckedKeySet(checkedKeys, treeMate, isUnchecking = false) {\n    const { treeNodeMap, getChildren } = treeMate;\n    const visitedKeySet = new Set();\n    const extendedKeySet = new Set(checkedKeys);\n    checkedKeys.forEach((checkedKey) => {\n        const checkedTreeNode = treeNodeMap.get(checkedKey);\n        if (checkedTreeNode !== undefined) {\n            traverseWithCb(checkedTreeNode, (treeNode) => {\n                if (treeNode.disabled) {\n                    return TRAVERSE_COMMAND.STOP;\n                }\n                const { key } = treeNode;\n                if (visitedKeySet.has(key))\n                    return;\n                visitedKeySet.add(key);\n                // Adding keys before loaded check is okay, since if not valid error\n                // would be thrown\n                extendedKeySet.add(key);\n                if (isExpilicitlyNotLoaded(treeNode.rawNode, getChildren)) {\n                    if (isUnchecking) {\n                        return TRAVERSE_COMMAND.STOP;\n                    }\n                    else {\n                        throw new SubtreeNotLoadedError();\n                    }\n                }\n            });\n        }\n    });\n    return extendedKeySet;\n}\n","export function getPath(key, { includeGroup = false, includeSelf = true }, treeMate) {\n    var _a;\n    const treeNodeMap = treeMate.treeNodeMap;\n    let treeNode = key === null || key === undefined ? null : (_a = treeNodeMap.get(key)) !== null && _a !== void 0 ? _a : null;\n    const mergedPath = {\n        keyPath: [],\n        treeNodePath: [],\n        treeNode: treeNode\n    };\n    if (treeNode === null || treeNode === void 0 ? void 0 : treeNode.ignored) {\n        mergedPath.treeNode = null;\n        return mergedPath;\n    }\n    while (treeNode) {\n        if (!treeNode.ignored && (includeGroup || !treeNode.isGroup)) {\n            mergedPath.treeNodePath.push(treeNode);\n        }\n        treeNode = treeNode.parent;\n    }\n    mergedPath.treeNodePath.reverse();\n    if (!includeSelf)\n        mergedPath.treeNodePath.pop();\n    mergedPath.keyPath = mergedPath.treeNodePath.map((treeNode) => treeNode.key);\n    return mergedPath;\n}\n","export function getFirstAvailableNode(nodes) {\n    if (nodes.length === 0)\n        return null;\n    const node = nodes[0];\n    if (node.isGroup || node.ignored || node.disabled) {\n        return node.getNext();\n    }\n    return node;\n}\nfunction rawGetNext(node, loop) {\n    const sibs = node.siblings;\n    const l = sibs.length;\n    const { index } = node;\n    if (loop) {\n        return sibs[(index + 1) % l];\n    }\n    else {\n        if (index === sibs.length - 1)\n            return null;\n        return sibs[index + 1];\n    }\n}\nfunction move(fromNode, dir, { loop = false, includeDisabled = false } = {}) {\n    const iterate = dir === 'prev' ? rawGetPrev : rawGetNext;\n    const getChildOptions = {\n        reverse: dir === 'prev'\n    };\n    let meet = false;\n    let endNode = null;\n    function traverse(node) {\n        if (node === null)\n            return;\n        if (node === fromNode) {\n            if (!meet) {\n                meet = true;\n            }\n            else if (!fromNode.disabled && !fromNode.isGroup) {\n                endNode = fromNode;\n                return;\n            }\n        }\n        else {\n            if ((!node.disabled || includeDisabled) &&\n                !node.ignored &&\n                !node.isGroup) {\n                endNode = node;\n                return;\n            }\n        }\n        if (node.isGroup) {\n            const child = getChild(node, getChildOptions);\n            if (child !== null) {\n                endNode = child;\n            }\n            else {\n                traverse(iterate(node, loop));\n            }\n        }\n        else {\n            const nextNode = iterate(node, false);\n            if (nextNode !== null) {\n                traverse(nextNode);\n            }\n            else {\n                const parent = rawGetParent(node);\n                if (parent === null || parent === void 0 ? void 0 : parent.isGroup) {\n                    traverse(iterate(parent, loop));\n                }\n                else if (loop) {\n                    traverse(iterate(node, true));\n                }\n            }\n        }\n    }\n    traverse(fromNode);\n    return endNode;\n}\nfunction rawGetPrev(node, loop) {\n    const sibs = node.siblings;\n    const l = sibs.length;\n    const { index } = node;\n    if (loop) {\n        return sibs[(index - 1 + l) % l];\n    }\n    else {\n        if (index === 0)\n            return null;\n        return sibs[index - 1];\n    }\n}\nfunction rawGetParent(node) {\n    return node.parent;\n}\nfunction getChild(node, options = {}) {\n    const { reverse = false } = options;\n    const { children } = node;\n    if (children) {\n        const { length } = children;\n        const start = reverse ? length - 1 : 0;\n        const end = reverse ? -1 : length;\n        const delta = reverse ? -1 : 1;\n        for (let i = start; i !== end; i += delta) {\n            const child = children[i];\n            if (!child.disabled && !child.ignored) {\n                if (child.isGroup) {\n                    const childInGroup = getChild(child, options);\n                    if (childInGroup !== null)\n                        return childInGroup;\n                }\n                else {\n                    return child;\n                }\n            }\n        }\n    }\n    return null;\n}\nexport const moveMethods = {\n    getChild() {\n        if (this.ignored)\n            return null;\n        return getChild(this);\n    },\n    getParent() {\n        const { parent } = this;\n        if (parent === null || parent === void 0 ? void 0 : parent.isGroup) {\n            return parent.getParent();\n        }\n        return parent;\n    },\n    getNext(options = {}) {\n        return move(this, 'next', options);\n    },\n    getPrev(options = {}) {\n        return move(this, 'prev', options);\n    }\n};\n","export function flatten(treeNodes, expandedKeys) {\n    const expandedKeySet = expandedKeys ? new Set(expandedKeys) : undefined;\n    const flattenedNodes = [];\n    function traverse(treeNodes) {\n        treeNodes.forEach((treeNode) => {\n            flattenedNodes.push(treeNode);\n            if (treeNode.isLeaf || !treeNode.children || treeNode.ignored)\n                return;\n            if (treeNode.isGroup) {\n                // group node shouldn't be expanded\n                traverse(treeNode.children);\n            }\n            else if (\n            // normal non-leaf node\n            expandedKeySet === undefined ||\n                expandedKeySet.has(treeNode.key)) {\n                traverse(treeNode.children);\n            }\n        });\n    }\n    traverse(treeNodes);\n    return flattenedNodes;\n}\n","export function contains(parent, child) {\n    const parentKey = parent.key;\n    // eslint-disable-next-line no-unmodified-loop-condition\n    while (child) {\n        if (child.key === parentKey)\n            return true;\n        child = child.parent;\n    }\n    return false;\n}\n","import { getCheckedKeys } from './check';\nimport { toArray, isDisabled, isLeaf, isGroup, isNodeInvalid, unwrapCheckedKeys, isShallowLoaded, unwrapIndeterminateKeys, getNonLeafKeys, isIgnored, defaultGetChildren, defaultGetKey } from './utils';\nimport { getPath } from './path';\nimport { moveMethods, getFirstAvailableNode } from './move';\nimport { flatten } from './flatten';\nimport { contains } from './contains';\nfunction createTreeNodes(rawNodes, treeNodeMap, levelTreeNodeMap, nodeProto, getChildren, parent = null, level = 0) {\n    const treeNodes = [];\n    rawNodes.forEach((rawNode, index) => {\n        var _a;\n        if (process.env.NODE_ENV !== 'production' &&\n            isNodeInvalid(rawNode, getChildren)) {\n            console.error('[treemate]: node', rawNode, 'is invalid');\n        }\n        const treeNode = Object.create(nodeProto);\n        treeNode.rawNode = rawNode;\n        treeNode.siblings = treeNodes;\n        treeNode.level = level;\n        treeNode.index = index;\n        treeNode.isFirstChild = index === 0;\n        treeNode.isLastChild = index + 1 === rawNodes.length;\n        treeNode.parent = parent;\n        if (!treeNode.ignored) {\n            const rawChildren = getChildren(rawNode);\n            if (Array.isArray(rawChildren)) {\n                treeNode.children = createTreeNodes(rawChildren, treeNodeMap, levelTreeNodeMap, nodeProto, getChildren, treeNode, level + 1);\n            }\n        }\n        treeNodes.push(treeNode);\n        treeNodeMap.set(treeNode.key, treeNode);\n        if (!levelTreeNodeMap.has(level))\n            levelTreeNodeMap.set(level, []);\n        (_a = levelTreeNodeMap.get(level)) === null || _a === void 0 ? void 0 : _a.push(treeNode);\n    });\n    return treeNodes;\n}\nexport function createTreeMate(rawNodes, options = {}) {\n    const treeNodeMap = new Map();\n    const levelTreeNodeMap = new Map();\n    const { getDisabled = isDisabled, getIgnored = isIgnored, getChildren = defaultGetChildren, getIsGroup = isGroup, getKey = defaultGetKey } = options;\n    const nodeProto = Object.assign({\n        get key() {\n            // do not pass parent or related things to it\n            // the key need to be specified explicitly\n            return getKey(this.rawNode);\n        },\n        get disabled() {\n            return getDisabled(this.rawNode);\n        },\n        get isGroup() {\n            return getIsGroup(this.rawNode);\n        },\n        get isLeaf() {\n            return isLeaf(this.rawNode, getChildren);\n        },\n        get shallowLoaded() {\n            return isShallowLoaded(this.rawNode, getChildren);\n        },\n        get ignored() {\n            return getIgnored(this.rawNode);\n        },\n        contains(node) {\n            return contains(this, node);\n        }\n    }, moveMethods);\n    const treeNodes = createTreeNodes(rawNodes, treeNodeMap, levelTreeNodeMap, nodeProto, getChildren);\n    function getNode(key) {\n        if (key === null || key === undefined)\n            return null;\n        const tmNode = treeNodeMap.get(key);\n        if (tmNode && !tmNode.isGroup && !tmNode.ignored) {\n            return tmNode;\n        }\n        return null;\n    }\n    function _getNode(key) {\n        if (key === null || key === undefined)\n            return null;\n        const tmNode = treeNodeMap.get(key);\n        if (tmNode && !tmNode.ignored) {\n            return tmNode;\n        }\n        return null;\n    }\n    function getPrev(key, options) {\n        const node = _getNode(key);\n        if (!node)\n            return null;\n        return node.getPrev(options);\n    }\n    function getNext(key, options) {\n        const node = _getNode(key);\n        if (!node)\n            return null;\n        return node.getNext(options);\n    }\n    function getParent(key) {\n        const node = _getNode(key);\n        if (!node)\n            return null;\n        return node.getParent();\n    }\n    function getChild(key) {\n        const node = _getNode(key);\n        if (!node)\n            return null;\n        return node.getChild();\n    }\n    const treemate = {\n        treeNodes,\n        treeNodeMap,\n        levelTreeNodeMap,\n        maxLevel: Math.max(...levelTreeNodeMap.keys()),\n        getChildren,\n        getFlattenedNodes(expandedKeys) {\n            return flatten(treeNodes, expandedKeys);\n        },\n        getNode,\n        getPrev,\n        getNext,\n        getParent,\n        getChild,\n        getFirstAvailableNode() {\n            return getFirstAvailableNode(treeNodes);\n        },\n        getPath(key, options = {}) {\n            return getPath(key, options, treemate);\n        },\n        getCheckedKeys(checkedKeys, options = {}) {\n            const { cascade = true, leafOnly = false, checkStrategy = 'all' } = options;\n            return getCheckedKeys({\n                checkedKeys: unwrapCheckedKeys(checkedKeys),\n                indeterminateKeys: unwrapIndeterminateKeys(checkedKeys),\n                cascade,\n                leafOnly,\n                checkStrategy\n            }, treemate);\n        },\n        check(keysToCheck, checkedKeys, options = {}) {\n            const { cascade = true, leafOnly = false, checkStrategy = 'all' } = options;\n            return getCheckedKeys({\n                checkedKeys: unwrapCheckedKeys(checkedKeys),\n                indeterminateKeys: unwrapIndeterminateKeys(checkedKeys),\n                keysToCheck: keysToCheck === undefined || keysToCheck === null\n                    ? []\n                    : toArray(keysToCheck),\n                cascade,\n                leafOnly,\n                checkStrategy\n            }, treemate);\n        },\n        uncheck(keysToUncheck, checkedKeys, options = {}) {\n            const { cascade = true, leafOnly = false, checkStrategy = 'all' } = options;\n            return getCheckedKeys({\n                checkedKeys: unwrapCheckedKeys(checkedKeys),\n                indeterminateKeys: unwrapIndeterminateKeys(checkedKeys),\n                keysToUncheck: keysToUncheck === null || keysToUncheck === undefined\n                    ? []\n                    : toArray(keysToUncheck),\n                cascade,\n                leafOnly,\n                checkStrategy\n            }, treemate);\n        },\n        getNonLeafKeys(options = {}) {\n            return getNonLeafKeys(treeNodes, options);\n        }\n    };\n    return treemate;\n}\n","function lowBit(n) {\n    return n & -n;\n}\nexport class FinweckTree {\n    /**\n     * @param l length of the array\n     * @param min min value of the array\n     */\n    constructor(l, min) {\n        this.l = l;\n        this.min = min;\n        const ft = new Array(l + 1);\n        for (let i = 0; i < l + 1; ++i) {\n            ft[i] = 0;\n        }\n        this.ft = ft;\n    }\n    /**\n     * Add arr[i] by n, start from 0\n     * @param i the index of the element to be added\n     * @param n the value to be added\n     */\n    add(i, n) {\n        if (n === 0)\n            return;\n        const { l, ft } = this;\n        i += 1;\n        while (i <= l) {\n            ft[i] += n;\n            i += lowBit(i);\n        }\n    }\n    /**\n     * Get the value of index i\n     * @param i index\n     * @returns value of the index\n     */\n    get(i) {\n        return this.sum(i + 1) - this.sum(i);\n    }\n    /**\n     * Get the sum of first i elements\n     * @param i count of head elements to be added\n     * @returns the sum of first i elements\n     */\n    sum(i) {\n        if (i === 0)\n            return 0;\n        const { ft, min, l } = this;\n        if (i === undefined)\n            i = l;\n        if (i > l)\n            throw new Error('[FinweckTree.sum]: `i` is larger than length.');\n        let ret = i * min;\n        while (i > 0) {\n            ret += ft[i];\n            i -= lowBit(i);\n        }\n        return ret;\n    }\n    /**\n     * Get the largest count of head elements whose sum are <= threshold\n     * @param threshold\n     * @returns the largest count of head elements whose sum are <= threshold\n     */\n    getBound(threshold) {\n        let l = 0;\n        let r = this.l;\n        while (r > l) {\n            const m = Math.floor((l + r) / 2);\n            const sumM = this.sum(m);\n            if (sumM > threshold) {\n                r = m;\n                continue;\n            }\n            else if (sumM < threshold) {\n                if (l === m) {\n                    if (this.sum(l + 1) <= threshold)\n                        return l + 1;\n                    return m;\n                }\n                l = m;\n            }\n            else {\n                return m;\n            }\n        }\n        return l;\n    }\n}\n","/* eslint-disable no-void */\n/* eslint-disable @typescript-eslint/restrict-plus-operands */\nimport { mergeProps, computed, defineComponent, ref, onMounted, h } from 'vue';\nimport { depx, pxfy, beforeNextFrameOnce } from 'seemly';\nimport { useMemo } from 'vooks';\nimport { c, FinweckTree } from '../../shared';\nimport VResizeObserver from '../../resize-observer/src';\nimport { useSsrAdapter } from '@css-render/vue3-ssr';\nconst styles = c('.v-vl', {\n    maxHeight: 'inherit',\n    height: '100%',\n    overflow: 'auto',\n    minWidth: '1px' // a zero width container won't be scrollable\n}, [\n    c('&:not(.v-vl--show-scrollbar)', {\n        scrollbarWidth: 'none'\n    }, [\n        c('&::-webkit-scrollbar, &::-webkit-scrollbar-track-piece, &::-webkit-scrollbar-thumb', {\n            width: 0,\n            height: 0,\n            display: 'none'\n        })\n    ])\n]);\nexport default defineComponent({\n    name: 'VirtualList',\n    inheritAttrs: false,\n    props: {\n        showScrollbar: {\n            type: Boolean,\n            default: true\n        },\n        items: {\n            type: Array,\n            default: () => []\n        },\n        // it is suppose to be the min height\n        itemSize: {\n            type: Number,\n            required: true\n        },\n        itemResizable: Boolean,\n        itemsStyle: [String, Object],\n        visibleItemsTag: {\n            type: [String, Object],\n            default: 'div'\n        },\n        visibleItemsProps: Object,\n        ignoreItemResize: Boolean,\n        onScroll: Function,\n        onWheel: Function,\n        onResize: Function,\n        defaultScrollKey: [Number, String],\n        defaultScrollIndex: Number,\n        keyField: {\n            type: String,\n            default: 'key'\n        },\n        // Whether it is a good API?\n        // ResizeObserver + footer & header is not enough.\n        // Too complex for simple case\n        paddingTop: {\n            type: [Number, String],\n            default: 0\n        },\n        paddingBottom: {\n            type: [Number, String],\n            default: 0\n        }\n    },\n    setup(props) {\n        const ssrAdapter = useSsrAdapter();\n        styles.mount({\n            id: 'vueuc/virtual-list',\n            head: true,\n            ssr: ssrAdapter\n        });\n        onMounted(() => {\n            const { defaultScrollIndex, defaultScrollKey } = props;\n            if (defaultScrollIndex !== undefined && defaultScrollIndex !== null) {\n                scrollTo({ index: defaultScrollIndex });\n            }\n            else if (defaultScrollKey !== undefined && defaultScrollKey !== null) {\n                scrollTo({ key: defaultScrollKey });\n            }\n        });\n        const keyIndexMapRef = computed(() => {\n            const map = new Map();\n            const { keyField } = props;\n            props.items.forEach((item, index) => {\n                map.set(item[keyField], index);\n            });\n            return map;\n        });\n        const listElRef = ref(null);\n        const listHeightRef = ref(undefined);\n        const keyToHeightOffset = new Map();\n        const finweckTreeRef = computed(() => {\n            const { items, itemSize, keyField } = props;\n            const ft = new FinweckTree(items.length, itemSize);\n            items.forEach((item, index) => {\n                const key = item[keyField];\n                const heightOffset = keyToHeightOffset.get(key);\n                if (heightOffset !== undefined) {\n                    ft.add(index, heightOffset);\n                }\n            });\n            return ft;\n        });\n        const finweckTreeUpdateTrigger = ref(0);\n        const scrollTopRef = ref(0);\n        const startIndexRef = useMemo(() => {\n            return Math.max(finweckTreeRef.value.getBound(scrollTopRef.value - depx(props.paddingTop)) - 1, 0);\n        });\n        const viewportItemsRef = computed(() => {\n            const { value: listHeight } = listHeightRef;\n            if (listHeight === undefined)\n                return [];\n            const { items, itemSize } = props;\n            const startIndex = startIndexRef.value;\n            const endIndex = Math.min(startIndex + Math.ceil(listHeight / itemSize + 1), items.length - 1);\n            const viewportItems = [];\n            for (let i = startIndex; i <= endIndex; ++i) {\n                viewportItems.push(items[i]);\n            }\n            return viewportItems;\n        });\n        const scrollTo = (options) => {\n            const { left, top, index, key, position, behavior, debounce = true } = options;\n            if (left !== undefined || top !== undefined) {\n                scrollToPosition(left, top, behavior);\n            }\n            else if (index !== undefined) {\n                scrollToIndex(index, behavior, debounce);\n            }\n            else if (key !== undefined) {\n                const toIndex = keyIndexMapRef.value.get(key);\n                if (toIndex !== undefined)\n                    scrollToIndex(toIndex, behavior, debounce);\n            }\n            else if (position === 'bottom') {\n                scrollToPosition(0, Number.MAX_SAFE_INTEGER, behavior);\n            }\n            else if (position === 'top') {\n                scrollToPosition(0, 0, behavior);\n            }\n        };\n        function scrollToIndex(index, behavior, debounce) {\n            const { value: ft } = finweckTreeRef;\n            const targetTop = ft.sum(index) + depx(props.paddingTop);\n            if (!debounce) {\n                listElRef.value.scrollTo({\n                    left: 0,\n                    top: targetTop,\n                    behavior\n                });\n            }\n            else {\n                const { scrollTop, offsetHeight } = listElRef.value;\n                if (targetTop > scrollTop) {\n                    const itemSize = ft.get(index);\n                    if (targetTop + itemSize <= scrollTop + offsetHeight) {\n                        // do nothing\n                    }\n                    else {\n                        listElRef.value.scrollTo({\n                            left: 0,\n                            top: targetTop + itemSize - offsetHeight,\n                            behavior\n                        });\n                    }\n                }\n                else {\n                    listElRef.value.scrollTo({\n                        left: 0,\n                        top: targetTop,\n                        behavior\n                    });\n                }\n            }\n            lastScrollAnchorIndex = index;\n        }\n        function scrollToPosition(left, top, behavior) {\n            listElRef.value.scrollTo({\n                left,\n                top,\n                behavior\n            });\n        }\n        function handleItemResize(key, entry) {\n            var _a;\n            if (props.ignoreItemResize)\n                return;\n            const { value: ft } = finweckTreeRef;\n            const index = keyIndexMapRef.value.get(key);\n            const height = entry.target.offsetHeight;\n            // height offset based on itemSize\n            // used when rebuild the finweck tree\n            const offset = height - props.itemSize;\n            if (offset === 0) {\n                keyToHeightOffset.delete(key);\n            }\n            else {\n                keyToHeightOffset.set(key, height - props.itemSize);\n            }\n            // delta height based on finweck tree data\n            const delta = height - ft.get(index);\n            if (delta === 0)\n                return;\n            if (lastAnchorIndex !== undefined && index <= lastAnchorIndex) {\n                (_a = listElRef.value) === null || _a === void 0 ? void 0 : _a.scrollBy(0, delta);\n            }\n            ft.add(index, delta);\n            finweckTreeUpdateTrigger.value++;\n        }\n        function handleListScroll(e) {\n            beforeNextFrameOnce(syncViewport);\n            const { onScroll } = props;\n            if (onScroll !== undefined)\n                onScroll(e);\n        }\n        function handleListResize(entry) {\n            listHeightRef.value = entry.contentRect.height;\n            const { onResize } = props;\n            if (onResize !== undefined)\n                onResize(entry);\n        }\n        let lastScrollAnchorIndex;\n        let lastAnchorIndex;\n        function syncViewport() {\n            const { value: listEl } = listElRef;\n            // sometime ref el can be null\n            // https://github.com/TuSimple/naive-ui/issues/811\n            if (listEl == null)\n                return;\n            lastAnchorIndex = lastScrollAnchorIndex !== null && lastScrollAnchorIndex !== void 0 ? lastScrollAnchorIndex : startIndexRef.value;\n            lastScrollAnchorIndex = undefined;\n            scrollTopRef.value = listElRef.value.scrollTop;\n        }\n        return {\n            listHeight: listHeightRef,\n            listStyle: {\n                overflow: 'auto'\n            },\n            keyToIndex: keyIndexMapRef,\n            itemsStyle: computed(() => {\n                const { itemResizable } = props;\n                const height = pxfy(finweckTreeRef.value.sum());\n                // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n                finweckTreeUpdateTrigger.value;\n                return [\n                    props.itemsStyle,\n                    {\n                        boxSizing: 'content-box',\n                        height: itemResizable ? '' : height,\n                        minHeight: itemResizable ? height : '',\n                        paddingTop: pxfy(props.paddingTop),\n                        paddingBottom: pxfy(props.paddingBottom)\n                    }\n                ];\n            }),\n            visibleItemsStyle: computed(() => {\n                // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n                finweckTreeUpdateTrigger.value;\n                return {\n                    transform: `translate3d(0, ${pxfy(finweckTreeRef.value.sum(startIndexRef.value))}, 0)`\n                };\n            }),\n            viewportItems: viewportItemsRef,\n            listElRef,\n            itemsElRef: ref(null),\n            scrollTo,\n            handleListResize,\n            handleListScroll,\n            handleItemResize\n        };\n    },\n    render() {\n        const { itemResizable, keyField, keyToIndex, visibleItemsTag } = this;\n        return h(VResizeObserver, {\n            onResize: this.handleListResize\n        }, {\n            default: () => {\n                var _a, _b;\n                return h('div', mergeProps(this.$attrs, {\n                    class: [\n                        'v-vl',\n                        this.showScrollbar && 'v-vl--show-scrollbar'\n                    ],\n                    onScroll: this.handleListScroll,\n                    onWheel: this.onWheel,\n                    ref: 'listElRef'\n                }), [\n                    this.items.length !== 0\n                        ? h('div', {\n                            ref: 'itemsElRef',\n                            class: 'v-vl-items',\n                            style: this.itemsStyle\n                        }, [\n                            h(visibleItemsTag, Object.assign({\n                                class: 'v-vl-visible-items',\n                                style: this.visibleItemsStyle\n                            }, this.visibleItemsProps), {\n                                default: () => this.viewportItems.map(item => {\n                                    const key = item[keyField];\n                                    const index = keyToIndex.get(key);\n                                    const itemVNode = this.$slots.default({ item, index })[0];\n                                    if (itemResizable) {\n                                        return h(VResizeObserver, {\n                                            key,\n                                            onResize: (entry) => this.handleItemResize(key, entry)\n                                        }, {\n                                            default: () => itemVNode\n                                        });\n                                    }\n                                    itemVNode.key = key;\n                                    return itemVNode;\n                                })\n                            })\n                        ])\n                        : (_b = (_a = this.$slots).empty) === null || _b === void 0 ? void 0 : _b.call(_a)\n                ]);\n            }\n        });\n    }\n});\n","/* eslint-disable @typescript-eslint/strict-boolean-expressions */\nimport { defineComponent, renderSlot, h, onMounted, ref, nextTick } from 'vue';\nimport { useSsrAdapter } from '@css-render/vue3-ssr';\nimport { c } from '../../shared';\nconst hiddenAttr = 'v-hidden';\nconst style = c('[v-hidden]', {\n    display: 'none!important'\n});\nexport default defineComponent({\n    name: 'Overflow',\n    props: {\n        getCounter: Function,\n        getTail: Function,\n        updateCounter: Function,\n        onUpdateOverflow: Function\n    },\n    setup(props, { slots }) {\n        const selfRef = ref(null);\n        const counterRef = ref(null);\n        function deriveCounter() {\n            const { value: self } = selfRef;\n            const { getCounter, getTail } = props;\n            let counter;\n            if (getCounter !== undefined)\n                counter = getCounter();\n            else {\n                counter = counterRef.value;\n            }\n            if (!self || !counter)\n                return;\n            if (counter.hasAttribute(hiddenAttr)) {\n                counter.removeAttribute(hiddenAttr);\n            }\n            const { children } = self;\n            const containerWidth = self.offsetWidth;\n            const childWidths = [];\n            const tail = slots.tail ? getTail === null || getTail === void 0 ? void 0 : getTail() : null;\n            let childWidthSum = tail ? tail.offsetWidth : 0;\n            let overflow = false;\n            const len = self.children.length - (slots.tail ? 1 : 0);\n            for (let i = 0; i < len - 1; ++i) {\n                if (i < 0)\n                    continue;\n                const child = children[i];\n                if (overflow) {\n                    if (!child.hasAttribute(hiddenAttr)) {\n                        child.setAttribute(hiddenAttr, '');\n                    }\n                    continue;\n                }\n                else if (child.hasAttribute(hiddenAttr)) {\n                    child.removeAttribute(hiddenAttr);\n                }\n                const childWidth = child.offsetWidth;\n                childWidthSum += childWidth;\n                childWidths[i] = childWidth;\n                if (childWidthSum > containerWidth) {\n                    const { updateCounter } = props;\n                    for (let j = i; j >= 0; --j) {\n                        const restCount = len - 1 - j;\n                        if (updateCounter !== undefined) {\n                            updateCounter(restCount);\n                        }\n                        else {\n                            counter.textContent = `${restCount}`;\n                        }\n                        const counterWidth = counter.offsetWidth;\n                        childWidthSum -= childWidths[j];\n                        if (childWidthSum + counterWidth <= containerWidth || j === 0) {\n                            overflow = true;\n                            i = j - 1;\n                            if (tail) {\n                                // tail too long or 1st element too long\n                                // we only consider tail now\n                                if (i === -1) {\n                                    tail.style.maxWidth = `${containerWidth - counterWidth}px`;\n                                    tail.style.boxSizing = 'border-box';\n                                }\n                                else {\n                                    tail.style.maxWidth = '';\n                                }\n                            }\n                            break;\n                        }\n                    }\n                }\n            }\n            const { onUpdateOverflow } = props;\n            if (!overflow) {\n                if (onUpdateOverflow !== undefined) {\n                    onUpdateOverflow(false);\n                }\n                counter.setAttribute(hiddenAttr, '');\n            }\n            else {\n                if (onUpdateOverflow !== undefined) {\n                    onUpdateOverflow(true);\n                }\n            }\n        }\n        const ssrAdapter = useSsrAdapter();\n        style.mount({\n            id: 'vueuc/overflow',\n            head: true,\n            ssr: ssrAdapter\n        });\n        onMounted(deriveCounter);\n        // besides onMounted, other case should be manually triggered, or we shoud watch items\n        return {\n            selfRef,\n            counterRef,\n            sync: deriveCounter\n        };\n    },\n    render() {\n        const { $slots } = this;\n        // eslint-disable-next-line @typescript-eslint/no-floating-promises\n        nextTick(this.sync);\n        // It shouldn't have border\n        return h('div', {\n            class: 'v-overflow',\n            ref: 'selfRef'\n        }, [\n            renderSlot($slots, 'default'),\n            // $slots.counter should only has 1 element\n            $slots.counter\n                ? $slots.counter()\n                : h('span', {\n                    style: {\n                        display: 'inline-block'\n                    },\n                    ref: 'counterRef'\n                }),\n            // $slots.tail should only has 1 element\n            $slots.tail ? $slots.tail() : null\n        ]);\n    }\n});\n","export default {\n    iconSizeSmall: '34px',\n    iconSizeMedium: '40px',\n    iconSizeLarge: '46px',\n    iconSizeHuge: '52px'\n};\n","import commonVars from './_common';\nimport { commonLight } from '../../_styles/common';\nexport const self = (vars) => {\n    const { textColorDisabled, iconColor, textColor2, fontSizeSmall, fontSizeMedium, fontSizeLarge, fontSizeHuge } = vars;\n    return Object.assign(Object.assign({}, commonVars), { fontSizeSmall,\n        fontSizeMedium,\n        fontSizeLarge,\n        fontSizeHuge, textColor: textColorDisabled, iconColor: iconColor, extraTextColor: textColor2 });\n};\nconst emptyLight = {\n    name: 'Empty',\n    common: commonLight,\n    self\n};\nexport default emptyLight;\n","import { cB, cE } from '../../../_utils/cssr'; // vars:\n// --font-size\n// --icon-size\n// --icon-color\n// --bezier\n// --text-color\n// --extra-text-color\n\nexport default cB('empty', `\n display: flex;\n flex-direction: column;\n align-items: center;\n font-size: var(--font-size);\n`, [cE('icon', `\n width: var(--icon-size);\n height: var(--icon-size);\n font-size: var(--icon-size);\n line-height: var(--icon-size);\n color: var(--icon-color);\n transition:\n color .3s var(--bezier);\n `), cE('description', `\n margin-top: 8px;\n transition: color .3s var(--bezier);\n color: var(--text-color);\n `), cE('extra', `\n text-align: center;\n transition: color .3s var(--bezier);\n margin-top: 12px;\n color: var(--extra-text-color);\n `)]);","import { h, defineComponent, computed, renderSlot, inject } from 'vue';\nimport { EmptyIcon } from '../../_internal/icons';\nimport { useConfig, useLocale, useTheme } from '../../_mixins';\nimport { createKey } from '../../_utils';\nimport { NBaseIcon } from '../../_internal';\nimport { emptyLight } from '../styles';\nimport style from './styles/index.cssr';\nimport { configProviderInjectionKey } from '../../config-provider/src/ConfigProvider';\nconst emptyProps = Object.assign(Object.assign({}, useTheme.props), { description: {\n        type: String,\n        default: undefined\n    }, showDescription: {\n        type: Boolean,\n        default: true\n    }, size: {\n        type: String,\n        default: 'medium'\n    }, renderIcon: Function });\nexport default defineComponent({\n    name: 'Empty',\n    props: emptyProps,\n    setup(props) {\n        const { mergedClsPrefixRef } = useConfig(props);\n        const themeRef = useTheme('Empty', 'Empty', style, emptyLight, props, mergedClsPrefixRef);\n        const { localeRef } = useLocale('Empty');\n        const NConfigProvider = inject(configProviderInjectionKey, null);\n        const mergedDescriptionRef = computed(() => {\n            var _a, _b, _c;\n            return ((_a = props.description) !== null && _a !== void 0 ? _a : (_c = (_b = NConfigProvider === null || NConfigProvider === void 0 ? void 0 : NConfigProvider.mergedComponentPropsRef.value) === null || _b === void 0 ? void 0 : _b.Empty) === null || _c === void 0 ? void 0 : _c.description);\n        });\n        const mergedRenderIconRef = computed(() => {\n            var _a, _b;\n            return ((_b = (_a = NConfigProvider === null || NConfigProvider === void 0 ? void 0 : NConfigProvider.mergedComponentPropsRef.value) === null || _a === void 0 ? void 0 : _a.Empty) === null || _b === void 0 ? void 0 : _b.renderIcon) ||\n                (() => h(EmptyIcon, null));\n        });\n        return {\n            mergedClsPrefix: mergedClsPrefixRef,\n            mergedRenderIcon: mergedRenderIconRef,\n            localizedDescription: computed(() => {\n                return mergedDescriptionRef.value || localeRef.value.description;\n            }),\n            cssVars: computed(() => {\n                const { size } = props;\n                const { common: { cubicBezierEaseInOut }, self: { [createKey('iconSize', size)]: iconSize, [createKey('fontSize', size)]: fontSize, textColor, iconColor, extraTextColor } } = themeRef.value;\n                return {\n                    '--icon-size': iconSize,\n                    '--font-size': fontSize,\n                    '--bezier': cubicBezierEaseInOut,\n                    '--text-color': textColor,\n                    '--icon-color': iconColor,\n                    '--extra-text-color': extraTextColor\n                };\n            })\n        };\n    },\n    render() {\n        const { $slots, mergedClsPrefix } = this;\n        return (h(\"div\", { class: `${mergedClsPrefix}-empty`, style: this.cssVars },\n            h(\"div\", { class: `${mergedClsPrefix}-empty__icon` }, renderSlot($slots, 'icon', undefined, () => [\n                h(NBaseIcon, { clsPrefix: mergedClsPrefix }, { default: this.mergedRenderIcon })\n            ])),\n            this.showDescription ? (h(\"div\", { class: `${mergedClsPrefix}-empty__description` }, renderSlot($slots, 'default', undefined, () => [\n                this.localizedDescription\n            ]))) : null,\n            $slots.extra ? (h(\"div\", { class: `${mergedClsPrefix}-empty__extra` }, renderSlot($slots, 'extra'))) : null));\n    }\n});\n","import { commonLight } from '../../../_styles/common';\nexport const self = (vars) => {\n    const { scrollbarColor, scrollbarColorHover } = vars;\n    return {\n        color: scrollbarColor,\n        colorHover: scrollbarColorHover\n    };\n};\nconst scrollbarLight = {\n    name: 'Scrollbar',\n    common: commonLight,\n    self\n};\nexport default scrollbarLight;\n","import { cB, c, cM, cE } from '../../../../_utils/cssr';\nimport fadeInTransition from '../../../../_styles/transitions/fade-in.cssr'; // vars:\n// --scrollbar-bezier\n// --scrollbar-color\n// --scrollbar-color-hover\n// --scrollbar-width\n// --scrollbar-height\n// --scrollbar-border-radius\n\nexport default cB('scrollbar', `\n overflow: hidden;\n position: relative;\n z-index: auto;\n height: 100%;\n width: 100%;\n`, [c('>', [cB('scrollbar-container', `\n width: 100%;\n overflow: scroll;\n height: 100%;\n max-height: inherit;\n scrollbar-width: none;\n `, [c('&::-webkit-scrollbar, &::-webkit-scrollbar-track-piece, &::-webkit-scrollbar-thumb', `\n width: 0;\n height: 0;\n display: none;\n `), c('>', [cB('scrollbar-content', `\n box-sizing: border-box;\n min-width: 100%;\n `)])]), cB('scrollbar-rail', `\n position: absolute;\n pointer-events: none;\n user-select: none;\n `, [cM('horizontal', `\n left: 2px;\n right: 2px;\n bottom: 4px;\n height: var(--scrollbar-height);\n `, [c('>', [cE('scrollbar', `\n height: var(--scrollbar-height);\n border-radius: var(--scrollbar-border-radius);\n right: 0;\n `)])]), cM('vertical', `\n right: 4px;\n top: 2px;\n bottom: 2px;\n width: var(--scrollbar-width);\n `, [c('>', [cE('scrollbar', `\n width: var(--scrollbar-width);\n border-radius: var(--scrollbar-border-radius);\n bottom: 0;\n `)])]), cM('disabled', [c('>', [cE('scrollbar', {\n  pointerEvents: 'none'\n})])]), c('>', [cE('scrollbar', `\n position: absolute;\n cursor: pointer;\n pointer-events: all;\n background-color: var(--scrollbar-color);\n transition: background-color .2s var(--scrollbar-bezier);\n `, [fadeInTransition(), c('&:hover', {\n  backgroundColor: 'var(--scrollbar-color-hover)'\n})])])])])]);","import { h, ref, defineComponent, computed, onMounted, onBeforeUnmount, mergeProps, renderSlot, Transition, watchEffect } from 'vue';\nimport { on, off } from 'evtd';\nimport { VResizeObserver } from 'vueuc';\nimport { useIsIos } from 'vooks';\nimport { useConfig, useTheme } from '../../../_mixins';\nimport { scrollbarLight } from '../styles';\nimport style from './styles/index.cssr';\nconst scrollbarProps = Object.assign(Object.assign({}, useTheme.props), { size: {\n        type: Number,\n        default: 5\n    }, duration: {\n        type: Number,\n        default: 0\n    }, scrollable: {\n        type: Boolean,\n        default: true\n    }, xScrollable: {\n        type: Boolean,\n        default: false\n    }, \n    // If container is set, resize observer won't not attached\n    container: Function, content: Function, containerStyle: [String, Object], contentClass: String, contentStyle: [String, Object], horizontalRailStyle: [String, Object], verticalRailStyle: [String, Object], onScroll: Function, onWheel: Function, onResize: Function, internalOnUpdateScrollLeft: Function });\nconst Scrollbar = defineComponent({\n    name: 'Scrollbar',\n    props: scrollbarProps,\n    inheritAttrs: false,\n    setup(props) {\n        const { mergedClsPrefixRef } = useConfig(props);\n        // dom ref\n        const containerRef = ref(null);\n        const contentRef = ref(null);\n        const yRailRef = ref(null);\n        const xRailRef = ref(null);\n        // data ref\n        const contentHeightRef = ref(null);\n        const contentWidthRef = ref(null);\n        const containerHeightRef = ref(null);\n        const containerWidthRef = ref(null);\n        const yRailSizeRef = ref(null);\n        const xRailSizeRef = ref(null);\n        const containerScrollTopRef = ref(0);\n        const containerScrollLeftRef = ref(0);\n        const isShowXBarRef = ref(false);\n        const isShowYBarRef = ref(false);\n        let yBarPressed = false;\n        let xBarPressed = false;\n        let xBarVanishTimerId;\n        let yBarVanishTimerId;\n        let memoYTop = 0;\n        let memoXLeft = 0;\n        let memoMouseX = 0;\n        let memoMouseY = 0;\n        const isIos = useIsIos();\n        const yBarSizeRef = computed(() => {\n            const { value: containerHeight } = containerHeightRef;\n            const { value: contentHeight } = contentHeightRef;\n            const { value: yRailSize } = yRailSizeRef;\n            if (containerHeight === null ||\n                contentHeight === null ||\n                yRailSize === null) {\n                return 0;\n            }\n            else {\n                return Math.min(containerHeight, (yRailSize * containerHeight) / contentHeight + props.size * 1.5);\n            }\n        });\n        const yBarSizePxRef = computed(() => {\n            return `${yBarSizeRef.value}px`;\n        });\n        const xBarSizeRef = computed(() => {\n            const { value: containerWidth } = containerWidthRef;\n            const { value: contentWidth } = contentWidthRef;\n            const { value: xRailSize } = xRailSizeRef;\n            if (containerWidth === null ||\n                contentWidth === null ||\n                xRailSize === null) {\n                return 0;\n            }\n            else {\n                return (xRailSize * containerWidth) / contentWidth + props.size * 1.5;\n            }\n        });\n        const xBarSizePxRef = computed(() => {\n            return `${xBarSizeRef.value}px`;\n        });\n        const yBarTopRef = computed(() => {\n            const { value: containerHeight } = containerHeightRef;\n            const { value: containerScrollTop } = containerScrollTopRef;\n            const { value: contentHeight } = contentHeightRef;\n            const { value: yRailSize } = yRailSizeRef;\n            if (containerHeight === null ||\n                contentHeight === null ||\n                yRailSize === null) {\n                return 0;\n            }\n            else {\n                return ((containerScrollTop / (contentHeight - containerHeight)) *\n                    (yRailSize - yBarSizeRef.value));\n            }\n        });\n        const yBarTopPxRef = computed(() => {\n            return `${yBarTopRef.value}px`;\n        });\n        const xBarLeftRef = computed(() => {\n            const { value: containerWidth } = containerWidthRef;\n            const { value: containerScrollLeft } = containerScrollLeftRef;\n            const { value: contentWidth } = contentWidthRef;\n            const { value: xRailSize } = xRailSizeRef;\n            if (containerWidth === null ||\n                contentWidth === null ||\n                xRailSize === null) {\n                return 0;\n            }\n            else {\n                return ((containerScrollLeft / (contentWidth - containerWidth)) *\n                    (xRailSize - xBarSizeRef.value));\n            }\n        });\n        const xBarLeftPxRef = computed(() => {\n            return `${xBarLeftRef.value}px`;\n        });\n        const needYBarRef = computed(() => {\n            const { value: containerHeight } = containerHeightRef;\n            const { value: contentHeight } = contentHeightRef;\n            return (containerHeight !== null &&\n                contentHeight !== null &&\n                contentHeight > containerHeight);\n        });\n        const needXBarRef = computed(() => {\n            const { value: containerWidth } = containerWidthRef;\n            const { value: contentWidth } = contentWidthRef;\n            return (containerWidth !== null &&\n                contentWidth !== null &&\n                contentWidth > containerWidth);\n        });\n        const mergedContainerRef = computed(() => {\n            const { container } = props;\n            if (container)\n                return container();\n            return containerRef.value;\n        });\n        const mergedContentRef = computed(() => {\n            const { content } = props;\n            if (content)\n                return content();\n            return contentRef.value;\n        });\n        // methods\n        const handleContentResize = sync;\n        const handleContainerResize = (e) => {\n            const { onResize } = props;\n            if (onResize)\n                onResize(e);\n            sync();\n        };\n        const scrollTo = (options, y) => {\n            if (!props.scrollable)\n                return;\n            if (typeof options === 'number') {\n                scrollToPosition(options, y !== null && y !== void 0 ? y : 0, 0, false, 'auto');\n                return;\n            }\n            const { left, top, index, elSize, position, behavior, el, debounce = true } = options;\n            if (left !== undefined || top !== undefined) {\n                scrollToPosition(left !== null && left !== void 0 ? left : 0, top !== null && top !== void 0 ? top : 0, 0, false, behavior);\n            }\n            if (el !== undefined) {\n                scrollToPosition(0, el.offsetTop, el.offsetHeight, debounce, behavior);\n            }\n            else if (index !== undefined && elSize !== undefined) {\n                scrollToPosition(0, index * elSize, elSize, debounce, behavior);\n            }\n            else if (position === 'bottom') {\n                scrollToPosition(0, Number.MAX_SAFE_INTEGER, 0, false, behavior);\n            }\n            else if (position === 'top') {\n                scrollToPosition(0, 0, 0, false, behavior);\n            }\n        };\n        function scrollToPosition(left, top, elSize, debounce, behavior) {\n            const { value: container } = mergedContainerRef;\n            if (!container)\n                return;\n            if (debounce) {\n                const { scrollTop, offsetHeight } = container;\n                if (top > scrollTop) {\n                    if (top + elSize <= scrollTop + offsetHeight) {\n                        // do nothing\n                    }\n                    else {\n                        container.scrollTo({\n                            left,\n                            top: top + elSize - offsetHeight,\n                            behavior\n                        });\n                    }\n                    return;\n                }\n            }\n            container.scrollTo({\n                left,\n                top,\n                behavior\n            });\n        }\n        function handleMouseEnterWrapper() {\n            showXBar();\n            showYBar();\n            sync();\n        }\n        function handleMouseLeaveWrapper() {\n            hideBar();\n        }\n        function hideBar() {\n            hideYBar();\n            hideXBar();\n        }\n        function hideYBar() {\n            if (yBarVanishTimerId !== undefined) {\n                window.clearTimeout(yBarVanishTimerId);\n            }\n            yBarVanishTimerId = window.setTimeout(() => {\n                isShowYBarRef.value = false;\n            }, props.duration);\n        }\n        function hideXBar() {\n            if (xBarVanishTimerId !== undefined) {\n                window.clearTimeout(xBarVanishTimerId);\n            }\n            xBarVanishTimerId = window.setTimeout(() => {\n                isShowXBarRef.value = false;\n            }, props.duration);\n        }\n        function showXBar() {\n            if (xBarVanishTimerId !== undefined) {\n                window.clearTimeout(xBarVanishTimerId);\n            }\n            isShowXBarRef.value = true;\n        }\n        function showYBar() {\n            if (yBarVanishTimerId !== undefined) {\n                window.clearTimeout(yBarVanishTimerId);\n            }\n            isShowYBarRef.value = true;\n        }\n        function handleScroll(e) {\n            const { onScroll } = props;\n            if (onScroll)\n                onScroll(e);\n            syncScrollState();\n        }\n        function syncScrollState() {\n            // only collect scroll state, do not trigger any dom event\n            const { value: container } = mergedContainerRef;\n            if (container) {\n                containerScrollTopRef.value = container.scrollTop;\n                containerScrollLeftRef.value = container.scrollLeft;\n            }\n        }\n        function syncPositionState() {\n            // only collect position state, do not trigger any dom event\n            // Don't use getClientBoundingRect because element may be scale transformed\n            const { value: content } = mergedContentRef;\n            if (content) {\n                contentHeightRef.value = content.offsetHeight;\n                contentWidthRef.value = content.offsetWidth;\n            }\n            const { value: container } = mergedContainerRef;\n            if (container) {\n                containerHeightRef.value = container.offsetHeight;\n                containerWidthRef.value = container.offsetWidth;\n            }\n            const { value: xRailEl } = xRailRef;\n            const { value: yRailEl } = yRailRef;\n            if (xRailEl) {\n                xRailSizeRef.value = xRailEl.offsetWidth;\n            }\n            if (yRailEl) {\n                yRailSizeRef.value = yRailEl.offsetHeight;\n            }\n        }\n        function sync() {\n            if (!props.scrollable)\n                return;\n            syncPositionState();\n            syncScrollState();\n        }\n        function handleXScrollMouseDown(e) {\n            e.preventDefault();\n            e.stopPropagation();\n            xBarPressed = true;\n            on('mousemove', window, handleXScrollMouseMove, true);\n            on('mouseup', window, handleXScrollMouseUp, true);\n            memoXLeft = containerScrollLeftRef.value;\n            memoMouseX = e.clientX;\n        }\n        function handleXScrollMouseMove(e) {\n            if (!xBarPressed)\n                return;\n            if (xBarVanishTimerId !== undefined) {\n                window.clearTimeout(xBarVanishTimerId);\n            }\n            if (yBarVanishTimerId !== undefined) {\n                window.clearTimeout(yBarVanishTimerId);\n            }\n            const { value: containerWidth } = containerWidthRef;\n            const { value: contentWidth } = contentWidthRef;\n            const { value: xBarSize } = xBarSizeRef;\n            if (containerWidth === null || contentWidth === null)\n                return;\n            const dX = e.clientX - memoMouseX;\n            const dScrollLeft = (dX * (contentWidth - containerWidth)) / (containerWidth - xBarSize);\n            const toScrollLeftUpperBound = contentWidth - containerWidth;\n            let toScrollLeft = memoXLeft + dScrollLeft;\n            toScrollLeft = Math.min(toScrollLeftUpperBound, toScrollLeft);\n            toScrollLeft = Math.max(toScrollLeft, 0);\n            const { value: container } = mergedContainerRef;\n            if (container) {\n                container.scrollLeft = toScrollLeft;\n                const { internalOnUpdateScrollLeft } = props;\n                if (internalOnUpdateScrollLeft)\n                    internalOnUpdateScrollLeft(toScrollLeft);\n            }\n        }\n        function handleXScrollMouseUp(e) {\n            e.preventDefault();\n            e.stopPropagation();\n            off('mousemove', window, handleXScrollMouseMove, true);\n            off('mouseup', window, handleXScrollMouseUp, true);\n            xBarPressed = false;\n            sync();\n            const { value: container } = mergedContainerRef;\n            if (!(container === null || container === void 0 ? void 0 : container.contains(e.target))) {\n                hideBar();\n            }\n        }\n        function handleYScrollMouseDown(e) {\n            e.preventDefault();\n            e.stopPropagation();\n            yBarPressed = true;\n            on('mousemove', window, handleYScrollMouseMove, true);\n            on('mouseup', window, handleYScrollMouseUp, true);\n            memoYTop = containerScrollTopRef.value;\n            memoMouseY = e.clientY;\n        }\n        function handleYScrollMouseMove(e) {\n            if (!yBarPressed)\n                return;\n            if (xBarVanishTimerId !== undefined) {\n                window.clearTimeout(xBarVanishTimerId);\n            }\n            if (yBarVanishTimerId !== undefined) {\n                window.clearTimeout(yBarVanishTimerId);\n            }\n            const { value: containerHeight } = containerHeightRef;\n            const { value: contentHeight } = contentHeightRef;\n            const { value: yBarSize } = yBarSizeRef;\n            if (containerHeight === null || contentHeight === null)\n                return;\n            const dY = e.clientY - memoMouseY;\n            const dScrollTop = (dY * (contentHeight - containerHeight)) / (containerHeight - yBarSize);\n            const toScrollTopUpperBound = contentHeight - containerHeight;\n            let toScrollTop = memoYTop + dScrollTop;\n            toScrollTop = Math.min(toScrollTopUpperBound, toScrollTop);\n            toScrollTop = Math.max(toScrollTop, 0);\n            const { value: container } = mergedContainerRef;\n            if (container) {\n                container.scrollTop = toScrollTop;\n            }\n        }\n        function handleYScrollMouseUp(e) {\n            e.preventDefault();\n            e.stopPropagation();\n            off('mousemove', window, handleYScrollMouseMove, true);\n            off('mouseup', window, handleYScrollMouseUp, true);\n            yBarPressed = false;\n            sync();\n            const { value: container } = mergedContainerRef;\n            if (!(container === null || container === void 0 ? void 0 : container.contains(e.target))) {\n                hideBar();\n            }\n        }\n        watchEffect(() => {\n            const { value: needXBar } = needXBarRef;\n            const { value: needYBar } = needYBarRef;\n            const { value: mergedClsPrefix } = mergedClsPrefixRef;\n            const { value: xRailEl } = xRailRef;\n            const { value: yRailEl } = yRailRef;\n            if (xRailEl) {\n                if (!needXBar) {\n                    xRailEl.classList.add(`${mergedClsPrefix}-scrollbar-rail--disabled`);\n                }\n                else {\n                    xRailEl.classList.remove(`${mergedClsPrefix}-scrollbar-rail--disabled`);\n                }\n            }\n            if (yRailEl) {\n                if (!needYBar) {\n                    yRailEl.classList.add(`${mergedClsPrefix}-scrollbar-rail--disabled`);\n                }\n                else {\n                    yRailEl.classList.remove(`${mergedClsPrefix}-scrollbar-rail--disabled`);\n                }\n            }\n        });\n        onMounted(() => {\n            // if container exist, it always can't be resolved when scrollbar is mounted\n            // for example:\n            // - component\n            //   - scrollbar\n            //     - inner\n            // if you pass inner to scrollbar, you may use a ref inside component\n            // however, when scrollbar is mounted, ref is not ready at component\n            // you need to init by yourself\n            if (props.container)\n                return;\n            sync();\n        });\n        onBeforeUnmount(() => {\n            if (xBarVanishTimerId !== undefined) {\n                window.clearTimeout(xBarVanishTimerId);\n            }\n            if (yBarVanishTimerId !== undefined) {\n                window.clearTimeout(yBarVanishTimerId);\n            }\n            off('mousemove', window, handleYScrollMouseMove, true);\n            off('mouseup', window, handleYScrollMouseUp, true);\n        });\n        const themeRef = useTheme('Scrollbar', 'Scrollbar', style, scrollbarLight, props, mergedClsPrefixRef);\n        return {\n            sync,\n            scrollTo,\n            mergedClsPrefix: mergedClsPrefixRef,\n            containerScrollTop: containerScrollTopRef,\n            containerRef,\n            contentRef,\n            yRailRef,\n            xRailRef,\n            needYBar: needYBarRef,\n            needXBar: needXBarRef,\n            yBarSizePx: yBarSizePxRef,\n            xBarSizePx: xBarSizePxRef,\n            yBarTopPx: yBarTopPxRef,\n            xBarLeftPx: xBarLeftPxRef,\n            isShowXBar: isShowXBarRef,\n            isShowYBar: isShowYBarRef,\n            isIos,\n            handleScroll,\n            handleContentResize,\n            handleContainerResize,\n            handleMouseEnterWrapper,\n            handleMouseLeaveWrapper,\n            handleYScrollMouseDown,\n            handleXScrollMouseDown,\n            cssVars: computed(() => {\n                const { common: { cubicBezierEaseInOut, scrollbarBorderRadius, scrollbarHeight, scrollbarWidth }, self: { color, colorHover } } = themeRef.value;\n                return {\n                    '--scrollbar-bezier': cubicBezierEaseInOut,\n                    '--scrollbar-color': color,\n                    '--scrollbar-color-hover': colorHover,\n                    '--scrollbar-border-radius': scrollbarBorderRadius,\n                    '--scrollbar-width': scrollbarWidth,\n                    '--scrollbar-height': scrollbarHeight\n                };\n            })\n        };\n    },\n    render() {\n        const { $slots, mergedClsPrefix } = this;\n        if (!this.scrollable)\n            return renderSlot($slots, 'default');\n        const createChildren = () => h('div', mergeProps(this.$attrs, {\n            class: `${mergedClsPrefix}-scrollbar`,\n            style: this.cssVars,\n            onMouseenter: this.handleMouseEnterWrapper,\n            onMouseleave: this.handleMouseLeaveWrapper\n        }), [\n            this.container ? (renderSlot($slots, 'default')) : (h(\"div\", { ref: \"containerRef\", class: `${mergedClsPrefix}-scrollbar-container`, style: this.containerStyle, onScroll: this.handleScroll, onWheel: this.onWheel },\n                h(VResizeObserver, { onResize: this.handleContentResize }, {\n                    default: () => (h(\"div\", { ref: \"contentRef\", style: [\n                            {\n                                width: this.xScrollable ? 'fit-content' : null\n                            },\n                            this.contentStyle\n                        ], class: [\n                            `${mergedClsPrefix}-scrollbar-content`,\n                            this.contentClass\n                        ] }, $slots))\n                }))),\n            h(\"div\", { ref: \"yRailRef\", class: `${mergedClsPrefix}-scrollbar-rail ${mergedClsPrefix}-scrollbar-rail--vertical`, style: [this.horizontalRailStyle] },\n                h(Transition, { name: \"fade-in-transition\" }, {\n                    default: () => this.needYBar && this.isShowYBar && !this.isIos ? (h(\"div\", { class: `${mergedClsPrefix}-scrollbar-rail__scrollbar`, style: {\n                            height: this.yBarSizePx,\n                            top: this.yBarTopPx\n                        }, onMousedown: this.handleYScrollMouseDown })) : null\n                })),\n            h(\"div\", { ref: \"xRailRef\", class: `${mergedClsPrefix}-scrollbar-rail ${mergedClsPrefix}-scrollbar-rail--horizontal`, style: [this.verticalRailStyle] },\n                h(Transition, { name: \"fade-in-transition\" }, {\n                    default: () => this.needXBar && this.isShowXBar && !this.isIos ? (h(\"div\", { class: `${mergedClsPrefix}-scrollbar-rail__scrollbar`, style: {\n                            width: this.xBarSizePx,\n                            left: this.xBarLeftPx\n                        }, onMousedown: this.handleXScrollMouseDown })) : null\n                }))\n        ]);\n        return this.container ? (createChildren()) : (h(VResizeObserver, { onResize: this.handleContainerResize }, {\n            default: createChildren\n        }));\n    }\n});\nexport default Scrollbar;\nexport const XScrollbar = Scrollbar;\n","import { h, inject, defineComponent, Transition } from 'vue';\nimport { useMemo } from 'vooks';\nimport { CheckmarkIcon } from '../../icons';\nimport NBaseIcon from '../../icon';\nimport { render } from '../../../_utils';\nimport { internalSelectionMenuInjectionKey } from './interface';\nconst checkMarkIcon = h(CheckmarkIcon);\nfunction renderCheckMark(show, clsPrefix) {\n    return (h(Transition, { name: \"fade-in-scale-up-transition\" }, {\n        default: () => show ? (h(NBaseIcon, { clsPrefix: clsPrefix, class: `${clsPrefix}-base-select-option__check` }, {\n            default: () => checkMarkIcon\n        })) : null\n    }));\n}\nexport default defineComponent({\n    name: 'NBaseSelectOption',\n    props: {\n        clsPrefix: {\n            type: String,\n            required: true\n        },\n        tmNode: {\n            type: Object,\n            required: true\n        }\n    },\n    setup(props) {\n        const { valueRef, pendingTmNodeRef, multipleRef, valueSetRef, renderLabelRef, renderOptionRef, handleOptionClick, handleOptionMouseEnter\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n         } = inject(internalSelectionMenuInjectionKey);\n        const isPendingRef = useMemo(() => {\n            const { value: pendingTmNode } = pendingTmNodeRef;\n            if (!pendingTmNode)\n                return false;\n            return props.tmNode.key === pendingTmNode.key;\n        });\n        function handleClick(e) {\n            const { tmNode } = props;\n            if (tmNode.disabled)\n                return;\n            handleOptionClick(e, tmNode);\n        }\n        function handleMouseEnter(e) {\n            const { tmNode } = props;\n            if (tmNode.disabled)\n                return;\n            handleOptionMouseEnter(e, tmNode);\n        }\n        function handleMouseMove(e) {\n            const { tmNode } = props;\n            const { value: isPending } = isPendingRef;\n            if (tmNode.disabled || isPending)\n                return;\n            handleOptionMouseEnter(e, tmNode);\n        }\n        return {\n            multiple: multipleRef,\n            isGrouped: useMemo(() => {\n                const { tmNode } = props;\n                const { parent } = tmNode;\n                return parent && parent.rawNode.type === 'group';\n            }),\n            isPending: isPendingRef,\n            isSelected: useMemo(() => {\n                const { value } = valueRef;\n                const { value: multiple } = multipleRef;\n                if (value === null)\n                    return false;\n                const optionValue = props.tmNode.rawNode.value;\n                if (multiple) {\n                    const { value: valueSet } = valueSetRef;\n                    return valueSet.has(optionValue);\n                }\n                else {\n                    return value === optionValue;\n                }\n            }),\n            renderLabel: renderLabelRef,\n            renderOption: renderOptionRef,\n            handleMouseMove,\n            handleMouseEnter,\n            handleClick\n        };\n    },\n    render() {\n        const { clsPrefix, tmNode: { rawNode }, isSelected, isPending, isGrouped, multiple, renderOption, renderLabel, handleClick, handleMouseEnter, handleMouseMove } = this;\n        const showCheckMark = multiple && isSelected;\n        const checkmark = renderCheckMark(showCheckMark, clsPrefix);\n        const children = renderLabel\n            ? [renderLabel(rawNode, isSelected), checkmark]\n            : [render(rawNode.label, rawNode, isSelected), checkmark];\n        const node = (h(\"div\", { class: [\n                `${clsPrefix}-base-select-option`,\n                rawNode.class,\n                {\n                    [`${clsPrefix}-base-select-option--disabled`]: rawNode.disabled,\n                    [`${clsPrefix}-base-select-option--selected`]: isSelected,\n                    [`${clsPrefix}-base-select-option--grouped`]: isGrouped,\n                    [`${clsPrefix}-base-select-option--pending`]: isPending\n                }\n            ], style: rawNode.style, onClick: handleClick, onMouseenter: handleMouseEnter, onMousemove: handleMouseMove },\n            h(\"div\", { class: `${clsPrefix}-base-select-option__content` }, children)));\n        return rawNode.render\n            ? rawNode.render({ node, option: rawNode, selected: isSelected })\n            : renderOption\n                ? renderOption({ node, option: rawNode, selected: isSelected })\n                : node;\n    }\n});\n","import { h, defineComponent, inject } from 'vue';\nimport { render } from '../../../_utils';\nimport { internalSelectionMenuInjectionKey } from './interface';\nexport default defineComponent({\n    name: 'NBaseSelectGroupHeader',\n    props: {\n        clsPrefix: {\n            type: String,\n            required: true\n        },\n        tmNode: {\n            type: Object,\n            required: true\n        }\n    },\n    setup() {\n        const { renderLabelRef, renderOptionRef\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n         } = inject(internalSelectionMenuInjectionKey);\n        return {\n            renderLabel: renderLabelRef,\n            renderOption: renderOptionRef\n        };\n    },\n    render() {\n        const { clsPrefix, renderLabel, renderOption, tmNode: { rawNode } } = this;\n        const children = renderLabel\n            ? renderLabel(rawNode, false)\n            : render(rawNode.label, rawNode, false);\n        const node = (h(\"div\", { class: `${clsPrefix}-base-select-group-header` }, children));\n        return rawNode.render\n            ? rawNode.render({ node, option: rawNode })\n            : renderOption\n                ? renderOption({ node, option: rawNode, selected: false })\n                : node;\n    }\n});\n","import { c, cB, cE, cM, cNotM } from '../../../../_utils/cssr';\nimport fadeInScaleUpTransition from '../../../../_styles/transitions/fade-in-scale-up.cssr'; // --loading-color\n// --loading-size\n\nexport default cB('base-select-menu', `\n line-height: 1.5;\n outline: none;\n z-index: 0;\n position: relative;\n border-radius: var(--border-radius);\n transition:\n background-color .3s var(--bezier),\n box-shadow .3s var(--bezier);\n background-color: var(--color);\n`, [cM('multiple', [cB('base-select-option', `\n padding-right: 28px;\n `)]), cB('scrollbar', `\n max-height: var(--height);\n `), cB('virtual-list', `\n max-height: var(--height);\n `), cB('base-select-option', `\n min-height: var(--option-height);\n font-size: var(--option-font-size);\n display: flex;\n align-items: center;\n `, [cE('content', `\n white-space: nowrap;\n text-overflow: ellipsis;\n overflow: hidden;\n `)]), cB('base-select-group-header', `\n min-height: var(--option-height);\n font-size: .93em;\n display: flex;\n align-items: center;\n `), cB('base-select-menu-option-wrapper', `\n position: relative;\n width: 100%;\n `), cE('loading, empty', `\n display: flex;\n padding: 12px 32px;\n flex: 1;\n justify-content: center;\n `), cE('loading', `\n color: var(--loading-color);\n font-size: var(--loading-size);\n `), cE('action', `\n padding: 8px var(--option-padding-left);\n font-size: var(--option-font-size);\n transition: \n color .3s var(--bezier);\n border-color .3s var(--bezier);\n border-top: 1px solid var(--action-divider-color);\n color: var(--action-text-color);\n `), cB('base-select-group-header', `\n position: relative;\n cursor: default;\n padding: var(--option-padding);\n color: var(--group-header-text-color);\n `), cB('base-select-option', `\n cursor: pointer;\n position: relative;\n padding: var(--option-padding);\n transition:\n background-color .3s var(--bezier),\n color .3s var(--bezier),\n opacity .3s var(--bezier);\n box-sizing: border-box;\n color: var(--option-text-color);\n opacity: 1;\n `, [c('&:active', `\n color: var(--option-text-color-pressed);\n `), cM('grouped', `\n padding-left: calc(var(--option-padding-left) * 1.5);\n `), cM('pending', `\n background-color: var(--option-color-pending);\n `), cM('selected', `\n color: var(--option-text-color-active);\n background-color: var(--option-color-active);\n `), cM('disabled', `\n cursor: not-allowed;\n `, [cNotM('selected', `\n color: var(--option-text-color-disabled);\n `), cM('selected', `\n opacity: var(--option-opacity-disabled);\n `)]), cE('check', `\n font-size: 16px;\n position: absolute;\n right: 8px;\n top: calc(50% - 7px);\n color: var(--option-check-color);\n transition: color .3s var(--bezier);\n `, [fadeInScaleUpTransition({\n  enterScale: '0.5'\n})])])]);","export default {\n    height: 'calc(var(--option-height) * 7.6)',\n    paddingSmall: '4px 0',\n    paddingMedium: '4px 0',\n    paddingLarge: '4px 0',\n    paddingHuge: '4px 0',\n    optionPaddingSmall: '0 12px',\n    optionPaddingMedium: '0 12px',\n    optionPaddingLarge: '0 12px',\n    optionPaddingHuge: '0 12px',\n    loadingSize: '18px'\n};\n","import { emptyLight } from '../../../empty/styles';\nimport { scrollbarLight } from '../../scrollbar/styles';\nimport { commonLight } from '../../../_styles/common';\nimport commonVariables from './_common';\nimport { createTheme } from '../../../_mixins';\nexport const self = (vars) => {\n    const { borderRadius, popoverColor, textColor3, dividerColor, textColor2, primaryColorPressed, textColorDisabled, primaryColor, opacityDisabled, hoverColor, fontSizeSmall, fontSizeMedium, fontSizeLarge, fontSizeHuge, heightSmall, heightMedium, heightLarge, heightHuge } = vars;\n    return Object.assign(Object.assign({}, commonVariables), { optionFontSizeSmall: fontSizeSmall, optionFontSizeMedium: fontSizeMedium, optionFontSizeLarge: fontSizeLarge, optionFontSizeHuge: fontSizeHuge, optionHeightSmall: heightSmall, optionHeightMedium: heightMedium, optionHeightLarge: heightLarge, optionHeightHuge: heightHuge, borderRadius: borderRadius, color: popoverColor, groupHeaderTextColor: textColor3, actionDividerColor: dividerColor, optionTextColor: textColor2, optionTextColorPressed: primaryColorPressed, optionTextColorDisabled: textColorDisabled, optionTextColorActive: primaryColor, optionOpacityDisabled: opacityDisabled, optionCheckColor: primaryColor, optionColorPending: hoverColor, optionColorActive: hoverColor, actionTextColor: textColor2, loadingColor: primaryColor });\n};\nconst internalSelectMenuLight = createTheme({\n    name: 'InternalSelectMenu',\n    common: commonLight,\n    peers: {\n        Scrollbar: scrollbarLight,\n        Empty: emptyLight\n    },\n    self\n});\nexport default internalSelectMenuLight;\n","import { h, ref, onMounted, computed, defineComponent, watch, toRef, renderSlot, provide, nextTick, watchEffect } from 'vue';\nimport { createIndexGetter } from 'treemate';\nimport { VirtualList } from 'vueuc';\nimport { depx, getPadding, happensIn } from 'seemly';\nimport { NEmpty } from '../../../empty';\nimport { NScrollbar } from '../../scrollbar';\nimport { formatLength } from '../../../_utils';\nimport { createKey } from '../../../_utils/cssr';\nimport { useTheme } from '../../../_mixins';\nimport NInternalLoading from '../../loading';\nimport NFocusDetector from '../../focus-detector';\nimport NSelectOption from './SelectOption';\nimport NSelectGroupHeader from './SelectGroupHeader';\nimport style from './styles/index.cssr';\nimport { internalSelectMenuLight } from '../styles';\nimport { internalSelectionMenuInjectionKey, internalSelectionMenuBodyInjectionKey } from './interface';\nexport default defineComponent({\n    name: 'InternalSelectMenu',\n    props: Object.assign(Object.assign({}, useTheme.props), { clsPrefix: {\n            type: String,\n            required: true\n        }, scrollable: {\n            type: Boolean,\n            default: true\n        }, treeMate: {\n            type: Object,\n            required: true\n        }, multiple: Boolean, size: {\n            type: String,\n            default: 'medium'\n        }, value: {\n            type: [String, Number, Array],\n            default: null\n        }, width: [Number, String], autoPending: Boolean, virtualScroll: {\n            type: Boolean,\n            default: true\n        }, \n        // show is used to toggle pending state initialization\n        show: {\n            type: Boolean,\n            default: true\n        }, loading: Boolean, focusable: Boolean, renderLabel: Function, renderOption: Function, onMousedown: Function, onScroll: Function, onFocus: Function, onBlur: Function, onKeyup: Function, onKeydown: Function, onTabOut: Function, onMouseenter: Function, onMouseleave: Function, \n        // deprecated\n        onToggle: Function }),\n    setup(props) {\n        const themeRef = useTheme('InternalSelectMenu', 'InternalSelectMenu', style, internalSelectMenuLight, props, toRef(props, 'clsPrefix'));\n        const selfRef = ref(null);\n        const virtualListRef = ref(null);\n        const scrollbarRef = ref(null);\n        const flattenedNodesRef = computed(() => props.treeMate.getFlattenedNodes());\n        const fIndexGetterRef = computed(() => createIndexGetter(flattenedNodesRef.value));\n        const pendingNodeRef = ref(null);\n        function initPendingNode() {\n            const { treeMate } = props;\n            setPendingTmNode(props.autoPending\n                ? props.value === null\n                    ? treeMate.getFirstAvailableNode()\n                    : props.multiple\n                        ? treeMate.getNode((props.value || [])[(props.value || [])\n                            .length - 1]) || treeMate.getFirstAvailableNode()\n                        : treeMate.getNode(props.value) ||\n                            treeMate.getFirstAvailableNode()\n                : null);\n        }\n        initPendingNode();\n        onMounted(() => {\n            watchEffect(() => {\n                if (props.show) {\n                    initPendingNode();\n                    void nextTick(scrollToPendingNode);\n                }\n            });\n        });\n        const itemSizeRef = computed(() => {\n            return depx(themeRef.value.self[createKey('optionHeight', props.size)]);\n        });\n        const paddingRef = computed(() => {\n            return getPadding(themeRef.value.self[createKey('padding', props.size)]);\n        });\n        const valueSetRef = computed(() => {\n            if (props.multiple && Array.isArray(props.value)) {\n                return new Set(props.value);\n            }\n            return new Set();\n        });\n        const emptyRef = computed(() => {\n            const tmNodes = flattenedNodesRef.value;\n            return tmNodes && tmNodes.length === 0;\n        });\n        const styleRef = computed(() => {\n            return [{ width: formatLength(props.width) }, cssVarsRef.value];\n        });\n        watch(toRef(props, 'treeMate'), () => {\n            if (props.autoPending) {\n                const tmNode = props.treeMate.getFirstAvailableNode();\n                setPendingTmNode(tmNode);\n            }\n            else {\n                setPendingTmNode(null);\n            }\n        });\n        function doToggle(tmNode) {\n            const { onToggle } = props;\n            if (onToggle)\n                onToggle(tmNode);\n        }\n        function doScroll(e) {\n            const { onScroll } = props;\n            if (onScroll)\n                onScroll(e);\n        }\n        // required, scroller sync need to be triggered manually\n        function handleVirtualListScroll(e) {\n            var _a;\n            (_a = scrollbarRef.value) === null || _a === void 0 ? void 0 : _a.sync();\n            doScroll(e);\n        }\n        function handleVirtualListResize() {\n            var _a;\n            (_a = scrollbarRef.value) === null || _a === void 0 ? void 0 : _a.sync();\n        }\n        function getPendingTmNode() {\n            const { value: pendingTmNode } = pendingNodeRef;\n            if (pendingTmNode)\n                return pendingTmNode;\n            return null;\n        }\n        function handleOptionMouseEnter(e, tmNode) {\n            if (tmNode.disabled)\n                return;\n            setPendingTmNode(tmNode, false);\n        }\n        function handleOptionClick(e, tmNode) {\n            if (tmNode.disabled)\n                return;\n            doToggle(tmNode);\n        }\n        // keyboard related methods\n        function handleKeyUp(e) {\n            var _a;\n            if (happensIn(e, 'action'))\n                return;\n            (_a = props.onKeyup) === null || _a === void 0 ? void 0 : _a.call(props, e);\n        }\n        function handleKeyDown(e) {\n            var _a;\n            if (happensIn(e, 'action'))\n                return;\n            (_a = props.onKeydown) === null || _a === void 0 ? void 0 : _a.call(props, e);\n        }\n        function handleMouseDown(e) {\n            var _a;\n            (_a = props.onMousedown) === null || _a === void 0 ? void 0 : _a.call(props, e);\n            if (props.focusable)\n                return;\n            e.preventDefault();\n        }\n        function next() {\n            const { value: pendingTmNode } = pendingNodeRef;\n            if (pendingTmNode) {\n                setPendingTmNode(pendingTmNode.getNext({ loop: true }), true);\n            }\n        }\n        function prev() {\n            const { value: pendingTmNode } = pendingNodeRef;\n            if (pendingTmNode) {\n                setPendingTmNode(pendingTmNode.getPrev({ loop: true }), true);\n            }\n        }\n        function setPendingTmNode(tmNode, doScroll = false) {\n            pendingNodeRef.value = tmNode;\n            if (doScroll)\n                scrollToPendingNode();\n        }\n        function scrollToPendingNode() {\n            var _a, _b;\n            const tmNode = pendingNodeRef.value;\n            if (!tmNode)\n                return;\n            const fIndex = fIndexGetterRef.value(tmNode.key);\n            if (fIndex === null)\n                return;\n            if (props.virtualScroll) {\n                (_a = virtualListRef.value) === null || _a === void 0 ? void 0 : _a.scrollTo({ index: fIndex });\n            }\n            else {\n                (_b = scrollbarRef.value) === null || _b === void 0 ? void 0 : _b.scrollTo({\n                    index: fIndex,\n                    elSize: itemSizeRef.value\n                });\n            }\n        }\n        function handleFocusin(e) {\n            var _a, _b;\n            if ((_a = selfRef.value) === null || _a === void 0 ? void 0 : _a.contains(e.target)) {\n                (_b = props.onFocus) === null || _b === void 0 ? void 0 : _b.call(props, e);\n            }\n        }\n        function handleFocusout(e) {\n            var _a, _b;\n            if (!((_a = selfRef.value) === null || _a === void 0 ? void 0 : _a.contains(e.relatedTarget))) {\n                (_b = props.onBlur) === null || _b === void 0 ? void 0 : _b.call(props, e);\n            }\n        }\n        provide(internalSelectionMenuInjectionKey, {\n            handleOptionMouseEnter,\n            handleOptionClick,\n            valueSetRef,\n            multipleRef: toRef(props, 'multiple'),\n            valueRef: toRef(props, 'value'),\n            renderLabelRef: toRef(props, 'renderLabel'),\n            renderOptionRef: toRef(props, 'renderOption'),\n            pendingTmNodeRef: pendingNodeRef\n        });\n        provide(internalSelectionMenuBodyInjectionKey, selfRef);\n        onMounted(() => {\n            const { value } = scrollbarRef;\n            if (value)\n                value.sync();\n        });\n        const cssVarsRef = computed(() => {\n            const { size } = props;\n            const { common: { cubicBezierEaseInOut }, self: { height, borderRadius, color, groupHeaderTextColor, actionDividerColor, optionTextColorPressed, optionTextColor, optionTextColorDisabled, optionTextColorActive, optionOpacityDisabled, optionCheckColor, actionTextColor, optionColorPending, optionColorActive, loadingColor, loadingSize, [createKey('optionFontSize', size)]: fontSize, [createKey('optionHeight', size)]: optionHeight, [createKey('optionPadding', size)]: optionPadding } } = themeRef.value;\n            return {\n                '--height': height,\n                '--action-divider-color': actionDividerColor,\n                '--action-text-color': actionTextColor,\n                '--bezier': cubicBezierEaseInOut,\n                '--border-radius': borderRadius,\n                '--color': color,\n                '--option-font-size': fontSize,\n                '--group-header-text-color': groupHeaderTextColor,\n                '--option-check-color': optionCheckColor,\n                '--option-color-pending': optionColorPending,\n                '--option-color-active': optionColorActive,\n                '--option-height': optionHeight,\n                '--option-opacity-disabled': optionOpacityDisabled,\n                '--option-text-color': optionTextColor,\n                '--option-text-color-active': optionTextColorActive,\n                '--option-text-color-disabled': optionTextColorDisabled,\n                '--option-text-color-pressed': optionTextColorPressed,\n                '--option-padding': optionPadding,\n                '--option-padding-left': getPadding(optionPadding, 'left'),\n                '--loading-color': loadingColor,\n                '--loading-size': loadingSize\n            };\n        });\n        const exposedProps = {\n            selfRef,\n            next,\n            prev,\n            getPendingTmNode\n        };\n        return Object.assign({ mergedTheme: themeRef, virtualListRef,\n            scrollbarRef, style: styleRef, itemSize: itemSizeRef, padding: paddingRef, flattenedNodes: flattenedNodesRef, empty: emptyRef, virtualListContainer() {\n                const { value } = virtualListRef;\n                return value === null || value === void 0 ? void 0 : value.listElRef;\n            },\n            virtualListContent() {\n                const { value } = virtualListRef;\n                return value === null || value === void 0 ? void 0 : value.itemsElRef;\n            },\n            doScroll,\n            handleFocusin,\n            handleFocusout,\n            handleKeyUp,\n            handleKeyDown,\n            handleMouseDown,\n            handleVirtualListResize,\n            handleVirtualListScroll }, exposedProps);\n    },\n    render() {\n        const { $slots, virtualScroll, clsPrefix, mergedTheme } = this;\n        return (h(\"div\", { ref: \"selfRef\", tabindex: this.focusable ? 0 : -1, class: [\n                `${clsPrefix}-base-select-menu`,\n                this.multiple && `${clsPrefix}-base-select-menu--multiple`\n            ], style: this.style, onFocusin: this.handleFocusin, onFocusout: this.handleFocusout, onKeyup: this.handleKeyUp, onKeydown: this.handleKeyDown, onMousedown: this.handleMouseDown, onMouseenter: this.onMouseenter, onMouseleave: this.onMouseleave },\n            this.loading ? (h(\"div\", { class: `${clsPrefix}-base-select-menu__loading` },\n                h(NInternalLoading, { clsPrefix: clsPrefix, strokeWidth: 20 }))) : !this.empty ? (h(NScrollbar, { ref: \"scrollbarRef\", theme: mergedTheme.peers.Scrollbar, themeOverrides: mergedTheme.peerOverrides.Scrollbar, scrollable: this.scrollable, container: virtualScroll ? this.virtualListContainer : undefined, content: virtualScroll ? this.virtualListContent : undefined, onScroll: virtualScroll ? undefined : this.doScroll }, {\n                default: () => {\n                    return virtualScroll ? (h(VirtualList, { ref: \"virtualListRef\", class: `${clsPrefix}-virtual-list`, items: this.flattenedNodes, itemSize: this.itemSize, showScrollbar: false, paddingTop: this.padding.top, paddingBottom: this.padding.bottom, onResize: this.handleVirtualListResize, onScroll: this.handleVirtualListScroll, itemResizable: true }, {\n                        default: ({ item: tmNode }) => {\n                            return tmNode.isGroup ? (h(NSelectGroupHeader, { key: tmNode.key, clsPrefix: clsPrefix, tmNode: tmNode })) : tmNode.ignored ? null : (h(NSelectOption, { clsPrefix: clsPrefix, key: tmNode.key, tmNode: tmNode }));\n                        }\n                    })) : (h(\"div\", { class: `${clsPrefix}-base-select-menu-option-wrapper`, style: {\n                            paddingTop: this.padding.top,\n                            paddingBottom: this.padding.bottom\n                        } }, this.flattenedNodes.map((tmNode) => tmNode.isGroup ? (h(NSelectGroupHeader, { key: tmNode.key, clsPrefix: clsPrefix, tmNode: tmNode })) : (h(NSelectOption, { clsPrefix: clsPrefix, key: tmNode.key, tmNode: tmNode })))));\n                }\n            })) : (h(\"div\", { class: `${clsPrefix}-base-select-menu__empty` }, renderSlot($slots, 'empty', undefined, () => [\n                h(NEmpty, { theme: mergedTheme.peers.Empty, themeOverrides: mergedTheme.peerOverrides.Empty })\n            ]))),\n            $slots.action && (h(\"div\", { class: `${clsPrefix}-base-select-menu__action`, \"data-action\": true }, renderSlot($slots, 'action'))),\n            $slots.action && h(NFocusDetector, { onFocus: this.onTabOut })));\n    }\n});\n","export default {\n    closeSizeSmall: '14px',\n    closeSizeMedium: '14px',\n    closeSizeLarge: '14px',\n    // closeSize\n    padding: '0 7px',\n    closeMargin: '0 0 0 3px',\n    closeMarginRtl: '0 3px 0 0'\n};\n","import commonVariables from './_common';\nimport { changeColor } from 'seemly';\nimport { commonLight } from '../../_styles/common';\nconst self = (vars) => {\n    const { textColor2, primaryColorHover, primaryColorPressed, primaryColor, infoColor, successColor, warningColor, errorColor, baseColor, borderColor, opacityDisabled, tagColor, closeColor, closeColorHover, closeColorPressed, borderRadiusSmall: borderRadius, fontSizeTiny, fontSizeSmall, fontSizeMedium, heightTiny, heightSmall, heightMedium } = vars;\n    return Object.assign(Object.assign({}, commonVariables), { heightSmall: heightTiny, heightMedium: heightSmall, heightLarge: heightMedium, borderRadius,\n        opacityDisabled, fontSizeSmall: fontSizeTiny, fontSizeMedium: fontSizeSmall, fontSizeLarge: fontSizeMedium, \n        // checked\n        textColorCheckable: textColor2, textColorHoverCheckable: primaryColorHover, textColorPressedCheckable: primaryColorPressed, textColorChecked: baseColor, colorCheckable: '#0000', colorHoverCheckable: '#0000', colorPressedCheckable: '#0000', colorChecked: primaryColor, colorCheckedHover: primaryColorHover, colorCheckedPressed: primaryColorPressed, \n        // default\n        border: `1px solid ${borderColor}`, textColor: textColor2, color: tagColor, closeColor: closeColor, closeColorHover: closeColorHover, closeColorPressed: closeColorPressed, borderPrimary: `1px solid ${changeColor(primaryColor, { alpha: 0.3 })}`, textColorPrimary: primaryColor, colorPrimary: changeColor(primaryColor, { alpha: 0.1 }), closeColorPrimary: changeColor(primaryColor, { alpha: 0.75 }), closeColorHoverPrimary: changeColor(primaryColor, { alpha: 0.6 }), closeColorPressedPrimary: changeColor(primaryColor, { alpha: 0.9 }), borderInfo: `1px solid ${changeColor(infoColor, { alpha: 0.3 })}`, textColorInfo: infoColor, colorInfo: changeColor(infoColor, { alpha: 0.1 }), closeColorInfo: changeColor(infoColor, { alpha: 0.75 }), closeColorHoverInfo: changeColor(infoColor, { alpha: 0.6 }), closeColorPressedInfo: changeColor(infoColor, { alpha: 0.9 }), borderSuccess: `1px solid ${changeColor(successColor, { alpha: 0.3 })}`, textColorSuccess: successColor, colorSuccess: changeColor(successColor, { alpha: 0.1 }), closeColorSuccess: changeColor(successColor, { alpha: 0.75 }), closeColorHoverSuccess: changeColor(successColor, { alpha: 0.6 }), closeColorPressedSuccess: changeColor(successColor, { alpha: 0.9 }), borderWarning: `1px solid ${changeColor(warningColor, { alpha: 0.35 })}`, textColorWarning: warningColor, colorWarning: changeColor(warningColor, { alpha: 0.12 }), closeColorWarning: changeColor(warningColor, { alpha: 0.75 }), closeColorHoverWarning: changeColor(warningColor, { alpha: 0.6 }), closeColorPressedWarning: changeColor(warningColor, { alpha: 0.9 }), borderError: `1px solid ${changeColor(errorColor, { alpha: 0.23 })}`, textColorError: errorColor, colorError: changeColor(errorColor, { alpha: 0.08 }), closeColorError: changeColor(errorColor, { alpha: 0.65 }), closeColorHoverError: changeColor(errorColor, { alpha: 0.5 }), closeColorPressedError: changeColor(errorColor, { alpha: 0.8 }) });\n};\nconst tagLight = {\n    name: 'Tag',\n    common: commonLight,\n    self\n};\nexport default tagLight;\n","export default {\n    color: Object,\n    type: {\n        type: String,\n        default: 'default'\n    },\n    round: Boolean,\n    size: {\n        type: String,\n        default: 'medium'\n    },\n    closable: Boolean,\n    disabled: {\n        type: Boolean,\n        default: undefined\n    }\n};\n","import { c, cB, cE, cM, cNotM } from '../../../_utils/cssr'; // vars:\n// --bezier\n// --border-radius\n// --border\n// --close-color\n// --close-color-hover\n// --close-color-pressed\n// --close-margin\n// --close-size\n// --color\n// --color-checkable\n// --color-checked\n// --color-checked-hover\n// --color-checked-pressed\n// --color-hover-checkable\n// --color-pressed-checkable\n// --font-size\n// --height\n// --opacity-disabled\n// --padding\n// --text-color\n// --text-color-checkable\n// --text-color-checked\n// --text-color-hover-checkable\n// --text-color-pressed-checkable\n\nexport default cB('tag', `\n white-space: nowrap;\n position: relative;\n box-sizing: border-box;\n cursor: default;\n display: inline-flex;\n align-items: center;\n flex-wrap: nowrap;\n padding: var(--padding);\n border-radius: var(--border-radius);\n color: var(--text-color);\n background-color: var(--color);\n transition: \n border-color .3s var(--bezier),\n background-color .3s var(--bezier),\n color .3s var(--bezier),\n box-shadow .3s var(--bezier),\n opacity .3s var(--bezier);\n line-height: 1.5;\n height: var(--height);\n font-size: var(--font-size);\n`, [cE('border', `\n pointer-events: none;\n position: absolute;\n left: 0;\n right: 0;\n top: 0;\n bottom: 0;\n border-radius: inherit;\n border: var(--border);\n transition: border-color .3s var(--bezier);\n `), cE('close', `\n font-size: var(--close-size);\n margin: var(--close-margin);\n transition: color .3s var(--bezier);\n cursor: pointer;\n `), cM('round', `\n padding: 0 calc(var(--height) / 2);\n border-radius: calc(var(--height) / 2);\n `), cM('disabled', {\n  cursor: 'not-allowed !important',\n  opacity: 'var(--opacity-disabled)'\n}), cM('checkable', `\n cursor: pointer;\n box-shadow: none;\n color: var(--text-color-checkable);\n background-color: var(--color-checkable);\n `, [cNotM('disabled', [c('&:hover', {\n  backgroundColor: 'var(--color-hover-checkable)'\n}, [cNotM('checked', {\n  color: 'var(--text-color-hover-checkable)'\n})]), c('&:active', {\n  backgroundColor: 'var(--color-pressed-checkable)'\n}, [cNotM('checked', {\n  color: 'var(--text-color-pressed-checkable)'\n})])]), cM('checked', {\n  color: 'var(--text-color-checked)',\n  backgroundColor: 'var(--color-checked)'\n}, [cNotM('disabled', [c('&:hover', {\n  backgroundColor: 'var(--color-checked-hover)'\n}), c('&:active', {\n  backgroundColor: 'var(--color-checked-pressed)'\n})])])])]);","import { h, defineComponent, computed, ref } from 'vue';\nimport { useConfig, useTheme } from '../../_mixins';\nimport { NBaseClose } from '../../_internal';\nimport { warn, createKey, call } from '../../_utils';\nimport { tagLight } from '../styles';\nimport commonProps from './common-props';\nimport style from './styles/index.cssr';\nimport useRtl from '../../_mixins/use-rtl';\nconst tagProps = Object.assign(Object.assign(Object.assign({}, useTheme.props), commonProps), { bordered: {\n        type: Boolean,\n        default: undefined\n    }, checked: Boolean, checkable: Boolean, onClose: [Array, Function], onMouseenter: Function, onMouseleave: Function, 'onUpdate:checked': Function, onUpdateChecked: Function, \n    // private\n    internalStopClickPropagation: Boolean, \n    // deprecated\n    onCheckedChange: {\n        type: Function,\n        validator: () => {\n            if (process.env.NODE_ENV !== 'production') {\n                warn('tag', '`on-checked-change` is deprecated, please use `on-update:checked` instead');\n            }\n            return true;\n        },\n        default: undefined\n    } });\nexport default defineComponent({\n    name: 'Tag',\n    props: tagProps,\n    setup(props) {\n        const contentRef = ref(null);\n        const { mergedBorderedRef, mergedClsPrefixRef, NConfigProvider } = useConfig(props);\n        const themeRef = useTheme('Tag', 'Tag', style, tagLight, props, mergedClsPrefixRef);\n        function handleClick(e) {\n            if (!props.disabled) {\n                if (props.checkable) {\n                    const { checked, onCheckedChange, onUpdateChecked, 'onUpdate:checked': _onUpdateChecked } = props;\n                    if (onUpdateChecked)\n                        onUpdateChecked(!checked);\n                    if (_onUpdateChecked)\n                        _onUpdateChecked(!checked);\n                    // deprecated\n                    if (onCheckedChange)\n                        onCheckedChange(!checked);\n                }\n            }\n        }\n        function handleCloseClick(e) {\n            if (props.internalStopClickPropagation) {\n                e.stopPropagation();\n            }\n            if (!props.disabled) {\n                const { onClose } = props;\n                if (onClose)\n                    call(onClose, e);\n            }\n        }\n        const tagPublicMethods = {\n            setTextContent(textContent) {\n                const { value } = contentRef;\n                if (value)\n                    value.textContent = textContent;\n            }\n        };\n        const rtlEnabledRef = useRtl('Tag', NConfigProvider === null || NConfigProvider === void 0 ? void 0 : NConfigProvider.mergedRtlRef, mergedClsPrefixRef);\n        return Object.assign(Object.assign({}, tagPublicMethods), { rtlEnabled: rtlEnabledRef, mergedClsPrefix: mergedClsPrefixRef, contentRef, mergedBordered: mergedBorderedRef, handleClick,\n            handleCloseClick, cssVars: computed(() => {\n                const { type, size, color: { color, textColor } = {} } = props;\n                const { common: { cubicBezierEaseInOut }, self: { padding, closeMargin, closeMarginRtl, borderRadius, opacityDisabled, textColorCheckable, textColorHoverCheckable, textColorPressedCheckable, textColorChecked, colorCheckable, colorHoverCheckable, colorPressedCheckable, colorChecked, colorCheckedHover, colorCheckedPressed, [createKey('closeSize', size)]: closeSize, [createKey('fontSize', size)]: fontSize, [createKey('height', size)]: height, [createKey('color', type)]: typedColor, [createKey('textColor', type)]: typeTextColor, [createKey('border', type)]: border, [createKey('closeColor', type)]: closeColor, [createKey('closeColorHover', type)]: closeColorHover, [createKey('closeColorPressed', type)]: closeColorPressed } } = themeRef.value;\n                return {\n                    '--bezier': cubicBezierEaseInOut,\n                    '--border-radius': borderRadius,\n                    '--border': border,\n                    '--close-color': closeColor,\n                    '--close-color-hover': closeColorHover,\n                    '--close-color-pressed': closeColorPressed,\n                    '--close-margin': closeMargin,\n                    '--close-margin-rtl': closeMarginRtl,\n                    '--close-size': closeSize,\n                    '--color': color || typedColor,\n                    '--color-checkable': colorCheckable,\n                    '--color-checked': colorChecked,\n                    '--color-checked-hover': colorCheckedHover,\n                    '--color-checked-pressed': colorCheckedPressed,\n                    '--color-hover-checkable': colorHoverCheckable,\n                    '--color-pressed-checkable': colorPressedCheckable,\n                    '--font-size': fontSize,\n                    '--height': height,\n                    '--opacity-disabled': opacityDisabled,\n                    '--padding': padding,\n                    '--text-color': textColor || typeTextColor,\n                    '--text-color-checkable': textColorCheckable,\n                    '--text-color-checked': textColorChecked,\n                    '--text-color-hover-checkable': textColorHoverCheckable,\n                    '--text-color-pressed-checkable': textColorPressedCheckable\n                };\n            }) });\n    },\n    render() {\n        const { mergedClsPrefix, rtlEnabled, color: { borderColor } = {} } = this;\n        return (h(\"div\", { class: [\n                `${mergedClsPrefix}-tag`,\n                {\n                    [`${mergedClsPrefix}-tag--rtl`]: rtlEnabled,\n                    [`${mergedClsPrefix}-tag--disabled`]: this.disabled,\n                    [`${mergedClsPrefix}-tag--checkable`]: this.checkable,\n                    [`${mergedClsPrefix}-tag--checked`]: this.checkable && this.checked,\n                    [`${mergedClsPrefix}-tag--round`]: this.round\n                }\n            ], style: this.cssVars, onClick: this.handleClick, onMouseenter: this.onMouseenter, onMouseleave: this.onMouseleave },\n            h(\"span\", { class: `${mergedClsPrefix}-tag__content`, ref: \"contentRef\" }, this.$slots),\n            !this.checkable && this.closable ? (h(NBaseClose, { clsPrefix: mergedClsPrefix, class: `${mergedClsPrefix}-tag__close`, disabled: this.disabled, onClick: this.handleCloseClick })) : null,\n            !this.checkable && this.mergedBordered ? (h(\"div\", { class: `${mergedClsPrefix}-tag__border`, style: { borderColor } })) : null));\n    }\n});\n","export default {\n    paddingSingle: '0 26px 0 14px',\n    clearSize: '16px',\n    arrowSize: '16px'\n};\n","import { changeColor } from 'seemly';\nimport { commonLight } from '../../../_styles/common';\nimport { popoverLight } from '../../../popover/styles';\nimport commonVariables from './_common';\nimport { createTheme } from '../../../_mixins';\nconst self = (vars) => {\n    const { borderRadius, textColor2, textColorDisabled, inputColor, inputColorDisabled, primaryColor, primaryColorHover, warningColor, warningColorHover, errorColor, errorColorHover, borderColor, iconColor, iconColorDisabled, clearColor, clearColorHover, clearColorPressed, placeholderColor, placeholderColorDisabled, fontSizeTiny, fontSizeSmall, fontSizeMedium, fontSizeLarge, heightTiny, heightSmall, heightMedium, heightLarge } = vars;\n    return Object.assign(Object.assign({}, commonVariables), { fontSizeTiny,\n        fontSizeSmall,\n        fontSizeMedium,\n        fontSizeLarge,\n        heightTiny,\n        heightSmall,\n        heightMedium,\n        heightLarge,\n        borderRadius, \n        // default\n        textColor: textColor2, textColorDisabled,\n        placeholderColor,\n        placeholderColorDisabled, color: inputColor, colorDisabled: inputColorDisabled, colorActive: inputColor, border: `1px solid ${borderColor}`, borderHover: `1px solid ${primaryColorHover}`, borderActive: `1px solid ${primaryColor}`, borderFocus: `1px solid ${primaryColorHover}`, boxShadowHover: null, boxShadowActive: `0 0 0 2px ${changeColor(primaryColor, {\n            alpha: 0.2\n        })}`, boxShadowFocus: `0 0 0 2px ${changeColor(primaryColor, {\n            alpha: 0.2\n        })}`, caretColor: primaryColor, arrowColor: iconColor, arrowColorDisabled: iconColorDisabled, loadingColor: primaryColor, \n        // warning\n        borderWarning: `1px solid ${warningColor}`, borderHoverWarning: `1px solid ${warningColorHover}`, borderActiveWarning: `1px solid ${warningColor}`, borderFocusWarning: `1px solid ${warningColorHover}`, boxShadowHoverWarning: null, boxShadowActiveWarning: `0 0 0 2px ${changeColor(warningColor, {\n            alpha: 0.2\n        })}`, boxShadowFocusWarning: `0 0 0 2px ${changeColor(warningColor, {\n            alpha: 0.2\n        })}`, colorActiveWarning: inputColor, caretColorWarning: warningColor, \n        // error\n        borderError: `1px solid ${errorColor}`, borderHoverError: `1px solid ${errorColorHover}`, borderActiveError: `1px solid ${errorColor}`, borderFocusError: `1px solid ${errorColorHover}`, boxShadowHoverError: null, boxShadowActiveError: `0 0 0 2px ${changeColor(errorColor, {\n            alpha: 0.2\n        })}`, boxShadowFocusError: `0 0 0 2px ${changeColor(errorColor, {\n            alpha: 0.2\n        })}`, colorActiveError: inputColor, caretColorError: errorColor, clearColor,\n        clearColorHover,\n        clearColorPressed });\n};\nconst internalSelectionLight = createTheme({\n    name: 'InternalSelection',\n    common: commonLight,\n    peers: {\n        Popover: popoverLight\n    },\n    self\n});\nexport default internalSelectionLight;\n","import { c, cB, cE, cM, cNotM, insideFormItem } from '../../../../_utils/cssr'; // vars:\n// --bezier\n// --border\n// --border-active\n// --border-focus\n// --border-hover\n// --border-radius\n// --box-shadow-active\n// --box-shadow-focus\n// --box-shadow-hover\n// --caret-color\n// --color\n// --color-active\n// --color-disabled\n// --font-size\n// --height\n// --padding-single\n// --placeholder-color\n// --placeholder-color-disabled\n// --text-color\n// --text-color-disabled\n// --arrow-color\n// --arrow-size\n// --loading-color\n// ...clear vars\n// ...form item vars\n\nexport default c([cB('base-selection', `\n position: relative;\n z-index: auto;\n box-shadow: none;\n width: 100%;\n max-width: 100%;\n display: inline-block;\n vertical-align: bottom;\n border-radius: var(--border-radius);\n min-height: var(--height);\n line-height: 1.5;\n font-size: var(--font-size);\n `, [cB('base-loading', `\n color: var(--loading-color);\n `), cB('base-selection-tags', {\n  minHeight: 'var(--height)'\n}), cE('border, state-border', `\n position: absolute;\n left: 0;\n right: 0;\n top: 0;\n bottom: 0;\n pointer-events: none;\n border: var(--border);\n border-radius: inherit;\n transition:\n box-shadow .3s var(--bezier),\n border-color .3s var(--bezier);\n `), cE('state-border', `\n z-index: 1;\n border-color: #0000;\n `), cB('base-suffix', `\n cursor: pointer;\n position: absolute;\n top: 50%;\n transform: translateY(-50%);\n right: 10px;\n `, [cE('arrow', `\n font-size: var(--arrow-size);\n color: var(--arrow-color);\n transition: color .3s var(--bezier);\n `)]), cB('base-selection-overlay', `\n display: flex;\n align-items: center;\n white-space: nowrap;\n overflow: hidden;\n pointer-events: none;\n position: absolute;\n top: 0;\n right: 0;\n bottom: 0;\n left: 0;\n padding: var(--padding-single);\n transition: color .3s var(--bezier);\n `), cB('base-selection-placeholder', `\n color: var(--placeholder-color);\n `), cB('base-selection-tags', `\n cursor: pointer;\n outline: none;\n box-sizing: border-box;\n position: relative;\n z-index: auto;\n display: flex;\n padding: 3px 26px 0 14px;\n flex-wrap: wrap;\n align-items: center;\n width: 100%;\n vertical-align: bottom;\n background-color: var(--color);\n border-radius: inherit;\n transition:\n color .3s var(--bezier),\n box-shadow .3s var(--bezier),\n background-color .3s var(--bezier);\n `), cB('base-selection-label', `\n height: var(--height);\n display: inline-flex;\n width: 100%;\n vertical-align: bottom;\n cursor: pointer;\n outline: none;\n z-index: auto;\n box-sizing: border-box;\n position: relative;\n transition:\n color .3s var(--bezier),\n box-shadow .3s var(--bezier),\n background-color .3s var(--bezier);\n border-radius: inherit;\n background-color: var(--color);\n align-items: center;\n `, [cB('base-selection-input', `\n line-height: inherit;\n outline: none;\n cursor: pointer;\n box-sizing: border-box;\n border:none;\n width: 100%;\n padding: var(--padding-single);\n background-color: #0000;\n color: var(--text-color);\n transition: color .3s var(--bezier);\n caret-color: var(--caret-color);\n `, [cE('content', `\n text-overflow: ellipsis;\n overflow: hidden;\n white-space: nowrap; \n `)]), cE('render-label', `\n color: var(--text-color);\n `)]), cNotM('disabled', [c('&:hover', [cE('state-border', `\n box-shadow: var(--box-shadow-hover);\n border: var(--border-hover);\n `)]), cM('focus', [cE('state-border', `\n box-shadow: var(--box-shadow-focus);\n border: var(--border-focus);\n `)]), cM('active', [cE('state-border', `\n box-shadow: var(--box-shadow-active);\n border: var(--border-active);\n `), cB('base-selection-label', {\n  backgroundColor: 'var(--color-active)'\n}), cB('base-selection-tags', {\n  backgroundColor: 'var(--color-active)'\n})])]), cM('disabled', {\n  cursor: 'not-allowed'\n}, [cE('arrow', `\n color: var(--arrow-color-disabled);\n `), cB('base-selection-label', `\n cursor: not-allowed;\n background-color: var(--color-disabled);\n `, [cB('base-selection-input', `\n cursor: not-allowed;\n color: var(--text-color-disabled);\n `), cE('render-label', `\n color: var(--text-color-disabled);\n `)]), cB('base-selection-tags', `\n cursor: not-allowed;\n background-color: var(--color-disabled);\n `), cB('base-selection-placeholder', `\n cursor: not-allowed;\n color: var(--placeholder-color-disabled);\n `)]), cB('base-selection-input-tag', `\n height: calc(var(--height) - 6px);\n line-height: calc(var(--height) - 6px);\n outline: none;\n display: none;\n position: relative;\n margin-bottom: 3px;\n max-width: 100%;\n vertical-align: bottom;\n `, [cE('input', `\n min-width: 1px;\n padding: 0;\n background-color: #0000;\n outline: none;\n border: none;\n max-width: 100%;\n overflow: hidden;\n width: 1em;\n line-height: inherit;\n cursor: pointer;\n color: var(--text-color);\n caret-color: var(--caret-color);\n `), cE('mirror', `\n position: absolute;\n left: 0;\n top: 0;\n white-space: pre;\n visibility: hidden;\n user-select: none;\n opacity: 0;\n `)])]), cB('base-selection-popover', `\n margin-bottom: -3px;\n display: flex;\n flex-wrap: wrap;\n `), cB('base-selection-tag-wrapper', `\n max-width: 100%;\n display: inline-flex;\n padding: 0 7px 3px 0;\n `, [c('&:last-child', {\n  paddingRight: 0\n}), cB('tag', `\n font-size: 14px;\n max-width: 100%;\n `, [cE('content', `\n text-overflow: ellipsis;\n overflow: hidden;\n `)])]), ['warning', 'error'].map(status => insideFormItem(status, cB('base-selection', [cE('state-border', {\n  border: `var(--border-${status})`\n}), cNotM('disabled', [c('&:hover', [cE('state-border', `\n box-shadow: var(--box-shadow-hover-${status});\n border: var(--border-hover-${status});\n `)]), cM('active', [cE('state-border', `\n box-shadow: var(--box-shadow-active-${status});\n border: var(--border-active-${status});\n `), cB('base-selection-label', {\n  backgroundColor: `var(--color-active-${status})`\n}), cB('base-selection-tags', {\n  backgroundColor: `var(--box-shadow-active-${status})`\n})]), cM('focus', [cE('state-border', `\n box-shadow: var(--box-shadow-focus-${status});\n border: var(--border-focus-${status});\n `)])])])))]);","/* eslint-disable @typescript-eslint/no-non-null-assertion */\nimport { h, defineComponent, Fragment, ref, computed, watch, toRef, nextTick, watchEffect, onMounted } from 'vue';\nimport { VOverflow } from 'vueuc';\nimport { NPopover } from '../../../popover';\nimport { NTag } from '../../../tag';\nimport { useTheme } from '../../../_mixins';\nimport { createKey, getTitleAttribute, render } from '../../../_utils';\nimport Suffix from '../../suffix';\nimport { internalSelectionLight } from '../styles';\nimport style from './styles/index.cssr';\nexport default defineComponent({\n    name: 'InternalSelection',\n    props: Object.assign(Object.assign({}, useTheme.props), { clsPrefix: {\n            type: String,\n            required: true\n        }, bordered: {\n            type: Boolean,\n            default: undefined\n        }, active: Boolean, pattern: {\n            type: String,\n            default: null\n        }, placeholder: String, selectedOption: {\n            type: Object,\n            default: null\n        }, selectedOptions: {\n            type: Array,\n            default: null\n        }, multiple: Boolean, filterable: Boolean, clearable: Boolean, disabled: Boolean, size: {\n            type: String,\n            default: 'medium'\n        }, loading: Boolean, autofocus: Boolean, showArrow: {\n            type: Boolean,\n            default: true\n        }, inputProps: Object, focused: Boolean, renderTag: Function, onKeyup: Function, onKeydown: Function, onClick: Function, onBlur: Function, onFocus: Function, onDeleteOption: Function, maxTagCount: [String, Number], onClear: Function, onPatternInput: Function, renderLabel: Function }),\n    setup(props) {\n        const patternInputMirrorRef = ref(null);\n        const patternInputRef = ref(null);\n        const selfRef = ref(null);\n        const multipleElRef = ref(null);\n        const singleElRef = ref(null);\n        const patternInputWrapperRef = ref(null);\n        const counterRef = ref(null);\n        const counterWrapperRef = ref(null);\n        const overflowRef = ref(null);\n        const inputTagElRef = ref(null);\n        const showTagsPopoverRef = ref(false);\n        const patternInputFocusedRef = ref(false);\n        const hoverRef = ref(false);\n        const themeRef = useTheme('InternalSelection', 'InternalSelection', style, internalSelectionLight, props, toRef(props, 'clsPrefix'));\n        const mergedClearableRef = computed(() => {\n            return (props.clearable && !props.disabled && (hoverRef.value || props.active));\n        });\n        const filterablePlaceholderRef = computed(() => {\n            return props.selectedOption\n                ? props.renderTag\n                    ? props.renderTag({\n                        option: props.selectedOption,\n                        handleClose: () => { }\n                    })\n                    : props.renderLabel\n                        ? props.renderLabel(props.selectedOption, true)\n                        : render(props.selectedOption.label, props.selectedOption, true)\n                : props.placeholder;\n        });\n        const labelRef = computed(() => {\n            const option = props.selectedOption;\n            if (!option)\n                return undefined;\n            return option.label;\n        });\n        const selectedRef = computed(() => {\n            if (props.multiple) {\n                return !!(Array.isArray(props.selectedOptions) && props.selectedOptions.length);\n            }\n            else {\n                return props.selectedOption !== null;\n            }\n        });\n        function syncMirrorWidth() {\n            var _a;\n            const { value: patternInputMirrorEl } = patternInputMirrorRef;\n            if (patternInputMirrorEl) {\n                const { value: patternInputEl } = patternInputRef;\n                if (patternInputEl) {\n                    patternInputEl.style.width = `${patternInputMirrorEl.offsetWidth}px`;\n                    if (props.maxTagCount !== 'responsive') {\n                        (_a = overflowRef.value) === null || _a === void 0 ? void 0 : _a.sync();\n                    }\n                }\n            }\n        }\n        function hideInputTag() {\n            const { value: inputTagEl } = inputTagElRef;\n            if (inputTagEl)\n                inputTagEl.style.display = 'none';\n        }\n        function showInputTag() {\n            const { value: inputTagEl } = inputTagElRef;\n            if (inputTagEl)\n                inputTagEl.style.display = 'inline-block';\n        }\n        watch(toRef(props, 'active'), (value) => {\n            if (!value)\n                hideInputTag();\n        });\n        watch(toRef(props, 'pattern'), () => {\n            if (props.multiple) {\n                void nextTick(syncMirrorWidth);\n            }\n        });\n        function doFocus(e) {\n            const { onFocus } = props;\n            if (onFocus)\n                onFocus(e);\n        }\n        function doBlur(e) {\n            const { onBlur } = props;\n            if (onBlur)\n                onBlur(e);\n        }\n        function doDeleteOption(value) {\n            const { onDeleteOption } = props;\n            if (onDeleteOption)\n                onDeleteOption(value);\n        }\n        function doClear(e) {\n            const { onClear } = props;\n            if (onClear)\n                onClear(e);\n        }\n        function doPatternInput(value) {\n            const { onPatternInput } = props;\n            if (onPatternInput)\n                onPatternInput(value);\n        }\n        function handleFocusin(e) {\n            var _a;\n            if (!e.relatedTarget ||\n                !((_a = selfRef.value) === null || _a === void 0 ? void 0 : _a.contains(e.relatedTarget))) {\n                doFocus(e);\n            }\n        }\n        function handleFocusout(e) {\n            var _a;\n            if ((_a = selfRef.value) === null || _a === void 0 ? void 0 : _a.contains(e.relatedTarget))\n                return;\n            doBlur(e);\n        }\n        function handleClear(e) {\n            doClear(e);\n        }\n        function handleMouseEnter() {\n            hoverRef.value = true;\n        }\n        function handleMouseLeave() {\n            hoverRef.value = false;\n        }\n        function handleMouseDown(e) {\n            if (!props.active || !props.filterable)\n                return;\n            if (e.target === patternInputRef.value)\n                return;\n            e.preventDefault();\n        }\n        function handleDeleteOption(option) {\n            doDeleteOption(option);\n        }\n        function handlePatternKeyDown(e) {\n            if (e.code === 'Backspace') {\n                if (!props.pattern.length) {\n                    const { selectedOptions } = props;\n                    if (selectedOptions === null || selectedOptions === void 0 ? void 0 : selectedOptions.length) {\n                        handleDeleteOption(selectedOptions[selectedOptions.length - 1]);\n                    }\n                }\n            }\n        }\n        const isCompositingRef = ref(false);\n        // the composition end is later than its input so we can cached the event\n        // and return the input event\n        let cachedInputEvent = null;\n        function handlePatternInputInput(e) {\n            // we should sync mirror width here\n            const { value: patternInputMirrorEl } = patternInputMirrorRef;\n            if (patternInputMirrorEl) {\n                const inputText = e.target.value;\n                patternInputMirrorEl.textContent = inputText;\n                syncMirrorWidth();\n            }\n            if (!isCompositingRef.value) {\n                doPatternInput(e);\n            }\n            else {\n                cachedInputEvent = e;\n            }\n        }\n        function handleCompositionStart() {\n            isCompositingRef.value = true;\n        }\n        function handleCompositionEnd() {\n            isCompositingRef.value = false;\n            doPatternInput(cachedInputEvent);\n            cachedInputEvent = null;\n        }\n        function handlePatternInputFocus() {\n            patternInputFocusedRef.value = true;\n        }\n        function handlePatternInputBlur(e) {\n            patternInputFocusedRef.value = false;\n        }\n        function focus() {\n            if (props.filterable) {\n                patternInputFocusedRef.value = false;\n                const { value: patternInputWrapperEl } = patternInputWrapperRef;\n                if (patternInputWrapperEl)\n                    patternInputWrapperEl.focus();\n            }\n            else if (props.multiple) {\n                const { value: multipleEl } = multipleElRef;\n                multipleEl === null || multipleEl === void 0 ? void 0 : multipleEl.focus();\n            }\n            else {\n                const { value: singleEl } = singleElRef;\n                singleEl === null || singleEl === void 0 ? void 0 : singleEl.focus();\n            }\n        }\n        function focusInput() {\n            const { value: patternInputEl } = patternInputRef;\n            if (patternInputEl) {\n                showInputTag();\n                patternInputEl.focus();\n            }\n        }\n        function blurInput() {\n            const { value: patternInputEl } = patternInputRef;\n            if (patternInputEl) {\n                patternInputEl.blur();\n            }\n        }\n        function updateCounter(count) {\n            const { value } = counterRef;\n            if (value) {\n                value.setTextContent(`+${count}`);\n            }\n        }\n        function getCounter() {\n            const { value } = counterWrapperRef;\n            return value;\n        }\n        function getTail() {\n            return patternInputRef.value;\n        }\n        let enterTimerId = null;\n        function clearEnterTimer() {\n            if (enterTimerId !== null)\n                window.clearTimeout(enterTimerId);\n        }\n        function handleMouseEnterCounter() {\n            if (props.disabled || props.active)\n                return;\n            clearEnterTimer();\n            enterTimerId = window.setTimeout(() => {\n                showTagsPopoverRef.value = true;\n            }, 100);\n        }\n        function handleMouseLeaveCounter() {\n            clearEnterTimer();\n        }\n        function onPopoverUpdateShow(show) {\n            if (!show) {\n                clearEnterTimer();\n                showTagsPopoverRef.value = false;\n            }\n        }\n        onMounted(() => {\n            watchEffect(() => {\n                const patternInputWrapperEl = patternInputWrapperRef.value;\n                if (!patternInputWrapperEl)\n                    return;\n                patternInputWrapperEl.tabIndex =\n                    props.disabled || patternInputFocusedRef.value ? -1 : 0;\n            });\n        });\n        return {\n            mergedTheme: themeRef,\n            mergedClearable: mergedClearableRef,\n            patternInputFocused: patternInputFocusedRef,\n            filterablePlaceholder: filterablePlaceholderRef,\n            label: labelRef,\n            selected: selectedRef,\n            showTagsPanel: showTagsPopoverRef,\n            isCompositing: isCompositingRef,\n            // dom ref\n            counterRef,\n            counterWrapperRef,\n            patternInputMirrorRef,\n            patternInputRef,\n            selfRef,\n            multipleElRef,\n            singleElRef,\n            patternInputWrapperRef,\n            overflowRef,\n            inputTagElRef,\n            handleMouseDown,\n            handleFocusin,\n            handleClear,\n            handleMouseEnter,\n            handleMouseLeave,\n            handleDeleteOption,\n            handlePatternKeyDown,\n            handlePatternInputInput,\n            handlePatternInputBlur,\n            handlePatternInputFocus,\n            handleMouseEnterCounter,\n            handleMouseLeaveCounter,\n            handleFocusout,\n            handleCompositionEnd,\n            handleCompositionStart,\n            onPopoverUpdateShow,\n            focus,\n            focusInput,\n            blurInput,\n            updateCounter,\n            getCounter,\n            getTail,\n            renderLabel: props.renderLabel,\n            cssVars: computed(() => {\n                const { size } = props;\n                const { common: { cubicBezierEaseInOut }, self: { borderRadius, color, placeholderColor, textColor, paddingSingle, caretColor, colorDisabled, textColorDisabled, placeholderColorDisabled, colorActive, boxShadowFocus, boxShadowActive, boxShadowHover, border, borderFocus, borderHover, borderActive, arrowColor, arrowColorDisabled, loadingColor, \n                // form warning\n                colorActiveWarning, boxShadowFocusWarning, boxShadowActiveWarning, boxShadowHoverWarning, borderWarning, borderFocusWarning, borderHoverWarning, borderActiveWarning, \n                // form error\n                colorActiveError, boxShadowFocusError, boxShadowActiveError, boxShadowHoverError, borderError, borderFocusError, borderHoverError, borderActiveError, \n                // clear\n                clearColor, clearColorHover, clearColorPressed, clearSize, \n                // arrow\n                arrowSize, [createKey('height', size)]: height, [createKey('fontSize', size)]: fontSize } } = themeRef.value;\n                return {\n                    '--bezier': cubicBezierEaseInOut,\n                    '--border': border,\n                    '--border-active': borderActive,\n                    '--border-focus': borderFocus,\n                    '--border-hover': borderHover,\n                    '--border-radius': borderRadius,\n                    '--box-shadow-active': boxShadowActive,\n                    '--box-shadow-focus': boxShadowFocus,\n                    '--box-shadow-hover': boxShadowHover,\n                    '--caret-color': caretColor,\n                    '--color': color,\n                    '--color-active': colorActive,\n                    '--color-disabled': colorDisabled,\n                    '--font-size': fontSize,\n                    '--height': height,\n                    '--padding-single': paddingSingle,\n                    '--placeholder-color': placeholderColor,\n                    '--placeholder-color-disabled': placeholderColorDisabled,\n                    '--text-color': textColor,\n                    '--text-color-disabled': textColorDisabled,\n                    '--arrow-color': arrowColor,\n                    '--arrow-color-disabled': arrowColorDisabled,\n                    '--loading-color': loadingColor,\n                    // form warning\n                    '--color-active-warning': colorActiveWarning,\n                    '--box-shadow-focus-warning': boxShadowFocusWarning,\n                    '--box-shadow-active-warning': boxShadowActiveWarning,\n                    '--box-shadow-hover-warning': boxShadowHoverWarning,\n                    '--border-warning': borderWarning,\n                    '--border-focus-warning': borderFocusWarning,\n                    '--border-hover-warning': borderHoverWarning,\n                    '--border-active-warning': borderActiveWarning,\n                    // form error\n                    '--color-active-error': colorActiveError,\n                    '--box-shadow-focus-error': boxShadowFocusError,\n                    '--box-shadow-active-error': boxShadowActiveError,\n                    '--box-shadow-hover-error': boxShadowHoverError,\n                    '--border-error': borderError,\n                    '--border-focus-error': borderFocusError,\n                    '--border-hover-error': borderHoverError,\n                    '--border-active-error': borderActiveError,\n                    // clear\n                    '--clear-size': clearSize,\n                    '--clear-color': clearColor,\n                    '--clear-color-hover': clearColorHover,\n                    '--clear-color-pressed': clearColorPressed,\n                    // arrow-size\n                    '--arrow-size': arrowSize\n                };\n            })\n        };\n    },\n    render() {\n        const { multiple, size, disabled, filterable, maxTagCount, bordered, clsPrefix, renderTag, renderLabel } = this;\n        const maxTagCountResponsive = maxTagCount === 'responsive';\n        const maxTagCountNumeric = typeof maxTagCount === 'number';\n        const useMaxTagCount = maxTagCountResponsive || maxTagCountNumeric;\n        const suffix = (h(Suffix, { clsPrefix: clsPrefix, loading: this.loading, showArrow: this.showArrow, showClear: this.mergedClearable && this.selected, onClear: this.handleClear }));\n        let body;\n        if (multiple) {\n            const createTag = (option) => (h(\"div\", { class: `${clsPrefix}-base-selection-tag-wrapper`, key: option.value }, renderTag ? (renderTag({\n                option,\n                handleClose: () => this.handleDeleteOption(option)\n            })) : (h(NTag, { size: size, closable: !option.disabled, disabled: disabled, internalStopClickPropagation: true, onClose: () => this.handleDeleteOption(option) }, {\n                default: () => renderLabel\n                    ? renderLabel(option, true)\n                    : render(option.label, option, true)\n            }))));\n            const originalTags = (maxTagCountNumeric\n                ? this.selectedOptions.slice(0, maxTagCount)\n                : this.selectedOptions).map(createTag);\n            const input = filterable ? (h(\"div\", { class: `${clsPrefix}-base-selection-input-tag`, ref: \"inputTagElRef\", key: \"__input-tag__\" },\n                h(\"input\", Object.assign({}, this.inputProps, { ref: \"patternInputRef\", tabindex: -1, disabled: disabled, value: this.pattern, autofocus: this.autofocus, class: `${clsPrefix}-base-selection-input-tag__input`, onBlur: this.handlePatternInputBlur, onFocus: this.handlePatternInputFocus, onKeydown: this.handlePatternKeyDown, onInput: this.handlePatternInputInput, onCompositionstart: this.handleCompositionStart, onCompositionend: this.handleCompositionEnd })),\n                h(\"span\", { ref: \"patternInputMirrorRef\", class: `${clsPrefix}-base-selection-input-tag__mirror` }, this.pattern ? this.pattern : ''))) : null;\n            // May Overflow\n            const renderCounter = maxTagCountResponsive\n                ? () => (h(\"div\", { class: `${clsPrefix}-base-selection-tag-wrapper`, ref: \"counterWrapperRef\" },\n                    h(NTag, { ref: \"counterRef\", onMouseenter: this.handleMouseEnterCounter, onMouseleave: this.handleMouseLeaveCounter, disabled: disabled })))\n                : undefined;\n            let counter;\n            if (maxTagCountNumeric) {\n                const rest = this.selectedOptions.length - maxTagCount;\n                if (rest > 0) {\n                    counter = (h(\"div\", { class: `${clsPrefix}-base-selection-tag-wrapper`, key: \"__counter__\" },\n                        h(NTag, { ref: \"counterRef\", onMouseenter: this.handleMouseEnterCounter, disabled: disabled }, {\n                            default: () => `+${rest}`\n                        })));\n                }\n            }\n            const tags = maxTagCountResponsive ? (filterable ? (h(VOverflow, { ref: \"overflowRef\", updateCounter: this.updateCounter, getCounter: this.getCounter, getTail: this.getTail, style: {\n                    width: '100%',\n                    display: 'flex',\n                    overflow: 'hidden'\n                } }, {\n                default: () => originalTags,\n                counter: renderCounter,\n                tail: () => input\n            })) : (h(VOverflow, { ref: \"overflowRef\", updateCounter: this.updateCounter, getCounter: this.getCounter, style: {\n                    width: '100%',\n                    display: 'flex',\n                    overflow: 'hidden'\n                } }, {\n                default: () => originalTags,\n                counter: renderCounter\n            }))) : maxTagCountNumeric ? (originalTags.concat(counter)) : (originalTags);\n            const renderPopover = useMaxTagCount\n                ? () => (h(\"div\", { class: `${clsPrefix}-base-selection-popover` }, maxTagCountResponsive\n                    ? originalTags\n                    : this.selectedOptions.map(createTag)))\n                : undefined;\n            const popoverProps = useMaxTagCount\n                ? {\n                    show: this.showTagsPanel,\n                    trigger: 'hover',\n                    overlap: true,\n                    placement: 'top',\n                    width: 'trigger',\n                    onUpdateShow: this.onPopoverUpdateShow,\n                    theme: this.mergedTheme.peers.Popover,\n                    themeOverrides: this.mergedTheme.peerOverrides.Popover\n                }\n                : null;\n            const placeholder = !this.selected && !this.pattern && !this.isCompositing ? (h(\"div\", { class: `${clsPrefix}-base-selection-placeholder ${clsPrefix}-base-selection-overlay` }, this.placeholder)) : null;\n            if (filterable) {\n                const popoverTrigger = (h(\"div\", { ref: \"patternInputWrapperRef\", class: `${clsPrefix}-base-selection-tags` },\n                    tags,\n                    maxTagCountResponsive ? null : input,\n                    suffix));\n                body = (h(Fragment, null,\n                    useMaxTagCount ? (h(NPopover, Object.assign({}, popoverProps), {\n                        trigger: () => popoverTrigger,\n                        default: renderPopover\n                    })) : (popoverTrigger),\n                    placeholder));\n            }\n            else {\n                const popoverTrigger = (h(\"div\", { ref: \"multipleElRef\", class: `${clsPrefix}-base-selection-tags`, tabindex: disabled ? undefined : 0 },\n                    tags,\n                    suffix));\n                body = (h(Fragment, null,\n                    useMaxTagCount ? (h(NPopover, Object.assign({}, popoverProps), {\n                        trigger: () => popoverTrigger,\n                        default: renderPopover\n                    })) : (popoverTrigger),\n                    placeholder));\n            }\n        }\n        else {\n            if (filterable) {\n                const showPlaceholder = !this.pattern &&\n                    (this.active || !this.selected) &&\n                    !this.isCompositing;\n                body = (h(\"div\", { ref: \"patternInputWrapperRef\", class: `${clsPrefix}-base-selection-label` },\n                    h(\"input\", Object.assign({}, this.inputProps, { ref: \"patternInputRef\", class: `${clsPrefix}-base-selection-input`, value: this.patternInputFocused && this.active ? this.pattern : '', placeholder: \"\", readonly: disabled, disabled: disabled, tabindex: -1, autofocus: this.autofocus, onFocus: this.handlePatternInputFocus, onBlur: this.handlePatternInputBlur, onInput: this.handlePatternInputInput, onCompositionstart: this.handleCompositionStart, onCompositionend: this.handleCompositionEnd })),\n                    showPlaceholder ? null : this.patternInputFocused &&\n                        this.active ? null : (h(\"div\", { class: `${clsPrefix}-base-selection-label__render-label ${clsPrefix}-base-selection-overlay`, key: \"input\" }, renderTag\n                        ? renderTag({\n                            option: this.selectedOption,\n                            handleClose: () => { }\n                        })\n                        : renderLabel\n                            ? renderLabel(this.selectedOption, true)\n                            : render(this.label, this.selectedOption, true))),\n                    showPlaceholder ? (h(\"div\", { class: `${clsPrefix}-base-selection-placeholder ${clsPrefix}-base-selection-overlay`, key: \"placeholder\" }, this.filterablePlaceholder)) : null,\n                    suffix));\n            }\n            else {\n                body = (h(\"div\", { ref: \"singleElRef\", class: `${clsPrefix}-base-selection-label`, tabindex: this.disabled ? undefined : 0 },\n                    this.label !== undefined ? (h(\"div\", { class: `${clsPrefix}-base-selection-input`, title: getTitleAttribute(this.label), key: \"input\" },\n                        h(\"div\", { class: `${clsPrefix}-base-selection-input__content` }, renderTag\n                            ? renderTag({\n                                option: this.selectedOption,\n                                handleClose: () => { }\n                            })\n                            : renderLabel\n                                ? renderLabel(this.selectedOption, true)\n                                : render(this.label, this.selectedOption, true)))) : (h(\"div\", { class: `${clsPrefix}-base-selection-placeholder ${clsPrefix}-base-selection-overlay`, key: \"placeholder\" }, this.placeholder)),\n                    suffix));\n            }\n        }\n        return (h(\"div\", { ref: \"selfRef\", class: [\n                `${clsPrefix}-base-selection`,\n                {\n                    [`${clsPrefix}-base-selection--active`]: this.active,\n                    [`${clsPrefix}-base-selection--selected`]: this.selected || (this.active && this.pattern),\n                    [`${clsPrefix}-base-selection--disabled`]: this.disabled,\n                    [`${clsPrefix}-base-selection--multiple`]: this.multiple,\n                    // focus is not controlled by selection itself since it always need\n                    // to be managed together with menu. provide :focus style will cause\n                    // many redundant codes.\n                    [`${clsPrefix}-base-selection--focus`]: this.focused\n                }\n            ], style: this.cssVars, onClick: this.onClick, onMouseenter: this.handleMouseEnter, onMouseleave: this.handleMouseLeave, onKeyup: this.onKeyup, onKeydown: this.onKeydown, onFocusin: this.handleFocusin, onFocusout: this.handleFocusout, onMousedown: this.handleMouseDown },\n            body,\n            bordered ? (h(\"div\", { class: `${clsPrefix}-base-selection__border` })) : null,\n            bordered ? (h(\"div\", { class: `${clsPrefix}-base-selection__state-border` })) : null));\n    }\n});\n","export function getKey(option) {\n    if (getIsGroup(option)) {\n        return (option.name ||\n            option.key ||\n            'key-required');\n    }\n    return option.value;\n}\nexport function getIsGroup(option) {\n    return option.type === 'group';\n}\nexport function getIgnored(option) {\n    return option.type === 'ignored';\n}\nexport const tmOptions = {\n    getKey,\n    getIsGroup,\n    getIgnored\n};\nexport function patternMatched(pattern, value) {\n    try {\n        return !!(1 + value.toString().toLowerCase().indexOf(pattern.trim().toLowerCase()));\n    }\n    catch (err) {\n        return false;\n    }\n}\nexport function filterOptions(originalOpts, filter, pattern) {\n    if (!filter)\n        return originalOpts;\n    function traverse(options) {\n        if (!Array.isArray(options))\n            return [];\n        const filteredOptions = [];\n        for (const option of options) {\n            if (getIsGroup(option)) {\n                const children = traverse(option.children);\n                if (children.length) {\n                    filteredOptions.push(Object.assign({}, option, {\n                        children\n                    }));\n                }\n            }\n            else if (getIgnored(option)) {\n                continue;\n            }\n            else if (filter(pattern, option)) {\n                filteredOptions.push(option);\n            }\n        }\n        return filteredOptions;\n    }\n    return traverse(originalOpts);\n}\nexport function createValOptMap(options) {\n    const valOptMap = new Map();\n    options.forEach((option) => {\n        if (getIsGroup(option)) {\n            ;\n            option.children.forEach((SelectGroupOption) => {\n                valOptMap.set(SelectGroupOption.value, SelectGroupOption);\n            });\n        }\n        else {\n            valOptMap.set(option.value, option);\n        }\n    });\n    return valOptMap;\n}\nexport function defaultFilter(pattern, option) {\n    if (!option)\n        return false;\n    if (typeof option.label === 'string') {\n        return patternMatched(pattern, option.label);\n    }\n    else if (option.value !== undefined) {\n        return patternMatched(pattern, String(option.value));\n    }\n    return false;\n}\n","import { internalSelectionLight } from '../../_internal/selection/styles';\nimport { internalSelectMenuLight } from '../../_internal/select-menu/styles';\nimport { commonLight } from '../../_styles/common';\nimport { createTheme } from '../../_mixins';\nexport function self(vars) {\n    const { boxShadow2 } = vars;\n    return {\n        menuBoxShadow: boxShadow2\n    };\n}\nconst selectLight = createTheme({\n    name: 'Select',\n    common: commonLight,\n    peers: {\n        InternalSelection: internalSelectionLight,\n        InternalSelectMenu: internalSelectMenuLight\n    },\n    self\n});\nexport default selectLight;\n","import { cB, c } from '../../../_utils/cssr';\nimport fadeInScaleUpTransition from '../../../_styles/transitions/fade-in-scale-up.cssr'; // --menu-box-shadow\n\nexport default c([cB('select', `\n z-index: auto;\n outline: none;\n width: 100%;\n position: relative;\n `), cB('select-menu', `\n margin: 4px 0;\n box-shadow: var(--menu-box-shadow);\n `, [fadeInScaleUpTransition()])]);","import { h, ref, computed, toRef, defineComponent, nextTick, watch, Transition, withDirectives, vShow } from 'vue';\nimport { happensIn } from 'seemly';\nimport { createTreeMate } from 'treemate';\nimport { VBinder, VFollower, VTarget } from 'vueuc';\nimport { useIsMounted, useMergedState, useCompitable } from 'vooks';\nimport { clickoutside } from 'vdirs';\nimport { useTheme, useConfig, useLocale, useFormItem } from '../../_mixins';\nimport { warn, call, useAdjustedTo } from '../../_utils';\nimport { NInternalSelectMenu, NInternalSelection } from '../../_internal';\nimport { selectLight } from '../styles';\nimport { tmOptions, createValOptMap, filterOptions, defaultFilter } from './utils';\nimport style from './styles/index.cssr';\nconst selectProps = Object.assign(Object.assign({}, useTheme.props), { to: useAdjustedTo.propTo, bordered: {\n        type: Boolean,\n        default: undefined\n    }, clearable: Boolean, options: {\n        type: Array,\n        default: () => []\n    }, defaultValue: {\n        type: [String, Number, Array],\n        default: null\n    }, value: [String, Number, Array], placeholder: String, menuProps: Object, multiple: Boolean, size: String, filterable: Boolean, disabled: {\n        type: Boolean,\n        default: undefined\n    }, remote: Boolean, loading: Boolean, filter: {\n        type: Function,\n        default: defaultFilter\n    }, placement: {\n        type: String,\n        default: 'bottom-start'\n    }, widthMode: {\n        type: String,\n        default: 'trigger'\n    }, tag: Boolean, onCreate: {\n        type: Function,\n        default: (label) => ({\n            label: label,\n            value: label\n        })\n    }, fallbackOption: {\n        type: [Function, Boolean],\n        default: () => (value) => ({\n            label: String(value),\n            value\n        })\n    }, show: {\n        type: Boolean,\n        default: undefined\n    }, showArrow: {\n        type: Boolean,\n        default: true\n    }, maxTagCount: [Number, String], consistentMenuWidth: {\n        type: Boolean,\n        default: true\n    }, virtualScroll: {\n        type: Boolean,\n        default: true\n    }, renderLabel: Function, renderOption: Function, renderTag: Function, 'onUpdate:value': [Function, Array], inputProps: Object, \n    // for jsx\n    onUpdateValue: [Function, Array], onBlur: [Function, Array], onClear: [Function, Array], onFocus: [Function, Array], onScroll: [Function, Array], onSearch: [Function, Array], onUpdateShow: [Function, Array], 'onUpdate:show': [Function, Array], \n    /** deprecated */\n    onChange: {\n        type: [Function, Array],\n        validator: () => {\n            if (process.env.NODE_ENV !== 'production') {\n                warn('select', '`on-change` is deprecated, please use `on-update:value` instead.');\n            }\n            return true;\n        },\n        default: undefined\n    }, items: {\n        type: Array,\n        validator: () => {\n            if (process.env.NODE_ENV !== 'production') {\n                warn('select', '`items` is deprecated, please use `options` instead.');\n            }\n            return true;\n        },\n        default: undefined\n    }, displayDirective: {\n        type: String,\n        default: 'show'\n    } });\nexport default defineComponent({\n    name: 'Select',\n    props: selectProps,\n    setup(props) {\n        const { mergedClsPrefixRef, mergedBorderedRef, namespaceRef } = useConfig(props);\n        const themeRef = useTheme('Select', 'Select', style, selectLight, props, mergedClsPrefixRef);\n        const uncontrolledValueRef = ref(props.defaultValue);\n        const controlledValueRef = toRef(props, 'value');\n        const mergedValueRef = useMergedState(controlledValueRef, uncontrolledValueRef);\n        const focusedRef = ref(false);\n        const patternRef = ref('');\n        const treeMateRef = computed(() => createTreeMate(filteredOptionsRef.value, tmOptions));\n        const valOptMapRef = computed(() => createValOptMap(localOptionsRef.value));\n        const uncontrolledShowRef = ref(false);\n        const mergedShowRef = useMergedState(toRef(props, 'show'), uncontrolledShowRef);\n        const triggerRef = ref(null);\n        const followerRef = ref(null);\n        const menuRef = ref(null);\n        const { localeRef } = useLocale('Select');\n        const localizedPlaceholderRef = computed(() => {\n            var _a;\n            return (_a = props.placeholder) !== null && _a !== void 0 ? _a : localeRef.value.placeholder;\n        });\n        const compitableOptionsRef = useCompitable(props, ['items', 'options']);\n        const createdOptionsRef = ref([]);\n        const beingCreatedOptionsRef = ref([]);\n        const memoValOptMapRef = ref(new Map());\n        const wrappedFallbackOptionRef = computed(() => {\n            const { fallbackOption } = props;\n            if (!fallbackOption)\n                return false;\n            return (value) => {\n                return Object.assign(fallbackOption(value), {\n                    value\n                });\n            };\n        });\n        const localOptionsRef = computed(() => {\n            return beingCreatedOptionsRef.value.concat(createdOptionsRef.value).concat(compitableOptionsRef.value);\n        });\n        const filteredOptionsRef = computed(() => {\n            if (props.remote) {\n                return compitableOptionsRef.value;\n            }\n            else {\n                const { value: localOptions } = localOptionsRef;\n                const { value: pattern } = patternRef;\n                if (!pattern.length || !props.filterable) {\n                    return localOptions;\n                }\n                else {\n                    const { filter } = props;\n                    return filterOptions(localOptions, filter, pattern);\n                }\n            }\n        });\n        function getMergedOptions(values) {\n            const remote = props.remote;\n            const { value: memoValOptMap } = memoValOptMapRef;\n            const { value: valOptMap } = valOptMapRef;\n            const { value: wrappedFallbackOption } = wrappedFallbackOptionRef;\n            const options = [];\n            values.forEach((value) => {\n                if (valOptMap.has(value)) {\n                    // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n                    options.push(valOptMap.get(value));\n                }\n                else if (remote && memoValOptMap.has(value)) {\n                    // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n                    options.push(memoValOptMap.get(value));\n                }\n                else if (wrappedFallbackOption) {\n                    const option = wrappedFallbackOption(value);\n                    if (option) {\n                        options.push(option);\n                    }\n                }\n            });\n            return options;\n        }\n        const selectedOptionsRef = computed(() => {\n            if (props.multiple) {\n                const { value: values } = mergedValueRef;\n                if (!Array.isArray(values))\n                    return [];\n                return getMergedOptions(values);\n            }\n            return null;\n        });\n        const selectedOptionRef = computed(() => {\n            const { value: mergedValue } = mergedValueRef;\n            if (!props.multiple && !Array.isArray(mergedValue)) {\n                if (mergedValue === null)\n                    return null;\n                return getMergedOptions([mergedValue])[0] || null;\n            }\n            return null;\n        });\n        const formItem = useFormItem(props);\n        const { mergedSizeRef, mergedDisabledRef } = formItem;\n        function doUpdateValue(value, option) {\n            const { onChange, 'onUpdate:value': _onUpdateValue, onUpdateValue } = props;\n            const { nTriggerFormChange, nTriggerFormInput } = formItem;\n            if (onChange)\n                call(onChange, value, option);\n            if (onUpdateValue)\n                call(onUpdateValue, value, option);\n            if (_onUpdateValue) {\n                call(_onUpdateValue, value, option);\n            }\n            uncontrolledValueRef.value = value;\n            nTriggerFormChange();\n            nTriggerFormInput();\n        }\n        function doBlur(e) {\n            const { onBlur } = props;\n            const { nTriggerFormBlur } = formItem;\n            if (onBlur)\n                call(onBlur, e);\n            nTriggerFormBlur();\n        }\n        function doClear() {\n            const { onClear } = props;\n            if (onClear)\n                call(onClear);\n        }\n        function doFocus(e) {\n            const { onFocus } = props;\n            const { nTriggerFormFocus } = formItem;\n            if (onFocus)\n                call(onFocus, e);\n            nTriggerFormFocus();\n        }\n        function doSearch(value) {\n            const { onSearch } = props;\n            if (onSearch)\n                call(onSearch, value);\n        }\n        function doScroll(e) {\n            const { onScroll } = props;\n            if (onScroll)\n                call(onScroll, e);\n        }\n        // remote related methods\n        function updateMemorizedOptions() {\n            var _a;\n            const { remote, multiple } = props;\n            if (remote) {\n                const { value: memoValOptMap } = memoValOptMapRef;\n                if (multiple) {\n                    (_a = selectedOptionsRef.value) === null || _a === void 0 ? void 0 : _a.forEach((option) => {\n                        memoValOptMap.set(option.value, option);\n                    });\n                }\n                else {\n                    const option = selectedOptionRef.value;\n                    if (option) {\n                        memoValOptMap.set(option.value, option);\n                    }\n                }\n            }\n        }\n        // menu related methods\n        function doUpdateShow(value) {\n            const { onUpdateShow, 'onUpdate:show': _onUpdateShow } = props;\n            if (onUpdateShow)\n                call(onUpdateShow, value);\n            if (_onUpdateShow)\n                call(_onUpdateShow, value);\n            uncontrolledShowRef.value = value;\n        }\n        function openMenu() {\n            if (!mergedDisabledRef.value) {\n                patternRef.value = '';\n                doUpdateShow(true);\n                uncontrolledShowRef.value = true;\n                if (props.filterable) {\n                    focusSelectionInput();\n                }\n            }\n        }\n        function closeMenu() {\n            doUpdateShow(false);\n        }\n        function handleMenuAfterLeave() {\n            patternRef.value = '';\n        }\n        function handleTriggerClick() {\n            if (mergedDisabledRef.value)\n                return;\n            if (!mergedShowRef.value) {\n                openMenu();\n            }\n            else {\n                if (!props.filterable) {\n                    // already focused, don't need to return focus\n                    closeMenu();\n                }\n            }\n        }\n        function handleTriggerBlur(e) {\n            var _a, _b;\n            if ((_b = (_a = menuRef.value) === null || _a === void 0 ? void 0 : _a.selfRef) === null || _b === void 0 ? void 0 : _b.contains(e.relatedTarget)) {\n                return;\n            }\n            focusedRef.value = false;\n            doBlur(e);\n            // outside select, don't need to return focus\n            closeMenu();\n        }\n        function handleTriggerFocus(e) {\n            doFocus(e);\n            focusedRef.value = true;\n        }\n        function handleMenuFocus(e) {\n            focusedRef.value = true;\n        }\n        function handleMenuBlur(e) {\n            var _a;\n            if ((_a = triggerRef.value) === null || _a === void 0 ? void 0 : _a.$el.contains(e.relatedTarget))\n                return;\n            focusedRef.value = false;\n            doBlur(e);\n            // outside select, don't need to return focus\n            closeMenu();\n        }\n        function handleMenuTabOut() {\n            var _a;\n            (_a = triggerRef.value) === null || _a === void 0 ? void 0 : _a.focus();\n            closeMenu();\n        }\n        function handleMenuClickOutside(e) {\n            var _a;\n            if (mergedShowRef.value) {\n                if (!((_a = triggerRef.value) === null || _a === void 0 ? void 0 : _a.$el.contains(e.target))) {\n                    // outside select, don't need to return focus\n                    closeMenu();\n                }\n            }\n        }\n        function createClearedMultipleSelectValue(value) {\n            if (!Array.isArray(value))\n                return [];\n            if (wrappedFallbackOptionRef.value) {\n                // if option has a fallback, I can't help user to clear some unknown value\n                return Array.from(value);\n            }\n            else {\n                // if there's no option fallback, unappeared options are treated as invalid\n                const { remote } = props;\n                const { value: valOptMap } = valOptMapRef;\n                if (remote) {\n                    const { value: memoValOptMap } = memoValOptMapRef;\n                    return value.filter((v) => valOptMap.has(v) || memoValOptMap.has(v));\n                }\n                else {\n                    return value.filter((v) => valOptMap.has(v));\n                }\n            }\n        }\n        function handleToggleByTmNode(tmNode) {\n            handleToggleByOption(tmNode.rawNode);\n        }\n        function handleToggleByOption(option) {\n            if (mergedDisabledRef.value)\n                return;\n            const { tag, remote } = props;\n            if (tag && !remote) {\n                const { value: beingCreatedOptions } = beingCreatedOptionsRef;\n                const beingCreatedOption = beingCreatedOptions[0] || null;\n                if (beingCreatedOption) {\n                    createdOptionsRef.value.push(beingCreatedOption);\n                    beingCreatedOptionsRef.value = [];\n                }\n            }\n            if (remote) {\n                memoValOptMapRef.value.set(option.value, option);\n            }\n            if (props.multiple) {\n                const changedValue = createClearedMultipleSelectValue(mergedValueRef.value);\n                const index = changedValue.findIndex((value) => value === option.value);\n                if (~index) {\n                    changedValue.splice(index, 1);\n                    if (tag && !remote) {\n                        const createdOptionIndex = getCreatedOptionIndex(option.value);\n                        if (~createdOptionIndex) {\n                            createdOptionsRef.value.splice(createdOptionIndex, 1);\n                            patternRef.value = '';\n                        }\n                    }\n                }\n                else {\n                    changedValue.push(option.value);\n                    patternRef.value = '';\n                }\n                doUpdateValue(changedValue, getMergedOptions(changedValue));\n            }\n            else {\n                if (tag && !remote) {\n                    const createdOptionIndex = getCreatedOptionIndex(option.value);\n                    if (~createdOptionIndex) {\n                        createdOptionsRef.value = [\n                            createdOptionsRef.value[createdOptionIndex]\n                        ];\n                    }\n                    else {\n                        createdOptionsRef.value = [];\n                    }\n                }\n                focusSelection();\n                closeMenu();\n                doUpdateValue(option.value, option);\n            }\n        }\n        function getCreatedOptionIndex(optionValue) {\n            const createdOptions = createdOptionsRef.value;\n            return createdOptions.findIndex((createdOption) => createdOption.value === optionValue);\n        }\n        function handlePatternInput(e) {\n            if (!mergedShowRef.value) {\n                openMenu();\n            }\n            const { value } = e.target;\n            patternRef.value = value;\n            const { tag, remote } = props;\n            doSearch(value);\n            if (tag && !remote) {\n                if (!value) {\n                    beingCreatedOptionsRef.value = [];\n                    return;\n                }\n                const optionBeingCreated = props.onCreate(value);\n                if (compitableOptionsRef.value.some((option) => option.value === optionBeingCreated.value) ||\n                    createdOptionsRef.value.some((option) => option.value === optionBeingCreated.value)) {\n                    beingCreatedOptionsRef.value = [];\n                }\n                else {\n                    beingCreatedOptionsRef.value = [optionBeingCreated];\n                }\n            }\n        }\n        function handleClear(e) {\n            e.stopPropagation();\n            const { multiple } = props;\n            if (!multiple && props.filterable) {\n                closeMenu();\n            }\n            doClear();\n            if (multiple) {\n                doUpdateValue([], []);\n            }\n            else {\n                doUpdateValue(null, null);\n            }\n        }\n        function handleMenuMousedown(e) {\n            if (!happensIn(e, 'action'))\n                e.preventDefault();\n        }\n        // scroll events on menu\n        function handleMenuScroll(e) {\n            doScroll(e);\n        }\n        // keyboard events\n        // also for menu keyup\n        function handleKeyUp(e) {\n            var _a, _b, _c, _d;\n            switch (e.code) {\n                case 'Space':\n                    if (props.filterable)\n                        break;\n                // eslint-disable-next-line no-fallthrough\n                case 'Enter':\n                case 'NumpadEnter':\n                    if (mergedShowRef.value) {\n                        const pendingTmNode = (_a = menuRef.value) === null || _a === void 0 ? void 0 : _a.getPendingTmNode();\n                        if (pendingTmNode) {\n                            handleToggleByTmNode(pendingTmNode);\n                        }\n                        else if (!props.filterable) {\n                            closeMenu();\n                            focusSelection();\n                        }\n                    }\n                    else {\n                        openMenu();\n                    }\n                    e.preventDefault();\n                    break;\n                case 'ArrowUp':\n                    if (props.loading)\n                        return;\n                    if (mergedShowRef.value) {\n                        (_b = menuRef.value) === null || _b === void 0 ? void 0 : _b.prev();\n                    }\n                    break;\n                case 'ArrowDown':\n                    if (props.loading)\n                        return;\n                    if (mergedShowRef.value) {\n                        (_c = menuRef.value) === null || _c === void 0 ? void 0 : _c.next();\n                    }\n                    else {\n                        openMenu();\n                    }\n                    break;\n                case 'Escape':\n                    closeMenu();\n                    (_d = triggerRef.value) === null || _d === void 0 ? void 0 : _d.focus();\n                    break;\n            }\n        }\n        // also for menu\n        function handleKeyDown(e) {\n            switch (e.code) {\n                case 'Space':\n                    if (!props.filterable) {\n                        e.preventDefault();\n                    }\n                    break;\n                case 'ArrowUp':\n                case 'ArrowDown':\n                    e.preventDefault();\n                    break;\n            }\n        }\n        function focusSelection() {\n            var _a;\n            (_a = triggerRef.value) === null || _a === void 0 ? void 0 : _a.focus();\n        }\n        function focusSelectionInput() {\n            var _a;\n            (_a = triggerRef.value) === null || _a === void 0 ? void 0 : _a.focusInput();\n        }\n        function syncPosition() {\n            var _a;\n            (_a = followerRef.value) === null || _a === void 0 ? void 0 : _a.syncPosition();\n        }\n        updateMemorizedOptions();\n        watch(toRef(props, 'options'), updateMemorizedOptions);\n        watch(filteredOptionsRef, () => {\n            if (!mergedShowRef.value)\n                return;\n            void nextTick(syncPosition);\n        });\n        watch(mergedValueRef, () => {\n            if (!mergedShowRef.value)\n                return;\n            void nextTick(syncPosition);\n        });\n        return {\n            mergedClsPrefix: mergedClsPrefixRef,\n            mergedBordered: mergedBorderedRef,\n            namespace: namespaceRef,\n            treeMate: treeMateRef,\n            isMounted: useIsMounted(),\n            triggerRef,\n            menuRef,\n            pattern: patternRef,\n            uncontrolledShow: uncontrolledShowRef,\n            mergedShow: mergedShowRef,\n            adjustedTo: useAdjustedTo(props),\n            uncontrolledValue: uncontrolledValueRef,\n            mergedValue: mergedValueRef,\n            followerRef,\n            localizedPlaceholder: localizedPlaceholderRef,\n            selectedOption: selectedOptionRef,\n            selectedOptions: selectedOptionsRef,\n            mergedSize: mergedSizeRef,\n            mergedDisabled: mergedDisabledRef,\n            focused: focusedRef,\n            handleMenuFocus,\n            handleMenuBlur,\n            handleMenuTabOut,\n            handleTriggerClick,\n            handleToggle: handleToggleByTmNode,\n            handleDeleteOption: handleToggleByOption,\n            handlePatternInput,\n            handleClear,\n            handleTriggerBlur,\n            handleTriggerFocus,\n            handleKeyDown,\n            handleKeyUp,\n            syncPosition,\n            handleMenuAfterLeave,\n            handleMenuClickOutside,\n            handleMenuScroll,\n            handleMenuKeyup: handleKeyUp,\n            handleMenuKeydown: handleKeyDown,\n            handleMenuMousedown,\n            mergedTheme: themeRef,\n            cssVars: computed(() => {\n                const { self: { menuBoxShadow } } = themeRef.value;\n                return {\n                    '--menu-box-shadow': menuBoxShadow\n                };\n            })\n        };\n    },\n    render() {\n        const { $slots, mergedClsPrefix } = this;\n        return (h(\"div\", { class: `${mergedClsPrefix}-select` },\n            h(VBinder, null, {\n                default: () => [\n                    h(VTarget, null, {\n                        default: () => (h(NInternalSelection, { ref: \"triggerRef\", inputProps: this.inputProps, clsPrefix: mergedClsPrefix, showArrow: this.showArrow, maxTagCount: this.maxTagCount, bordered: this.mergedBordered, active: this.mergedShow, pattern: this.pattern, placeholder: this.localizedPlaceholder, selectedOption: this.selectedOption, selectedOptions: this.selectedOptions, multiple: this.multiple, renderTag: this.renderTag, renderLabel: this.renderLabel, filterable: this.filterable, clearable: this.clearable, disabled: this.mergedDisabled, size: this.mergedSize, theme: this.mergedTheme.peers.InternalSelection, themeOverrides: this.mergedTheme.peerOverrides.InternalSelection, loading: this.loading, focused: this.focused, onClick: this.handleTriggerClick, onDeleteOption: this.handleDeleteOption, onPatternInput: this.handlePatternInput, onClear: this.handleClear, onBlur: this.handleTriggerBlur, onFocus: this.handleTriggerFocus, onKeydown: this.handleKeyDown, onKeyup: this.handleKeyUp }))\n                    }),\n                    h(VFollower, { ref: \"followerRef\", show: this.mergedShow, to: this.adjustedTo, teleportDisabled: this.adjustedTo === useAdjustedTo.tdkey, containerClass: this.namespace, width: this.consistentMenuWidth ? 'target' : undefined, minWidth: \"target\", placement: this.placement }, {\n                        default: () => (h(Transition, { name: \"fade-in-scale-up-transition\", appear: this.isMounted, onAfterLeave: this.handleMenuAfterLeave }, {\n                            default: () => {\n                                var _a, _b;\n                                return (this.mergedShow ||\n                                    this.displayDirective === 'show') &&\n                                    withDirectives(h(NInternalSelectMenu, Object.assign({}, this.menuProps, { ref: \"menuRef\", virtualScroll: this.consistentMenuWidth && this.virtualScroll, class: [\n                                            `${mergedClsPrefix}-select-menu`,\n                                            (_a = this.menuProps) === null || _a === void 0 ? void 0 : _a.class\n                                        ], clsPrefix: mergedClsPrefix, focusable: true, autoPending: true, theme: this.mergedTheme.peers.InternalSelectMenu, themeOverrides: this.mergedTheme.peerOverrides\n                                            .InternalSelectMenu, treeMate: this.treeMate, multiple: this.multiple, size: 'medium', renderOption: this.renderOption, renderLabel: this.renderLabel, value: this.mergedValue, style: [(_b = this.menuProps) === null || _b === void 0 ? void 0 : _b.style, this.cssVars], onToggle: this.handleToggle, onScroll: this.handleMenuScroll, onFocus: this.handleMenuFocus, onBlur: this.handleMenuBlur, onKeyup: this.handleMenuKeyup, onKeydown: this.handleMenuKeydown, onTabOut: this.handleMenuTabOut, onMousedown: this.handleMenuMousedown, show: this.mergedShow }), $slots), this.displayDirective === 'show'\n                                        ? [\n                                            [vShow, this.mergedShow],\n                                            [clickoutside, this.handleMenuClickOutside]\n                                        ]\n                                        : [[clickoutside, this.handleMenuClickOutside]]);\n                            }\n                        }))\n                    })\n                ]\n            })));\n    }\n});\n","import { cB, cE, cM, c, cNotM } from '../../../_utils/cssr'; // vars:\n// --bezier\n// --button-border-color\n// --height\n// --opacity-disabled\n// --font-size\n\nexport default cB('radio-group', `\n display: inline-block;\n font-size: var(--font-size);\n`, [cE('splitor', `\n display: inline-block;\n vertical-align: bottom;\n width: 1px;\n transition:\n background-color .3s var(--bezier),\n opacity .3s var(--bezier);\n background: var(--button-border-color);\n `, [cM('checked', {\n  backgroundColor: 'var(--button-border-color-active)'\n}), cM('disabled', {\n  opacity: 'var(--opacity-disabled)'\n})]), cM('button-group', `\n white-space: nowrap;\n height: var(--height);\n line-height: var(--height);\n `, [cB('radio-button', {\n  height: 'var(--height)',\n  lineHeight: 'var(--height)'\n}), cE('splitor', {\n  height: 'var(--height)'\n})]), cB('radio-button', `\n vertical-align: bottom;\n outline: none;\n position: relative;\n user-select: none;\n display: inline-block;\n box-sizing: border-box;\n padding-left: 14px;\n padding-right: 14px;\n white-space: nowrap;\n transition:\n background-color .3s var(--bezier),\n opacity .3s var(--bezier),\n border-color .3s var(--bezier),\n color .3s var(--bezier);\n color: var(--button-text-color);\n border-top: 1px solid var(--button-border-color);\n border-bottom: 1px solid var(--button-border-color);\n `, [cE('radio-input', `\n border: 0;\n width: 0;\n height: 0;\n opacity: 0;\n margin: 0;\n `), cE('state-border', `\n pointer-events: none;\n position: absolute;\n box-shadow: var(--button-box-shadow);\n transition: box-shadow .3s var(--bezier);\n left: -1px;\n bottom: -1px;\n right: -1px;\n top: -1px;\n `), c('&:first-child', `\n border-top-left-radius: var(--button-border-radius);\n border-bottom-left-radius: var(--button-border-radius);\n border-left: 1px solid var(--button-border-color);\n `, [cE('state-border', `\n border-top-left-radius: var(--button-border-radius);\n border-bottom-left-radius: var(--button-border-radius);\n `)]), c('&:last-child', `\n border-top-right-radius: var(--button-border-radius);\n border-bottom-right-radius: var(--button-border-radius);\n border-right: 1px solid var(--button-border-color);\n `, [cE('state-border', `\n border-top-right-radius: var(--button-border-radius);\n border-bottom-right-radius: var(--button-border-radius);\n `)]), cNotM('disabled', `\n cursor: pointer;\n `, [c('&:hover', [cE('state-border', `\n transition: box-shadow .3s var(--bezier);\n box-shadow: var(--button-box-shadow-hover);\n `), cNotM('checked', {\n  color: 'var(--button-text-color-hover)'\n})]), cM('focus', [c('&:not(:active)', [cE('state-border', {\n  boxShadow: 'var(--button-box-shadow-focus)'\n})])])]), cM('checked', `\n background: var(--button-color-active);\n color: var(--button-text-color-active);\n border-color: var(--button-border-color-active);\n `), cM('disabled', `\n cursor: not-allowed;\n opacity: var(--opacity-disabled);\n `)])]);","import { h, defineComponent, computed, provide, ref, toRef } from 'vue';\nimport { useMergedState } from 'vooks';\nimport { useTheme, useFormItem, useConfig } from '../../_mixins';\nimport { getSlot, warn, createKey, call, flatten } from '../../_utils';\nimport { radioLight } from '../styles';\nimport { radioGroupInjectionKey } from './use-radio';\nimport style from './styles/radio-group.cssr';\nfunction mapSlot(defaultSlot, value, clsPrefix) {\n    var _a;\n    const children = [];\n    let isButtonGroup = false;\n    for (let i = 0; i < defaultSlot.length; ++i) {\n        const wrappedInstance = defaultSlot[i];\n        const name = (_a = wrappedInstance.type) === null || _a === void 0 ? void 0 : _a.name;\n        if (name === 'RadioButton') {\n            isButtonGroup = true;\n        }\n        if (process.env.NODE_ENV !== 'production' && isButtonGroup && name !== 'RadioButton') {\n            warn('radio-group', '`n-radio-group` in button mode only takes `n-radio-button` as children.');\n            continue;\n        }\n        const instanceProps = wrappedInstance.props;\n        if (name !== 'RadioButton') {\n            children.push(wrappedInstance);\n            continue;\n        }\n        if (i === 0) {\n            children.push(wrappedInstance);\n        }\n        else {\n            const lastInstanceProps = children[children.length - 1]\n                .props;\n            const lastInstanceChecked = value === lastInstanceProps.value;\n            const lastInstanceDisabled = lastInstanceProps.disabled;\n            const currentInstanceChecked = value === instanceProps.value;\n            const currentInstanceDisabled = instanceProps.disabled;\n            /**\n             * Priority of button splitor:\n             * !disabled  checked >\n             *  disabled  checked >\n             * !disabled !checked >\n             *  disabled !checked\n             */\n            const lastInstancePriority = (lastInstanceChecked ? 2 : 0) + (!lastInstanceDisabled ? 1 : 0);\n            const currentInstancePriority = (currentInstanceChecked ? 2 : 0) + (!currentInstanceDisabled ? 1 : 0);\n            const lastInstanceClass = {\n                [`${clsPrefix}-radio-group__splitor--disabled`]: lastInstanceDisabled,\n                [`${clsPrefix}-radio-group__splitor--checked`]: lastInstanceChecked\n            };\n            const currentInstanceClass = {\n                [`${clsPrefix}-radio-group__splitor--disabled`]: currentInstanceDisabled,\n                [`${clsPrefix}-radio-group__splitor--checked`]: currentInstanceChecked\n            };\n            const splitorClass = lastInstancePriority < currentInstancePriority\n                ? currentInstanceClass\n                : lastInstanceClass;\n            children.push(h(\"div\", { class: [`${clsPrefix}-radio-group__splitor`, splitorClass] }), wrappedInstance);\n        }\n    }\n    return {\n        children,\n        isButtonGroup\n    };\n}\nconst radioGroupProps = Object.assign(Object.assign({}, useTheme.props), { name: String, value: [String, Number], defaultValue: {\n        type: [String, Number],\n        default: null\n    }, size: String, disabled: {\n        type: Boolean,\n        default: undefined\n    }, 'onUpdate:value': [Function, Array], onUpdateValue: [Function, Array] });\nexport default defineComponent({\n    name: 'RadioGroup',\n    props: radioGroupProps,\n    setup(props) {\n        const selfElRef = ref(null);\n        const { mergedSizeRef, mergedDisabledRef, nTriggerFormChange, nTriggerFormInput, nTriggerFormBlur, nTriggerFormFocus } = useFormItem(props);\n        const { mergedClsPrefixRef } = useConfig(props);\n        const themeRef = useTheme('Radio', 'RadioGroup', style, radioLight, props, mergedClsPrefixRef);\n        const uncontrolledValueRef = ref(props.defaultValue);\n        const controlledValueRef = toRef(props, 'value');\n        const mergedValueRef = useMergedState(controlledValueRef, uncontrolledValueRef);\n        function doUpdateValue(value) {\n            const { onUpdateValue, 'onUpdate:value': _onUpdateValue } = props;\n            if (onUpdateValue) {\n                call(onUpdateValue, value);\n            }\n            if (_onUpdateValue) {\n                call(_onUpdateValue, value);\n            }\n            uncontrolledValueRef.value = value;\n            nTriggerFormChange();\n            nTriggerFormInput();\n        }\n        function handleFocusin(e) {\n            const { value: selfEl } = selfElRef;\n            if (!selfEl)\n                return;\n            if (selfEl.contains(e.relatedTarget))\n                return;\n            nTriggerFormFocus();\n        }\n        function handleFocusout(e) {\n            const { value: selfEl } = selfElRef;\n            if (!selfEl)\n                return;\n            if (selfEl.contains(e.relatedTarget))\n                return;\n            nTriggerFormBlur();\n        }\n        provide(radioGroupInjectionKey, {\n            mergedClsPrefixRef,\n            nameRef: toRef(props, 'name'),\n            valueRef: mergedValueRef,\n            disabledRef: mergedDisabledRef,\n            mergedSizeRef,\n            doUpdateValue\n        });\n        return {\n            selfElRef,\n            mergedClsPrefix: mergedClsPrefixRef,\n            mergedValue: mergedValueRef,\n            handleFocusout,\n            handleFocusin,\n            cssVars: computed(() => {\n                const { value: size } = mergedSizeRef;\n                const { common: { cubicBezierEaseInOut }, self: { buttonBorderColor, buttonBorderColorActive, buttonBorderRadius, buttonBoxShadow, buttonBoxShadowFocus, buttonBoxShadowHover, buttonColorActive, buttonTextColor, buttonTextColorActive, buttonTextColorHover, opacityDisabled, [createKey('buttonHeight', size)]: height, [createKey('fontSize', size)]: fontSize } } = themeRef.value;\n                return {\n                    '--font-size': fontSize,\n                    '--bezier': cubicBezierEaseInOut,\n                    '--button-border-color': buttonBorderColor,\n                    '--button-border-color-active': buttonBorderColorActive,\n                    '--button-border-radius': buttonBorderRadius,\n                    '--button-box-shadow': buttonBoxShadow,\n                    '--button-box-shadow-focus': buttonBoxShadowFocus,\n                    '--button-box-shadow-hover': buttonBoxShadowHover,\n                    '--button-color-active': buttonColorActive,\n                    '--button-text-color': buttonTextColor,\n                    '--button-text-color-hover': buttonTextColorHover,\n                    '--button-text-color-active': buttonTextColorActive,\n                    '--height': height,\n                    '--opacity-disabled': opacityDisabled\n                };\n            })\n        };\n    },\n    render() {\n        const { mergedValue, mergedClsPrefix, handleFocusin, handleFocusout } = this;\n        const { children, isButtonGroup } = mapSlot(flatten(getSlot(this)), mergedValue, mergedClsPrefix);\n        return (h(\"div\", { onFocusin: handleFocusin, onFocusout: handleFocusout, ref: \"selfElRef\", class: [\n                `${mergedClsPrefix}-radio-group`,\n                isButtonGroup && `${mergedClsPrefix}-radio-group--button-group`\n            ], style: this.cssVars }, children));\n    }\n});\n","export function isElementInViewport(el: Element) {\r\n    const rect = el.getBoundingClientRect(),\r\n        width = rect.right - rect.left,\r\n        height = rect.bottom - rect.top;\r\n    return (\r\n        rect.top > -height &&\r\n        rect.left > -width &&\r\n        rect.bottom < (window.innerHeight || document.documentElement.clientHeight) + height &&\r\n        rect.right < (window.innerWidth || document.documentElement.clientWidth) + width\r\n    );\r\n}\r\n\r\n/**\r\n * Allow mouse dragging outside the dragged element.\r\n * @param immediatelyTriggerEvent If not null, immediately trigger drag move event when called\r\n * @param onDragMove\r\n * @param onDragEnd\r\n */\r\nexport function addGlobalDragListener(\r\n    immediatelyTriggerEvent: MouseEvent | null,\r\n    onDragMove: (e: MouseEvent) => void,\r\n    onDragEnd?: (e: MouseEvent) => void\r\n) {\r\n    let onMouseUp: (e: MouseEvent) => void;\r\n    let onMouseOutOfWindow: (e: MouseEvent) => void;\r\n    let _onDragMove = (e: MouseEvent) => {\r\n        return onDragMove(e);\r\n    };\r\n    let _onDragEnd = (e: MouseEvent) => {\r\n        document.removeEventListener('mousemove', _onDragMove);\r\n        document.removeEventListener('mouseup', onMouseUp);\r\n        document.removeEventListener('mouseout', onMouseOutOfWindow);\r\n        return onDragEnd && onDragEnd(e);\r\n    };\r\n    onMouseUp = _onDragEnd;\r\n    onMouseOutOfWindow = (e: MouseEvent) => {\r\n        if (!e.relatedTarget || ((e.relatedTarget as HTMLElement).nodeName === 'HTML')) {\r\n            _onDragEnd(e);\r\n        }\r\n    };\r\n\r\n    document.addEventListener('mousemove', _onDragMove);\r\n    document.addEventListener('mouseup', onMouseUp);\r\n    document.addEventListener('mouseout', onMouseOutOfWindow);\r\n\r\n    if (immediatelyTriggerEvent) {\r\n        _onDragMove(immediatelyTriggerEvent);\r\n    }\r\n}\r\n","import {computed, defineComponent, onBeforeUnmount, onMounted, PropType, ref} from 'vue';\r\nimport {isElementInViewport} from '../../utils/dom';\r\n\r\nexport default defineComponent({\r\n    props: {\r\n        src: {type: String, required: true},\r\n        width: {type: Number, required: true},\r\n        height: {type: Number, required: true},\r\n        imgWidth: {type: Number, required: true},\r\n        imgHeight: {type: Number, required: true},\r\n        center: {type: Object as PropType<[number, number, number]>, required: true},\r\n        related: {type: Array as PropType<[number, number, number][]>, required: true},\r\n        landmarks: {type: Array as PropType<{ point: [number, number, number], visibility: number }[]>, required: true},\r\n        flip: Boolean,\r\n    },\r\n    setup(props) {\r\n        const dom = ref<Element>();\r\n        const visible = ref(false);\r\n\r\n        const imgStyle = computed(function () {\r\n            const cx = props.flip ? 1 - props.center[0] : props.center[0];\r\n            let xl = cx;\r\n            let xh = cx;\r\n            for (let point of props.related) {\r\n                const x = props.flip ? 1 - point[0] : point[0];\r\n                xl = Math.min(xl, x);\r\n                xh = Math.max(xh, x);\r\n            }\r\n            xl = Math.max(0, xl);\r\n            xh = Math.min(1, xh);\r\n            const xr = Math.max(Math.abs(cx - xl), Math.abs(xh - cx));\r\n\r\n            const cy = props.center[1];\r\n            let yl = cy;\r\n            let yh = cy;\r\n            for (let point of props.related) {\r\n                yl = Math.min(yl, point[1]);\r\n                yh = Math.max(yh, point[1]);\r\n            }\r\n            yl = Math.max(0, yl);\r\n            yh = Math.min(1, yh);\r\n            const yr = Math.max(Math.abs(cy - yl), Math.abs(yh - cy));\r\n\r\n            const r = (xr + yr) / 2 + Math.min(xr, yr) / 4;\r\n\r\n            const preferWidth = r * 2 * props.imgWidth;\r\n            const preferHeight = r * 2 * props.imgHeight;\r\n            const scale = Math.min(props.width / preferWidth, props.height / preferHeight);\r\n            const width = props.imgWidth * scale;\r\n            const height = props.imgHeight * scale;\r\n            const left = -cx * width + props.width / 2;\r\n            const top = -cy * height + props.height / 2;\r\n            return {\r\n                left: Math.round(left) + 'px',\r\n                top: Math.round(top) + 'px',\r\n                width: Math.floor(width) + 'px',\r\n                height: Math.floor(height) + 'px',\r\n                transform: props.flip ? 'scaleX(-1)' : '',\r\n            };\r\n        });\r\n\r\n        let checkVisibilityTid: NodeJS.Timer | null = null;\r\n\r\n        onMounted(function () {\r\n            checkVisibilityTid = setInterval(checkVisibility, 100);\r\n            checkVisibility();\r\n        });\r\n\r\n        onBeforeUnmount(function () {\r\n            if (checkVisibilityTid != null) {\r\n                clearInterval(checkVisibilityTid);\r\n            }\r\n        });\r\n\r\n        function checkVisibility() {\r\n            if (dom.value && isElementInViewport(dom.value)) {\r\n                visible.value = true;\r\n                if (checkVisibilityTid != null) {\r\n                    clearInterval(checkVisibilityTid);\r\n                    checkVisibilityTid = null;\r\n                }\r\n            }\r\n        }\r\n\r\n        return {\r\n            dom,\r\n            imgStyle,\r\n            visible,\r\n        };\r\n    }\r\n});","import {CloseCircleOutlined} from '@vicons/antd';\r\nimport {NIcon, NSpin} from 'naive-ui';\r\nimport {computed, defineComponent, ref, watch} from 'vue';\r\nimport {APP_NAME} from '../../config';\r\nimport {addGlobalDragListener} from '../../utils/dom';\r\nimport {loadImage} from '../../utils/image';\r\n\r\nconst MAX_ZOOM = 14;\r\nconst MIN_ZOOM = -10;\r\n\r\nexport default defineComponent({\r\n    components: {\r\n        NIcon,\r\n        NSpin,\r\n\r\n        CloseCircleOutlined,\r\n    },\r\n    props: {\r\n        show: Boolean,\r\n        id: {type: String, required: true},\r\n        regular: {type: String, required: true},\r\n        full: {type: String, required: true},\r\n        authorName: {type: String, required: true},\r\n        authorUsername: {type: String, required: true},\r\n        flip: Boolean,\r\n    },\r\n    emits: ['update:show'],\r\n    setup(props, ctx) {\r\n        const fullLoading = ref(false);\r\n        const zoom = ref(0);\r\n        const dx = ref(0);\r\n        const dy = ref(0);\r\n\r\n        const authorUrl = computed(function () {\r\n            return `https://unsplash.com/@${props.authorUsername}?utm_source=${APP_NAME}&utm_medium=referral`;\r\n        });\r\n        const unsplashUrl = computed(function () {\r\n            return `https://unsplash.com/?utm_source=${APP_NAME}&utm_medium=referral`;\r\n        });\r\n        const imgStyle = computed(function () {\r\n            const scale = 1.1 ** zoom.value;\r\n            const translateX = -dx.value / scale * (props.flip ? -1 : 1);\r\n            const translateY = dy.value / scale;\r\n            return {\r\n                transform: `scaleX(${(props.flip ? -1 : 1) * scale}) scaleY(${scale}) translateX(${translateX}px) translateY(${translateY}px)`\r\n            };\r\n        });\r\n\r\n        watch(() => props.full, async function () {\r\n            resetTransform();\r\n            if (!props.full) {\r\n                return;\r\n            }\r\n            try {\r\n                fullLoading.value = true;\r\n                await loadImage(props.full);\r\n            } finally {\r\n                fullLoading.value = false;\r\n            }\r\n        });\r\n\r\n        function close() {\r\n            resetTransform();\r\n            ctx.emit('update:show', false);\r\n        }\r\n\r\n        function resetTransform() {\r\n            zoom.value = 0;\r\n            dx.value = 0;\r\n            dy.value = 0;\r\n        }\r\n\r\n        function onWheel(e: WheelEvent) {\r\n            zoom.value -= Math.round(e.deltaY / 100);\r\n            zoom.value = Math.max(MIN_ZOOM, Math.min(MAX_ZOOM, zoom.value));\r\n        }\r\n\r\n        function onMouseDown(e: MouseEvent) {\r\n            if (e.button === 0) {\r\n                e.preventDefault();\r\n                e.stopPropagation();\r\n                const dragStartX = dx.value;\r\n                const dragStartY = dy.value;\r\n                const x0 = e.clientX;\r\n                const y0 = e.clientY;\r\n                addGlobalDragListener(\r\n                    e,\r\n                    function (e: MouseEvent) {\r\n                        dx.value = dragStartX - (e.clientX - x0);\r\n                        dy.value = dragStartY + e.clientY - y0;\r\n                    }\r\n                );\r\n            }\r\n        }\r\n\r\n        return {\r\n            fullLoading,\r\n            authorUrl,\r\n            unsplashUrl,\r\n            imgStyle,\r\n\r\n            close,\r\n            onWheel,\r\n            onMouseDown,\r\n        };\r\n    }\r\n});","export function isWebGL2Supported() {\r\n    return !!document.createElement('canvas')?.getContext('webgl2');\r\n}\r\n\r\nexport function isMouseSupported() {\r\n    return 'PointerEvent' in window;\r\n}","import {quat, ReadonlyVec3, vec3} from 'gl-matrix';\r\nimport {angleBetweenVec3, quatLookRotation} from '../../utils/math/math';\r\n\r\nexport function mid(...points: ReadonlyVec3[]) {\r\n    const ret: [number, number, number] = [0, 0, 0];\r\n    for (let point of points) {\r\n        vec3.add(ret, ret, point);\r\n    }\r\n    if (points.length) {\r\n        vec3.scale(ret, ret, 1 / points.length);\r\n    }\r\n    return ret;\r\n}\r\n\r\nexport function simplifyAngle(rad: number) {\r\n    rad = rad % (Math.PI * 2);\r\n    if (rad < 0) {\r\n        rad += Math.PI * 2;\r\n    }\r\n    return rad;\r\n}\r\n\r\nexport function getAngle2D(a0: ReadonlyVec3, a1: ReadonlyVec3, b0: ReadonlyVec3, b1: ReadonlyVec3) {\r\n    return Math.atan2(b1[1] - b0[1], b1[0] - b0[0]) - Math.atan2(a1[1] - a0[1], a1[0] - a0[0]);\r\n}\r\n\r\nexport function getAngle(a0: ReadonlyVec3, a1: ReadonlyVec3, b0: ReadonlyVec3, b1: ReadonlyVec3) {\r\n    const a: ReadonlyVec3 = [\r\n        a1[0] - a0[0],\r\n        a1[1] - a0[1],\r\n        a1[2] - a0[2],\r\n    ];\r\n    const b: ReadonlyVec3 = [\r\n        b1[0] - b0[0],\r\n        b1[1] - b0[1],\r\n        b1[2] - b0[2],\r\n    ];\r\n    return angleBetweenVec3(a, b);\r\n}\r\n\r\nexport function avg(...nums: number[]) {\r\n    return nums.reduce((sum, curr) => sum + curr, 0) / nums.length;\r\n}\r\n\r\nexport const getNormalInLocalSpace = (function () {\r\n    const up = vec3.create();\r\n    const right = vec3.create();\r\n    const forward = vec3.create();\r\n    const v = vec3.create();\r\n    const q = quat.create();\r\n    return function (\r\n        right0: ReadonlyVec3,\r\n        right1: ReadonlyVec3,\r\n        up0: ReadonlyVec3,\r\n        up1: ReadonlyVec3,\r\n        v0: ReadonlyVec3,\r\n        v1: ReadonlyVec3,\r\n        flipX: boolean = false,\r\n    ) {\r\n        vec3.sub(up, up1, up0);\r\n        if (flipX) {\r\n            up[0] = -up[0];\r\n        }\r\n        vec3.normalize(up, up);\r\n        vec3.sub(right, right1, right0);\r\n        if (flipX) {\r\n            right[0] = -right[0];\r\n        }\r\n        vec3.cross(forward, right, up);\r\n        vec3.normalize(forward, forward);\r\n        quatLookRotation(q, forward, up);\r\n        quat.invert(q, q);\r\n        vec3.sub(v, v1, v0);\r\n        if (flipX) {\r\n            v[0] = -v[0];\r\n        }\r\n        vec3.normalize(v, v);\r\n        return vec3.transformQuat([0, 0, 0], v, q) as [number, number, number];\r\n    };\r\n})();\r\n\r\nexport function getNormal(\r\n    v0: ReadonlyVec3,\r\n    v1: ReadonlyVec3,\r\n) {\r\n    const v = vec3.sub([0, 0, 0], v1, v0) as [number, number, number];\r\n    vec3.normalize(v, v);\r\n    return v;\r\n}\r\n\r\nexport function normalizedLandmarkToViewSpace(point: ReadonlyVec3, aspect: number) {\r\n    return [\r\n        (point[0] * 2 - 1) * aspect,\r\n        -point[1] * 2 + 1,\r\n        point[2] * aspect\r\n    ] as [number, number, number];\r\n}\r\n\r\nexport function flipX(point: ReadonlyVec3) {\r\n    return [-point[0], point[1], point[2]] as [number, number, number];\r\n}\r\n\r\nexport function cross(a: ReadonlyVec3, b: ReadonlyVec3) {\r\n    const ret: [number, number, number] = [0, 0, 0];\r\n    vec3.cross(ret, a, b);\r\n    return ret;\r\n}\r\n\r\nexport function isWithinBoundary2D(point: ReadonlyVec3) {\r\n    return point[0] >= 0 && point[0] <= 1 && point[1] >= 0 && point[1] <= 1;\r\n}","import SkeletonModel from '../../components/SkeletonModelCanvas/model/SkeletonModel';\r\nimport {LANDMARK_VISIBILITY_ACCEPTABLE_THRESHOLD} from '../../config';\r\nimport {angleBetweenVec3} from '../../utils/math/math';\r\nimport Photo from '../../utils/Photo';\r\nimport {flipX, getNormal, mid, normalizedLandmarkToViewSpace} from './math';\r\nimport {MatchResult, PoseMatcher} from './search';\r\n\r\nconst MAX_VIEW_SPACE_ANGLE_ERROR = Math.PI / 180 * 45;\r\n\r\nexport default class MatchChest implements PoseMatcher {\r\n\r\n    private targetUp: [number, number, number] = [0, 0, 0];\r\n    private targetRight: [number, number, number] = [0, 0, 0];\r\n    private targetUpMirror: [number, number, number] = [0, 0, 0];\r\n    private targetRightMirror: [number, number, number] = [0, 0, 0];\r\n\r\n    prepare(model: SkeletonModel) {\r\n        this.targetUp = getNormal(\r\n            mid(model.leftThigh.originViewPosition, model.rightThigh.originViewPosition),\r\n            mid(model.leftUpperArm.originViewPosition, model.rightUpperArm.originViewPosition)\r\n        );\r\n        this.targetRight = getNormal(model.rightUpperArm.originViewPosition, model.leftUpperArm.originViewPosition);\r\n        this.targetUpMirror = getNormal(\r\n            flipX(mid(model.leftThigh.originViewPosition, model.rightThigh.originViewPosition)),\r\n            flipX(mid(model.leftUpperArm.originViewPosition, model.rightUpperArm.originViewPosition))\r\n        );\r\n        this.targetRightMirror = getNormal(flipX(model.leftUpperArm.originViewPosition), flipX(model.rightUpperArm.originViewPosition));\r\n    }\r\n\r\n    match(photo: Photo): MatchResult | null {\r\n        const landmarks = photo.normalizedLandmarks;\r\n\r\n        const conf = Math.min(\r\n            landmarks[12].visibility,\r\n            landmarks[11].visibility,\r\n            landmarks[24].visibility,\r\n            landmarks[23].visibility\r\n        );\r\n        if (conf < LANDMARK_VISIBILITY_ACCEPTABLE_THRESHOLD) {\r\n            return null;\r\n        }\r\n\r\n        const aspect = photo.width / photo.height;\r\n\r\n        const leftShoulder = normalizedLandmarkToViewSpace(landmarks[11].point, aspect);\r\n        const rightShoulder = normalizedLandmarkToViewSpace(landmarks[12].point, aspect);\r\n        const leftHip = normalizedLandmarkToViewSpace(landmarks[23].point, aspect);\r\n        const rightHip = normalizedLandmarkToViewSpace(landmarks[24].point, aspect);\r\n        const trunkUp = getNormal(mid(leftHip, rightHip), mid(leftShoulder, rightShoulder));\r\n        const trunkRight = getNormal(rightShoulder, leftShoulder);\r\n\r\n        const angleError1 = angleBetweenVec3(this.targetUp, trunkUp);\r\n        const angleError2 = angleBetweenVec3(this.targetRight, trunkRight);\r\n        const score = (Math.PI - angleError1) * (Math.PI - angleError2);\r\n\r\n        const angleError1F = angleBetweenVec3(this.targetUpMirror, trunkUp);\r\n        const angleError2F = angleBetweenVec3(this.targetRightMirror, trunkRight);\r\n        const scoreF = (Math.PI - angleError1F) * (Math.PI - angleError2F);\r\n\r\n        let bestScore = 0;\r\n        let flip = false;\r\n\r\n        if (angleError1 <= MAX_VIEW_SPACE_ANGLE_ERROR && angleError2 <= MAX_VIEW_SPACE_ANGLE_ERROR && score > scoreF) {\r\n            bestScore = score;\r\n        } else if (angleError1F <= MAX_VIEW_SPACE_ANGLE_ERROR && angleError2F <= MAX_VIEW_SPACE_ANGLE_ERROR) {\r\n            bestScore = scoreF;\r\n            flip = true;\r\n        } else {\r\n            return null;\r\n        }\r\n\r\n        return {\r\n            score: bestScore,\r\n            center: mid(landmarks[11].point, landmarks[12].point),\r\n            related: [\r\n                landmarks[11].point,\r\n                landmarks[12].point,\r\n                landmarks[13].point,\r\n                landmarks[14].point,\r\n                mid(\r\n                    landmarks[24].point,\r\n                    landmarks[23].point,\r\n                    landmarks[12].point,\r\n                    landmarks[11].point\r\n                )\r\n            ],\r\n            flip\r\n        };\r\n    }\r\n\r\n}","import SkeletonModel from '../../components/SkeletonModelCanvas/model/SkeletonModel';\r\nimport {LANDMARK_VISIBILITY_ACCEPTABLE_THRESHOLD} from '../../config';\r\nimport {angleBetweenVec3} from '../../utils/math/math';\r\nimport Photo from '../../utils/Photo';\r\nimport {flipX, getNormal, mid, normalizedLandmarkToViewSpace} from './math';\r\nimport {MatchResult, PoseMatcher} from './search';\r\n\r\nconst MAX_VIEW_SPACE_ANGLE_ERROR = Math.PI / 180 * 45;\r\n\r\nexport default class MatchCrotch implements PoseMatcher {\r\n\r\n    private targetUp: [number, number, number] = [0, 0, 0];\r\n    private targetRight: [number, number, number] = [0, 0, 0];\r\n    private targetUpMirror: [number, number, number] = [0, 0, 0];\r\n    private targetRightMirror: [number, number, number] = [0, 0, 0];\r\n\r\n    prepare(model: SkeletonModel) {\r\n        this.targetUp = getNormal(\r\n            mid(model.leftThigh.originViewPosition, model.rightThigh.originViewPosition),\r\n            mid(model.leftUpperArm.originViewPosition, model.rightUpperArm.originViewPosition)\r\n        );\r\n        this.targetRight = getNormal(model.rightThigh.originViewPosition, model.leftThigh.originViewPosition);\r\n        this.targetUpMirror = getNormal(\r\n            flipX(mid(model.leftThigh.originViewPosition, model.rightThigh.originViewPosition)),\r\n            flipX(mid(model.leftUpperArm.originViewPosition, model.rightUpperArm.originViewPosition))\r\n        );\r\n        this.targetRightMirror = getNormal(flipX(model.leftThigh.originViewPosition), flipX(model.rightThigh.originViewPosition));\r\n    }\r\n\r\n    match(photo: Photo): MatchResult | null {\r\n        const landmarks = photo.normalizedLandmarks;\r\n\r\n        const conf = Math.min(\r\n            landmarks[12].visibility,\r\n            landmarks[11].visibility,\r\n            landmarks[24].visibility,\r\n            landmarks[23].visibility\r\n        );\r\n        if (conf < LANDMARK_VISIBILITY_ACCEPTABLE_THRESHOLD) {\r\n            return null;\r\n        }\r\n\r\n        const aspect = photo.width / photo.height;\r\n\r\n        const leftShoulder = normalizedLandmarkToViewSpace(landmarks[11].point, aspect);\r\n        const rightShoulder = normalizedLandmarkToViewSpace(landmarks[12].point, aspect);\r\n        const leftHip = normalizedLandmarkToViewSpace(landmarks[23].point, aspect);\r\n        const rightHip = normalizedLandmarkToViewSpace(landmarks[24].point, aspect);\r\n        const trunkUp = getNormal(mid(leftHip, rightHip), mid(leftShoulder, rightShoulder));\r\n        const trunkRight = getNormal(rightHip, leftHip);\r\n\r\n        const angleError1 = angleBetweenVec3(this.targetUp, trunkUp);\r\n        const angleError2 = angleBetweenVec3(this.targetRight, trunkRight);\r\n        const score = (Math.PI - angleError1) * (Math.PI - angleError2);\r\n\r\n        const angleError1F = angleBetweenVec3(this.targetUpMirror, trunkUp);\r\n        const angleError2F = angleBetweenVec3(this.targetRightMirror, trunkRight);\r\n        const scoreF = (Math.PI - angleError1F) * (Math.PI - angleError2F);\r\n\r\n        let bestScore = 0;\r\n        let flip = false;\r\n\r\n        if (angleError1 <= MAX_VIEW_SPACE_ANGLE_ERROR && angleError2 <= MAX_VIEW_SPACE_ANGLE_ERROR && score > scoreF) {\r\n            bestScore = score;\r\n        } else if (angleError1F <= MAX_VIEW_SPACE_ANGLE_ERROR && angleError2F <= MAX_VIEW_SPACE_ANGLE_ERROR) {\r\n            bestScore = scoreF;\r\n            flip = true;\r\n        } else {\r\n            return null;\r\n        }\r\n\r\n        return {\r\n            score: bestScore,\r\n            center: mid(landmarks[23].point, landmarks[24].point),\r\n            related: [\r\n                landmarks[23].point,\r\n                landmarks[24].point,\r\n                landmarks[25].point,\r\n                landmarks[26].point,\r\n                mid(\r\n                    landmarks[24].point,\r\n                    landmarks[23].point,\r\n                    landmarks[12].point,\r\n                    landmarks[11].point\r\n                )\r\n            ],\r\n            flip\r\n        };\r\n    }\r\n\r\n}","import SkeletonModel from '../../components/SkeletonModelCanvas/model/SkeletonModel';\r\nimport {LANDMARK_VISIBILITY_ACCEPTABLE_THRESHOLD} from '../../config';\r\nimport {angleBetweenVec3} from '../../utils/math/math';\r\nimport Photo from '../../utils/Photo';\r\nimport {\r\n    avg,\r\n    cross,\r\n    flipX,\r\n    getAngle,\r\n    getAngle2D,\r\n    getNormal,\r\n    getNormalInLocalSpace,\r\n    mid,\r\n    normalizedLandmarkToViewSpace,\r\n    simplifyAngle\r\n} from './math';\r\nimport {MatchResult, PoseMatcher} from './search';\r\n\r\nconst MAX_VIEW_ANGLE_ERROR = Math.PI / 180 * 45;\r\nconst MAX_WORLD_SPACE_ANGLE_ERROR = Math.PI / 180 * 60;\r\n\r\nconst Z_AXIS: [number, number, number] = [0, 0, 1];\r\n\r\nexport default class MatchElbow implements PoseMatcher {\r\n\r\n    private isLeft: boolean;\r\n\r\n    private upperArmZAxisAngle: number = 0;\r\n    private lowerArmZAxisAngle: number = 0;\r\n    private elbowAngle: number = 0;\r\n    private elbowViewAngle: number = 0;\r\n\r\n    private upperArmLocalDir: [number, number, number] = [0, 0, 0];\r\n    private upperArmLocalDirMirror: [number, number, number] = [0, 0, 0];\r\n    private trunkForward: [number, number, number] = [0, 0, 0];\r\n    private trunkForwardMirror: [number, number, number] = [0, 0, 0];\r\n\r\n    constructor(isLeft: boolean) {\r\n        this.isLeft = isLeft;\r\n    }\r\n\r\n    prepare(model: SkeletonModel): void {\r\n        let shoulder = model.rightUpperArm.originViewPosition;\r\n        let elbow = model.rightUpperArm.controlPointViewPosition;\r\n        let wrist = model.rightLowerArm.controlPointViewPosition;\r\n        if (this.isLeft) {\r\n            shoulder = model.leftUpperArm.originViewPosition;\r\n            elbow = model.leftUpperArm.controlPointViewPosition;\r\n            wrist = model.leftLowerArm.controlPointViewPosition;\r\n        }\r\n        const upperArmNormal = getNormal(shoulder, elbow);\r\n        const lowerArmNormal = getNormal(elbow, wrist);\r\n        this.upperArmZAxisAngle = angleBetweenVec3(Z_AXIS, upperArmNormal);\r\n        this.lowerArmZAxisAngle = angleBetweenVec3(Z_AXIS, lowerArmNormal);\r\n        this.elbowAngle = angleBetweenVec3(upperArmNormal, lowerArmNormal);\r\n        this.elbowViewAngle = simplifyAngle(getAngle2D(elbow, shoulder, elbow, wrist)) - Math.PI;\r\n\r\n        if (this.isLeft) {\r\n            this.upperArmLocalDir = getNormalInLocalSpace(\r\n                model.rightUpperArm.originWorldPosition,\r\n                model.leftUpperArm.originWorldPosition,\r\n                model.trunk.originWorldPosition,\r\n                model.trunk.controlPointWorldPosition,\r\n                model.leftUpperArm.originWorldPosition,\r\n                model.leftUpperArm.controlPointWorldPosition,\r\n            );\r\n            this.upperArmLocalDirMirror = getNormalInLocalSpace(\r\n                model.rightUpperArm.originWorldPosition,\r\n                model.leftUpperArm.originWorldPosition,\r\n                model.trunk.originWorldPosition,\r\n                model.trunk.controlPointWorldPosition,\r\n                model.leftUpperArm.originWorldPosition,\r\n                model.leftUpperArm.controlPointWorldPosition,\r\n                true,\r\n            );\r\n        } else {\r\n            this.upperArmLocalDir = getNormalInLocalSpace(\r\n                model.leftUpperArm.originWorldPosition,\r\n                model.rightUpperArm.originWorldPosition,\r\n                model.trunk.originWorldPosition,\r\n                model.trunk.controlPointWorldPosition,\r\n                model.rightUpperArm.originWorldPosition,\r\n                model.rightUpperArm.controlPointWorldPosition,\r\n            );\r\n            this.upperArmLocalDirMirror = getNormalInLocalSpace(\r\n                model.leftUpperArm.originWorldPosition,\r\n                model.rightUpperArm.originWorldPosition,\r\n                model.trunk.originWorldPosition,\r\n                model.trunk.controlPointWorldPosition,\r\n                model.rightUpperArm.originWorldPosition,\r\n                model.rightUpperArm.controlPointWorldPosition,\r\n                true,\r\n            );\r\n        }\r\n\r\n        const trunkViewUp = getNormal(\r\n            mid(model.leftThigh.originViewPosition, model.rightThigh.originViewPosition),\r\n            mid(model.leftUpperArm.originViewPosition, model.rightUpperArm.originViewPosition)\r\n        );\r\n        const trunkViewUpMirror = getNormal(\r\n            flipX(mid(model.leftThigh.originViewPosition, model.rightThigh.originViewPosition)),\r\n            flipX(mid(model.leftUpperArm.originViewPosition, model.rightUpperArm.originViewPosition))\r\n        );\r\n        const trunkViewRight = getNormal(model.rightUpperArm.originViewPosition, model.leftUpperArm.originViewPosition);\r\n        const trunkViewRightMirror = getNormal(flipX(model.leftUpperArm.originViewPosition), flipX(model.rightUpperArm.originViewPosition));\r\n        this.trunkForward = cross(trunkViewRight, trunkViewUp);\r\n        this.trunkForwardMirror = cross(trunkViewRightMirror, trunkViewUpMirror);\r\n    }\r\n\r\n    match(photo: Photo): MatchResult | null {\r\n        const aspect = photo.width / photo.height;\r\n        const normalized = photo.normalizedLandmarks;\r\n        const world = photo.worldLandmarks;\r\n\r\n        const leftShoulderView = normalizedLandmarkToViewSpace(normalized[11].point, aspect);\r\n        const rightShoulderView = normalizedLandmarkToViewSpace(normalized[12].point, aspect);\r\n        const leftHipView = normalizedLandmarkToViewSpace(normalized[23].point, aspect);\r\n        const rightHipView = normalizedLandmarkToViewSpace(normalized[24].point, aspect);\r\n        const trunkUpView = getNormal(mid(leftHipView, rightHipView), mid(leftShoulderView, rightShoulderView));\r\n        const trunkRightView = getNormal(rightShoulderView, leftShoulderView);\r\n        const trunkForwardView = cross(trunkRightView, trunkUpView);\r\n\r\n        const confL = Math.min(\r\n            avg(normalized[11].visibility, normalized[13].visibility),\r\n            avg(normalized[13].visibility, normalized[15].visibility)\r\n        );\r\n        let upperArmZAngleErrorL = Infinity;\r\n        let lowerArmZAngleErrorL = Infinity;\r\n        let elbowAngleErrorL = Infinity;\r\n        let elbowViewAngleErrorL = Infinity;\r\n        let upperArmLocalAngleErrorL = Infinity;\r\n        let forwardErrorL = Infinity;\r\n        if (confL >= LANDMARK_VISIBILITY_ACCEPTABLE_THRESHOLD) {\r\n            const shoulderView = leftShoulderView;\r\n            const elbowView = normalizedLandmarkToViewSpace(normalized[13].point, aspect);\r\n            const wristView = normalizedLandmarkToViewSpace(normalized[15].point, aspect);\r\n            const upperArmViewNormal = getNormal(shoulderView, elbowView);\r\n            const lowerArmViewNormal = getNormal(elbowView, wristView);\r\n            const upperArmZAxisAngle = angleBetweenVec3(Z_AXIS, upperArmViewNormal);\r\n            const lowerArmZAxisAngle = angleBetweenVec3(Z_AXIS, lowerArmViewNormal);\r\n            upperArmZAngleErrorL = Math.abs(this.upperArmZAxisAngle - upperArmZAxisAngle);\r\n            lowerArmZAngleErrorL = Math.abs(this.lowerArmZAxisAngle - lowerArmZAxisAngle);\r\n\r\n            const shoulder = world[11].point;\r\n            const elbow = world[13].point;\r\n            const wrist = world[15].point;\r\n            const elbowAngle = getAngle(shoulder, elbow, elbow, wrist);\r\n            elbowAngleErrorL = Math.abs(this.elbowAngle - elbowAngle);\r\n\r\n            const elbowViewAngle = simplifyAngle(getAngle2D(elbowView, shoulderView, elbowView, wristView)) - Math.PI;\r\n            elbowViewAngleErrorL = Math.abs(this.elbowViewAngle - elbowViewAngle * (this.isLeft ? 1 : -1));\r\n\r\n            const upperArmLocalDir = getNormalInLocalSpace(\r\n                world[12].point,\r\n                world[11].point,\r\n                world[23].point,\r\n                world[11].point,\r\n                world[11].point,\r\n                world[13].point,\r\n            );\r\n            upperArmLocalAngleErrorL = angleBetweenVec3(upperArmLocalDir, this.isLeft ? this.upperArmLocalDir : this.upperArmLocalDirMirror);\r\n\r\n            forwardErrorL = angleBetweenVec3(trunkForwardView, this.isLeft ? this.trunkForward : this.trunkForwardMirror);\r\n        }\r\n        const scoreL = (Math.PI - upperArmZAngleErrorL)\r\n            * (Math.PI - lowerArmZAngleErrorL)\r\n            * (Math.PI - elbowAngleErrorL)\r\n            * (Math.PI * 2 - elbowViewAngleErrorL)\r\n            * (Math.PI - upperArmLocalAngleErrorL)\r\n            * (Math.PI - forwardErrorL)\r\n        ;\r\n\r\n        const confR = Math.min(\r\n            avg(normalized[12].visibility, normalized[14].visibility),\r\n            avg(normalized[14].visibility, normalized[16].visibility)\r\n        );\r\n        let upperArmZAngleErrorR = Infinity;\r\n        let lowerArmZAngleErrorR = Infinity;\r\n        let elbowAngleErrorR = Infinity;\r\n        let elbowViewAngleErrorR = Infinity;\r\n        let upperArmLocalAngleErrorR = Infinity;\r\n        let forwardErrorR = Infinity;\r\n        if (confR >= LANDMARK_VISIBILITY_ACCEPTABLE_THRESHOLD) {\r\n            const shoulderView = rightShoulderView;\r\n            const elbowView = normalizedLandmarkToViewSpace(normalized[14].point, aspect);\r\n            const wristView = normalizedLandmarkToViewSpace(normalized[16].point, aspect);\r\n            const upperArmViewNormal = getNormal(shoulderView, elbowView);\r\n            const lowerArmViewNormal = getNormal(elbowView, wristView);\r\n            const upperArmZAxisAngle = angleBetweenVec3(Z_AXIS, upperArmViewNormal);\r\n            const lowerArmZAxisAngle = angleBetweenVec3(Z_AXIS, lowerArmViewNormal);\r\n            upperArmZAngleErrorR = Math.abs(this.upperArmZAxisAngle - upperArmZAxisAngle);\r\n            lowerArmZAngleErrorR = Math.abs(this.lowerArmZAxisAngle - lowerArmZAxisAngle);\r\n\r\n            const shoulder = world[12].point;\r\n            const elbow = world[14].point;\r\n            const wrist = world[16].point;\r\n            const elbowAngle = getAngle(shoulder, elbow, elbow, wrist);\r\n            elbowAngleErrorR = Math.abs(this.elbowAngle - elbowAngle);\r\n\r\n            const elbowViewAngle = simplifyAngle(getAngle2D(elbowView, shoulderView, elbowView, wristView)) - Math.PI;\r\n            elbowViewAngleErrorR = Math.abs(this.elbowViewAngle - elbowViewAngle * (this.isLeft ? -1 : 1));\r\n\r\n            const upperArmLocalDir = getNormalInLocalSpace(\r\n                world[11].point,\r\n                world[12].point,\r\n                world[24].point,\r\n                world[12].point,\r\n                world[12].point,\r\n                world[14].point,\r\n            );\r\n            upperArmLocalAngleErrorR = angleBetweenVec3(upperArmLocalDir, !this.isLeft ? this.upperArmLocalDir : this.upperArmLocalDirMirror);\r\n\r\n            forwardErrorR = angleBetweenVec3(trunkForwardView, this.isLeft ? this.trunkForwardMirror : this.trunkForward);\r\n        }\r\n        const scoreR = (Math.PI - upperArmZAngleErrorR)\r\n            * (Math.PI - lowerArmZAngleErrorR)\r\n            * (Math.PI - elbowAngleErrorR)\r\n            * (Math.PI * 2 - elbowViewAngleErrorR)\r\n            * (Math.PI - upperArmLocalAngleErrorR)\r\n            * (Math.PI - forwardErrorR)\r\n        ;\r\n\r\n        if (scoreL >= scoreR\r\n            && upperArmZAngleErrorL <= MAX_VIEW_ANGLE_ERROR\r\n            && lowerArmZAngleErrorL <= MAX_VIEW_ANGLE_ERROR\r\n            && elbowAngleErrorL <= MAX_WORLD_SPACE_ANGLE_ERROR\r\n            && elbowViewAngleErrorL <= MAX_VIEW_ANGLE_ERROR\r\n            && upperArmLocalAngleErrorL <= MAX_WORLD_SPACE_ANGLE_ERROR\r\n        ) {\r\n            return {\r\n                score: scoreL,\r\n                center: normalized[13].point,\r\n                related: [normalized[11].point, normalized[15].point],\r\n                flip: !this.isLeft\r\n            };\r\n        } else if (\r\n            upperArmZAngleErrorR <= MAX_VIEW_ANGLE_ERROR\r\n            && lowerArmZAngleErrorR <= MAX_VIEW_ANGLE_ERROR\r\n            && elbowAngleErrorR <= MAX_WORLD_SPACE_ANGLE_ERROR\r\n            && elbowViewAngleErrorR <= MAX_VIEW_ANGLE_ERROR\r\n            && upperArmLocalAngleErrorR <= MAX_WORLD_SPACE_ANGLE_ERROR\r\n        ) {\r\n            return {\r\n                score: scoreR,\r\n                center: normalized[14].point,\r\n                related: [normalized[12].point, normalized[16].point],\r\n                flip: this.isLeft\r\n            };\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n}","import SkeletonModel from '../../components/SkeletonModelCanvas/model/SkeletonModel';\r\nimport {LANDMARK_VISIBILITY_ACCEPTABLE_THRESHOLD} from '../../config';\r\nimport {angleBetweenVec3} from '../../utils/math/math';\r\nimport Photo from '../../utils/Photo';\r\nimport {avg, getAngle, getNormal, getNormalInLocalSpace} from './math';\r\nimport {MatchResult, PoseMatcher} from './search';\r\n\r\nconst MAX_WORLD_SPACE_ANGLE_ERROR = Math.PI / 180 * 60;\r\n\r\nexport default class MatchElbowCameraUnrelated implements PoseMatcher {\r\n\r\n    private isLeft: boolean;\r\n\r\n    private elbowAngle: number = 0;\r\n    private upperArmLocalDir: [number, number, number] = [0, 0, 0];\r\n    private upperArmLocalDirMirror: [number, number, number] = [0, 0, 0];\r\n    private lowerArmLocalDir: [number, number, number] = [0, 0, 0];\r\n    private lowerArmLocalDirMirror: [number, number, number] = [0, 0, 0];\r\n\r\n    constructor(isLeft: boolean) {\r\n        this.isLeft = isLeft;\r\n    }\r\n\r\n    prepare(model: SkeletonModel): void {\r\n        let shoulder = model.rightUpperArm.originWorldPosition;\r\n        let elbow = model.rightUpperArm.controlPointWorldPosition;\r\n        let wrist = model.rightLowerArm.controlPointWorldPosition;\r\n        if (this.isLeft) {\r\n            shoulder = model.leftUpperArm.originWorldPosition;\r\n            elbow = model.leftUpperArm.controlPointWorldPosition;\r\n            wrist = model.leftLowerArm.controlPointWorldPosition;\r\n        }\r\n        const upperArmNormal = getNormal(shoulder, elbow);\r\n        const lowerArmNormal = getNormal(elbow, wrist);\r\n        this.elbowAngle = angleBetweenVec3(upperArmNormal, lowerArmNormal);\r\n\r\n        if (this.isLeft) {\r\n            this.upperArmLocalDir = getNormalInLocalSpace(\r\n                model.rightUpperArm.originWorldPosition,\r\n                model.leftUpperArm.originWorldPosition,\r\n                model.trunk.originWorldPosition,\r\n                model.trunk.controlPointWorldPosition,\r\n                model.leftUpperArm.originWorldPosition,\r\n                model.leftUpperArm.controlPointWorldPosition,\r\n            );\r\n            this.upperArmLocalDirMirror = getNormalInLocalSpace(\r\n                model.rightUpperArm.originWorldPosition,\r\n                model.leftUpperArm.originWorldPosition,\r\n                model.trunk.originWorldPosition,\r\n                model.trunk.controlPointWorldPosition,\r\n                model.leftUpperArm.originWorldPosition,\r\n                model.leftUpperArm.controlPointWorldPosition,\r\n                true,\r\n            );\r\n\r\n            this.lowerArmLocalDir = getNormalInLocalSpace(\r\n                model.rightUpperArm.originWorldPosition,\r\n                model.leftUpperArm.originWorldPosition,\r\n                model.leftUpperArm.controlPointWorldPosition,\r\n                model.leftUpperArm.originWorldPosition,\r\n                model.leftLowerArm.originWorldPosition,\r\n                model.leftLowerArm.controlPointWorldPosition,\r\n            );\r\n            this.lowerArmLocalDirMirror = getNormalInLocalSpace(\r\n                model.rightUpperArm.originWorldPosition,\r\n                model.leftUpperArm.originWorldPosition,\r\n                model.leftUpperArm.controlPointWorldPosition,\r\n                model.leftUpperArm.originWorldPosition,\r\n                model.leftLowerArm.originWorldPosition,\r\n                model.leftLowerArm.controlPointWorldPosition,\r\n                true\r\n            );\r\n        } else {\r\n            this.upperArmLocalDir = getNormalInLocalSpace(\r\n                model.leftUpperArm.originWorldPosition,\r\n                model.rightUpperArm.originWorldPosition,\r\n                model.trunk.originWorldPosition,\r\n                model.trunk.controlPointWorldPosition,\r\n                model.rightUpperArm.originWorldPosition,\r\n                model.rightUpperArm.controlPointWorldPosition,\r\n            );\r\n            this.upperArmLocalDirMirror = getNormalInLocalSpace(\r\n                model.leftUpperArm.originWorldPosition,\r\n                model.rightUpperArm.originWorldPosition,\r\n                model.trunk.originWorldPosition,\r\n                model.trunk.controlPointWorldPosition,\r\n                model.rightUpperArm.originWorldPosition,\r\n                model.rightUpperArm.controlPointWorldPosition,\r\n                true,\r\n            );\r\n\r\n            this.lowerArmLocalDir = getNormalInLocalSpace(\r\n                model.leftUpperArm.originWorldPosition,\r\n                model.rightUpperArm.originWorldPosition,\r\n                model.rightUpperArm.controlPointWorldPosition,\r\n                model.rightUpperArm.originWorldPosition,\r\n                model.rightLowerArm.originWorldPosition,\r\n                model.rightLowerArm.controlPointWorldPosition,\r\n            );\r\n            this.lowerArmLocalDirMirror = getNormalInLocalSpace(\r\n                model.leftUpperArm.originWorldPosition,\r\n                model.rightUpperArm.originWorldPosition,\r\n                model.rightUpperArm.controlPointWorldPosition,\r\n                model.rightUpperArm.originWorldPosition,\r\n                model.rightLowerArm.originWorldPosition,\r\n                model.rightLowerArm.controlPointWorldPosition,\r\n                true\r\n            );\r\n        }\r\n    }\r\n\r\n    match(photo: Photo): MatchResult | null {\r\n        const world = photo.worldLandmarks;\r\n        const normalized = photo.normalizedLandmarks;\r\n\r\n        const confL = Math.min(\r\n            avg(world[11].visibility, world[13].visibility),\r\n            avg(world[13].visibility, world[15].visibility)\r\n        );\r\n        let elbowAngleErrorL = Infinity;\r\n        let upperArmLocalAngleErrorL = Infinity;\r\n        let lowerArmLocalAngleErrorL = Infinity;\r\n        if (confL >= LANDMARK_VISIBILITY_ACCEPTABLE_THRESHOLD) {\r\n            const shoulder = world[11].point;\r\n            const elbow = world[13].point;\r\n            const wrist = world[15].point;\r\n            const elbowAngle = getAngle(shoulder, elbow, elbow, wrist);\r\n            elbowAngleErrorL = Math.abs(this.elbowAngle - elbowAngle);\r\n\r\n            const upperArmLocalDir = getNormalInLocalSpace(\r\n                world[12].point,\r\n                world[11].point,\r\n                world[23].point,\r\n                world[11].point,\r\n                world[11].point,\r\n                world[13].point,\r\n            );\r\n            upperArmLocalAngleErrorL = angleBetweenVec3(upperArmLocalDir, this.isLeft ? this.upperArmLocalDir : this.upperArmLocalDirMirror);\r\n\r\n            const lowerArmLocalDir = getNormalInLocalSpace(\r\n                world[12].point,\r\n                world[11].point,\r\n                world[13].point,\r\n                world[11].point,\r\n                world[13].point,\r\n                world[15].point,\r\n            );\r\n            lowerArmLocalAngleErrorL = angleBetweenVec3(lowerArmLocalDir, this.isLeft ? this.lowerArmLocalDir : this.lowerArmLocalDirMirror);\r\n        }\r\n        const scoreL = (Math.PI - elbowAngleErrorL) * (Math.PI - upperArmLocalAngleErrorL) * (Math.PI - lowerArmLocalAngleErrorL);\r\n\r\n        const confR = Math.min(\r\n            avg(world[12].visibility, world[14].visibility),\r\n            avg(world[14].visibility, world[16].visibility)\r\n        );\r\n        let elbowAngleErrorR = Infinity;\r\n        let upperArmLocalAngleErrorR = Infinity;\r\n        let lowerArmLocalAngleErrorR = Infinity;\r\n        if (confR >= LANDMARK_VISIBILITY_ACCEPTABLE_THRESHOLD) {\r\n            const shoulder = world[12].point;\r\n            const elbow = world[14].point;\r\n            const wrist = world[16].point;\r\n            const elbowAngle = getAngle(shoulder, elbow, elbow, wrist);\r\n            elbowAngleErrorR = Math.abs(this.elbowAngle - elbowAngle);\r\n\r\n            const upperArmLocalDir = getNormalInLocalSpace(\r\n                world[11].point,\r\n                world[12].point,\r\n                world[24].point,\r\n                world[12].point,\r\n                world[12].point,\r\n                world[14].point,\r\n            );\r\n            upperArmLocalAngleErrorR = angleBetweenVec3(upperArmLocalDir, !this.isLeft ? this.upperArmLocalDir : this.upperArmLocalDirMirror);\r\n\r\n            const lowerArmLocalDir = getNormalInLocalSpace(\r\n                world[11].point,\r\n                world[12].point,\r\n                world[14].point,\r\n                world[12].point,\r\n                world[14].point,\r\n                world[16].point,\r\n            );\r\n            lowerArmLocalAngleErrorR = angleBetweenVec3(lowerArmLocalDir, !this.isLeft ? this.lowerArmLocalDir : this.lowerArmLocalDirMirror);\r\n        }\r\n        const scoreR = (Math.PI - elbowAngleErrorR) * (Math.PI - upperArmLocalAngleErrorR) * (Math.PI - lowerArmLocalAngleErrorR);\r\n\r\n        if (scoreL >= scoreR\r\n            && elbowAngleErrorL <= MAX_WORLD_SPACE_ANGLE_ERROR\r\n            && upperArmLocalAngleErrorL <= MAX_WORLD_SPACE_ANGLE_ERROR\r\n            && lowerArmLocalAngleErrorL <= MAX_WORLD_SPACE_ANGLE_ERROR\r\n        ) {\r\n            return {\r\n                score: scoreL,\r\n                center: normalized[13].point,\r\n                related: [normalized[11].point, normalized[15].point],\r\n                flip: !this.isLeft\r\n            };\r\n        } else if (\r\n            elbowAngleErrorR <= MAX_WORLD_SPACE_ANGLE_ERROR\r\n            && upperArmLocalAngleErrorR <= MAX_WORLD_SPACE_ANGLE_ERROR\r\n            && lowerArmLocalAngleErrorR <= MAX_WORLD_SPACE_ANGLE_ERROR\r\n        ) {\r\n            return {\r\n                score: scoreR,\r\n                center: normalized[14].point,\r\n                related: [normalized[12].point, normalized[16].point],\r\n                flip: this.isLeft\r\n            };\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n}","import SkeletonModel from '../../components/SkeletonModelCanvas/model/SkeletonModel';\r\nimport {LANDMARK_VISIBILITY_ACCEPTABLE_THRESHOLD} from '../../config';\r\nimport {angleBetweenVec3} from '../../utils/math/math';\r\nimport Photo from '../../utils/Photo';\r\nimport {flipX, getNormal, isWithinBoundary2D, mid, normalizedLandmarkToViewSpace} from './math';\r\nimport {MatchResult, PoseMatcher} from './search';\r\n\r\nconst MAX_VIEW_SPACE_ANGLE_ERROR = Math.PI / 180 * 45;\r\n\r\nexport default class MatchFace implements PoseMatcher {\r\n\r\n    private targetForward: [number, number, number] = [0, 0, 0];\r\n    private targetRight: [number, number, number] = [0, 0, 0];\r\n    private targetForwardMirror: [number, number, number] = [0, 0, 0];\r\n    private targetRightMirror: [number, number, number] = [0, 0, 0];\r\n\r\n    prepare(model: SkeletonModel): void {\r\n        const leftEar = model.head.landmarksViewPosition[0];\r\n        const rightEar = model.head.landmarksViewPosition[1];\r\n        this.targetRight = getNormal(rightEar, leftEar);\r\n        this.targetForward = getNormal(model.head.originViewPosition, model.head.controlPointViewPosition);\r\n        this.targetRightMirror = getNormal(flipX(leftEar), flipX(rightEar));\r\n        this.targetForwardMirror = getNormal(flipX(model.head.originViewPosition), flipX(model.head.controlPointViewPosition));\r\n    }\r\n\r\n    match(photo: Photo): MatchResult | null {\r\n        const landmarks = photo.normalizedLandmarks;\r\n        if (!isWithinBoundary2D(landmarks[8].point) || !isWithinBoundary2D(landmarks[7].point)) {\r\n            return null;\r\n        }\r\n        const conf = Math.min(\r\n            landmarks[8].visibility,\r\n            landmarks[7].visibility,\r\n            landmarks[10].visibility,\r\n            landmarks[9].visibility\r\n        );\r\n        if (conf < LANDMARK_VISIBILITY_ACCEPTABLE_THRESHOLD) {\r\n            return null;\r\n        }\r\n        const aspect = photo.width / photo.height;\r\n\r\n        const leftEar = normalizedLandmarkToViewSpace(landmarks[7].point, aspect);\r\n        const rightEar = normalizedLandmarkToViewSpace(landmarks[8].point, aspect);\r\n        const nose = normalizedLandmarkToViewSpace(landmarks[0].point, aspect);\r\n        const right = getNormal(rightEar, leftEar);\r\n        const forward = getNormal(mid(leftEar, rightEar), nose);\r\n\r\n        const angleError1 = angleBetweenVec3(this.targetRight, right);\r\n        const angleError2 = angleBetweenVec3(this.targetForward, forward);\r\n        const score = (Math.PI - angleError1) * (Math.PI - angleError2);\r\n\r\n        const angleError1F = angleBetweenVec3(this.targetRightMirror, right);\r\n        const angleError2F = angleBetweenVec3(this.targetForwardMirror, forward);\r\n        const scoreF = (Math.PI - angleError1F) * (Math.PI - angleError2F);\r\n\r\n        let bestScore = 0;\r\n        let flip = false;\r\n\r\n        if (angleError1 <= MAX_VIEW_SPACE_ANGLE_ERROR && angleError2 <= MAX_VIEW_SPACE_ANGLE_ERROR && score > scoreF) {\r\n            bestScore = score;\r\n        } else if (angleError1F <= MAX_VIEW_SPACE_ANGLE_ERROR && angleError2F <= MAX_VIEW_SPACE_ANGLE_ERROR) {\r\n            bestScore = scoreF;\r\n            flip = true;\r\n        } else {\r\n            return null;\r\n        }\r\n\r\n        const xl = Math.min(landmarks[8].point[0], landmarks[7].point[0]);\r\n        const xh = Math.max(landmarks[8].point[0], landmarks[7].point[0]);\r\n        const xRange = xh - xl;\r\n        const xPadding = xRange * 0.5;\r\n        const yl = Math.min(landmarks[6].point[1], landmarks[3].point[1], landmarks[10].point[1], landmarks[9].point[1]);\r\n        const yh = Math.min(landmarks[6].point[1], landmarks[3].point[1], landmarks[10].point[1], landmarks[9].point[1]);\r\n        const yRange = yh - yl;\r\n        const yPadding = yRange * 0.5;\r\n\r\n        return {\r\n            score: bestScore,\r\n            center: mid(landmarks[0].point),\r\n            related: [\r\n                landmarks[8].point,\r\n                landmarks[7].point,\r\n                landmarks[10].point,\r\n                landmarks[9].point,\r\n                [xl - xPadding, landmarks[0].point[1], landmarks[0].point[2]],\r\n                [xh + xPadding, landmarks[0].point[1], landmarks[0].point[2]],\r\n                [landmarks[0].point[0], yl - yPadding, landmarks[0].point[2]],\r\n                [landmarks[0].point[0], yh + yPadding, landmarks[0].point[2]],\r\n            ],\r\n            flip\r\n        };\r\n    }\r\n\r\n}","import SkeletonModel from '../../components/SkeletonModelCanvas/model/SkeletonModel';\r\nimport {LANDMARK_VISIBILITY_ACCEPTABLE_THRESHOLD} from '../../config';\r\nimport {angleBetweenVec3} from '../../utils/math/math';\r\nimport Photo from '../../utils/Photo';\r\nimport {avg, flipX, getNormal, getNormalInLocalSpace, mid, normalizedLandmarkToViewSpace} from './math';\r\nimport {MatchResult, PoseMatcher} from './search';\r\n\r\nconst MAX_WORLD_SPACE_ANGLE_ERROR = Math.PI / 180 * 30;\r\nconst MAX_VIEW_SPACE_ANGLE_ERROR = Math.PI / 180 * 60;\r\n\r\nexport default class MatchHip implements PoseMatcher {\r\n\r\n    private isLeft: boolean;\r\n\r\n    private thighLocalDir: [number, number, number] = [0, 0, 0];\r\n    private thighLocalDirMirror: [number, number, number] = [0, 0, 0];\r\n\r\n    private trunkViewUp: [number, number, number] = [0, 0, 0];\r\n    private trunkViewRight: [number, number, number] = [0, 0, 0];\r\n    private trunkViewUpMirror: [number, number, number] = [0, 0, 0];\r\n    private trunkViewRightMirror: [number, number, number] = [0, 0, 0];\r\n\r\n    constructor(isLeft: boolean) {\r\n        this.isLeft = isLeft;\r\n    }\r\n\r\n    prepare(model: SkeletonModel): void {\r\n        this.trunkViewUp = getNormal(\r\n            mid(model.leftThigh.originViewPosition, model.rightThigh.originViewPosition),\r\n            mid(model.leftUpperArm.originViewPosition, model.rightUpperArm.originViewPosition)\r\n        );\r\n        this.trunkViewUpMirror = getNormal(\r\n            flipX(mid(model.leftThigh.originViewPosition, model.rightThigh.originViewPosition)),\r\n            flipX(mid(model.leftUpperArm.originViewPosition, model.rightUpperArm.originViewPosition))\r\n        );\r\n        this.trunkViewRight = getNormal(model.rightThigh.originViewPosition, model.leftThigh.originViewPosition);\r\n        this.trunkViewRightMirror = getNormal(flipX(model.leftThigh.originViewPosition), flipX(model.rightThigh.originViewPosition));\r\n        if (this.isLeft) {\r\n            this.thighLocalDir = getNormalInLocalSpace(\r\n                model.rightThigh.originWorldPosition,\r\n                model.leftThigh.originWorldPosition,\r\n                model.trunk.originWorldPosition,\r\n                model.trunk.controlPointWorldPosition,\r\n                model.leftThigh.originWorldPosition,\r\n                model.leftThigh.controlPointWorldPosition,\r\n            );\r\n            this.thighLocalDirMirror = getNormalInLocalSpace(\r\n                model.rightThigh.originWorldPosition,\r\n                model.leftThigh.originWorldPosition,\r\n                model.trunk.originWorldPosition,\r\n                model.trunk.controlPointWorldPosition,\r\n                model.leftThigh.originWorldPosition,\r\n                model.leftThigh.controlPointWorldPosition,\r\n                true,\r\n            );\r\n        } else {\r\n            this.thighLocalDir = getNormalInLocalSpace(\r\n                model.leftThigh.originWorldPosition,\r\n                model.rightThigh.originWorldPosition,\r\n                model.trunk.originWorldPosition,\r\n                model.trunk.controlPointWorldPosition,\r\n                model.rightThigh.originWorldPosition,\r\n                model.rightThigh.controlPointWorldPosition,\r\n            );\r\n            this.thighLocalDirMirror = getNormalInLocalSpace(\r\n                model.leftThigh.originWorldPosition,\r\n                model.rightThigh.originWorldPosition,\r\n                model.trunk.originWorldPosition,\r\n                model.trunk.controlPointWorldPosition,\r\n                model.rightThigh.originWorldPosition,\r\n                model.rightThigh.controlPointWorldPosition,\r\n                true,\r\n            );\r\n        }\r\n    }\r\n\r\n    match(photo: Photo): MatchResult | null {\r\n        const world = photo.worldLandmarks;\r\n        const normalized = photo.normalizedLandmarks;\r\n        const aspect = photo.width / photo.height;\r\n\r\n        const leftShoulderView = normalizedLandmarkToViewSpace(normalized[11].point, aspect);\r\n        const rightShoulderView = normalizedLandmarkToViewSpace(normalized[12].point, aspect);\r\n        const leftHipView = normalizedLandmarkToViewSpace(normalized[23].point, aspect);\r\n        const rightHipView = normalizedLandmarkToViewSpace(normalized[24].point, aspect);\r\n        const trunkUpView = getNormal(mid(leftHipView, rightHipView), mid(leftShoulderView, rightShoulderView));\r\n        const trunkRightView = getNormal(rightShoulderView, leftShoulderView);\r\n\r\n        const confL = Math.min(\r\n            avg(world[11].visibility, world[23].visibility, world[24].visibility),\r\n            avg(world[23].visibility, world[25].visibility)\r\n        );\r\n        let errorL = Infinity;\r\n        let viewError1L = Infinity;\r\n        let viewError2L = Infinity;\r\n        if (confL >= LANDMARK_VISIBILITY_ACCEPTABLE_THRESHOLD) {\r\n            const dirL = getNormalInLocalSpace(\r\n                world[24].point,\r\n                world[23].point,\r\n                world[23].point,\r\n                world[11].point,\r\n                world[23].point,\r\n                world[25].point,\r\n            );\r\n            errorL = angleBetweenVec3(dirL, this.isLeft ? this.thighLocalDir : this.thighLocalDirMirror);\r\n            viewError1L = angleBetweenVec3(trunkUpView, this.isLeft ? this.trunkViewUp : this.trunkViewUpMirror);\r\n            viewError2L = angleBetweenVec3(trunkRightView, this.isLeft ? this.trunkViewRight : this.trunkViewRightMirror);\r\n        }\r\n\r\n        const confR = Math.min(\r\n            avg(world[12].visibility, world[24].visibility, world[23].visibility),\r\n            avg(world[24].visibility, world[26].visibility)\r\n        );\r\n        let errorR = Infinity;\r\n        let viewError1R = Infinity;\r\n        let viewError2R = Infinity;\r\n        if (confR >= LANDMARK_VISIBILITY_ACCEPTABLE_THRESHOLD) {\r\n            const dirR = getNormalInLocalSpace(\r\n                world[23].point,\r\n                world[24].point,\r\n                world[24].point,\r\n                world[12].point,\r\n                world[24].point,\r\n                world[26].point,\r\n            );\r\n            errorR = angleBetweenVec3(dirR, !this.isLeft ? this.thighLocalDir : this.thighLocalDirMirror);\r\n            viewError1R = angleBetweenVec3(trunkUpView, this.isLeft ? this.trunkViewUpMirror : this.trunkViewUp);\r\n            viewError2R = angleBetweenVec3(trunkRightView, this.isLeft ? this.trunkViewRightMirror : this.trunkViewRight);\r\n        }\r\n\r\n        if (\r\n            errorL < errorR\r\n            && errorL <= MAX_WORLD_SPACE_ANGLE_ERROR\r\n            && viewError1L <= MAX_VIEW_SPACE_ANGLE_ERROR\r\n            && viewError2L <= MAX_VIEW_SPACE_ANGLE_ERROR\r\n        ) {\r\n            return {\r\n                score: (Math.PI - errorL) * (Math.PI - viewError1L) * (Math.PI - viewError2L),\r\n                center: normalized[23].point,\r\n                related: [normalized[24].point, normalized[25].point, mid(normalized[23].point, normalized[11].point)],\r\n                flip: !this.isLeft\r\n            };\r\n        } else if (\r\n            errorR <= MAX_WORLD_SPACE_ANGLE_ERROR\r\n            && viewError1R <= MAX_VIEW_SPACE_ANGLE_ERROR\r\n            && viewError2R <= MAX_VIEW_SPACE_ANGLE_ERROR\r\n        ) {\r\n            return {\r\n                score: (Math.PI - errorR) * (Math.PI - viewError1R) * (Math.PI - viewError2R),\r\n                center: normalized[24].point,\r\n                related: [normalized[23].point, normalized[26].point, mid(normalized[24].point, normalized[12].point)],\r\n                flip: this.isLeft\r\n            };\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n}","import SkeletonModel from '../../components/SkeletonModelCanvas/model/SkeletonModel';\r\nimport {LANDMARK_VISIBILITY_ACCEPTABLE_THRESHOLD} from '../../config';\r\nimport {angleBetweenVec3} from '../../utils/math/math';\r\nimport Photo from '../../utils/Photo';\r\nimport {avg, getNormal, getNormalInLocalSpace, mid, normalizedLandmarkToViewSpace} from './math';\r\nimport {MatchResult, PoseMatcher} from './search';\r\n\r\nconst MAX_WORLD_SPACE_ANGLE_ERROR = Math.PI / 180 * 45;\r\n\r\nexport default class MatchHipCameraUnrelated implements PoseMatcher {\r\n\r\n    private isLeft: boolean;\r\n\r\n    private thighLocalDir: [number, number, number] = [0, 0, 0];\r\n    private thighLocalDirMirror: [number, number, number] = [0, 0, 0];\r\n\r\n    constructor(isLeft: boolean) {\r\n        this.isLeft = isLeft;\r\n    }\r\n\r\n    prepare(model: SkeletonModel): void {\r\n        if (this.isLeft) {\r\n            this.thighLocalDir = getNormalInLocalSpace(\r\n                model.rightThigh.originWorldPosition,\r\n                model.leftThigh.originWorldPosition,\r\n                model.trunk.originWorldPosition,\r\n                model.trunk.controlPointWorldPosition,\r\n                model.leftThigh.originWorldPosition,\r\n                model.leftThigh.controlPointWorldPosition,\r\n            );\r\n            this.thighLocalDirMirror = getNormalInLocalSpace(\r\n                model.rightThigh.originWorldPosition,\r\n                model.leftThigh.originWorldPosition,\r\n                model.trunk.originWorldPosition,\r\n                model.trunk.controlPointWorldPosition,\r\n                model.leftThigh.originWorldPosition,\r\n                model.leftThigh.controlPointWorldPosition,\r\n                true,\r\n            );\r\n        } else {\r\n            this.thighLocalDir = getNormalInLocalSpace(\r\n                model.leftThigh.originWorldPosition,\r\n                model.rightThigh.originWorldPosition,\r\n                model.trunk.originWorldPosition,\r\n                model.trunk.controlPointWorldPosition,\r\n                model.rightThigh.originWorldPosition,\r\n                model.rightThigh.controlPointWorldPosition,\r\n            );\r\n            this.thighLocalDirMirror = getNormalInLocalSpace(\r\n                model.leftThigh.originWorldPosition,\r\n                model.rightThigh.originWorldPosition,\r\n                model.trunk.originWorldPosition,\r\n                model.trunk.controlPointWorldPosition,\r\n                model.rightThigh.originWorldPosition,\r\n                model.rightThigh.controlPointWorldPosition,\r\n                true,\r\n            );\r\n        }\r\n    }\r\n\r\n    match(photo: Photo): MatchResult | null {\r\n        const world = photo.worldLandmarks;\r\n        const normalized = photo.normalizedLandmarks;\r\n        const aspect = photo.width / photo.height;\r\n\r\n        const leftShoulderView = normalizedLandmarkToViewSpace(normalized[11].point, aspect);\r\n        const rightShoulderView = normalizedLandmarkToViewSpace(normalized[12].point, aspect);\r\n        const leftHipView = normalizedLandmarkToViewSpace(normalized[23].point, aspect);\r\n        const rightHipView = normalizedLandmarkToViewSpace(normalized[24].point, aspect);\r\n        const trunkUpView = getNormal(mid(leftHipView, rightHipView), mid(leftShoulderView, rightShoulderView));\r\n        const trunkRightView = getNormal(rightShoulderView, leftShoulderView);\r\n\r\n        const confL = Math.min(\r\n            avg(world[11].visibility, world[23].visibility, world[24].visibility),\r\n            avg(world[23].visibility, world[25].visibility)\r\n        );\r\n        let errorL = Infinity;\r\n        if (confL >= LANDMARK_VISIBILITY_ACCEPTABLE_THRESHOLD) {\r\n            const dirL = getNormalInLocalSpace(\r\n                world[24].point,\r\n                world[23].point,\r\n                world[23].point,\r\n                world[11].point,\r\n                world[23].point,\r\n                world[25].point,\r\n            );\r\n            errorL = angleBetweenVec3(dirL, this.isLeft ? this.thighLocalDir : this.thighLocalDirMirror);\r\n        }\r\n\r\n        const confR = Math.min(\r\n            avg(world[12].visibility, world[24].visibility, world[23].visibility),\r\n            avg(world[24].visibility, world[26].visibility)\r\n        );\r\n        let errorR = Infinity;\r\n        if (confR >= LANDMARK_VISIBILITY_ACCEPTABLE_THRESHOLD) {\r\n            const dirR = getNormalInLocalSpace(\r\n                world[23].point,\r\n                world[24].point,\r\n                world[24].point,\r\n                world[12].point,\r\n                world[24].point,\r\n                world[26].point,\r\n            );\r\n            errorR = angleBetweenVec3(dirR, !this.isLeft ? this.thighLocalDir : this.thighLocalDirMirror);\r\n        }\r\n\r\n        if (\r\n            errorL < errorR\r\n            && errorL <= MAX_WORLD_SPACE_ANGLE_ERROR\r\n        ) {\r\n            return {\r\n                score: (Math.PI - errorL),\r\n                center: normalized[23].point,\r\n                related: [normalized[24].point, normalized[25].point, mid(normalized[23].point, normalized[11].point)],\r\n                flip: !this.isLeft\r\n            };\r\n        } else if (\r\n            errorR <= MAX_WORLD_SPACE_ANGLE_ERROR\r\n        ) {\r\n            return {\r\n                score: (Math.PI - errorR),\r\n                center: normalized[24].point,\r\n                related: [normalized[23].point, normalized[26].point, mid(normalized[24].point, normalized[12].point)],\r\n                flip: this.isLeft\r\n            };\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n}","import SkeletonModel from '../../components/SkeletonModelCanvas/model/SkeletonModel';\r\nimport {LANDMARK_VISIBILITY_ACCEPTABLE_THRESHOLD} from '../../config';\r\nimport {angleBetweenVec3} from '../../utils/math/math';\r\nimport Photo from '../../utils/Photo';\r\nimport {\r\n    avg,\r\n    cross,\r\n    flipX,\r\n    getAngle,\r\n    getAngle2D,\r\n    getNormal,\r\n    getNormalInLocalSpace,\r\n    mid,\r\n    normalizedLandmarkToViewSpace,\r\n    simplifyAngle\r\n} from './math';\r\nimport {MatchResult, PoseMatcher} from './search';\r\n\r\nconst MAX_VIEW_ANGLE_ERROR = Math.PI / 180 * 45;\r\nconst MAX_WORLD_SPACE_ANGLE_ERROR = Math.PI / 180 * 60;\r\n\r\nconst Z_AXIS: [number, number, number] = [0, 0, 1];\r\n\r\nexport default class MatchKnee implements PoseMatcher {\r\n\r\n    private isLeft: boolean;\r\n\r\n    private thighZAxisAngle: number = 0;\r\n    private calfZAxisAngle: number = 0;\r\n    private kneeAngle: number = 0;\r\n    private kneeViewAngle: number = 0;\r\n\r\n    private thighLocalDir: [number, number, number] = [0, 0, 0];\r\n    private thighLocalDirMirror: [number, number, number] = [0, 0, 0];\r\n    private trunkForward: [number, number, number] = [0, 0, 0];\r\n    private trunkForwardMirror: [number, number, number] = [0, 0, 0];\r\n\r\n    constructor(isLeft: boolean) {\r\n        this.isLeft = isLeft;\r\n    }\r\n\r\n    prepare(model: SkeletonModel): void {\r\n        let hip = model.rightThigh.originViewPosition;\r\n        let knee = model.rightThigh.controlPointViewPosition;\r\n        let ankle = model.rightCalf.controlPointViewPosition;\r\n        if (this.isLeft) {\r\n            hip = model.leftThigh.originViewPosition;\r\n            knee = model.leftThigh.controlPointViewPosition;\r\n            ankle = model.leftCalf.controlPointViewPosition;\r\n        }\r\n        const thighNormal = getNormal(hip, knee);\r\n        const calfNormal = getNormal(knee, ankle);\r\n        this.thighZAxisAngle = angleBetweenVec3(Z_AXIS, thighNormal);\r\n        this.calfZAxisAngle = angleBetweenVec3(Z_AXIS, calfNormal);\r\n        this.kneeAngle = angleBetweenVec3(thighNormal, calfNormal);\r\n        this.kneeViewAngle = simplifyAngle(getAngle2D(knee, hip, knee, ankle)) - Math.PI;\r\n\r\n        if (this.isLeft) {\r\n            this.thighLocalDir = getNormalInLocalSpace(\r\n                model.rightThigh.originWorldPosition,\r\n                model.leftThigh.originWorldPosition,\r\n                model.trunk.originWorldPosition,\r\n                model.trunk.controlPointWorldPosition,\r\n                model.leftThigh.originWorldPosition,\r\n                model.leftThigh.controlPointWorldPosition,\r\n            );\r\n            this.thighLocalDirMirror = getNormalInLocalSpace(\r\n                model.rightThigh.originWorldPosition,\r\n                model.leftThigh.originWorldPosition,\r\n                model.trunk.originWorldPosition,\r\n                model.trunk.controlPointWorldPosition,\r\n                model.leftThigh.originWorldPosition,\r\n                model.leftThigh.controlPointWorldPosition,\r\n                true,\r\n            );\r\n        } else {\r\n            this.thighLocalDir = getNormalInLocalSpace(\r\n                model.leftThigh.originWorldPosition,\r\n                model.rightThigh.originWorldPosition,\r\n                model.trunk.originWorldPosition,\r\n                model.trunk.controlPointWorldPosition,\r\n                model.rightThigh.originWorldPosition,\r\n                model.rightThigh.controlPointWorldPosition,\r\n            );\r\n            this.thighLocalDirMirror = getNormalInLocalSpace(\r\n                model.leftThigh.originWorldPosition,\r\n                model.rightThigh.originWorldPosition,\r\n                model.trunk.originWorldPosition,\r\n                model.trunk.controlPointWorldPosition,\r\n                model.rightThigh.originWorldPosition,\r\n                model.rightThigh.controlPointWorldPosition,\r\n                true,\r\n            );\r\n        }\r\n\r\n        const trunkViewUp = getNormal(\r\n            mid(model.leftThigh.originViewPosition, model.rightThigh.originViewPosition),\r\n            mid(model.leftUpperArm.originViewPosition, model.rightUpperArm.originViewPosition)\r\n        );\r\n        const trunkViewUpMirror = getNormal(\r\n            flipX(mid(model.leftThigh.originViewPosition, model.rightThigh.originViewPosition)),\r\n            flipX(mid(model.leftUpperArm.originViewPosition, model.rightUpperArm.originViewPosition))\r\n        );\r\n        const trunkViewRight = getNormal(model.rightThigh.originViewPosition, model.leftThigh.originViewPosition);\r\n        const trunkViewRightMirror = getNormal(flipX(model.leftThigh.originViewPosition), flipX(model.rightThigh.originViewPosition));\r\n        this.trunkForward = cross(trunkViewRight, trunkViewUp);\r\n        this.trunkForwardMirror = cross(trunkViewRightMirror, trunkViewUpMirror);\r\n    }\r\n\r\n    match(photo: Photo): MatchResult | null {\r\n        const aspect = photo.width / photo.height;\r\n        const normalized = photo.normalizedLandmarks;\r\n        const world = photo.worldLandmarks;\r\n\r\n        const leftShoulderView = normalizedLandmarkToViewSpace(normalized[11].point, aspect);\r\n        const rightShoulderView = normalizedLandmarkToViewSpace(normalized[12].point, aspect);\r\n        const leftHipView = normalizedLandmarkToViewSpace(normalized[23].point, aspect);\r\n        const rightHipView = normalizedLandmarkToViewSpace(normalized[24].point, aspect);\r\n        const trunkUpView = getNormal(mid(leftHipView, rightHipView), mid(leftShoulderView, rightShoulderView));\r\n        const trunkRightView = getNormal(rightShoulderView, leftShoulderView);\r\n        const trunkForwardView = cross(trunkRightView, trunkUpView);\r\n\r\n        const confL = Math.min(\r\n            avg(normalized[23].visibility, normalized[25].visibility),\r\n            avg(normalized[25].visibility, normalized[27].visibility)\r\n        );\r\n        let thighZAngleErrorL = Infinity;\r\n        let calfZAngleErrorL = Infinity;\r\n        let kneeAngleErrorL = Infinity;\r\n        let kneeViewAngleErrorL = Infinity;\r\n        let thighLocalAngleErrorL = Infinity;\r\n        let forwardErrorL = Infinity;\r\n        if (confL >= LANDMARK_VISIBILITY_ACCEPTABLE_THRESHOLD) {\r\n            const hipView = leftHipView;\r\n            const kneeView = normalizedLandmarkToViewSpace(normalized[25].point, aspect);\r\n            const ankleView = normalizedLandmarkToViewSpace(normalized[27].point, aspect);\r\n            const thighViewNormal = getNormal(hipView, kneeView);\r\n            const calfViewNormal = getNormal(kneeView, ankleView);\r\n            const thighZAxisAngle = angleBetweenVec3(Z_AXIS, thighViewNormal);\r\n            const calfZAxisAngle = angleBetweenVec3(Z_AXIS, calfViewNormal);\r\n            thighZAngleErrorL = Math.abs(this.thighZAxisAngle - thighZAxisAngle);\r\n            calfZAngleErrorL = Math.abs(this.calfZAxisAngle - calfZAxisAngle);\r\n\r\n            const hip = world[23].point;\r\n            const knee = world[25].point;\r\n            const ankle = world[27].point;\r\n            const kneeAngle = getAngle(hip, knee, knee, ankle);\r\n            kneeAngleErrorL = Math.abs(this.kneeAngle - kneeAngle);\r\n\r\n            const kneeViewAngle = simplifyAngle(getAngle2D(kneeView, hipView, kneeView, ankleView)) - Math.PI;\r\n            kneeViewAngleErrorL = Math.abs(this.kneeViewAngle - kneeViewAngle * (this.isLeft ? 1 : -1));\r\n\r\n            const thighLocalDir = getNormalInLocalSpace(\r\n                world[24].point,\r\n                world[23].point,\r\n                world[23].point,\r\n                world[11].point,\r\n                world[23].point,\r\n                world[25].point,\r\n            );\r\n            thighLocalAngleErrorL = angleBetweenVec3(thighLocalDir, this.isLeft ? this.thighLocalDir : this.thighLocalDirMirror);\r\n\r\n            forwardErrorL = angleBetweenVec3(trunkForwardView, this.isLeft ? this.trunkForward : this.trunkForwardMirror);\r\n        }\r\n        const scoreL = (Math.PI - thighZAngleErrorL)\r\n            * (Math.PI - calfZAngleErrorL)\r\n            * (Math.PI - kneeAngleErrorL)\r\n            * (Math.PI * 2 - kneeViewAngleErrorL)\r\n            * (Math.PI - thighLocalAngleErrorL)\r\n            * (Math.PI - forwardErrorL)\r\n        ;\r\n\r\n\r\n        const confR = Math.min(\r\n            avg(normalized[24].visibility, normalized[26].visibility),\r\n            avg(normalized[26].visibility, normalized[28].visibility)\r\n        );\r\n        let thighZAngleErrorR = Infinity;\r\n        let calfZAngleErrorR = Infinity;\r\n        let kneeAngleErrorR = Infinity;\r\n        let kneeViewAngleErrorR = Infinity;\r\n        let thighLocalAngleErrorR = Infinity;\r\n        let forwardErrorR = Infinity;\r\n        if (confR >= LANDMARK_VISIBILITY_ACCEPTABLE_THRESHOLD) {\r\n            const hipView = rightHipView;\r\n            const kneeView = normalizedLandmarkToViewSpace(normalized[26].point, aspect);\r\n            const ankleView = normalizedLandmarkToViewSpace(normalized[28].point, aspect);\r\n            const thighViewNormal = getNormal(hipView, kneeView);\r\n            const calfViewNormal = getNormal(kneeView, ankleView);\r\n            const thighZAxisAngle = angleBetweenVec3(Z_AXIS, thighViewNormal);\r\n            const calfZAxisAngle = angleBetweenVec3(Z_AXIS, calfViewNormal);\r\n            thighZAngleErrorR = Math.abs(this.thighZAxisAngle - thighZAxisAngle);\r\n            calfZAngleErrorR = Math.abs(this.calfZAxisAngle - calfZAxisAngle);\r\n\r\n            const hip = world[24].point;\r\n            const knee = world[26].point;\r\n            const ankle = world[28].point;\r\n            const kneeAngle = getAngle(hip, knee, knee, ankle);\r\n            kneeAngleErrorR = Math.abs(this.kneeAngle - kneeAngle);\r\n\r\n            const kneeViewAngle = simplifyAngle(getAngle2D(kneeView, hipView, kneeView, ankleView)) - Math.PI;\r\n            kneeViewAngleErrorR = Math.abs(this.kneeViewAngle - kneeViewAngle * (this.isLeft ? -1 : 1));\r\n\r\n            const thighLocalDir = getNormalInLocalSpace(\r\n                world[23].point,\r\n                world[24].point,\r\n                world[24].point,\r\n                world[12].point,\r\n                world[24].point,\r\n                world[26].point,\r\n            );\r\n            thighLocalAngleErrorR = angleBetweenVec3(thighLocalDir, !this.isLeft ? this.thighLocalDir : this.thighLocalDirMirror);\r\n\r\n            forwardErrorR = angleBetweenVec3(trunkForwardView, !this.isLeft ? this.trunkForward : this.trunkForwardMirror);\r\n        }\r\n        const scoreR = (Math.PI - thighZAngleErrorR)\r\n            * (Math.PI - calfZAngleErrorR)\r\n            * (Math.PI - kneeAngleErrorR)\r\n            * (Math.PI * 2 - kneeViewAngleErrorR)\r\n            * (Math.PI - thighLocalAngleErrorR)\r\n            * (Math.PI - forwardErrorR)\r\n        ;\r\n\r\n        if (scoreL >= scoreR\r\n            && thighZAngleErrorL <= MAX_VIEW_ANGLE_ERROR\r\n            && calfZAngleErrorL <= MAX_VIEW_ANGLE_ERROR\r\n            && kneeAngleErrorL <= MAX_WORLD_SPACE_ANGLE_ERROR\r\n            && kneeViewAngleErrorL <= MAX_VIEW_ANGLE_ERROR\r\n            && thighLocalAngleErrorL <= MAX_WORLD_SPACE_ANGLE_ERROR\r\n        ) {\r\n            return {\r\n                score: scoreL,\r\n                center: normalized[25].point,\r\n                related: [normalized[23].point, normalized[27].point],\r\n                flip: !this.isLeft\r\n            };\r\n        } else if (\r\n            thighZAngleErrorR <= MAX_VIEW_ANGLE_ERROR\r\n            && calfZAngleErrorR <= MAX_VIEW_ANGLE_ERROR\r\n            && kneeAngleErrorR <= MAX_WORLD_SPACE_ANGLE_ERROR\r\n            && kneeViewAngleErrorR <= MAX_VIEW_ANGLE_ERROR\r\n            && thighLocalAngleErrorR <= MAX_WORLD_SPACE_ANGLE_ERROR\r\n        ) {\r\n            return {\r\n                score: scoreR,\r\n                center: normalized[26].point,\r\n                related: [normalized[24].point, normalized[28].point],\r\n                flip: this.isLeft\r\n            };\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n}","import SkeletonModel from '../../components/SkeletonModelCanvas/model/SkeletonModel';\r\nimport {LANDMARK_VISIBILITY_ACCEPTABLE_THRESHOLD} from '../../config';\r\nimport {angleBetweenVec3} from '../../utils/math/math';\r\nimport Photo from '../../utils/Photo';\r\nimport {avg, getAngle, getNormal, getNormalInLocalSpace} from './math';\r\nimport {MatchResult, PoseMatcher} from './search';\r\n\r\nconst MAX_WORLD_SPACE_ANGLE_ERROR = Math.PI / 180 * 60;\r\n\r\nexport default class MatchKneeCameraUnrelated implements PoseMatcher {\r\n\r\n    private isLeft: boolean;\r\n\r\n    private kneeAngle: number = 0;\r\n    private thighLocalDir: [number, number, number] = [0, 0, 0];\r\n    private thighLocalDirMirror: [number, number, number] = [0, 0, 0];\r\n    private calfLocalDir: [number, number, number] = [0, 0, 0];\r\n    private calfLocalDirMirror: [number, number, number] = [0, 0, 0];\r\n\r\n    constructor(isLeft: boolean) {\r\n        this.isLeft = isLeft;\r\n    }\r\n\r\n    prepare(model: SkeletonModel): void {\r\n        let hip = model.rightThigh.originWorldPosition;\r\n        let knee = model.rightThigh.controlPointWorldPosition;\r\n        let ankle = model.rightCalf.controlPointWorldPosition;\r\n        if (this.isLeft) {\r\n            hip = model.leftThigh.originWorldPosition;\r\n            knee = model.leftThigh.controlPointWorldPosition;\r\n            ankle = model.leftCalf.controlPointWorldPosition;\r\n        }\r\n        const thighNormal = getNormal(hip, knee);\r\n        const calfNormal = getNormal(knee, ankle);\r\n        this.kneeAngle = angleBetweenVec3(thighNormal, calfNormal);\r\n\r\n        if (this.isLeft) {\r\n            this.thighLocalDir = getNormalInLocalSpace(\r\n                model.rightThigh.originWorldPosition,\r\n                model.leftThigh.originWorldPosition,\r\n                model.trunk.originWorldPosition,\r\n                model.trunk.controlPointWorldPosition,\r\n                model.leftThigh.originWorldPosition,\r\n                model.leftThigh.controlPointWorldPosition,\r\n            );\r\n            this.thighLocalDirMirror = getNormalInLocalSpace(\r\n                model.rightThigh.originWorldPosition,\r\n                model.leftThigh.originWorldPosition,\r\n                model.trunk.originWorldPosition,\r\n                model.trunk.controlPointWorldPosition,\r\n                model.leftThigh.originWorldPosition,\r\n                model.leftThigh.controlPointWorldPosition,\r\n                true,\r\n            );\r\n\r\n            this.calfLocalDir = getNormalInLocalSpace(\r\n                model.rightThigh.originWorldPosition,\r\n                model.leftThigh.originWorldPosition,\r\n                model.leftThigh.controlPointWorldPosition,\r\n                model.leftThigh.originWorldPosition,\r\n                model.leftCalf.originWorldPosition,\r\n                model.leftCalf.controlPointWorldPosition,\r\n            );\r\n            this.calfLocalDirMirror = getNormalInLocalSpace(\r\n                model.rightThigh.originWorldPosition,\r\n                model.leftThigh.originWorldPosition,\r\n                model.leftThigh.controlPointWorldPosition,\r\n                model.leftThigh.originWorldPosition,\r\n                model.leftCalf.originWorldPosition,\r\n                model.leftCalf.controlPointWorldPosition,\r\n                true\r\n            );\r\n        } else {\r\n            this.thighLocalDir = getNormalInLocalSpace(\r\n                model.leftThigh.originWorldPosition,\r\n                model.rightThigh.originWorldPosition,\r\n                model.trunk.originWorldPosition,\r\n                model.trunk.controlPointWorldPosition,\r\n                model.rightThigh.originWorldPosition,\r\n                model.rightThigh.controlPointWorldPosition,\r\n            );\r\n            this.thighLocalDirMirror = getNormalInLocalSpace(\r\n                model.leftThigh.originWorldPosition,\r\n                model.rightThigh.originWorldPosition,\r\n                model.trunk.originWorldPosition,\r\n                model.trunk.controlPointWorldPosition,\r\n                model.rightThigh.originWorldPosition,\r\n                model.rightThigh.controlPointWorldPosition,\r\n                true,\r\n            );\r\n\r\n            this.calfLocalDir = getNormalInLocalSpace(\r\n                model.leftThigh.originWorldPosition,\r\n                model.rightThigh.originWorldPosition,\r\n                model.rightThigh.controlPointWorldPosition,\r\n                model.rightThigh.originWorldPosition,\r\n                model.rightCalf.originWorldPosition,\r\n                model.rightCalf.controlPointWorldPosition,\r\n            );\r\n            this.calfLocalDirMirror = getNormalInLocalSpace(\r\n                model.leftThigh.originWorldPosition,\r\n                model.rightThigh.originWorldPosition,\r\n                model.rightThigh.controlPointWorldPosition,\r\n                model.rightThigh.originWorldPosition,\r\n                model.rightCalf.originWorldPosition,\r\n                model.rightCalf.controlPointWorldPosition,\r\n                true\r\n            );\r\n        }\r\n    }\r\n\r\n    match(photo: Photo): MatchResult | null {\r\n        const world = photo.worldLandmarks;\r\n        const normalized = photo.normalizedLandmarks;\r\n\r\n        const confL = Math.min(\r\n            avg(world[23].visibility, world[25].visibility),\r\n            avg(world[25].visibility, world[27].visibility)\r\n        );\r\n        let kneeAngleErrorL = Infinity;\r\n        let thighLocalAngleErrorL = Infinity;\r\n        let calfLocalAngleErrorL = Infinity;\r\n        if (confL >= LANDMARK_VISIBILITY_ACCEPTABLE_THRESHOLD) {\r\n            const hip = world[23].point;\r\n            const knee = world[25].point;\r\n            const ankle = world[27].point;\r\n            const kneeAngle = getAngle(hip, knee, knee, ankle);\r\n            kneeAngleErrorL = Math.abs(this.kneeAngle - kneeAngle);\r\n\r\n            const thighLocalDir = getNormalInLocalSpace(\r\n                world[24].point,\r\n                world[23].point,\r\n                world[23].point,\r\n                world[11].point,\r\n                world[23].point,\r\n                world[25].point,\r\n            );\r\n            thighLocalAngleErrorL = angleBetweenVec3(thighLocalDir, this.isLeft ? this.thighLocalDir : this.thighLocalDirMirror);\r\n\r\n            const calfLocalDir = getNormalInLocalSpace(\r\n                world[24].point,\r\n                world[23].point,\r\n                world[25].point,\r\n                world[23].point,\r\n                world[25].point,\r\n                world[27].point,\r\n            );\r\n            calfLocalAngleErrorL = angleBetweenVec3(calfLocalDir, this.isLeft ? this.calfLocalDir : this.calfLocalDirMirror);\r\n        }\r\n        const scoreL = (Math.PI - kneeAngleErrorL) * (Math.PI - thighLocalAngleErrorL) * (Math.PI - calfLocalAngleErrorL);\r\n\r\n        const confR = Math.min(\r\n            avg(world[24].visibility, world[26].visibility),\r\n            avg(world[26].visibility, world[28].visibility)\r\n        );\r\n        let kneeAngleErrorR = Infinity;\r\n        let thighLocalAngleErrorR = Infinity;\r\n        let calfLocalAngleErrorR = Infinity;\r\n        if (confR >= LANDMARK_VISIBILITY_ACCEPTABLE_THRESHOLD) {\r\n            const hip = world[24].point;\r\n            const knee = world[26].point;\r\n            const ankle = world[28].point;\r\n            const kneeAngle = getAngle(hip, knee, knee, ankle);\r\n            kneeAngleErrorR = Math.abs(this.kneeAngle - kneeAngle);\r\n\r\n            const thighLocalDir = getNormalInLocalSpace(\r\n                world[23].point,\r\n                world[24].point,\r\n                world[24].point,\r\n                world[12].point,\r\n                world[24].point,\r\n                world[26].point,\r\n            );\r\n            thighLocalAngleErrorR = angleBetweenVec3(thighLocalDir, !this.isLeft ? this.thighLocalDir : this.thighLocalDirMirror);\r\n\r\n            const calfLocalDir = getNormalInLocalSpace(\r\n                world[23].point,\r\n                world[24].point,\r\n                world[26].point,\r\n                world[24].point,\r\n                world[26].point,\r\n                world[28].point,\r\n            );\r\n            calfLocalAngleErrorR = angleBetweenVec3(calfLocalDir, !this.isLeft ? this.calfLocalDir : this.calfLocalDirMirror);\r\n        }\r\n        const scoreR = (Math.PI - kneeAngleErrorR) * (Math.PI - thighLocalAngleErrorR) * (Math.PI - calfLocalAngleErrorR);\r\n\r\n        if (scoreL >= scoreR\r\n            && kneeAngleErrorL <= MAX_WORLD_SPACE_ANGLE_ERROR\r\n            && thighLocalAngleErrorL <= MAX_WORLD_SPACE_ANGLE_ERROR\r\n            && calfLocalAngleErrorL <= MAX_WORLD_SPACE_ANGLE_ERROR\r\n        ) {\r\n            return {\r\n                score: scoreL,\r\n                center: normalized[25].point,\r\n                related: [normalized[23].point, normalized[27].point],\r\n                flip: !this.isLeft\r\n            };\r\n        } else if (\r\n            kneeAngleErrorR <= MAX_WORLD_SPACE_ANGLE_ERROR\r\n            && thighLocalAngleErrorR <= MAX_WORLD_SPACE_ANGLE_ERROR\r\n            && calfLocalAngleErrorR <= MAX_WORLD_SPACE_ANGLE_ERROR\r\n        ) {\r\n            return {\r\n                score: scoreR,\r\n                center: normalized[26].point,\r\n                related: [normalized[24].point, normalized[28].point],\r\n                flip: this.isLeft\r\n            };\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n}","import SkeletonModel from '../../components/SkeletonModelCanvas/model/SkeletonModel';\r\nimport {LANDMARK_VISIBILITY_ACCEPTABLE_THRESHOLD} from '../../config';\r\nimport {angleBetweenVec3} from '../../utils/math/math';\r\nimport Photo from '../../utils/Photo';\r\nimport {avg, flipX, getNormal, getNormalInLocalSpace, mid, normalizedLandmarkToViewSpace} from './math';\r\nimport {MatchResult, PoseMatcher} from './search';\r\n\r\nconst MAX_WORLD_SPACE_ANGLE_ERROR = Math.PI / 180 * 45;\r\nconst MAX_VIEW_SPACE_ANGLE_ERROR = Math.PI / 180 * 45;\r\n\r\nexport default class MatchShoulder implements PoseMatcher {\r\n\r\n    private isLeft: boolean;\r\n\r\n    private shoulderLocalDir: [number, number, number] = [0, 0, 0];\r\n    private shoulderLocalDirMirror: [number, number, number] = [0, 0, 0];\r\n\r\n    private trunkViewUp: [number, number, number] = [0, 0, 0];\r\n    private trunkViewRight: [number, number, number] = [0, 0, 0];\r\n    private trunkViewUpMirror: [number, number, number] = [0, 0, 0];\r\n    private trunkViewRightMirror: [number, number, number] = [0, 0, 0];\r\n\r\n    constructor(isLeft: boolean) {\r\n        this.isLeft = isLeft;\r\n    }\r\n\r\n    prepare(model: SkeletonModel) {\r\n        this.trunkViewUp = getNormal(\r\n            mid(model.leftThigh.originViewPosition, model.rightThigh.originViewPosition),\r\n            mid(model.leftUpperArm.originViewPosition, model.rightUpperArm.originViewPosition)\r\n        );\r\n        this.trunkViewUpMirror = getNormal(\r\n            flipX(mid(model.leftThigh.originViewPosition, model.rightThigh.originViewPosition)),\r\n            flipX(mid(model.leftUpperArm.originViewPosition, model.rightUpperArm.originViewPosition))\r\n        );\r\n        this.trunkViewRight = getNormal(model.rightUpperArm.originViewPosition, model.leftUpperArm.originViewPosition);\r\n        this.trunkViewRightMirror = getNormal(flipX(model.leftUpperArm.originViewPosition), flipX(model.rightUpperArm.originViewPosition));\r\n        if (this.isLeft) {\r\n            this.shoulderLocalDir = getNormalInLocalSpace(\r\n                model.rightUpperArm.originWorldPosition,\r\n                model.leftUpperArm.originWorldPosition,\r\n                model.trunk.originWorldPosition,\r\n                model.trunk.controlPointWorldPosition,\r\n                model.leftUpperArm.originWorldPosition,\r\n                model.leftUpperArm.controlPointWorldPosition,\r\n            );\r\n            this.shoulderLocalDirMirror = getNormalInLocalSpace(\r\n                model.rightUpperArm.originWorldPosition,\r\n                model.leftUpperArm.originWorldPosition,\r\n                model.trunk.originWorldPosition,\r\n                model.trunk.controlPointWorldPosition,\r\n                model.leftUpperArm.originWorldPosition,\r\n                model.leftUpperArm.controlPointWorldPosition,\r\n                true,\r\n            );\r\n        } else {\r\n            this.shoulderLocalDir = getNormalInLocalSpace(\r\n                model.leftUpperArm.originWorldPosition,\r\n                model.rightUpperArm.originWorldPosition,\r\n                model.trunk.originWorldPosition,\r\n                model.trunk.controlPointWorldPosition,\r\n                model.rightUpperArm.originWorldPosition,\r\n                model.rightUpperArm.controlPointWorldPosition,\r\n            );\r\n            this.shoulderLocalDirMirror = getNormalInLocalSpace(\r\n                model.leftUpperArm.originWorldPosition,\r\n                model.rightUpperArm.originWorldPosition,\r\n                model.trunk.originWorldPosition,\r\n                model.trunk.controlPointWorldPosition,\r\n                model.rightUpperArm.originWorldPosition,\r\n                model.rightUpperArm.controlPointWorldPosition,\r\n                true,\r\n            );\r\n        }\r\n    }\r\n\r\n    match(photo: Photo): MatchResult | null {\r\n        const world = photo.worldLandmarks;\r\n        const normalized = photo.normalizedLandmarks;\r\n        const aspect = photo.width / photo.height;\r\n\r\n        const leftShoulderView = normalizedLandmarkToViewSpace(normalized[11].point, aspect);\r\n        const rightShoulderView = normalizedLandmarkToViewSpace(normalized[12].point, aspect);\r\n        const leftHipView = normalizedLandmarkToViewSpace(normalized[23].point, aspect);\r\n        const rightHipView = normalizedLandmarkToViewSpace(normalized[24].point, aspect);\r\n        const trunkUpView = getNormal(mid(leftHipView, rightHipView), mid(leftShoulderView, rightShoulderView));\r\n        const trunkRightView = getNormal(rightShoulderView, leftShoulderView);\r\n\r\n        const confL = Math.min(\r\n            avg(world[12].visibility, world[11].visibility, world[23].visibility),\r\n            avg(world[11].visibility, world[13].visibility)\r\n        );\r\n        let errorL = Infinity;\r\n        let viewError1L = Infinity;\r\n        let viewError2L = Infinity;\r\n        if (confL >= LANDMARK_VISIBILITY_ACCEPTABLE_THRESHOLD) {\r\n            const dirL = getNormalInLocalSpace(\r\n                world[12].point,\r\n                world[11].point,\r\n                world[23].point,\r\n                world[11].point,\r\n                world[11].point,\r\n                world[13].point,\r\n            );\r\n            errorL = angleBetweenVec3(dirL, this.isLeft ? this.shoulderLocalDir : this.shoulderLocalDirMirror);\r\n            viewError1L = angleBetweenVec3(trunkUpView, this.isLeft ? this.trunkViewUp : this.trunkViewUpMirror);\r\n            viewError2L = angleBetweenVec3(trunkRightView, this.isLeft ? this.trunkViewRight : this.trunkViewRightMirror);\r\n        }\r\n\r\n        const confR = Math.min(\r\n            avg(world[11].visibility, world[12].visibility, world[24].visibility),\r\n            avg(world[12].visibility, world[14].visibility)\r\n        );\r\n        let errorR = Infinity;\r\n        let viewError1R = Infinity;\r\n        let viewError2R = Infinity;\r\n        if (confR >= LANDMARK_VISIBILITY_ACCEPTABLE_THRESHOLD) {\r\n            const dirR = getNormalInLocalSpace(\r\n                world[11].point,\r\n                world[12].point,\r\n                world[24].point,\r\n                world[12].point,\r\n                world[12].point,\r\n                world[14].point,\r\n            );\r\n            errorR = angleBetweenVec3(dirR, !this.isLeft ? this.shoulderLocalDir : this.shoulderLocalDirMirror);\r\n            viewError1R = angleBetweenVec3(trunkUpView, this.isLeft ? this.trunkViewUpMirror : this.trunkViewUp);\r\n            viewError2R = angleBetweenVec3(trunkRightView, this.isLeft ? this.trunkViewRightMirror : this.trunkViewRight);\r\n        }\r\n\r\n        if (\r\n            errorL < errorR\r\n            && errorL <= MAX_WORLD_SPACE_ANGLE_ERROR\r\n            && viewError1L <= MAX_VIEW_SPACE_ANGLE_ERROR\r\n            && viewError2L <= MAX_VIEW_SPACE_ANGLE_ERROR\r\n        ) {\r\n            return {\r\n                score: (Math.PI - errorL) * (Math.PI - viewError1L) * (Math.PI - viewError2L),\r\n                center: normalized[11].point,\r\n                related: [normalized[12].point, normalized[13].point, mid(normalized[23].point, normalized[11].point)],\r\n                flip: !this.isLeft\r\n            };\r\n        } else if (\r\n            errorR <= MAX_WORLD_SPACE_ANGLE_ERROR\r\n            && viewError1R <= MAX_VIEW_SPACE_ANGLE_ERROR\r\n            && viewError2R <= MAX_VIEW_SPACE_ANGLE_ERROR\r\n        ) {\r\n            return {\r\n                score: (Math.PI - errorR) * (Math.PI - viewError1R) * (Math.PI - viewError2R),\r\n                center: normalized[12].point,\r\n                related: [normalized[11].point, normalized[14].point, mid(normalized[24].point, normalized[12].point)],\r\n                flip: this.isLeft\r\n            };\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n}","import SkeletonModel from '../../components/SkeletonModelCanvas/model/SkeletonModel';\r\nimport {LANDMARK_VISIBILITY_ACCEPTABLE_THRESHOLD} from '../../config';\r\nimport {angleBetweenVec3} from '../../utils/math/math';\r\nimport Photo from '../../utils/Photo';\r\nimport {avg, getNormal, getNormalInLocalSpace, mid, normalizedLandmarkToViewSpace} from './math';\r\nimport {MatchResult, PoseMatcher} from './search';\r\n\r\nconst MAX_WORLD_SPACE_ANGLE_ERROR = Math.PI / 180 * 45;\r\n\r\nexport default class MatchShoulderCameraUnrelated implements PoseMatcher {\r\n\r\n    private isLeft: boolean;\r\n\r\n    private shoulderLocalDir: [number, number, number] = [0, 0, 0];\r\n    private shoulderLocalDirMirror: [number, number, number] = [0, 0, 0];\r\n\r\n    constructor(isLeft: boolean) {\r\n        this.isLeft = isLeft;\r\n    }\r\n\r\n    prepare(model: SkeletonModel) {\r\n        if (this.isLeft) {\r\n            this.shoulderLocalDir = getNormalInLocalSpace(\r\n                model.rightUpperArm.originWorldPosition,\r\n                model.leftUpperArm.originWorldPosition,\r\n                model.trunk.originWorldPosition,\r\n                model.trunk.controlPointWorldPosition,\r\n                model.leftUpperArm.originWorldPosition,\r\n                model.leftUpperArm.controlPointWorldPosition,\r\n            );\r\n            this.shoulderLocalDirMirror = getNormalInLocalSpace(\r\n                model.rightUpperArm.originWorldPosition,\r\n                model.leftUpperArm.originWorldPosition,\r\n                model.trunk.originWorldPosition,\r\n                model.trunk.controlPointWorldPosition,\r\n                model.leftUpperArm.originWorldPosition,\r\n                model.leftUpperArm.controlPointWorldPosition,\r\n                true,\r\n            );\r\n        } else {\r\n            this.shoulderLocalDir = getNormalInLocalSpace(\r\n                model.leftUpperArm.originWorldPosition,\r\n                model.rightUpperArm.originWorldPosition,\r\n                model.trunk.originWorldPosition,\r\n                model.trunk.controlPointWorldPosition,\r\n                model.rightUpperArm.originWorldPosition,\r\n                model.rightUpperArm.controlPointWorldPosition,\r\n            );\r\n            this.shoulderLocalDirMirror = getNormalInLocalSpace(\r\n                model.leftUpperArm.originWorldPosition,\r\n                model.rightUpperArm.originWorldPosition,\r\n                model.trunk.originWorldPosition,\r\n                model.trunk.controlPointWorldPosition,\r\n                model.rightUpperArm.originWorldPosition,\r\n                model.rightUpperArm.controlPointWorldPosition,\r\n                true,\r\n            );\r\n        }\r\n    }\r\n\r\n    match(photo: Photo): MatchResult | null {\r\n        const world = photo.worldLandmarks;\r\n        const normalized = photo.normalizedLandmarks;\r\n        const aspect = photo.width / photo.height;\r\n\r\n        const leftShoulderView = normalizedLandmarkToViewSpace(normalized[11].point, aspect);\r\n        const rightShoulderView = normalizedLandmarkToViewSpace(normalized[12].point, aspect);\r\n        const leftHipView = normalizedLandmarkToViewSpace(normalized[23].point, aspect);\r\n        const rightHipView = normalizedLandmarkToViewSpace(normalized[24].point, aspect);\r\n        const trunkUpView = getNormal(mid(leftHipView, rightHipView), mid(leftShoulderView, rightShoulderView));\r\n        const trunkRightView = getNormal(rightShoulderView, leftShoulderView);\r\n\r\n        const confL = Math.min(\r\n            avg(world[12].visibility, world[11].visibility, world[23].visibility),\r\n            avg(world[11].visibility, world[13].visibility)\r\n        );\r\n        let errorL = Infinity;\r\n        if (confL >= LANDMARK_VISIBILITY_ACCEPTABLE_THRESHOLD) {\r\n            const dirL = getNormalInLocalSpace(\r\n                world[12].point,\r\n                world[11].point,\r\n                world[23].point,\r\n                world[11].point,\r\n                world[11].point,\r\n                world[13].point,\r\n            );\r\n            errorL = angleBetweenVec3(dirL, this.isLeft ? this.shoulderLocalDir : this.shoulderLocalDirMirror);\r\n        }\r\n\r\n        const confR = Math.min(\r\n            avg(world[11].visibility, world[12].visibility, world[24].visibility),\r\n            avg(world[12].visibility, world[14].visibility)\r\n        );\r\n        let errorR = Infinity;\r\n        if (confR >= LANDMARK_VISIBILITY_ACCEPTABLE_THRESHOLD) {\r\n            const dirR = getNormalInLocalSpace(\r\n                world[11].point,\r\n                world[12].point,\r\n                world[24].point,\r\n                world[12].point,\r\n                world[12].point,\r\n                world[14].point,\r\n            );\r\n            errorR = angleBetweenVec3(dirR, !this.isLeft ? this.shoulderLocalDir : this.shoulderLocalDirMirror);\r\n        }\r\n\r\n        if (\r\n            errorL < errorR\r\n            && errorL <= MAX_WORLD_SPACE_ANGLE_ERROR\r\n        ) {\r\n            return {\r\n                score: Math.PI - errorL,\r\n                center: normalized[11].point,\r\n                related: [normalized[12].point, normalized[13].point, mid(normalized[23].point, normalized[11].point)],\r\n                flip: !this.isLeft\r\n            };\r\n        } else if (\r\n            errorR <= MAX_WORLD_SPACE_ANGLE_ERROR\r\n        ) {\r\n            return {\r\n                score: Math.PI - errorR,\r\n                center: normalized[12].point,\r\n                related: [normalized[11].point, normalized[14].point, mid(normalized[24].point, normalized[12].point)],\r\n                flip: this.isLeft\r\n            };\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n}","import SkeletonModel from '../../components/SkeletonModelCanvas/model/SkeletonModel';\r\nimport Photo from '../../utils/Photo';\r\n\r\nexport type MatchResult = {\r\n    score: number;\r\n    /** Search result thumbs center */\r\n    center: [number, number, number],\r\n    /** Affect search result thumbs */\r\n    related: [number, number, number][],\r\n    flip: boolean;\r\n};\r\n\r\nexport interface PoseMatcher {\r\n    prepare(model: SkeletonModel): void;\r\n\r\n    match(photo: Photo): MatchResult | null;\r\n}\r\n\r\nexport type SearchResult = {\r\n    score: number;\r\n    center: [number, number, number],\r\n    related: [number, number, number][],\r\n    flip: boolean;\r\n    photo: Photo;\r\n};\r\n\r\nexport function filterAndSort(photos: Photo[], model: SkeletonModel, matcher: PoseMatcher): SearchResult[] {\r\n    const ret: SearchResult[] = [];\r\n    matcher.prepare(model);\r\n    photos.forEach(photo => {\r\n        const matchResult = matcher.match(photo);\r\n        if (matchResult != null) {\r\n            ret.push({\r\n                ...matchResult,\r\n                photo\r\n            });\r\n        }\r\n    });\r\n    ret.sort((a, b) => -a.score + b.score);\r\n    return ret;\r\n}","import {WarningOutlined} from '@vicons/antd';\r\nimport {NButton, NIcon, NRadio, NRadioGroup, NSelect} from 'naive-ui';\r\nimport {defineComponent, nextTick, onMounted, ref} from 'vue';\r\nimport ImageClip from '../components/ImageClip/ImageClip.vue';\r\nimport ImageViewer from '../components/ImageViewer/ImageViewer.vue';\r\nimport {BodyPart} from '../components/SkeletonModelCanvas/model/BodyPart';\r\nimport SkeletonModel from '../components/SkeletonModelCanvas/model/SkeletonModel';\r\nimport SkeletonModelCanvas from '../components/SkeletonModelCanvas/SkeletonModelCanvas.vue';\r\nimport {MAX_NUM_OF_SEARCH_RESULTS} from '../config';\r\nimport {isMouseSupported, isWebGL2Supported} from '../utils/browser-support';\r\nimport DraggableCamera from '../utils/DraggableCamera';\r\nimport Photo from '../utils/Photo';\r\nimport PhotoDataset from '../utils/PhotoDataset';\r\nimport MatchChest from './impl/MatchChest';\r\nimport MatchCrotch from './impl/MatchCrotch';\r\nimport MatchElbow from './impl/MatchElbow';\r\nimport MatchElbowCameraUnrelated from './impl/MatchElbowCameraUnrelated';\r\nimport MatchFace from './impl/MatchFace';\r\nimport MatchHip from './impl/MatchHip';\r\nimport MatchHipCameraUnrelated from './impl/MatchHipCameraUnrelated';\r\nimport MatchKnee from './impl/MatchKnee';\r\nimport MatchKneeCameraUnrelated from './impl/MatchKneeCameraUnrelated';\r\nimport MatchShoulder from './impl/MatchShoulder';\r\nimport MatchShoulderCameraUnrelated from './impl/MatchShoulderCameraUnrelated';\r\nimport {filterAndSort, PoseMatcher, SearchResult} from './impl/search';\r\n\r\nconst matchers: {\r\n    [name: string]: {\r\n        matcher: PoseMatcher,\r\n        cameraUnrelatedMatcher?: PoseMatcher,\r\n        highlights: BodyPart[],\r\n    }\r\n} = {\r\n    'Face': {\r\n        matcher: new MatchFace(),\r\n        highlights: [BodyPart.head]\r\n    },\r\n    'Chest': {\r\n        matcher: new MatchChest(),\r\n        highlights: [BodyPart.trunk]\r\n    },\r\n    'Left Shoulder': {\r\n        matcher: new MatchShoulder(true),\r\n        cameraUnrelatedMatcher: new MatchShoulderCameraUnrelated(true),\r\n        highlights: [BodyPart.trunk, BodyPart.leftUpperArm]\r\n    },\r\n    'Right Shoulder': {\r\n        matcher: new MatchShoulder(false),\r\n        cameraUnrelatedMatcher: new MatchShoulderCameraUnrelated(false),\r\n        highlights: [BodyPart.trunk, BodyPart.rightUpperArm]\r\n    },\r\n    'Left Elbow': {\r\n        matcher: new MatchElbow(true),\r\n        cameraUnrelatedMatcher: new MatchElbowCameraUnrelated(true),\r\n        highlights: [BodyPart.leftUpperArm, BodyPart.leftLowerArm]\r\n    },\r\n    'Right Elbow': {\r\n        matcher: new MatchElbow(false),\r\n        cameraUnrelatedMatcher: new MatchElbowCameraUnrelated(false),\r\n        highlights: [BodyPart.rightUpperArm, BodyPart.rightLowerArm]\r\n    },\r\n    'Crotch': {\r\n        matcher: new MatchCrotch(),\r\n        highlights: [BodyPart.trunk]\r\n    },\r\n    'Left Hip': {\r\n        matcher: new MatchHip(true),\r\n        cameraUnrelatedMatcher: new MatchHipCameraUnrelated(true),\r\n        highlights: [BodyPart.trunk, BodyPart.leftThigh]\r\n    },\r\n    'Right Hip': {\r\n        matcher: new MatchHip(false),\r\n        cameraUnrelatedMatcher: new MatchHipCameraUnrelated(false),\r\n        highlights: [BodyPart.trunk, BodyPart.rightThigh]\r\n    },\r\n    'Left Knee': {\r\n        matcher: new MatchKnee(true),\r\n        cameraUnrelatedMatcher: new MatchKneeCameraUnrelated(true),\r\n        highlights: [BodyPart.leftThigh, BodyPart.leftCalf]\r\n    },\r\n    'Right Knee': {\r\n        matcher: new MatchKnee(false),\r\n        cameraUnrelatedMatcher: new MatchKneeCameraUnrelated(false),\r\n        highlights: [BodyPart.rightThigh, BodyPart.rightCalf]\r\n    },\r\n};\r\n\r\nexport default defineComponent({\r\n    components: {\r\n        NButton,\r\n        NSelect,\r\n        NRadio,\r\n        NRadioGroup,\r\n        NIcon,\r\n\r\n        WarningOutlined,\r\n\r\n        SkeletonModelCanvas,\r\n        ImageClip,\r\n        ImageViewer,\r\n    },\r\n    setup() {\r\n        const supportWebGL2 = isWebGL2Supported();\r\n        const supportMouse = isMouseSupported();\r\n\r\n        const dataset = new PhotoDataset();\r\n        const model = new SkeletonModel();\r\n        const camera = new DraggableCamera();\r\n\r\n        const searchResultDom = ref<HTMLElement>();\r\n\r\n        const dbLoading = ref(false);\r\n        const bodyPartOptions = Object.keys(matchers).map(option => ({value: option, label: option}));\r\n        const bodyPart = ref<string>();\r\n        const gender = ref(0);\r\n        const cameraRelated = ref(1);\r\n\r\n        const searching = ref(false);\r\n        const searchResult = ref<SearchResult[]>();\r\n\r\n        const showImageViewer = ref(false);\r\n        const imageViewerFlip = ref(false);\r\n        const currentPhoto = ref<Photo>(new Photo());\r\n\r\n        onMounted(async function () {\r\n            try {\r\n                dbLoading.value = true;\r\n                await nextTick();\r\n                await dataset.load();\r\n            } finally {\r\n                dbLoading.value = false;\r\n            }\r\n        });\r\n\r\n        async function search() {\r\n            try {\r\n                searching.value = true;\r\n                searchResult.value = [];\r\n                await nextTick();\r\n                const bodyPartMatchers = matchers[bodyPart.value!];\r\n                if (bodyPartMatchers) {\r\n                    let list = dataset.data;\r\n                    if (gender.value) {\r\n                        list = list.filter(photo => photo.gender === gender.value);\r\n                    }\r\n                    const matcher = !cameraRelated.value && bodyPartMatchers.cameraUnrelatedMatcher ?\r\n                        bodyPartMatchers.cameraUnrelatedMatcher\r\n                        : bodyPartMatchers.matcher;\r\n                    searchResult.value = filterAndSort(list, model, matcher).slice(0, MAX_NUM_OF_SEARCH_RESULTS);\r\n                    searchResultDom.value!.scrollTop = 0;\r\n                }\r\n            } finally {\r\n                searching.value = false;\r\n            }\r\n        }\r\n\r\n        function showLargePhoto(item: SearchResult) {\r\n            showImageViewer.value = true;\r\n            imageViewerFlip.value = item.flip;\r\n            currentPhoto.value = item.photo;\r\n        }\r\n\r\n        return {\r\n            supportWebGL2,\r\n            supportMouse,\r\n\r\n            matchers,\r\n            model,\r\n            camera,\r\n\r\n            searchResultDom,\r\n\r\n            dbLoading,\r\n            bodyPartOptions,\r\n            bodyPart,\r\n            gender,\r\n            cameraRelated,\r\n\r\n            searchResult,\r\n            searching,\r\n\r\n            showImageViewer,\r\n            imageViewerFlip,\r\n            currentPhoto,\r\n\r\n            search,\r\n            showLargePhoto,\r\n        };\r\n    }\r\n});"],"names":["_hoisted_1","_hoisted_2","_createVNode","_hoisted_3","_openBlock","_createBlock","style","CloseIcon","c","self","commonVars","emptyLight","useLocale","scrollbarLight","CheckmarkIcon","commonVariables","internalSelectMenuLight","getPadding","NInternalLoading","VirtualList","NFocusDetector","tagLight","internalSelectionLight","Suffix","selectLight","useIsMounted","flatten","vec3.create","quat.create","vec3.transformQuat","vec3.sub","MAX_VIEW_SPACE_ANGLE_ERROR","MAX_VIEW_ANGLE_ERROR","MAX_WORLD_SPACE_ANGLE_ERROR","Z_AXIS"],"mappings":"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"}