{"version":3,"file":"Search.02161c60.js","sources":["../../node_modules/@vicons/antd/es/InfoCircleOutlined.js","../../node_modules/@vicons/antd/es/SearchOutlined.js","../../node_modules/@vicons/antd/es/UndoOutlined.js","../../node_modules/@vicons/antd/es/WarningOutlined.js","../../node_modules/seemly/es/animation/next-frame-once.js","../../node_modules/seemly/es/dom/happens-in.js","../../node_modules/vooks/es/use-false-until-truthy.js","../../node_modules/vooks/es/utils.js","../../node_modules/vooks/es/on-fonts-ready.js","../../node_modules/vooks/es/use-is-ios.js","../../node_modules/naive-ui/es/_utils/vue/keep.js","../../node_modules/naive-ui/es/_utils/vue/omit.js","../../node_modules/naive-ui/es/_utils/vue/flatten.js","../../node_modules/naive-ui/es/_utils/vue/keysOf.js","../../node_modules/naive-ui/es/_utils/vue/render.js","../../node_modules/naive-ui/es/_utils/naive/attribute.js","../../node_modules/naive-ui/es/_utils/vue/get-first-slot-vnode.js","../../node_modules/naive-ui/es/modal/src/interface.js","../../node_modules/naive-ui/es/drawer/src/interface.js","../../node_modules/naive-ui/es/popover/src/interface.js","../../node_modules/naive-ui/es/_internal/select-menu/src/interface.js","../../node_modules/naive-ui/es/_utils/composable/use-adjusted-to.js","../../node_modules/naive-ui/es/_internal/icons/Checkmark.js","../../node_modules/naive-ui/es/_internal/icons/Close.js","../../node_modules/naive-ui/es/_internal/icons/Empty.js","../../node_modules/naive-ui/es/_internal/close/src/styles/index.cssr.js","../../node_modules/naive-ui/es/_internal/close/src/Close.js","../../node_modules/naive-ui/es/_internal/focus-detector/src/FocusDetector.js","../../node_modules/treemate/es/utils.js","../../node_modules/treemate/es/check.js","../../node_modules/treemate/es/path.js","../../node_modules/treemate/es/move.js","../../node_modules/treemate/es/flatten.js","../../node_modules/treemate/es/contains.js","../../node_modules/treemate/es/create.js","../../node_modules/vueuc/es/shared/v-node.js","../../node_modules/vueuc/es/binder/src/utils.js","../../node_modules/vueuc/es/binder/src/Binder.js","../../node_modules/vueuc/es/binder/src/Target.js","../../node_modules/vdirs/es/mousemoveoutside.js","../../node_modules/vdirs/es/clickoutside.js","../../node_modules/vdirs/es/utils.js","../../node_modules/vdirs/es/zindexable/z-index-manager.js","../../node_modules/vdirs/es/zindexable/index.js","../../node_modules/vueuc/es/shared/cssr.js","../../node_modules/vueuc/es/shared/finweck-tree.js","../../node_modules/vueuc/es/lazy-teleport/src/index.js","../../node_modules/vueuc/es/binder/src/get-placement-style.js","../../node_modules/vueuc/es/binder/src/Follower.js","../../node_modules/vueuc/es/virtual-list/src/VirtualList.js","../../node_modules/vueuc/es/overflow/src/index.js","../../node_modules/naive-ui/es/empty/styles/_common.js","../../node_modules/naive-ui/es/empty/styles/light.js","../../node_modules/naive-ui/es/empty/src/styles/index.cssr.js","../../node_modules/naive-ui/es/empty/src/Empty.js","../../node_modules/naive-ui/es/_internal/scrollbar/styles/light.js","../../node_modules/naive-ui/es/_internal/scrollbar/src/styles/index.cssr.js","../../node_modules/naive-ui/es/_internal/scrollbar/src/ScrollBar.js","../../node_modules/naive-ui/es/_internal/select-menu/src/SelectOption.js","../../node_modules/naive-ui/es/_internal/select-menu/src/SelectGroupHeader.js","../../node_modules/naive-ui/es/_styles/transitions/fade-in-scale-up.cssr.js","../../node_modules/naive-ui/es/_internal/select-menu/src/styles/index.cssr.js","../../node_modules/naive-ui/es/_internal/select-menu/styles/_common.js","../../node_modules/naive-ui/es/_internal/select-menu/styles/light.js","../../node_modules/naive-ui/es/_internal/select-menu/src/SelectMenu.js","../../node_modules/naive-ui/es/popover/styles/_common.js","../../node_modules/naive-ui/es/popover/styles/light.js","../../node_modules/naive-ui/es/popover/src/styles/index.cssr.js","../../node_modules/naive-ui/es/popover/src/PopoverBody.js","../../node_modules/naive-ui/es/popover/src/Popover.js","../../node_modules/naive-ui/es/tag/styles/_common.js","../../node_modules/naive-ui/es/tag/styles/light.js","../../node_modules/naive-ui/es/tag/src/common-props.js","../../node_modules/naive-ui/es/tag/src/styles/index.cssr.js","../../node_modules/naive-ui/es/tag/src/Tag.js","../../node_modules/naive-ui/es/_internal/selection/styles/_common.js","../../node_modules/naive-ui/es/_internal/selection/styles/light.js","../../node_modules/naive-ui/es/_internal/selection/src/styles/index.cssr.js","../../node_modules/naive-ui/es/_internal/selection/src/Selection.js","../../node_modules/naive-ui/es/select/src/utils.js","../../node_modules/naive-ui/es/select/styles/light.js","../../node_modules/naive-ui/es/select/src/styles/index.cssr.js","../../node_modules/naive-ui/es/select/src/Select.js","../../node_modules/naive-ui/es/icon/styles/light.js","../../node_modules/naive-ui/es/icon/src/styles/index.cssr.js","../../node_modules/naive-ui/es/icon/src/Icon.js","../../node_modules/naive-ui/es/popconfirm/styles/_common.js","../../node_modules/naive-ui/es/popconfirm/styles/light.js","../../node_modules/naive-ui/es/popconfirm/src/interface.js","../../node_modules/naive-ui/es/popconfirm/src/PopconfirmPanel.js","../../node_modules/naive-ui/es/popconfirm/src/styles/index.cssr.js","../../node_modules/naive-ui/es/popconfirm/src/Popconfirm.js","../../src/component/SkeletonModelCanvas/model/BodyPart.ts","../../src/component/SkeletonModelCanvas/ObjLoader.ts","../../src/utils/render/Geometry.ts","../../src/component/SkeletonModelCanvas/model/SkeletonModelNode.ts","../../src/component/SkeletonModelCanvas/model/SkeletonModel.ts","../../src/utils/math/raycast.ts","../../src/utils/input/mouse-drag.ts","../../src/utils/render/camera/OrthographicCamera.ts","../../src/utils/render/camera/PerspectiveCamera.ts","../../src/utils/DraggableCamera.ts","../../src/utils/input/MouseButton.ts","../../src/utils/input/Input.ts","../../src/utils/math/intersect.ts","../../src/utils/render/constants.ts","../../src/utils/render/FrameBuffer.ts","../../src/utils/render/Texture.ts","../../src/utils/render/get-uniform-setter.ts","../../src/utils/render/Shader.ts","../../src/utils/render/Renderer.ts","../../src/component/SkeletonModelCanvas/draw-shape.ts","../../src/component/SkeletonModelCanvas/landmarks-to-transforms.ts","../../src/component/SkeletonModelCanvas/SkeletonModelCanvas.ts?vue&type=script&src&lang.ts","../../src/utils/browser-support.ts","../../src/Search/impl/DataLoader.ts","../../src/Search/impl/matcher/ChestMatcher.ts","../../src/Search/impl/matcher/CrotchMatcher.ts","../../src/Search/impl/matcher/ElbowMatcher.ts","../../src/Search/impl/matcher/FaceMatcher.ts","../../src/Search/impl/matcher/HipMatcher.ts","../../src/Search/impl/matcher/KneeMatcher.ts","../../src/Search/impl/matcher/ShoulderMatcher.ts","../../src/Search/impl/search.ts","../../src/Search/Search.ts?vue&type=script&src&lang.ts"],"sourcesContent":["import { createVNode as _createVNode, openBlock as _openBlock, createBlock as _createBlock, defineComponent } from 'vue'\nconst _hoisted_1 = {\n  xmlns: 'http://www.w3.org/2000/svg',\n  'xmlns:xlink': 'http://www.w3.org/1999/xlink',\n  viewBox: '0 0 1024 1024'\n}\nconst _hoisted_2 = /*#__PURE__*/ _createVNode(\n  'path',\n  {\n    d: 'M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448s448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372s372 166.6 372 372s-166.6 372-372 372z',\n    fill: 'currentColor'\n  },\n  null,\n  -1\n  /* HOISTED */\n)\nconst _hoisted_3 = /*#__PURE__*/ _createVNode(\n  'path',\n  {\n    d: 'M464 336a48 48 0 1 0 96 0a48 48 0 1 0-96 0zm72 112h-48c-4.4 0-8 3.6-8 8v272c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V456c0-4.4-3.6-8-8-8z',\n    fill: 'currentColor'\n  },\n  null,\n  -1\n  /* HOISTED */\n)\nexport default defineComponent({\n  name: 'InfoCircleOutlined',\n  render: function render(_ctx, _cache) {\n    return _openBlock(), _createBlock('svg', _hoisted_1, [_hoisted_2, _hoisted_3])\n  }\n})\n","import { createVNode as _createVNode, openBlock as _openBlock, createBlock as _createBlock, defineComponent } from 'vue'\nconst _hoisted_1 = {\n  xmlns: 'http://www.w3.org/2000/svg',\n  'xmlns:xlink': 'http://www.w3.org/1999/xlink',\n  viewBox: '0 0 1024 1024'\n}\nconst _hoisted_2 = /*#__PURE__*/ _createVNode(\n  'path',\n  {\n    d: 'M909.6 854.5L649.9 594.8C690.2 542.7 712 479 712 412c0-80.2-31.3-155.4-87.9-212.1c-56.6-56.7-132-87.9-212.1-87.9s-155.5 31.3-212.1 87.9C143.2 256.5 112 331.8 112 412c0 80.1 31.3 155.5 87.9 212.1C256.5 680.8 331.8 712 412 712c67 0 130.6-21.8 182.7-62l259.7 259.6a8.2 8.2 0 0 0 11.6 0l43.6-43.5a8.2 8.2 0 0 0 0-11.6zM570.4 570.4C528 612.7 471.8 636 412 636s-116-23.3-158.4-65.6C211.3 528 188 471.8 188 412s23.3-116.1 65.6-158.4C296 211.3 352.2 188 412 188s116.1 23.2 158.4 65.6S636 352.2 636 412s-23.3 116.1-65.6 158.4z',\n    fill: 'currentColor'\n  },\n  null,\n  -1\n  /* HOISTED */\n)\nexport default defineComponent({\n  name: 'SearchOutlined',\n  render: function render(_ctx, _cache) {\n    return _openBlock(), _createBlock('svg', _hoisted_1, [_hoisted_2])\n  }\n})\n","import { createVNode as _createVNode, openBlock as _openBlock, createBlock as _createBlock, defineComponent } from 'vue'\nconst _hoisted_1 = {\n  xmlns: 'http://www.w3.org/2000/svg',\n  'xmlns:xlink': 'http://www.w3.org/1999/xlink',\n  viewBox: '0 0 1024 1024'\n}\nconst _hoisted_2 = /*#__PURE__*/ _createVNode(\n  'path',\n  {\n    d: 'M511.4 124C290.5 124.3 112 303 112 523.9c0 128 60.2 242 153.8 315.2l-37.5 48c-4.1 5.3-.3 13 6.3 12.9l167-.8c5.2 0 9-4.9 7.7-9.9L369.8 727a8 8 0 0 0-14.1-3L315 776.1c-10.2-8-20-16.7-29.3-26a318.64 318.64 0 0 1-68.6-101.7C200.4 609 192 567.1 192 523.9s8.4-85.1 25.1-124.5c16.1-38.1 39.2-72.3 68.6-101.7c29.4-29.4 63.6-52.5 101.7-68.6C426.9 212.4 468.8 204 512 204s85.1 8.4 124.5 25.1c38.1 16.1 72.3 39.2 101.7 68.6c29.4 29.4 52.5 63.6 68.6 101.7c16.7 39.4 25.1 81.3 25.1 124.5s-8.4 85.1-25.1 124.5a318.64 318.64 0 0 1-68.6 101.7c-7.5 7.5-15.3 14.5-23.4 21.2a7.93 7.93 0 0 0-1.2 11.1l39.4 50.5c2.8 3.5 7.9 4.1 11.4 1.3C854.5 760.8 912 649.1 912 523.9c0-221.1-179.4-400.2-400.6-399.9z',\n    fill: 'currentColor'\n  },\n  null,\n  -1\n  /* HOISTED */\n)\nexport default defineComponent({\n  name: 'UndoOutlined',\n  render: function render(_ctx, _cache) {\n    return _openBlock(), _createBlock('svg', _hoisted_1, [_hoisted_2])\n  }\n})\n","import { createVNode as _createVNode, openBlock as _openBlock, createBlock as _createBlock, defineComponent } from 'vue'\nconst _hoisted_1 = {\n  xmlns: 'http://www.w3.org/2000/svg',\n  'xmlns:xlink': 'http://www.w3.org/1999/xlink',\n  viewBox: '0 0 1024 1024'\n}\nconst _hoisted_2 = /*#__PURE__*/ _createVNode(\n  'path',\n  {\n    d: 'M464 720a48 48 0 1 0 96 0a48 48 0 1 0-96 0zm16-304v184c0 4.4 3.6 8 8 8h48c4.4 0 8-3.6 8-8V416c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8zm475.7 440l-416-720c-6.2-10.7-16.9-16-27.7-16s-21.6 5.3-27.7 16l-416 720C56 877.4 71.4 904 96 904h832c24.6 0 40-26.6 27.7-48zm-783.5-27.9L512 239.9l339.8 588.2H172.2z',\n    fill: 'currentColor'\n  },\n  null,\n  -1\n  /* HOISTED */\n)\nexport default defineComponent({\n  name: 'WarningOutlined',\n  render: function render(_ctx, _cache) {\n    return _openBlock(), _createBlock('svg', _hoisted_1, [_hoisted_2])\n  }\n})\n","let onceCbs = [];\nconst paramsMap = new WeakMap();\nfunction flushOnceCallbacks() {\n    onceCbs.forEach((cb) => cb(...paramsMap.get(cb)));\n    onceCbs = [];\n}\nfunction beforeNextFrameOnce(cb, ...params) {\n    paramsMap.set(cb, params);\n    if (onceCbs.includes(cb))\n        return;\n    onceCbs.push(cb) === 1 && requestAnimationFrame(flushOnceCallbacks);\n}\nexport { beforeNextFrameOnce };\n","export function happensIn(e, dataSetPropName) {\n    let { target } = e;\n    while (target) {\n        if (target.dataset) {\n            if (target.dataset[dataSetPropName] !== undefined)\n                return true;\n        }\n        target = target.parentElement;\n    }\n    return false;\n}\n","import { ref, readonly, watch } from 'vue';\nexport default function useFalseUntilTruthy(originalRef) {\n    const currentRef = ref(!!originalRef.value);\n    if (currentRef.value)\n        return readonly(currentRef);\n    const stop = watch(originalRef, (value) => {\n        if (value) {\n            currentRef.value = true;\n            stop();\n        }\n    });\n    return readonly(currentRef);\n}\n","import { getCurrentInstance } from 'vue';\nexport function hasInstance() {\n    return getCurrentInstance() !== null;\n}\nexport const isBrowser = typeof window !== 'undefined';\n","import { onMounted, onBeforeUnmount } from 'vue';\nimport { isBrowser } from './utils';\nlet fontsReady;\nlet isFontReady;\nconst init = () => {\n    var _a, _b;\n    fontsReady = isBrowser ? (_b = (_a = document) === null || _a === void 0 ? void 0 : _a.fonts) === null || _b === void 0 ? void 0 : _b.ready : undefined;\n    isFontReady = false;\n    /* istanbul ignore if */\n    if (fontsReady !== undefined) {\n        void fontsReady.then(() => {\n            isFontReady = true;\n        });\n    }\n    else {\n        isFontReady = true;\n    }\n};\ninit();\n// For testing\nexport { init };\n/**\n * Call callback on fontsReady is resolved. If fontsReady is already resolved,\n * callback won't be called.\n */\nexport default function onFontsReady(cb) {\n    /* istanbul ignore next */\n    if (isFontReady)\n        return;\n    let deactivated = false;\n    onMounted(() => {\n        /* istanbul ignore next */\n        if (!isFontReady) {\n            fontsReady === null || fontsReady === void 0 ? void 0 : fontsReady.then(() => {\n                if (deactivated)\n                    return;\n                cb();\n            });\n        }\n    });\n    onBeforeUnmount(() => {\n        deactivated = true;\n    });\n}\n","export const isIos = (typeof window === 'undefined'\n    ? false\n    : /iPad|iPhone|iPod/.test(navigator.platform) ||\n        (navigator.platform === 'MacIntel' && navigator.maxTouchPoints > 1)) &&\n    // eslint-disable-next-line @typescript-eslint/strict-boolean-expressions\n    !window.MSStream;\nexport default function useIsIos() {\n    return isIos;\n}\n","export function keep(object, keys = [], rest) {\n    const keepedObject = {};\n    keys.forEach((key) => {\n        keepedObject[key] = object[key];\n    });\n    return Object.assign(keepedObject, rest);\n}\n","export function omit(object, keys = [], rest) {\n    const omitedObject = {};\n    const originalKeys = Object.getOwnPropertyNames(object);\n    originalKeys.forEach((originalKey) => {\n        if (!keys.includes(originalKey)) {\n            omitedObject[originalKey] = object[originalKey];\n        }\n    });\n    return Object.assign(omitedObject, rest);\n}\n","import { Fragment, createTextVNode, Comment } from 'vue';\n// o(n) flatten\nexport function flatten(vNodes, filterCommentNode = true, result = []) {\n    vNodes.forEach((vNode) => {\n        if (vNode === null)\n            return;\n        if (typeof vNode !== 'object') {\n            if (typeof vNode === 'string' || typeof vNode === 'number') {\n                result.push(createTextVNode(String(vNode)));\n            }\n            return;\n        }\n        if (Array.isArray(vNode)) {\n            flatten(vNode, filterCommentNode, result);\n            return;\n        }\n        if (vNode.type === Fragment) {\n            if (vNode.children === null)\n                return;\n            if (Array.isArray(vNode.children)) {\n                flatten(vNode.children, filterCommentNode, result);\n            }\n            // rawSlot\n        }\n        else if (vNode.type !== Comment) {\n            result.push(vNode);\n        }\n    });\n    return result;\n}\n","export function keysOf(obj) {\n    return Object.keys(obj);\n}\n","import { createTextVNode } from 'vue';\nexport const render = (r, ...args) => {\n    if (typeof r === 'function') {\n        return r(...args);\n    }\n    else if (typeof r === 'string') {\n        return createTextVNode(r);\n    }\n    else if (typeof r === 'number') {\n        return createTextVNode(String(r));\n    }\n    else {\n        return null;\n    }\n};\n","export function getTitleAttribute(value) {\n    switch (typeof value) {\n        case 'string':\n            // The empty string should also be reset to undefined.\n            return value || undefined;\n        case 'number':\n            return String(value);\n        default:\n            return undefined;\n    }\n}\n","import { flatten } from './flatten';\nimport { warn } from '../naive';\nexport function getFirstSlotVNode(slots, slotName = 'default', props = undefined) {\n    const slot = slots[slotName];\n    if (!slot) {\n        warn('getFirstSlotVNode', `slot[${slotName}] is empty`);\n        return null;\n    }\n    const slotContent = flatten(slot(props));\n    // vue will normalize the slot, so slot must be an array\n    if (slotContent.length === 1) {\n        return slotContent[0];\n    }\n    else {\n        warn('getFirstSlotVNode', `slot[${slotName}] should have exactly one child`);\n        return null;\n    }\n}\n","export const modalBodyInjectionKey = Symbol('modalBody');\nexport const modalInjectionKey = Symbol('modal');\n","export const drawerBodyInjectionKey = Symbol('drawerBody');\nexport const drawerInjectionKey = Symbol('drawer');\n","export const popoverBodyInjectionKey = Symbol('popoverBodyInjection');\n","export const internalSelectionMenuInjectionKey = Symbol('internal-select-menu');\nexport const internalSelectionMenuBodyInjectionKey = Symbol('internal-select-menu-body');\n","import { useMemo } from 'vooks';\nimport { inject } from 'vue';\nimport { modalBodyInjectionKey } from '../../modal/src/interface';\nimport { drawerBodyInjectionKey } from '../../drawer/src/interface';\nimport { popoverBodyInjectionKey } from '../../popover/src/interface';\nimport { internalSelectionMenuBodyInjectionKey } from '../../_internal/select-menu/src/interface';\nconst teleportDisabled = '__disabled__';\nfunction useAdjustedTo(props) {\n    const modal = inject(modalBodyInjectionKey, null);\n    const drawer = inject(drawerBodyInjectionKey, null);\n    const popover = inject(popoverBodyInjectionKey, null);\n    const selectMenu = inject(internalSelectionMenuBodyInjectionKey, null);\n    return useMemo(() => {\n        var _a;\n        const { to } = props;\n        if (to !== undefined) {\n            if (to === false)\n                return teleportDisabled;\n            if (to === true)\n                return 'body';\n            return to;\n        }\n        if (modal === null || modal === void 0 ? void 0 : modal.value) {\n            return (_a = modal.value.$el) !== null && _a !== void 0 ? _a : modal.value;\n        }\n        if (drawer === null || drawer === void 0 ? void 0 : drawer.value)\n            return drawer.value;\n        if (popover === null || popover === void 0 ? void 0 : popover.value)\n            return popover.value;\n        if (selectMenu === null || selectMenu === void 0 ? void 0 : selectMenu.value)\n            return selectMenu.value;\n        return to !== null && to !== void 0 ? to : 'body';\n    });\n}\n// teleport disabled key\nuseAdjustedTo.tdkey = teleportDisabled;\nuseAdjustedTo.propTo = {\n    type: [String, Object, Boolean],\n    default: undefined\n};\nexport { useAdjustedTo };\n","import { h, defineComponent } from 'vue';\nexport default defineComponent({\n    name: 'Checkmark',\n    render() {\n        return (h(\"svg\", { xmlns: \"http://www.w3.org/2000/svg\", viewBox: \"0 0 16 16\" },\n            h(\"g\", { fill: \"none\" },\n                h(\"path\", { d: \"M14.046 3.486a.75.75 0 0 1-.032 1.06l-7.93 7.474a.85.85 0 0 1-1.188-.022l-2.68-2.72a.75.75 0 1 1 1.068-1.053l2.234 2.267l7.468-7.038a.75.75 0 0 1 1.06.032z\", fill: \"currentColor\" }))));\n    }\n});\n","import { h } from 'vue';\nimport { replaceable } from './replaceable';\nexport default replaceable('close', h(\"svg\", { viewBox: \"0 0 12 12\", version: \"1.1\", xmlns: \"http://www.w3.org/2000/svg\" },\n    h(\"g\", { stroke: \"none\", \"stroke-width\": \"1\", fill: \"none\", \"fill-rule\": \"evenodd\" },\n        h(\"g\", { fill: \"currentColor\", \"fill-rule\": \"nonzero\" },\n            h(\"path\", { d: \"M2.08859116,2.2156945 L2.14644661,2.14644661 C2.32001296,1.97288026 2.58943736,1.95359511 2.7843055,2.08859116 L2.85355339,2.14644661 L6,5.293 L9.14644661,2.14644661 C9.34170876,1.95118446 9.65829124,1.95118446 9.85355339,2.14644661 C10.0488155,2.34170876 10.0488155,2.65829124 9.85355339,2.85355339 L6.707,6 L9.85355339,9.14644661 C10.0271197,9.32001296 10.0464049,9.58943736 9.91140884,9.7843055 L9.85355339,9.85355339 C9.67998704,10.0271197 9.41056264,10.0464049 9.2156945,9.91140884 L9.14644661,9.85355339 L6,6.707 L2.85355339,9.85355339 C2.65829124,10.0488155 2.34170876,10.0488155 2.14644661,9.85355339 C1.95118446,9.65829124 1.95118446,9.34170876 2.14644661,9.14644661 L5.293,6 L2.14644661,2.85355339 C1.97288026,2.67998704 1.95359511,2.41056264 2.08859116,2.2156945 L2.14644661,2.14644661 L2.08859116,2.2156945 Z\" })))));\n","import { h, defineComponent } from 'vue';\nexport default defineComponent({\n    name: 'Empty',\n    render() {\n        return (h(\"svg\", { viewBox: \"0 0 28 28\", fill: \"none\", xmlns: \"http://www.w3.org/2000/svg\" },\n            h(\"path\", { d: \"M26 7.5C26 11.0899 23.0899 14 19.5 14C15.9101 14 13 11.0899 13 7.5C13 3.91015 15.9101 1 19.5 1C23.0899 1 26 3.91015 26 7.5ZM16.8536 4.14645C16.6583 3.95118 16.3417 3.95118 16.1464 4.14645C15.9512 4.34171 15.9512 4.65829 16.1464 4.85355L18.7929 7.5L16.1464 10.1464C15.9512 10.3417 15.9512 10.6583 16.1464 10.8536C16.3417 11.0488 16.6583 11.0488 16.8536 10.8536L19.5 8.20711L22.1464 10.8536C22.3417 11.0488 22.6583 11.0488 22.8536 10.8536C23.0488 10.6583 23.0488 10.3417 22.8536 10.1464L20.2071 7.5L22.8536 4.85355C23.0488 4.65829 23.0488 4.34171 22.8536 4.14645C22.6583 3.95118 22.3417 3.95118 22.1464 4.14645L19.5 6.79289L16.8536 4.14645Z\", fill: \"currentColor\" }),\n            h(\"path\", { d: \"M25 22.75V12.5991C24.5572 13.0765 24.053 13.4961 23.5 13.8454V16H17.5L17.3982 16.0068C17.0322 16.0565 16.75 16.3703 16.75 16.75C16.75 18.2688 15.5188 19.5 14 19.5C12.4812 19.5 11.25 18.2688 11.25 16.75L11.2432 16.6482C11.1935 16.2822 10.8797 16 10.5 16H4.5V7.25C4.5 6.2835 5.2835 5.5 6.25 5.5H12.2696C12.4146 4.97463 12.6153 4.47237 12.865 4H6.25C4.45507 4 3 5.45507 3 7.25V22.75C3 24.5449 4.45507 26 6.25 26H21.75C23.5449 26 25 24.5449 25 22.75ZM4.5 22.75V17.5H9.81597L9.85751 17.7041C10.2905 19.5919 11.9808 21 14 21L14.215 20.9947C16.2095 20.8953 17.842 19.4209 18.184 17.5H23.5V22.75C23.5 23.7165 22.7165 24.5 21.75 24.5H6.25C5.2835 24.5 4.5 23.7165 4.5 22.75Z\", fill: \"currentColor\" })));\n    }\n});\n","import { cB, cM, c } from '../../../../_utils/cssr'; // vars:\n// --close-color\n// --close-color-hover\n// --close-color-pressed\n// --close-color-disabled\n\nexport default cB('base-close', `\n cursor: pointer;\n color: var(--close-color);\n`, [c('&:hover', {\n  color: 'var(--close-color-hover)'\n}), c('&:active', {\n  color: 'var(--close-color-pressed)'\n}), cM('disabled', {\n  cursor: 'not-allowed!important',\n  color: 'var(--close-color-disabled)'\n})]);","import { h, defineComponent, toRef } from 'vue';\nimport { useStyle } from '../../../_mixins';\nimport NBaseIcon from '../../icon';\nimport { CloseIcon } from '../../icons';\nimport style from './styles/index.cssr';\nexport default defineComponent({\n    name: 'BaseClose',\n    props: {\n        clsPrefix: {\n            type: String,\n            required: true\n        },\n        disabled: {\n            type: Boolean,\n            default: undefined\n        },\n        onClick: Function\n    },\n    setup(props) {\n        useStyle('BaseClose', style, toRef(props, 'clsPrefix'));\n        return () => {\n            const { clsPrefix, disabled } = props;\n            return (h(NBaseIcon, { role: \"button\", ariaDisabled: disabled, ariaLabel: \"close\", clsPrefix: clsPrefix, class: [\n                    `${clsPrefix}-base-close`,\n                    disabled && `${clsPrefix}-base-close--disabled`\n                ], onClick: disabled ? undefined : props.onClick }, {\n                default: () => h(CloseIcon, null)\n            }));\n        };\n    }\n});\n","import { h, defineComponent } from 'vue';\nexport default defineComponent({\n    props: {\n        onFocus: Function,\n        onBlur: Function\n    },\n    setup(props) {\n        return () => (h(\"div\", { style: \"width: 0; height: 0\", tabindex: 0, onFocus: props.onFocus, onBlur: props.onBlur }));\n    }\n});\n","export function toArray(arg) {\n    if (Array.isArray(arg))\n        return arg;\n    return [arg];\n}\n// Do not use enum for lint plugin has error\nexport const TRAVERSE_COMMAND = {\n    STOP: 'STOP'\n};\nexport function traverseWithCb(treeNode, callback) {\n    const command = callback(treeNode);\n    if (treeNode.children !== undefined && command !== TRAVERSE_COMMAND.STOP) {\n        treeNode.children.forEach((childNode) => traverseWithCb(childNode, callback));\n    }\n}\nexport function getNonLeafKeys(treeNodes, options = {}) {\n    const { preserveGroup = false } = options;\n    const keys = [];\n    const cb = preserveGroup\n        ? (node) => {\n            if (!node.isLeaf) {\n                keys.push(node.key);\n                traverse(node.children);\n            }\n        }\n        : (node) => {\n            if (!node.isLeaf) {\n                if (!node.isGroup)\n                    keys.push(node.key);\n                traverse(node.children);\n            }\n        };\n    function traverse(nodes) {\n        nodes.forEach(cb);\n    }\n    traverse(treeNodes);\n    return keys;\n}\nexport function isLeaf(rawNode, getChildren) {\n    const { isLeaf } = rawNode;\n    if (isLeaf !== undefined)\n        return isLeaf;\n    else if (!getChildren(rawNode))\n        return true;\n    return false;\n}\nexport function defaultGetChildren(node) {\n    return node.children;\n}\nexport function defaultGetKey(node) {\n    return node.key;\n}\nexport function isIgnored() {\n    return false;\n}\nexport function isShallowLoaded(rawNode, getChildren) {\n    const { isLeaf } = rawNode;\n    if (isLeaf === false && !Array.isArray(getChildren(rawNode)))\n        return false;\n    return true;\n}\nexport function isDisabled(rawNode) {\n    return rawNode.disabled === true;\n}\nexport function isExpilicitlyNotLoaded(rawNode, getChildren) {\n    return (rawNode.isLeaf === false && !Array.isArray(getChildren(rawNode)));\n}\nexport function isNodeInvalid(rawNode, getChildren) {\n    return rawNode.isLeaf === true && Array.isArray(getChildren(rawNode));\n}\nexport function unwrapCheckedKeys(result) {\n    var _a;\n    if (result === undefined || result === null)\n        return [];\n    if (Array.isArray(result))\n        return result;\n    return (_a = result.checkedKeys) !== null && _a !== void 0 ? _a : [];\n}\nexport function unwrapIndeterminateKeys(result) {\n    var _a;\n    if (result === undefined || result === null || Array.isArray(result)) {\n        return [];\n    }\n    return (_a = result.indeterminateKeys) !== null && _a !== void 0 ? _a : [];\n}\nexport function merge(originalKeys, keysToAdd) {\n    const set = new Set(originalKeys);\n    keysToAdd.forEach((key) => {\n        if (!set.has(key)) {\n            set.add(key);\n        }\n    });\n    return Array.from(set);\n}\nexport function minus(originalKeys, keysToRemove) {\n    const set = new Set(originalKeys);\n    keysToRemove.forEach((key) => {\n        if (set.has(key)) {\n            set.delete(key);\n        }\n    });\n    return Array.from(set);\n}\nexport function isGroup(rawNode) {\n    return (rawNode === null || rawNode === void 0 ? void 0 : rawNode.type) === 'group';\n}\nexport function createIndexGetter(treeNodes) {\n    const map = new Map();\n    treeNodes.forEach((treeNode, i) => {\n        map.set(treeNode.key, i);\n    });\n    return (key) => { var _a; return (_a = map.get(key)) !== null && _a !== void 0 ? _a : null; };\n}\n","import { isExpilicitlyNotLoaded, merge, minus, traverseWithCb, TRAVERSE_COMMAND } from './utils';\nexport class SubtreeNotLoadedError extends Error {\n    constructor() {\n        super();\n        this.message =\n            'SubtreeNotLoadedError: checking a subtree whose required nodes are not fully loaded.';\n    }\n}\nfunction getExtendedCheckedKeySetAfterCheck(checkKeys, currentCheckedKeys, treeMate) {\n    return getExtendedCheckedKeySet(currentCheckedKeys.concat(checkKeys), treeMate);\n}\nfunction getAvailableAscendantNodeSet(uncheckedKeys, treeMate) {\n    const visitedKeys = new Set();\n    uncheckedKeys.forEach((uncheckedKey) => {\n        const uncheckedTreeNode = treeMate.treeNodeMap.get(uncheckedKey);\n        if (uncheckedTreeNode !== undefined) {\n            let nodeCursor = uncheckedTreeNode.parent;\n            while (nodeCursor !== null) {\n                if (nodeCursor.disabled)\n                    break;\n                if (visitedKeys.has(nodeCursor.key))\n                    break;\n                else {\n                    visitedKeys.add(nodeCursor.key);\n                }\n                nodeCursor = nodeCursor.parent;\n            }\n        }\n    });\n    return visitedKeys;\n}\nfunction getExtendedCheckedKeySetAfterUncheck(uncheckedKeys, currentCheckedKeys, treeMate) {\n    const extendedCheckedKeySet = getExtendedCheckedKeySet(currentCheckedKeys, treeMate);\n    const extendedKeySetToUncheck = getExtendedCheckedKeySet(uncheckedKeys, treeMate, true);\n    const ascendantKeySet = getAvailableAscendantNodeSet(uncheckedKeys, treeMate);\n    const keysToRemove = [];\n    extendedCheckedKeySet.forEach((key) => {\n        if (extendedKeySetToUncheck.has(key) || ascendantKeySet.has(key)) {\n            keysToRemove.push(key);\n        }\n    });\n    keysToRemove.forEach((key) => extendedCheckedKeySet.delete(key));\n    return extendedCheckedKeySet;\n}\nexport function getCheckedKeys(options, treeMate) {\n    const { checkedKeys, keysToCheck, keysToUncheck, indeterminateKeys, cascade, leafOnly, checkStrategy } = options;\n    if (!cascade) {\n        if (keysToCheck !== undefined) {\n            return {\n                checkedKeys: merge(checkedKeys, keysToCheck),\n                indeterminateKeys: Array.from(indeterminateKeys)\n            };\n        }\n        else if (keysToUncheck !== undefined) {\n            return {\n                checkedKeys: minus(checkedKeys, keysToUncheck),\n                indeterminateKeys: Array.from(indeterminateKeys)\n            };\n        }\n        else {\n            return {\n                checkedKeys: Array.from(checkedKeys),\n                indeterminateKeys: Array.from(indeterminateKeys)\n            };\n        }\n    }\n    const { levelTreeNodeMap } = treeMate;\n    let extendedCheckedKeySet;\n    if (keysToUncheck !== undefined) {\n        extendedCheckedKeySet = getExtendedCheckedKeySetAfterUncheck(keysToUncheck, checkedKeys, treeMate);\n    }\n    else if (keysToCheck !== undefined) {\n        extendedCheckedKeySet = getExtendedCheckedKeySetAfterCheck(keysToCheck, checkedKeys, treeMate);\n    }\n    else {\n        extendedCheckedKeySet = getExtendedCheckedKeySet(checkedKeys, treeMate);\n    }\n    const checkStrategyIsParent = checkStrategy === 'parent';\n    const checkStrategyIsChild = checkStrategy === 'child' || leafOnly;\n    const syntheticCheckedKeySet = extendedCheckedKeySet;\n    const syntheticIndeterminateKeySet = new Set();\n    const maxLevel = Math.max.apply(null, Array.from(levelTreeNodeMap.keys()));\n    // cascade check\n    // 1. if tree is fully loaded, it just works\n    // 2. if the tree is not fully loaded, we assume that keys which is in not\n    //    loaded tree are not in checked keys\n    //    for example:\n    //    a -- b(fully-loaded)   -- c(fully-loaded)\n    //      |- d(partial-loaded) -- ?e(not-loaded)\n    //    in the case, `e` is assumed not to be checked, nor we can't calc `d`'s\n    //    and `a`'s status\n    for (let level = maxLevel; level >= 0; level -= 1) {\n        const levelIsZero = level === 0;\n        // it should exists, nor it is a bug\n        const levelTreeNodes = levelTreeNodeMap.get(level);\n        for (const levelTreeNode of levelTreeNodes) {\n            if (levelTreeNode.isLeaf)\n                continue;\n            const { key: levelTreeNodeKey, shallowLoaded } = levelTreeNode;\n            if (checkStrategyIsChild && shallowLoaded) {\n                // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n                levelTreeNode.children.forEach((v) => {\n                    if (!v.disabled &&\n                        !v.isLeaf &&\n                        v.shallowLoaded &&\n                        syntheticCheckedKeySet.has(v.key)) {\n                        syntheticCheckedKeySet.delete(v.key);\n                    }\n                });\n            }\n            if (levelTreeNode.disabled || !shallowLoaded) {\n                continue;\n            }\n            let fullyChecked = true;\n            let partialChecked = false;\n            let allDisabled = true;\n            // it is shallow loaded, so `children` must exist\n            for (const childNode of levelTreeNode.children) {\n                const childKey = childNode.key;\n                if (childNode.disabled)\n                    continue;\n                if (allDisabled)\n                    allDisabled = false;\n                if (syntheticCheckedKeySet.has(childKey)) {\n                    partialChecked = true;\n                }\n                else if (syntheticIndeterminateKeySet.has(childKey)) {\n                    partialChecked = true;\n                    fullyChecked = false;\n                    break;\n                }\n                else {\n                    fullyChecked = false;\n                    if (partialChecked) {\n                        break;\n                    }\n                }\n            }\n            if (fullyChecked && !allDisabled) {\n                if (checkStrategyIsParent) {\n                    // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n                    levelTreeNode.children.forEach((v) => {\n                        if (!v.disabled && syntheticCheckedKeySet.has(v.key)) {\n                            syntheticCheckedKeySet.delete(v.key);\n                        }\n                    });\n                }\n                syntheticCheckedKeySet.add(levelTreeNodeKey);\n            }\n            else if (partialChecked) {\n                syntheticIndeterminateKeySet.add(levelTreeNodeKey);\n            }\n            if (levelIsZero &&\n                checkStrategyIsChild &&\n                syntheticCheckedKeySet.has(levelTreeNodeKey)) {\n                syntheticCheckedKeySet.delete(levelTreeNodeKey);\n            }\n        }\n    }\n    return {\n        checkedKeys: Array.from(syntheticCheckedKeySet),\n        indeterminateKeys: Array.from(syntheticIndeterminateKeySet)\n    };\n}\n// unchecking is safe when doing cascade uncheck in async mode\nexport function getExtendedCheckedKeySet(checkedKeys, treeMate, isUnchecking = false) {\n    const { treeNodeMap, getChildren } = treeMate;\n    const visitedKeySet = new Set();\n    const extendedKeySet = new Set(checkedKeys);\n    checkedKeys.forEach((checkedKey) => {\n        const checkedTreeNode = treeNodeMap.get(checkedKey);\n        if (checkedTreeNode !== undefined) {\n            traverseWithCb(checkedTreeNode, (treeNode) => {\n                if (treeNode.disabled) {\n                    return TRAVERSE_COMMAND.STOP;\n                }\n                const { key } = treeNode;\n                if (visitedKeySet.has(key))\n                    return;\n                visitedKeySet.add(key);\n                // Adding keys before loaded check is okay, since if not valid error\n                // would be thrown\n                extendedKeySet.add(key);\n                if (isExpilicitlyNotLoaded(treeNode.rawNode, getChildren)) {\n                    if (isUnchecking) {\n                        return TRAVERSE_COMMAND.STOP;\n                    }\n                    else {\n                        throw new SubtreeNotLoadedError();\n                    }\n                }\n            });\n        }\n    });\n    return extendedKeySet;\n}\n","export function getPath(key, { includeGroup = false, includeSelf = true }, treeMate) {\n    var _a;\n    const treeNodeMap = treeMate.treeNodeMap;\n    let treeNode = key === null || key === undefined ? null : (_a = treeNodeMap.get(key)) !== null && _a !== void 0 ? _a : null;\n    const mergedPath = {\n        keyPath: [],\n        treeNodePath: [],\n        treeNode: treeNode\n    };\n    if (treeNode === null || treeNode === void 0 ? void 0 : treeNode.ignored) {\n        mergedPath.treeNode = null;\n        return mergedPath;\n    }\n    while (treeNode) {\n        if (!treeNode.ignored && (includeGroup || !treeNode.isGroup)) {\n            mergedPath.treeNodePath.push(treeNode);\n        }\n        treeNode = treeNode.parent;\n    }\n    mergedPath.treeNodePath.reverse();\n    if (!includeSelf)\n        mergedPath.treeNodePath.pop();\n    mergedPath.keyPath = mergedPath.treeNodePath.map((treeNode) => treeNode.key);\n    return mergedPath;\n}\n","export function getFirstAvailableNode(nodes) {\n    if (nodes.length === 0)\n        return null;\n    const node = nodes[0];\n    if (node.isGroup || node.ignored || node.disabled) {\n        return node.getNext();\n    }\n    return node;\n}\nfunction rawGetNext(node, loop) {\n    const sibs = node.siblings;\n    const l = sibs.length;\n    const { index } = node;\n    if (loop) {\n        return sibs[(index + 1) % l];\n    }\n    else {\n        if (index === sibs.length - 1)\n            return null;\n        return sibs[index + 1];\n    }\n}\nfunction move(fromNode, dir, { loop = false, includeDisabled = false } = {}) {\n    const iterate = dir === 'prev' ? rawGetPrev : rawGetNext;\n    const getChildOptions = {\n        reverse: dir === 'prev'\n    };\n    let meet = false;\n    let endNode = null;\n    function traverse(node) {\n        if (node === null)\n            return;\n        if (node === fromNode) {\n            if (!meet) {\n                meet = true;\n            }\n            else if (!fromNode.disabled && !fromNode.isGroup) {\n                endNode = fromNode;\n                return;\n            }\n        }\n        else {\n            if ((!node.disabled || includeDisabled) &&\n                !node.ignored &&\n                !node.isGroup) {\n                endNode = node;\n                return;\n            }\n        }\n        if (node.isGroup) {\n            const child = getChild(node, getChildOptions);\n            if (child !== null) {\n                endNode = child;\n            }\n            else {\n                traverse(iterate(node, loop));\n            }\n        }\n        else {\n            const nextNode = iterate(node, false);\n            if (nextNode !== null) {\n                traverse(nextNode);\n            }\n            else {\n                const parent = rawGetParent(node);\n                if (parent === null || parent === void 0 ? void 0 : parent.isGroup) {\n                    traverse(iterate(parent, loop));\n                }\n                else if (loop) {\n                    traverse(iterate(node, true));\n                }\n            }\n        }\n    }\n    traverse(fromNode);\n    return endNode;\n}\nfunction rawGetPrev(node, loop) {\n    const sibs = node.siblings;\n    const l = sibs.length;\n    const { index } = node;\n    if (loop) {\n        return sibs[(index - 1 + l) % l];\n    }\n    else {\n        if (index === 0)\n            return null;\n        return sibs[index - 1];\n    }\n}\nfunction rawGetParent(node) {\n    return node.parent;\n}\nfunction getChild(node, options = {}) {\n    const { reverse = false } = options;\n    const { children } = node;\n    if (children) {\n        const { length } = children;\n        const start = reverse ? length - 1 : 0;\n        const end = reverse ? -1 : length;\n        const delta = reverse ? -1 : 1;\n        for (let i = start; i !== end; i += delta) {\n            const child = children[i];\n            if (!child.disabled && !child.ignored) {\n                if (child.isGroup) {\n                    const childInGroup = getChild(child, options);\n                    if (childInGroup !== null)\n                        return childInGroup;\n                }\n                else {\n                    return child;\n                }\n            }\n        }\n    }\n    return null;\n}\nexport const moveMethods = {\n    getChild() {\n        if (this.ignored)\n            return null;\n        return getChild(this);\n    },\n    getParent() {\n        const { parent } = this;\n        if (parent === null || parent === void 0 ? void 0 : parent.isGroup) {\n            return parent.getParent();\n        }\n        return parent;\n    },\n    getNext(options = {}) {\n        return move(this, 'next', options);\n    },\n    getPrev(options = {}) {\n        return move(this, 'prev', options);\n    }\n};\n","export function flatten(treeNodes, expandedKeys) {\n    const expandedKeySet = expandedKeys ? new Set(expandedKeys) : undefined;\n    const flattenedNodes = [];\n    function traverse(treeNodes) {\n        treeNodes.forEach((treeNode) => {\n            flattenedNodes.push(treeNode);\n            if (treeNode.isLeaf || !treeNode.children || treeNode.ignored)\n                return;\n            if (treeNode.isGroup) {\n                // group node shouldn't be expanded\n                traverse(treeNode.children);\n            }\n            else if (\n            // normal non-leaf node\n            expandedKeySet === undefined ||\n                expandedKeySet.has(treeNode.key)) {\n                traverse(treeNode.children);\n            }\n        });\n    }\n    traverse(treeNodes);\n    return flattenedNodes;\n}\n","export function contains(parent, child) {\n    const parentKey = parent.key;\n    // eslint-disable-next-line no-unmodified-loop-condition\n    while (child) {\n        if (child.key === parentKey)\n            return true;\n        child = child.parent;\n    }\n    return false;\n}\n","import { getCheckedKeys } from './check';\nimport { toArray, isDisabled, isLeaf, isGroup, isNodeInvalid, unwrapCheckedKeys, isShallowLoaded, unwrapIndeterminateKeys, getNonLeafKeys, isIgnored, defaultGetChildren, defaultGetKey } from './utils';\nimport { getPath } from './path';\nimport { moveMethods, getFirstAvailableNode } from './move';\nimport { flatten } from './flatten';\nimport { contains } from './contains';\nfunction createTreeNodes(rawNodes, treeNodeMap, levelTreeNodeMap, nodeProto, getChildren, parent = null, level = 0) {\n    const treeNodes = [];\n    rawNodes.forEach((rawNode, index) => {\n        var _a;\n        if (process.env.NODE_ENV !== 'production' &&\n            isNodeInvalid(rawNode, getChildren)) {\n            console.error('[treemate]: node', rawNode, 'is invalid');\n        }\n        const treeNode = Object.create(nodeProto);\n        treeNode.rawNode = rawNode;\n        treeNode.siblings = treeNodes;\n        treeNode.level = level;\n        treeNode.index = index;\n        treeNode.isFirstChild = index === 0;\n        treeNode.isLastChild = index + 1 === rawNodes.length;\n        treeNode.parent = parent;\n        if (!treeNode.ignored) {\n            const rawChildren = getChildren(rawNode);\n            if (Array.isArray(rawChildren)) {\n                treeNode.children = createTreeNodes(rawChildren, treeNodeMap, levelTreeNodeMap, nodeProto, getChildren, treeNode, level + 1);\n            }\n        }\n        treeNodes.push(treeNode);\n        treeNodeMap.set(treeNode.key, treeNode);\n        if (!levelTreeNodeMap.has(level))\n            levelTreeNodeMap.set(level, []);\n        (_a = levelTreeNodeMap.get(level)) === null || _a === void 0 ? void 0 : _a.push(treeNode);\n    });\n    return treeNodes;\n}\nexport function createTreeMate(rawNodes, options = {}) {\n    const treeNodeMap = new Map();\n    const levelTreeNodeMap = new Map();\n    const { getDisabled = isDisabled, getIgnored = isIgnored, getChildren = defaultGetChildren, getIsGroup = isGroup, getKey = defaultGetKey } = options;\n    const nodeProto = Object.assign({\n        get key() {\n            // do not pass parent or related things to it\n            // the key need to be specified explicitly\n            return getKey(this.rawNode);\n        },\n        get disabled() {\n            return getDisabled(this.rawNode);\n        },\n        get isGroup() {\n            return getIsGroup(this.rawNode);\n        },\n        get isLeaf() {\n            return isLeaf(this.rawNode, getChildren);\n        },\n        get shallowLoaded() {\n            return isShallowLoaded(this.rawNode, getChildren);\n        },\n        get ignored() {\n            return getIgnored(this.rawNode);\n        },\n        contains(node) {\n            return contains(this, node);\n        }\n    }, moveMethods);\n    const treeNodes = createTreeNodes(rawNodes, treeNodeMap, levelTreeNodeMap, nodeProto, getChildren);\n    function getNode(key) {\n        if (key === null || key === undefined)\n            return null;\n        const tmNode = treeNodeMap.get(key);\n        if (tmNode && !tmNode.isGroup && !tmNode.ignored) {\n            return tmNode;\n        }\n        return null;\n    }\n    function _getNode(key) {\n        if (key === null || key === undefined)\n            return null;\n        const tmNode = treeNodeMap.get(key);\n        if (tmNode && !tmNode.ignored) {\n            return tmNode;\n        }\n        return null;\n    }\n    function getPrev(key, options) {\n        const node = _getNode(key);\n        if (!node)\n            return null;\n        return node.getPrev(options);\n    }\n    function getNext(key, options) {\n        const node = _getNode(key);\n        if (!node)\n            return null;\n        return node.getNext(options);\n    }\n    function getParent(key) {\n        const node = _getNode(key);\n        if (!node)\n            return null;\n        return node.getParent();\n    }\n    function getChild(key) {\n        const node = _getNode(key);\n        if (!node)\n            return null;\n        return node.getChild();\n    }\n    const treemate = {\n        treeNodes,\n        treeNodeMap,\n        levelTreeNodeMap,\n        maxLevel: Math.max(...levelTreeNodeMap.keys()),\n        getChildren,\n        getFlattenedNodes(expandedKeys) {\n            return flatten(treeNodes, expandedKeys);\n        },\n        getNode,\n        getPrev,\n        getNext,\n        getParent,\n        getChild,\n        getFirstAvailableNode() {\n            return getFirstAvailableNode(treeNodes);\n        },\n        getPath(key, options = {}) {\n            return getPath(key, options, treemate);\n        },\n        getCheckedKeys(checkedKeys, options = {}) {\n            const { cascade = true, leafOnly = false, checkStrategy = 'all' } = options;\n            return getCheckedKeys({\n                checkedKeys: unwrapCheckedKeys(checkedKeys),\n                indeterminateKeys: unwrapIndeterminateKeys(checkedKeys),\n                cascade,\n                leafOnly,\n                checkStrategy\n            }, treemate);\n        },\n        check(keysToCheck, checkedKeys, options = {}) {\n            const { cascade = true, leafOnly = false, checkStrategy = 'all' } = options;\n            return getCheckedKeys({\n                checkedKeys: unwrapCheckedKeys(checkedKeys),\n                indeterminateKeys: unwrapIndeterminateKeys(checkedKeys),\n                keysToCheck: keysToCheck === undefined || keysToCheck === null\n                    ? []\n                    : toArray(keysToCheck),\n                cascade,\n                leafOnly,\n                checkStrategy\n            }, treemate);\n        },\n        uncheck(keysToUncheck, checkedKeys, options = {}) {\n            const { cascade = true, leafOnly = false, checkStrategy = 'all' } = options;\n            return getCheckedKeys({\n                checkedKeys: unwrapCheckedKeys(checkedKeys),\n                indeterminateKeys: unwrapIndeterminateKeys(checkedKeys),\n                keysToUncheck: keysToUncheck === null || keysToUncheck === undefined\n                    ? []\n                    : toArray(keysToUncheck),\n                cascade,\n                leafOnly,\n                checkStrategy\n            }, treemate);\n        },\n        getNonLeafKeys(options = {}) {\n            return getNonLeafKeys(treeNodes, options);\n        }\n    };\n    return treemate;\n}\n","export function getSlot(slots, slotName = 'default') {\n    const slot = slots[slotName];\n    if (slot === undefined) {\n        throw new Error(`[vueuc/binder]: slot[${slotName}] is empty.`);\n    }\n    return slot();\n}\nexport function getFirstVNode(slots, slotName = 'default') {\n    const slot = slots[slotName];\n    if (slot === undefined) {\n        throw new Error(`[vueuc/binder]: slot[${slotName}] is empty.`);\n    }\n    const content = slot();\n    // vue will normalize the slot, so slot must be an array\n    if (content.length === 1) {\n        return content[0];\n    }\n    else {\n        throw new Error(`[vueuc/binder]: slot[${slotName}] should have exactly one child.`);\n    }\n}\n","let viewMeasurer = null;\nexport function ensureViewBoundingRect() {\n    if (viewMeasurer === null) {\n        viewMeasurer = document.getElementById('v-binder-view-measurer');\n        if (viewMeasurer === null) {\n            viewMeasurer = document.createElement('div');\n            viewMeasurer.id = 'v-binder-view-measurer';\n            const { style } = viewMeasurer;\n            style.position = 'fixed';\n            style.left = '0';\n            style.right = '0';\n            style.top = '0';\n            style.bottom = '0';\n            style.pointerEvents = 'none';\n            style.visibility = 'hidden';\n            document.body.appendChild(viewMeasurer);\n        }\n    }\n    return viewMeasurer.getBoundingClientRect();\n}\nexport function getPointRect(x, y) {\n    const viewRect = ensureViewBoundingRect();\n    return {\n        top: y,\n        left: x,\n        height: 0,\n        width: 0,\n        right: viewRect.width - x,\n        bottom: viewRect.height - y\n    };\n}\nexport function getRect(el) {\n    const elRect = el.getBoundingClientRect();\n    const viewRect = ensureViewBoundingRect();\n    return {\n        left: elRect.left - viewRect.left,\n        top: elRect.top - viewRect.top,\n        bottom: viewRect.height + viewRect.top - elRect.bottom,\n        right: viewRect.width + viewRect.left - elRect.right,\n        width: elRect.width,\n        height: elRect.height\n    };\n}\nexport function getParentNode(node) {\n    // document type\n    if (node.nodeType === 9) {\n        return null;\n    }\n    return node.parentNode;\n}\nexport function getScrollParent(node) {\n    if (node === null)\n        return null;\n    const parentNode = getParentNode(node);\n    if (parentNode === null) {\n        return null;\n    }\n    // Document\n    if (parentNode.nodeType === 9) {\n        return document;\n    }\n    // Element\n    if (parentNode.nodeType === 1) {\n        // Firefox want us to check `-x` and `-y` variations as well\n        const { overflow, overflowX, overflowY } = getComputedStyle(parentNode);\n        if (/(auto|scroll|overlay)/.test(overflow + overflowY + overflowX)) {\n            return parentNode;\n        }\n    }\n    return getScrollParent(parentNode);\n}\n","/* eslint-disable @typescript-eslint/no-non-null-assertion */\nimport { defineComponent, provide, ref, inject, getCurrentInstance, onBeforeUnmount } from 'vue';\nimport { beforeNextFrameOnce } from 'seemly';\nimport { getSlot } from '../../shared/v-node';\nimport { getScrollParent } from './utils';\nimport { on, off } from 'evtd';\nconst Binder = defineComponent({\n    name: 'Binder',\n    props: {\n        syncTargetWithParent: Boolean,\n        syncTarget: {\n            type: Boolean,\n            default: true\n        }\n    },\n    setup(props) {\n        var _a;\n        provide('VBinder', (_a = getCurrentInstance()) === null || _a === void 0 ? void 0 : _a.proxy);\n        const VBinder = inject('VBinder', null);\n        const targetRef = ref(null);\n        /**\n         * If there's no nested vbinder, we can simply set the target ref.\n         *\n         * However, when it comes to:\n         * <VBinder> <- syncTarget = false\n         *\n         *              Should hold target DOM ref, but can't get it directly from\n         *              its VTarget. So if there are nested VBinder, we should:\n         *              1. Stop setting target DOM from level-1 VTarget\n         *              2. Set target DOM from level-2 VTarget\n         *              For (1), we need `syncTarget` to `false`\n         *              For (2), we need to set `syncTargetWithParent` to `true` on\n         *              level-2 VBinder\n         *   <VTarget>\n         *     <VBinder> <- syncTargetWithParent = true\n         *       <VTarget>target</VTarget>\n         *     </VBinder>\n         *     <VFollower>\n         *       content1\n         *     </VFollower>\n         *   </VTarget>\n         *   <VFollower>\n         *     content2\n         *   </VFollower>\n         * </VBinder>\n         */\n        const setTargetRef = (el) => {\n            targetRef.value = el;\n            // eslint-disable-next-line @typescript-eslint/strict-boolean-expressions\n            if (VBinder && props.syncTargetWithParent) {\n                VBinder.setTargetRef(el);\n            }\n        };\n        // scroll related\n        let scrollableNodes = [];\n        const ensureScrollListener = () => {\n            let cursor = targetRef.value;\n            while (true) {\n                cursor = getScrollParent(cursor);\n                if (cursor === null)\n                    break;\n                scrollableNodes.push(cursor);\n            }\n            for (const el of scrollableNodes) {\n                on('scroll', el, onScroll, true);\n            }\n        };\n        const removeScrollListeners = () => {\n            for (const el of scrollableNodes) {\n                off('scroll', el, onScroll, true);\n            }\n            scrollableNodes = [];\n        };\n        const followerScrollListeners = new Set();\n        const addScrollListener = (listener) => {\n            if (followerScrollListeners.size === 0) {\n                ensureScrollListener();\n            }\n            if (!followerScrollListeners.has(listener)) {\n                followerScrollListeners.add(listener);\n            }\n        };\n        const removeScrollListener = (listener) => {\n            if (followerScrollListeners.has(listener)) {\n                followerScrollListeners.delete(listener);\n            }\n            if (followerScrollListeners.size === 0) {\n                removeScrollListeners();\n            }\n        };\n        const onScroll = () => {\n            beforeNextFrameOnce(onScrollRaf);\n        };\n        const onScrollRaf = () => {\n            followerScrollListeners.forEach((listener) => listener());\n        };\n        // resize related\n        const followerResizeListeners = new Set();\n        const addResizeListener = (listener) => {\n            if (followerResizeListeners.size === 0) {\n                on('resize', window, onResize);\n            }\n            if (!followerResizeListeners.has(listener)) {\n                followerResizeListeners.add(listener);\n            }\n        };\n        const removeResizeListener = (listener) => {\n            if (followerResizeListeners.has(listener)) {\n                followerResizeListeners.delete(listener);\n            }\n            if (followerResizeListeners.size === 0) {\n                off('resize', window, onResize);\n            }\n        };\n        const onResize = () => {\n            followerResizeListeners.forEach((listener) => listener());\n        };\n        onBeforeUnmount(() => {\n            off('resize', window, onResize);\n            removeScrollListeners();\n        });\n        return {\n            targetRef,\n            setTargetRef,\n            addScrollListener,\n            removeScrollListener,\n            addResizeListener,\n            removeResizeListener\n        };\n    },\n    render() {\n        return getSlot(this.$slots);\n    }\n});\nexport default Binder;\n","/* eslint-disable @typescript-eslint/no-non-null-assertion */\nimport { defineComponent, inject, withDirectives } from 'vue';\nimport { getFirstVNode } from '../../shared/v-node';\nexport default defineComponent({\n    name: 'Target',\n    setup() {\n        const { setTargetRef, syncTarget } = inject('VBinder');\n        const setTargetDirective = {\n            mounted: setTargetRef,\n            updated: setTargetRef\n        };\n        return {\n            syncTarget,\n            setTargetDirective\n        };\n    },\n    render() {\n        const { syncTarget, setTargetDirective } = this;\n        /**\n         * If you are using VBinder as a child of VBinder, the children wouldn't be\n         * a valid DOM or component that can be attached to by directive.\n         * So we won't sync target on those kind of situation and control the\n         * target sync logic manually.\n         */\n        if (syncTarget) {\n            return withDirectives(getFirstVNode(this.$slots), [[setTargetDirective]]);\n        }\n        return getFirstVNode(this.$slots);\n    }\n});\n","import { on, off } from 'evtd';\nconst ctxKey = '@@mmoContext';\nconst mousemoveoutside = {\n    mounted(el, { value }) {\n        el[ctxKey] = {\n            handler: undefined\n        };\n        if (typeof value === 'function') {\n            el[ctxKey].handler = value;\n            on('mousemoveoutside', el, value);\n        }\n    },\n    updated(el, { value }) {\n        const ctx = el[ctxKey];\n        if (typeof value === 'function') {\n            if (ctx.handler) {\n                if (ctx.handler !== value) {\n                    off('mousemoveoutside', el, ctx.handler);\n                    ctx.handler = value;\n                    on('mousemoveoutside', el, value);\n                }\n            }\n            else {\n                el[ctxKey].handler = value;\n                on('mousemoveoutside', el, value);\n            }\n        }\n        else {\n            if (ctx.handler) {\n                off('mousemoveoutside', el, ctx.handler);\n                ctx.handler = undefined;\n            }\n        }\n    },\n    unmounted(el) {\n        const { handler } = el[ctxKey];\n        if (handler) {\n            off('mousemoveoutside', el, handler);\n        }\n        el[ctxKey].handler = undefined;\n    }\n};\nexport default mousemoveoutside;\n","import { on, off } from 'evtd';\nconst ctxKey = '@@coContext';\nconst clickoutside = {\n    mounted(el, { value }) {\n        el[ctxKey] = {\n            handler: undefined\n        };\n        if (typeof value === 'function') {\n            el[ctxKey].handler = value;\n            on('clickoutside', el, value);\n        }\n    },\n    updated(el, { value }) {\n        const ctx = el[ctxKey];\n        if (typeof value === 'function') {\n            if (ctx.handler) {\n                if (ctx.handler !== value) {\n                    off('clickoutside', el, ctx.handler);\n                    ctx.handler = value;\n                    on('clickoutside', el, value);\n                }\n            }\n            else {\n                el[ctxKey].handler = value;\n                on('clickoutside', el, value);\n            }\n        }\n        else {\n            if (ctx.handler) {\n                off('clickoutside', el, ctx.handler);\n                ctx.handler = undefined;\n            }\n        }\n    },\n    unmounted(el) {\n        const { handler } = el[ctxKey];\n        if (handler) {\n            off('clickoutside', el, handler);\n        }\n        el[ctxKey].handler = undefined;\n    }\n};\nexport default clickoutside;\n","const warnedMessages = new Set();\nexport function warnOnce(location, message) {\n    const mergedMessage = `[vdirs/${location}]: ${message}`;\n    if (warnedMessages.has(mergedMessage))\n        return;\n    warnedMessages.add(mergedMessage);\n}\nexport function warn(location, message) {\n    console.error(`[vdirs/${location}]: ${message}`);\n}\n","import { warn } from '../utils';\nclass ZIndexManager {\n    constructor() {\n        this.elementZIndex = new Map();\n        this.nextZIndex = 2000;\n    }\n    get elementCount() {\n        return this.elementZIndex.size;\n    }\n    ensureZIndex(el, zIndex) {\n        const { elementZIndex } = this;\n        if (zIndex !== undefined) {\n            el.style.zIndex = `${zIndex}`;\n            elementZIndex.delete(el);\n            return;\n        }\n        const { nextZIndex } = this;\n        if (elementZIndex.has(el)) {\n            const currentZIndex = elementZIndex.get(el);\n            if (currentZIndex + 1 === this.nextZIndex)\n                return;\n        }\n        el.style.zIndex = `${nextZIndex}`;\n        elementZIndex.set(el, nextZIndex);\n        this.nextZIndex = nextZIndex + 1;\n        this.squashState();\n    }\n    unregister(el) {\n        const { elementZIndex } = this;\n        if (elementZIndex.has(el)) {\n            elementZIndex.delete(el);\n        }\n        else {\n            warn('vdirs/z-index-manager/unregister-element', 'Element not found when unregistering.');\n        }\n        this.squashState();\n    }\n    squashState() {\n        const { elementCount } = this;\n        if (!elementCount) {\n            this.nextZIndex = 2000;\n        }\n        if (this.nextZIndex - elementCount > 2500)\n            this.rearrange();\n    }\n    rearrange() {\n        const elementZIndexPair = Array.from(this.elementZIndex.entries());\n        elementZIndexPair.sort((pair1, pair2) => {\n            return pair1[1] - pair2[1];\n        });\n        this.nextZIndex = 2000;\n        elementZIndexPair.forEach(pair => {\n            const el = pair[0];\n            const zIndex = this.nextZIndex++;\n            if (`${zIndex}` !== el.style.zIndex)\n                el.style.zIndex = `${zIndex}`;\n        });\n    }\n}\nexport default new ZIndexManager();\n","import zIndexManager from './z-index-manager';\nconst ctx = '@@ziContext';\nconst zindexable = {\n    mounted(el, bindings) {\n        const { value = {} } = bindings;\n        const { zIndex, enabled } = value;\n        zIndexManager.ensureZIndex(el, zIndex);\n        el[ctx] = {\n            enabled\n        };\n    },\n    updated(el, bindings) {\n        const { value = {} } = bindings;\n        const { zIndex, enabled } = value;\n        const cachedEnabled = el[ctx].enabled;\n        if (enabled && !cachedEnabled) {\n            zIndexManager.ensureZIndex(el, zIndex);\n        }\n        el[ctx].enabled = enabled;\n    },\n    unmounted(el) {\n        zIndexManager.unregister(el);\n    }\n};\nexport default zindexable;\n","import { CssRender } from 'css-render';\nconst { c } = CssRender();\nexport { c };\n","function lowBit(n) {\n    return n & -n;\n}\nexport class FinweckTree {\n    /**\n     * @param l length of the array\n     * @param min min value of the array\n     */\n    constructor(l, min) {\n        this.l = l;\n        this.min = min;\n        const ft = new Array(l + 1);\n        for (let i = 0; i < l + 1; ++i) {\n            ft[i] = 0;\n        }\n        this.ft = ft;\n    }\n    /**\n     * Add arr[i] by n, start from 0\n     * @param i the index of the element to be added\n     * @param n the value to be added\n     */\n    add(i, n) {\n        if (n === 0)\n            return;\n        const { l, ft } = this;\n        i += 1;\n        while (i <= l) {\n            ft[i] += n;\n            i += lowBit(i);\n        }\n    }\n    /**\n     * Get the value of index i\n     * @param i index\n     * @returns value of the index\n     */\n    get(i) {\n        return this.sum(i + 1) - this.sum(i);\n    }\n    /**\n     * Get the sum of first i elements\n     * @param i count of head elements to be added\n     * @returns the sum of first i elements\n     */\n    sum(i) {\n        if (i === 0)\n            return 0;\n        const { ft, min, l } = this;\n        if (i === undefined)\n            i = l;\n        if (i > l)\n            throw new Error('[FinweckTree.sum]: `i` is larger than length.');\n        let ret = i * min;\n        while (i > 0) {\n            ret += ft[i];\n            i -= lowBit(i);\n        }\n        return ret;\n    }\n    /**\n     * Get the largest count of head elements whose sum are <= threshold\n     * @param threshold\n     * @returns the largest count of head elements whose sum are <= threshold\n     */\n    getBound(threshold) {\n        let l = 0;\n        let r = this.l;\n        while (r > l) {\n            const m = Math.floor((l + r) / 2);\n            const sumM = this.sum(m);\n            if (sumM > threshold) {\n                r = m;\n                continue;\n            }\n            else if (sumM < threshold) {\n                if (l === m) {\n                    if (this.sum(l + 1) <= threshold)\n                        return l + 1;\n                    return m;\n                }\n                l = m;\n            }\n            else {\n                return m;\n            }\n        }\n        return l;\n    }\n}\n","import { Teleport, h, toRef, computed, defineComponent } from 'vue';\nimport { useFalseUntilTruthy } from 'vooks';\nimport { getSlot } from '../../shared/v-node';\nexport default defineComponent({\n    name: 'LazyTeleport',\n    props: {\n        to: {\n            type: [String, Object],\n            default: undefined\n        },\n        disabled: Boolean,\n        show: {\n            type: Boolean,\n            required: true\n        }\n    },\n    setup(props) {\n        return {\n            showTeleport: useFalseUntilTruthy(toRef(props, 'show')),\n            mergedTo: computed(() => {\n                const { to } = props;\n                return to !== null && to !== void 0 ? to : 'body';\n            })\n        };\n    },\n    render() {\n        return this.showTeleport\n            ? this.disabled\n                ? getSlot(this.$slots)\n                : h(Teleport, {\n                    disabled: this.disabled,\n                    to: this.mergedTo\n                }, getSlot(this.$slots))\n            : null;\n    }\n});\n","const oppositionPositions = {\n    top: 'bottom',\n    bottom: 'top',\n    left: 'right',\n    right: 'left'\n};\nconst oppositeAligns = {\n    start: 'end',\n    center: 'center',\n    end: 'start'\n};\nconst propToCompare = {\n    top: 'height',\n    bottom: 'height',\n    left: 'width',\n    right: 'width'\n};\nconst transformOrigins = {\n    'bottom-start': 'top left',\n    bottom: 'top center',\n    'bottom-end': 'top right',\n    'top-start': 'bottom left',\n    top: 'bottom center',\n    'top-end': 'bottom right',\n    'right-start': 'top left',\n    right: 'center left',\n    'right-end': 'bottom left',\n    'left-start': 'top right',\n    left: 'center right',\n    'left-end': 'bottom right'\n};\nconst overlapTransformOrigin = {\n    'bottom-start': 'bottom left',\n    bottom: 'bottom center',\n    'bottom-end': 'bottom right',\n    'top-start': 'top left',\n    top: 'top center',\n    'top-end': 'top right',\n    'right-start': 'top right',\n    right: 'center right',\n    'right-end': 'bottom right',\n    'left-start': 'top left',\n    left: 'center left',\n    'left-end': 'bottom left'\n};\nconst oppositeAlignCssPositionProps = {\n    'bottom-start': 'right',\n    'bottom-end': 'left',\n    'top-start': 'right',\n    'top-end': 'left',\n    'right-start': 'bottom',\n    'right-end': 'top',\n    'left-start': 'bottom',\n    'left-end': 'top'\n};\nexport function getProperPlacementOfFollower(placement, targetRect, followerRect, flip, overlap) {\n    if (!flip || overlap) {\n        return placement;\n    }\n    const [position, align] = placement.split('-');\n    let properAlign = align !== null && align !== void 0 ? align : 'center';\n    if (align !== 'center') {\n        const oppositeAlignCssPositionProp = oppositeAlignCssPositionProps[placement];\n        const currentAlignCssPositionProp = oppositionPositions[oppositeAlignCssPositionProp];\n        const oppositeAlignCssSizeProp = propToCompare[oppositeAlignCssPositionProp];\n        // if follower rect is larger than target rect in align direction\n        //           [ target ]\n        //           [     follower     ]\n        // [     follower     ] <---->\n        if (followerRect[oppositeAlignCssSizeProp] > targetRect[oppositeAlignCssSizeProp]) {\n            // [ target ]---|\n            // [ follower   |  ]\n            if (\n            // overflow screen\n            (targetRect[oppositeAlignCssPositionProp] + targetRect[oppositeAlignCssSizeProp] <= followerRect[oppositeAlignCssSizeProp]) &&\n                // opposite align has larger space\n                (targetRect[oppositeAlignCssPositionProp] < targetRect[currentAlignCssPositionProp])) {\n                properAlign = oppositeAligns[align];\n            }\n        }\n        // if follower rect is smaller than target rect in align direction\n        // [     target     ]\n        // [ follower ]         <---->\n        if (followerRect[oppositeAlignCssSizeProp] < targetRect[oppositeAlignCssSizeProp]) {\n            if (targetRect[currentAlignCssPositionProp] < 0 &&\n                // opposite align has larger space\n                targetRect[oppositeAlignCssPositionProp] > targetRect[currentAlignCssPositionProp]) {\n                properAlign = oppositeAligns[align];\n            }\n        }\n    }\n    let properPosition = position;\n    if (\n    // space is not enough\n    !(targetRect[position] >= followerRect[propToCompare[position]]) &&\n        // opposite position's space is larger\n        targetRect[oppositionPositions[position]] >= followerRect[propToCompare[position]]) {\n        properPosition = oppositionPositions[position];\n    }\n    return properAlign !== 'center' ? `${properPosition}-${properAlign}` : properPosition;\n}\nexport function getProperTransformOrigin(placement, overlap) {\n    if (overlap)\n        return overlapTransformOrigin[placement];\n    return transformOrigins[placement];\n}\n// ------------\n// |  offset  |\n// |          |\n// | [target] |\n// |          |\n// ------------\nexport function getOffset(placement, offsetRect, targetRect, overlap) {\n    if (overlap) {\n        switch (placement) {\n            case 'bottom-start':\n                return {\n                    top: `${Math.round(targetRect.top - offsetRect.top + targetRect.height)}px`,\n                    left: `${Math.round(targetRect.left - offsetRect.left)}px`,\n                    transform: 'translateY(-100%)'\n                };\n            case 'bottom-end':\n                return {\n                    top: `${Math.round(targetRect.top - offsetRect.top + targetRect.height)}px`,\n                    left: `${Math.round(targetRect.left - offsetRect.left + targetRect.width)}px`,\n                    transform: 'translateX(-100%) translateY(-100%)'\n                };\n            case 'top-start':\n                return {\n                    top: `${Math.round(targetRect.top - offsetRect.top)}px`,\n                    left: `${Math.round(targetRect.left - offsetRect.left)}px`,\n                    transform: ''\n                };\n            case 'top-end':\n                return {\n                    top: `${Math.round(targetRect.top - offsetRect.top)}px`,\n                    left: `${Math.round(targetRect.left - offsetRect.left + targetRect.width)}px`,\n                    transform: 'translateX(-100%)'\n                };\n            case 'right-start':\n                return {\n                    top: `${Math.round(targetRect.top - offsetRect.top)}px`,\n                    left: `${Math.round(targetRect.left - offsetRect.left + targetRect.width)}px`,\n                    transform: 'translateX(-100%)'\n                };\n            case 'right-end':\n                return {\n                    top: `${Math.round(targetRect.top - offsetRect.top + targetRect.height)}px`,\n                    left: `${Math.round(targetRect.left - offsetRect.left + targetRect.width)}px`,\n                    transform: 'translateX(-100%) translateY(-100%)'\n                };\n            case 'left-start':\n                return {\n                    top: `${Math.round(targetRect.top - offsetRect.top)}px`,\n                    left: `${Math.round(targetRect.left - offsetRect.left)}px`,\n                    transform: ''\n                };\n            case 'left-end':\n                return {\n                    top: `${Math.round(targetRect.top - offsetRect.top + targetRect.height)}px`,\n                    left: `${Math.round(targetRect.left - offsetRect.left)}px`,\n                    transform: 'translateY(-100%)'\n                };\n            case 'top':\n                return {\n                    top: `${Math.round(targetRect.top - offsetRect.top)}px`,\n                    left: `${Math.round(targetRect.left - offsetRect.left + targetRect.width / 2)}px`,\n                    transform: 'translateX(-50%)'\n                };\n            case 'right':\n                return {\n                    top: `${Math.round(targetRect.top - offsetRect.top + targetRect.height / 2)}px`,\n                    left: `${Math.round(targetRect.left - offsetRect.left + targetRect.width)}px`,\n                    transform: 'translateX(-100%) translateY(-50%)'\n                };\n            case 'left':\n                return {\n                    top: `${Math.round(targetRect.top - offsetRect.top + targetRect.height / 2)}px`,\n                    left: `${Math.round(targetRect.left - offsetRect.left)}px`,\n                    transform: 'translateY(-50%)'\n                };\n            case 'bottom':\n            default:\n                return {\n                    top: `${Math.round(targetRect.top - offsetRect.top + targetRect.height)}px`,\n                    left: `${Math.round(targetRect.left - offsetRect.left + targetRect.width / 2)}px`,\n                    transform: 'translateX(-50%) translateY(-100%)'\n                };\n        }\n    }\n    switch (placement) {\n        case 'bottom-start':\n            return {\n                top: `${Math.round(targetRect.top - offsetRect.top + targetRect.height)}px`,\n                left: `${Math.round(targetRect.left - offsetRect.left)}px`,\n                transform: ''\n            };\n        case 'bottom-end':\n            return {\n                top: `${Math.round(targetRect.top - offsetRect.top + targetRect.height)}px`,\n                left: `${Math.round(targetRect.left - offsetRect.left + targetRect.width)}px`,\n                transform: 'translateX(-100%)'\n            };\n        case 'top-start':\n            return {\n                top: `${Math.round(targetRect.top - offsetRect.top)}px`,\n                left: `${Math.round(targetRect.left - offsetRect.left)}px`,\n                transform: 'translateY(-100%)'\n            };\n        case 'top-end':\n            return {\n                top: `${Math.round(targetRect.top - offsetRect.top)}px`,\n                left: `${Math.round(targetRect.left - offsetRect.left + targetRect.width)}px`,\n                transform: 'translateX(-100%) translateY(-100%)'\n            };\n        case 'right-start':\n            return {\n                top: `${Math.round(targetRect.top - offsetRect.top)}px`,\n                left: `${Math.round(targetRect.left - offsetRect.left + targetRect.width)}px`,\n                transform: ''\n            };\n        case 'right-end':\n            return {\n                top: `${Math.round(targetRect.top - offsetRect.top + targetRect.height)}px`,\n                left: `${Math.round(targetRect.left - offsetRect.left + targetRect.width)}px`,\n                transform: 'translateY(-100%)'\n            };\n        case 'left-start':\n            return {\n                top: `${Math.round(targetRect.top - offsetRect.top)}px`,\n                left: `${Math.round(targetRect.left - offsetRect.left)}px`,\n                transform: 'translateX(-100%)'\n            };\n        case 'left-end':\n            return {\n                top: `${Math.round(targetRect.top - offsetRect.top + targetRect.height)}px`,\n                left: `${Math.round(targetRect.left - offsetRect.left)}px`,\n                transform: 'translateX(-100%) translateY(-100%)'\n            };\n        case 'top':\n            return {\n                top: `${Math.round(targetRect.top - offsetRect.top)}px`,\n                left: `${Math.round(targetRect.left - offsetRect.left + targetRect.width / 2)}px`,\n                transform: 'translateY(-100%) translateX(-50%)'\n            };\n        case 'right':\n            return {\n                top: `${Math.round(targetRect.top - offsetRect.top + targetRect.height / 2)}px`,\n                left: `${Math.round(targetRect.left - offsetRect.left + targetRect.width)}px`,\n                transform: 'translateY(-50%)'\n            };\n        case 'left':\n            return {\n                top: `${Math.round(targetRect.top - offsetRect.top + targetRect.height / 2)}px`,\n                left: `${Math.round(targetRect.left - offsetRect.left)}px`,\n                transform: 'translateY(-50%) translateX(-100%)'\n            };\n        case 'bottom':\n        default:\n            return {\n                top: `${Math.round(targetRect.top - offsetRect.top + targetRect.height)}px`,\n                left: `${Math.round(targetRect.left - offsetRect.left + targetRect.width / 2)}px`,\n                transform: 'translateX(-50%)'\n            };\n    }\n}\n","/* eslint-disable @typescript-eslint/no-non-null-assertion */\nimport { h, defineComponent, inject, nextTick, watch, toRef, ref, onMounted, onBeforeUnmount, withDirectives } from 'vue';\nimport { zindexable } from 'vdirs';\nimport { useMemo, useIsMounted, onFontsReady } from 'vooks';\nimport { useSsrAdapter } from '@css-render/vue3-ssr';\nimport { c } from '../../shared';\nimport LazyTeleport from '../../lazy-teleport/src/index';\nimport { getProperPlacementOfFollower, getProperTransformOrigin, getOffset } from './get-placement-style';\nimport { getPointRect, getRect } from './utils';\nconst style = c([\n    c('.v-binder-follower-container', {\n        position: 'absolute',\n        left: '0',\n        right: '0',\n        top: '0',\n        height: '0',\n        pointerEvents: 'none',\n        zIndex: 'auto'\n    }),\n    c('.v-binder-follower-content', {\n        position: 'absolute',\n        zIndex: 'auto'\n    }, [\n        c('> *', {\n            pointerEvents: 'all'\n        })\n    ])\n]);\nexport default defineComponent({\n    name: 'Follower',\n    inheritAttrs: false,\n    props: {\n        show: Boolean,\n        enabled: {\n            type: Boolean,\n            default: undefined\n        },\n        placement: {\n            type: String,\n            default: 'bottom'\n        },\n        syncTrigger: {\n            type: Array,\n            default: ['resize', 'scroll']\n        },\n        to: [String, Object],\n        flip: {\n            type: Boolean,\n            default: true\n        },\n        x: Number,\n        y: Number,\n        width: String,\n        minWidth: String,\n        containerClass: String,\n        teleportDisabled: Boolean,\n        zindexable: {\n            type: Boolean,\n            default: true\n        },\n        zIndex: Number,\n        overlap: Boolean\n    },\n    setup(props) {\n        const VBinder = inject('VBinder');\n        const mergedEnabledRef = useMemo(() => {\n            return props.enabled !== undefined ? props.enabled : props.show;\n        });\n        const followerRef = ref(null);\n        const offsetContainerRef = ref(null);\n        const ensureListeners = () => {\n            const { syncTrigger } = props;\n            if (syncTrigger.includes('scroll')) {\n                VBinder.addScrollListener(syncPosition);\n            }\n            if (syncTrigger.includes('resize')) {\n                VBinder.addResizeListener(syncPosition);\n            }\n        };\n        const removeListeners = () => {\n            VBinder.removeScrollListener(syncPosition);\n            VBinder.removeResizeListener(syncPosition);\n        };\n        onMounted(() => {\n            if (mergedEnabledRef.value) {\n                syncPosition();\n                ensureListeners();\n            }\n        });\n        const ssrAdapter = useSsrAdapter();\n        style.mount({\n            id: 'vueuc/binder',\n            head: true,\n            ssr: ssrAdapter\n        });\n        onBeforeUnmount(() => {\n            removeListeners();\n        });\n        onFontsReady(() => {\n            if (mergedEnabledRef.value) {\n                syncPosition();\n            }\n        });\n        const syncPosition = () => {\n            if (!mergedEnabledRef.value) {\n                return;\n            }\n            const follower = followerRef.value;\n            // sometimes watched props change before its dom is ready\n            // for example: show=false, x=undefined, y=undefined\n            //              show=true,  x=0,         y=0\n            // will cause error\n            // I may optimize the watch start point later\n            if (follower === null)\n                return;\n            const target = VBinder.targetRef;\n            const { x, y, overlap } = props;\n            const targetRect = x !== undefined && y !== undefined\n                ? getPointRect(x, y)\n                : getRect(target);\n            const { width, minWidth, placement, flip } = props;\n            follower.setAttribute('v-placement', placement);\n            if (overlap) {\n                follower.setAttribute('v-overlap', '');\n            }\n            else {\n                follower.removeAttribute('v-overlap');\n            }\n            const { style } = follower;\n            if (width === 'target') {\n                style.width = `${targetRect.width}px`;\n            }\n            else if (width !== undefined) {\n                style.width = width;\n            }\n            else {\n                style.width = '';\n            }\n            if (minWidth === 'target') {\n                style.minWidth = `${targetRect.width}px`;\n            }\n            else if (minWidth !== undefined) {\n                style.minWidth = minWidth;\n            }\n            else {\n                style.minWidth = '';\n            }\n            const followerRect = getRect(follower);\n            const offsetContainerRect = getRect(offsetContainerRef.value);\n            const properPlacement = getProperPlacementOfFollower(placement, targetRect, followerRect, flip, overlap);\n            const properTransformOrigin = getProperTransformOrigin(properPlacement, overlap);\n            const { left, top, transform } = getOffset(properPlacement, offsetContainerRect, targetRect, overlap);\n            // we assume that the content size doesn't change after flip,\n            // nor we need to make sync logic more complex\n            follower.setAttribute('v-placement', properPlacement);\n            follower.style.transform = `translateX(${left}) translateY(${top}) ${transform}`;\n            follower.style.transformOrigin = properTransformOrigin;\n        };\n        watch(mergedEnabledRef, (value) => {\n            if (value) {\n                ensureListeners();\n                syncOnNextTick();\n            }\n            else {\n                removeListeners();\n            }\n        });\n        const syncOnNextTick = () => {\n            nextTick()\n                .then(syncPosition)\n                .catch((e) => console.error(e));\n        };\n        ['placement', 'x', 'y', 'flip', 'width', 'overlap', 'minWidth'].forEach((prop) => {\n            watch(toRef(props, prop), syncPosition);\n        });\n        ['teleportDisabled'].forEach((prop) => {\n            watch(toRef(props, prop), syncOnNextTick);\n        });\n        watch(toRef(props, 'syncTrigger'), (value) => {\n            if (!value.includes('resize')) {\n                VBinder.removeResizeListener(syncPosition);\n            }\n            else {\n                VBinder.addResizeListener(syncPosition);\n            }\n            if (!value.includes('scroll')) {\n                VBinder.removeScrollListener(syncPosition);\n            }\n            else {\n                VBinder.addScrollListener(syncPosition);\n            }\n        });\n        const isMountedRef = useIsMounted();\n        const mergedToRef = useMemo(() => {\n            const { to } = props;\n            if (to !== undefined)\n                return to;\n            if (isMountedRef.value) {\n                // TODO: find proper container\n                return undefined;\n            }\n            return undefined;\n        });\n        return {\n            VBinder,\n            mergedEnabled: mergedEnabledRef,\n            offsetContainerRef,\n            followerRef,\n            mergedTo: mergedToRef,\n            syncPosition\n        };\n    },\n    render() {\n        return h(LazyTeleport, {\n            show: this.show,\n            to: this.mergedTo,\n            disabled: this.teleportDisabled\n        }, {\n            default: () => {\n                const vNode = h('div', {\n                    class: ['v-binder-follower-container', this.containerClass],\n                    ref: 'offsetContainerRef'\n                }, [\n                    h('div', {\n                        class: 'v-binder-follower-content',\n                        ref: 'followerRef'\n                    }, this.$slots)\n                ]);\n                if (this.zindexable) {\n                    return withDirectives(vNode, [\n                        [\n                            zindexable,\n                            {\n                                enabled: this.mergedEnabled,\n                                zIndex: this.zIndex\n                            }\n                        ]\n                    ]);\n                }\n                return vNode;\n            }\n        });\n    }\n});\n","/* eslint-disable no-void */\n/* eslint-disable @typescript-eslint/restrict-plus-operands */\nimport { mergeProps, computed, defineComponent, ref, onMounted, h } from 'vue';\nimport { depx, pxfy, beforeNextFrameOnce } from 'seemly';\nimport { useMemo } from 'vooks';\nimport { c, FinweckTree } from '../../shared';\nimport VResizeObserver from '../../resize-observer/src';\nimport { useSsrAdapter } from '@css-render/vue3-ssr';\nconst styles = c('.v-vl', {\n    maxHeight: 'inherit',\n    height: '100%',\n    overflow: 'auto',\n    minWidth: '1px' // a zero width container won't be scrollable\n}, [\n    c('&:not(.v-vl--show-scrollbar)', {\n        scrollbarWidth: 'none'\n    }, [\n        c('&::-webkit-scrollbar, &::-webkit-scrollbar-track-piece, &::-webkit-scrollbar-thumb', {\n            width: 0,\n            height: 0,\n            display: 'none'\n        })\n    ])\n]);\nexport default defineComponent({\n    name: 'VirtualList',\n    inheritAttrs: false,\n    props: {\n        showScrollbar: {\n            type: Boolean,\n            default: true\n        },\n        items: {\n            type: Array,\n            default: () => []\n        },\n        // it is suppose to be the min height\n        itemSize: {\n            type: Number,\n            required: true\n        },\n        itemResizable: Boolean,\n        itemsStyle: [String, Object],\n        visibleItemsTag: {\n            type: [String, Object],\n            default: 'div'\n        },\n        visibleItemsProps: Object,\n        ignoreItemResize: Boolean,\n        onScroll: Function,\n        onWheel: Function,\n        onResize: Function,\n        defaultScrollKey: [Number, String],\n        defaultScrollIndex: Number,\n        keyField: {\n            type: String,\n            default: 'key'\n        },\n        // Whether it is a good API?\n        // ResizeObserver + footer & header is not enough.\n        // Too complex for simple case\n        paddingTop: {\n            type: [Number, String],\n            default: 0\n        },\n        paddingBottom: {\n            type: [Number, String],\n            default: 0\n        }\n    },\n    setup(props) {\n        const ssrAdapter = useSsrAdapter();\n        styles.mount({\n            id: 'vueuc/virtual-list',\n            head: true,\n            ssr: ssrAdapter\n        });\n        onMounted(() => {\n            const { defaultScrollIndex, defaultScrollKey } = props;\n            if (defaultScrollIndex !== undefined && defaultScrollIndex !== null) {\n                scrollTo({ index: defaultScrollIndex });\n            }\n            else if (defaultScrollKey !== undefined && defaultScrollKey !== null) {\n                scrollTo({ key: defaultScrollKey });\n            }\n        });\n        const keyIndexMapRef = computed(() => {\n            const map = new Map();\n            const { keyField } = props;\n            props.items.forEach((item, index) => {\n                map.set(item[keyField], index);\n            });\n            return map;\n        });\n        const listElRef = ref(null);\n        const listHeightRef = ref(undefined);\n        const keyToHeightOffset = new Map();\n        const finweckTreeRef = computed(() => {\n            const { items, itemSize, keyField } = props;\n            const ft = new FinweckTree(items.length, itemSize);\n            items.forEach((item, index) => {\n                const key = item[keyField];\n                const heightOffset = keyToHeightOffset.get(key);\n                if (heightOffset !== undefined) {\n                    ft.add(index, heightOffset);\n                }\n            });\n            return ft;\n        });\n        const finweckTreeUpdateTrigger = ref(0);\n        const scrollTopRef = ref(0);\n        const startIndexRef = useMemo(() => {\n            return Math.max(finweckTreeRef.value.getBound(scrollTopRef.value - depx(props.paddingTop)) - 1, 0);\n        });\n        const viewportItemsRef = computed(() => {\n            const { value: listHeight } = listHeightRef;\n            if (listHeight === undefined)\n                return [];\n            const { items, itemSize } = props;\n            const startIndex = startIndexRef.value;\n            const endIndex = Math.min(startIndex + Math.ceil(listHeight / itemSize + 1), items.length - 1);\n            const viewportItems = [];\n            for (let i = startIndex; i <= endIndex; ++i) {\n                viewportItems.push(items[i]);\n            }\n            return viewportItems;\n        });\n        const scrollTo = (options) => {\n            const { left, top, index, key, position, behavior, debounce = true } = options;\n            if (left !== undefined || top !== undefined) {\n                scrollToPosition(left, top, behavior);\n            }\n            else if (index !== undefined) {\n                scrollToIndex(index, behavior, debounce);\n            }\n            else if (key !== undefined) {\n                const toIndex = keyIndexMapRef.value.get(key);\n                if (toIndex !== undefined)\n                    scrollToIndex(toIndex, behavior, debounce);\n            }\n            else if (position === 'bottom') {\n                scrollToPosition(0, Number.MAX_SAFE_INTEGER, behavior);\n            }\n            else if (position === 'top') {\n                scrollToPosition(0, 0, behavior);\n            }\n        };\n        function scrollToIndex(index, behavior, debounce) {\n            const { value: ft } = finweckTreeRef;\n            const targetTop = ft.sum(index) + depx(props.paddingTop);\n            if (!debounce) {\n                listElRef.value.scrollTo({\n                    left: 0,\n                    top: targetTop,\n                    behavior\n                });\n            }\n            else {\n                const { scrollTop, offsetHeight } = listElRef.value;\n                if (targetTop > scrollTop) {\n                    const itemSize = ft.get(index);\n                    if (targetTop + itemSize <= scrollTop + offsetHeight) {\n                        // do nothing\n                    }\n                    else {\n                        listElRef.value.scrollTo({\n                            left: 0,\n                            top: targetTop + itemSize - offsetHeight,\n                            behavior\n                        });\n                    }\n                }\n                else {\n                    listElRef.value.scrollTo({\n                        left: 0,\n                        top: targetTop,\n                        behavior\n                    });\n                }\n            }\n            lastScrollAnchorIndex = index;\n        }\n        function scrollToPosition(left, top, behavior) {\n            listElRef.value.scrollTo({\n                left,\n                top,\n                behavior\n            });\n        }\n        function handleItemResize(key, entry) {\n            var _a;\n            if (props.ignoreItemResize)\n                return;\n            const { value: ft } = finweckTreeRef;\n            const index = keyIndexMapRef.value.get(key);\n            const height = entry.target.offsetHeight;\n            // height offset based on itemSize\n            // used when rebuild the finweck tree\n            const offset = height - props.itemSize;\n            if (offset === 0) {\n                keyToHeightOffset.delete(key);\n            }\n            else {\n                keyToHeightOffset.set(key, height - props.itemSize);\n            }\n            // delta height based on finweck tree data\n            const delta = height - ft.get(index);\n            if (delta === 0)\n                return;\n            if (lastAnchorIndex !== undefined && index <= lastAnchorIndex) {\n                (_a = listElRef.value) === null || _a === void 0 ? void 0 : _a.scrollBy(0, delta);\n            }\n            ft.add(index, delta);\n            finweckTreeUpdateTrigger.value++;\n        }\n        function handleListScroll(e) {\n            beforeNextFrameOnce(syncViewport);\n            const { onScroll } = props;\n            if (onScroll !== undefined)\n                onScroll(e);\n        }\n        function handleListResize(entry) {\n            listHeightRef.value = entry.contentRect.height;\n            const { onResize } = props;\n            if (onResize !== undefined)\n                onResize(entry);\n        }\n        let lastScrollAnchorIndex;\n        let lastAnchorIndex;\n        function syncViewport() {\n            const { value: listEl } = listElRef;\n            // sometime ref el can be null\n            // https://github.com/TuSimple/naive-ui/issues/811\n            if (listEl == null)\n                return;\n            lastAnchorIndex = lastScrollAnchorIndex !== null && lastScrollAnchorIndex !== void 0 ? lastScrollAnchorIndex : startIndexRef.value;\n            lastScrollAnchorIndex = undefined;\n            scrollTopRef.value = listElRef.value.scrollTop;\n        }\n        return {\n            listHeight: listHeightRef,\n            listStyle: {\n                overflow: 'auto'\n            },\n            keyToIndex: keyIndexMapRef,\n            itemsStyle: computed(() => {\n                const { itemResizable } = props;\n                const height = pxfy(finweckTreeRef.value.sum());\n                // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n                finweckTreeUpdateTrigger.value;\n                return [\n                    props.itemsStyle,\n                    {\n                        boxSizing: 'content-box',\n                        height: itemResizable ? '' : height,\n                        minHeight: itemResizable ? height : '',\n                        paddingTop: pxfy(props.paddingTop),\n                        paddingBottom: pxfy(props.paddingBottom)\n                    }\n                ];\n            }),\n            visibleItemsStyle: computed(() => {\n                // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n                finweckTreeUpdateTrigger.value;\n                return {\n                    transform: `translate3d(0, ${pxfy(finweckTreeRef.value.sum(startIndexRef.value))}, 0)`\n                };\n            }),\n            viewportItems: viewportItemsRef,\n            listElRef,\n            itemsElRef: ref(null),\n            scrollTo,\n            handleListResize,\n            handleListScroll,\n            handleItemResize\n        };\n    },\n    render() {\n        const { itemResizable, keyField, keyToIndex, visibleItemsTag } = this;\n        return h(VResizeObserver, {\n            onResize: this.handleListResize\n        }, {\n            default: () => {\n                var _a, _b;\n                return h('div', mergeProps(this.$attrs, {\n                    class: [\n                        'v-vl',\n                        this.showScrollbar && 'v-vl--show-scrollbar'\n                    ],\n                    onScroll: this.handleListScroll,\n                    onWheel: this.onWheel,\n                    ref: 'listElRef'\n                }), [\n                    this.items.length !== 0\n                        ? h('div', {\n                            ref: 'itemsElRef',\n                            class: 'v-vl-items',\n                            style: this.itemsStyle\n                        }, [\n                            h(visibleItemsTag, Object.assign({\n                                class: 'v-vl-visible-items',\n                                style: this.visibleItemsStyle\n                            }, this.visibleItemsProps), {\n                                default: () => this.viewportItems.map(item => {\n                                    const key = item[keyField];\n                                    const index = keyToIndex.get(key);\n                                    const itemVNode = this.$slots.default({ item, index })[0];\n                                    if (itemResizable) {\n                                        return h(VResizeObserver, {\n                                            key,\n                                            onResize: (entry) => this.handleItemResize(key, entry)\n                                        }, {\n                                            default: () => itemVNode\n                                        });\n                                    }\n                                    itemVNode.key = key;\n                                    return itemVNode;\n                                })\n                            })\n                        ])\n                        : (_b = (_a = this.$slots).empty) === null || _b === void 0 ? void 0 : _b.call(_a)\n                ]);\n            }\n        });\n    }\n});\n","/* eslint-disable @typescript-eslint/strict-boolean-expressions */\nimport { defineComponent, renderSlot, h, onMounted, ref, nextTick } from 'vue';\nimport { useSsrAdapter } from '@css-render/vue3-ssr';\nimport { c } from '../../shared';\nconst hiddenAttr = 'v-hidden';\nconst style = c('[v-hidden]', {\n    display: 'none!important'\n});\nexport default defineComponent({\n    name: 'Overflow',\n    props: {\n        getCounter: Function,\n        getTail: Function,\n        updateCounter: Function,\n        onUpdateOverflow: Function\n    },\n    setup(props, { slots }) {\n        const selfRef = ref(null);\n        const counterRef = ref(null);\n        function deriveCounter() {\n            const { value: self } = selfRef;\n            const { getCounter, getTail } = props;\n            let counter;\n            if (getCounter !== undefined)\n                counter = getCounter();\n            else {\n                counter = counterRef.value;\n            }\n            if (!self || !counter)\n                return;\n            if (counter.hasAttribute(hiddenAttr)) {\n                counter.removeAttribute(hiddenAttr);\n            }\n            const { children } = self;\n            const containerWidth = self.offsetWidth;\n            const childWidths = [];\n            const tail = slots.tail ? getTail === null || getTail === void 0 ? void 0 : getTail() : null;\n            let childWidthSum = tail ? tail.offsetWidth : 0;\n            let overflow = false;\n            const len = self.children.length - (slots.tail ? 1 : 0);\n            for (let i = 0; i < len - 1; ++i) {\n                if (i < 0)\n                    continue;\n                const child = children[i];\n                if (overflow) {\n                    if (!child.hasAttribute(hiddenAttr)) {\n                        child.setAttribute(hiddenAttr, '');\n                    }\n                    continue;\n                }\n                else if (child.hasAttribute(hiddenAttr)) {\n                    child.removeAttribute(hiddenAttr);\n                }\n                const childWidth = child.offsetWidth;\n                childWidthSum += childWidth;\n                childWidths[i] = childWidth;\n                if (childWidthSum > containerWidth) {\n                    const { updateCounter } = props;\n                    for (let j = i; j >= 0; --j) {\n                        const restCount = len - 1 - j;\n                        if (updateCounter !== undefined) {\n                            updateCounter(restCount);\n                        }\n                        else {\n                            counter.textContent = `${restCount}`;\n                        }\n                        const counterWidth = counter.offsetWidth;\n                        childWidthSum -= childWidths[j];\n                        if (childWidthSum + counterWidth <= containerWidth || j === 0) {\n                            overflow = true;\n                            i = j - 1;\n                            if (tail) {\n                                // tail too long or 1st element too long\n                                // we only consider tail now\n                                if (i === -1) {\n                                    tail.style.maxWidth = `${containerWidth - counterWidth}px`;\n                                    tail.style.boxSizing = 'border-box';\n                                }\n                                else {\n                                    tail.style.maxWidth = '';\n                                }\n                            }\n                            break;\n                        }\n                    }\n                }\n            }\n            const { onUpdateOverflow } = props;\n            if (!overflow) {\n                if (onUpdateOverflow !== undefined) {\n                    onUpdateOverflow(false);\n                }\n                counter.setAttribute(hiddenAttr, '');\n            }\n            else {\n                if (onUpdateOverflow !== undefined) {\n                    onUpdateOverflow(true);\n                }\n            }\n        }\n        const ssrAdapter = useSsrAdapter();\n        style.mount({\n            id: 'vueuc/overflow',\n            head: true,\n            ssr: ssrAdapter\n        });\n        onMounted(deriveCounter);\n        // besides onMounted, other case should be manually triggered, or we shoud watch items\n        return {\n            selfRef,\n            counterRef,\n            sync: deriveCounter\n        };\n    },\n    render() {\n        const { $slots } = this;\n        // eslint-disable-next-line @typescript-eslint/no-floating-promises\n        nextTick(this.sync);\n        // It shouldn't have border\n        return h('div', {\n            class: 'v-overflow',\n            ref: 'selfRef'\n        }, [\n            renderSlot($slots, 'default'),\n            // $slots.counter should only has 1 element\n            $slots.counter\n                ? $slots.counter()\n                : h('span', {\n                    style: {\n                        display: 'inline-block'\n                    },\n                    ref: 'counterRef'\n                }),\n            // $slots.tail should only has 1 element\n            $slots.tail ? $slots.tail() : null\n        ]);\n    }\n});\n","export default {\n    iconSizeSmall: '34px',\n    iconSizeMedium: '40px',\n    iconSizeLarge: '46px',\n    iconSizeHuge: '52px'\n};\n","import commonVars from './_common';\nimport { commonLight } from '../../_styles/common';\nexport const self = (vars) => {\n    const { textColorDisabled, iconColor, textColor2, fontSizeSmall, fontSizeMedium, fontSizeLarge, fontSizeHuge } = vars;\n    return Object.assign(Object.assign({}, commonVars), { fontSizeSmall,\n        fontSizeMedium,\n        fontSizeLarge,\n        fontSizeHuge, textColor: textColorDisabled, iconColor: iconColor, extraTextColor: textColor2 });\n};\nconst emptyLight = {\n    name: 'Empty',\n    common: commonLight,\n    self\n};\nexport default emptyLight;\n","import { cB, cE } from '../../../_utils/cssr'; // vars:\n// --font-size\n// --icon-size\n// --icon-color\n// --bezier\n// --text-color\n// --extra-text-color\n\nexport default cB('empty', `\n display: flex;\n flex-direction: column;\n align-items: center;\n font-size: var(--font-size);\n`, [cE('icon', `\n width: var(--icon-size);\n height: var(--icon-size);\n font-size: var(--icon-size);\n line-height: var(--icon-size);\n color: var(--icon-color);\n transition:\n color .3s var(--bezier);\n `), cE('description', `\n margin-top: 8px;\n transition: color .3s var(--bezier);\n color: var(--text-color);\n `), cE('extra', `\n text-align: center;\n transition: color .3s var(--bezier);\n margin-top: 12px;\n color: var(--extra-text-color);\n `)]);","import { h, defineComponent, computed, renderSlot, inject } from 'vue';\nimport { EmptyIcon } from '../../_internal/icons';\nimport { useConfig, useLocale, useTheme } from '../../_mixins';\nimport { createKey } from '../../_utils';\nimport { NBaseIcon } from '../../_internal';\nimport { emptyLight } from '../styles';\nimport style from './styles/index.cssr';\nimport { configProviderInjectionKey } from '../../config-provider/src/ConfigProvider';\nconst emptyProps = Object.assign(Object.assign({}, useTheme.props), { description: {\n        type: String,\n        default: undefined\n    }, showDescription: {\n        type: Boolean,\n        default: true\n    }, size: {\n        type: String,\n        default: 'medium'\n    }, renderIcon: Function });\nexport default defineComponent({\n    name: 'Empty',\n    props: emptyProps,\n    setup(props) {\n        const { mergedClsPrefixRef } = useConfig(props);\n        const themeRef = useTheme('Empty', 'Empty', style, emptyLight, props, mergedClsPrefixRef);\n        const { localeRef } = useLocale('Empty');\n        const NConfigProvider = inject(configProviderInjectionKey, null);\n        const mergedDescriptionRef = computed(() => {\n            var _a, _b, _c;\n            return ((_a = props.description) !== null && _a !== void 0 ? _a : (_c = (_b = NConfigProvider === null || NConfigProvider === void 0 ? void 0 : NConfigProvider.mergedComponentPropsRef.value) === null || _b === void 0 ? void 0 : _b.Empty) === null || _c === void 0 ? void 0 : _c.description);\n        });\n        const mergedRenderIconRef = computed(() => {\n            var _a, _b;\n            return ((_b = (_a = NConfigProvider === null || NConfigProvider === void 0 ? void 0 : NConfigProvider.mergedComponentPropsRef.value) === null || _a === void 0 ? void 0 : _a.Empty) === null || _b === void 0 ? void 0 : _b.renderIcon) ||\n                (() => h(EmptyIcon, null));\n        });\n        return {\n            mergedClsPrefix: mergedClsPrefixRef,\n            mergedRenderIcon: mergedRenderIconRef,\n            localizedDescription: computed(() => {\n                return mergedDescriptionRef.value || localeRef.value.description;\n            }),\n            cssVars: computed(() => {\n                const { size } = props;\n                const { common: { cubicBezierEaseInOut }, self: { [createKey('iconSize', size)]: iconSize, [createKey('fontSize', size)]: fontSize, textColor, iconColor, extraTextColor } } = themeRef.value;\n                return {\n                    '--icon-size': iconSize,\n                    '--font-size': fontSize,\n                    '--bezier': cubicBezierEaseInOut,\n                    '--text-color': textColor,\n                    '--icon-color': iconColor,\n                    '--extra-text-color': extraTextColor\n                };\n            })\n        };\n    },\n    render() {\n        const { $slots, mergedClsPrefix } = this;\n        return (h(\"div\", { class: `${mergedClsPrefix}-empty`, style: this.cssVars },\n            h(\"div\", { class: `${mergedClsPrefix}-empty__icon` }, renderSlot($slots, 'icon', undefined, () => [\n                h(NBaseIcon, { clsPrefix: mergedClsPrefix }, { default: this.mergedRenderIcon })\n            ])),\n            this.showDescription ? (h(\"div\", { class: `${mergedClsPrefix}-empty__description` }, renderSlot($slots, 'default', undefined, () => [\n                this.localizedDescription\n            ]))) : null,\n            $slots.extra ? (h(\"div\", { class: `${mergedClsPrefix}-empty__extra` }, renderSlot($slots, 'extra'))) : null));\n    }\n});\n","import { commonLight } from '../../../_styles/common';\nexport const self = (vars) => {\n    const { scrollbarColor, scrollbarColorHover } = vars;\n    return {\n        color: scrollbarColor,\n        colorHover: scrollbarColorHover\n    };\n};\nconst scrollbarLight = {\n    name: 'Scrollbar',\n    common: commonLight,\n    self\n};\nexport default scrollbarLight;\n","import { cB, c, cM, cE } from '../../../../_utils/cssr';\nimport fadeInTransition from '../../../../_styles/transitions/fade-in.cssr'; // vars:\n// --scrollbar-bezier\n// --scrollbar-color\n// --scrollbar-color-hover\n// --scrollbar-width\n// --scrollbar-height\n// --scrollbar-border-radius\n\nexport default cB('scrollbar', `\n overflow: hidden;\n position: relative;\n z-index: auto;\n height: 100%;\n width: 100%;\n`, [c('>', [cB('scrollbar-container', `\n width: 100%;\n overflow: scroll;\n height: 100%;\n max-height: inherit;\n scrollbar-width: none;\n `, [c('&::-webkit-scrollbar, &::-webkit-scrollbar-track-piece, &::-webkit-scrollbar-thumb', `\n width: 0;\n height: 0;\n display: none;\n `), c('>', [cB('scrollbar-content', `\n box-sizing: border-box;\n min-width: 100%;\n `)])]), cB('scrollbar-rail', `\n position: absolute;\n pointer-events: none;\n user-select: none;\n `, [cM('horizontal', `\n left: 2px;\n right: 2px;\n bottom: 4px;\n height: var(--scrollbar-height);\n `, [c('>', [cE('scrollbar', `\n height: var(--scrollbar-height);\n border-radius: var(--scrollbar-border-radius);\n right: 0;\n `)])]), cM('vertical', `\n right: 4px;\n top: 2px;\n bottom: 2px;\n width: var(--scrollbar-width);\n `, [c('>', [cE('scrollbar', `\n width: var(--scrollbar-width);\n border-radius: var(--scrollbar-border-radius);\n bottom: 0;\n `)])]), cM('disabled', [c('>', [cE('scrollbar', {\n  pointerEvents: 'none'\n})])]), c('>', [cE('scrollbar', `\n position: absolute;\n cursor: pointer;\n pointer-events: all;\n background-color: var(--scrollbar-color);\n transition: background-color .2s var(--scrollbar-bezier);\n `, [fadeInTransition(), c('&:hover', {\n  backgroundColor: 'var(--scrollbar-color-hover)'\n})])])])])]);","import { h, ref, defineComponent, computed, onMounted, onBeforeUnmount, mergeProps, renderSlot, Transition, watchEffect } from 'vue';\nimport { on, off } from 'evtd';\nimport { VResizeObserver } from 'vueuc';\nimport { useIsIos } from 'vooks';\nimport { useConfig, useTheme } from '../../../_mixins';\nimport { scrollbarLight } from '../styles';\nimport style from './styles/index.cssr';\nconst scrollbarProps = Object.assign(Object.assign({}, useTheme.props), { size: {\n        type: Number,\n        default: 5\n    }, duration: {\n        type: Number,\n        default: 0\n    }, scrollable: {\n        type: Boolean,\n        default: true\n    }, xScrollable: {\n        type: Boolean,\n        default: false\n    }, \n    // If container is set, resize observer won't not attached\n    container: Function, content: Function, containerStyle: [String, Object], contentClass: String, contentStyle: [String, Object], horizontalRailStyle: [String, Object], verticalRailStyle: [String, Object], onScroll: Function, onWheel: Function, onResize: Function, internalOnUpdateScrollLeft: Function });\nconst Scrollbar = defineComponent({\n    name: 'Scrollbar',\n    props: scrollbarProps,\n    inheritAttrs: false,\n    setup(props) {\n        const { mergedClsPrefixRef } = useConfig(props);\n        // dom ref\n        const containerRef = ref(null);\n        const contentRef = ref(null);\n        const yRailRef = ref(null);\n        const xRailRef = ref(null);\n        // data ref\n        const contentHeightRef = ref(null);\n        const contentWidthRef = ref(null);\n        const containerHeightRef = ref(null);\n        const containerWidthRef = ref(null);\n        const yRailSizeRef = ref(null);\n        const xRailSizeRef = ref(null);\n        const containerScrollTopRef = ref(0);\n        const containerScrollLeftRef = ref(0);\n        const isShowXBarRef = ref(false);\n        const isShowYBarRef = ref(false);\n        let yBarPressed = false;\n        let xBarPressed = false;\n        let xBarVanishTimerId;\n        let yBarVanishTimerId;\n        let memoYTop = 0;\n        let memoXLeft = 0;\n        let memoMouseX = 0;\n        let memoMouseY = 0;\n        const isIos = useIsIos();\n        const yBarSizeRef = computed(() => {\n            const { value: containerHeight } = containerHeightRef;\n            const { value: contentHeight } = contentHeightRef;\n            const { value: yRailSize } = yRailSizeRef;\n            if (containerHeight === null ||\n                contentHeight === null ||\n                yRailSize === null) {\n                return 0;\n            }\n            else {\n                return Math.min(containerHeight, (yRailSize * containerHeight) / contentHeight + props.size * 1.5);\n            }\n        });\n        const yBarSizePxRef = computed(() => {\n            return `${yBarSizeRef.value}px`;\n        });\n        const xBarSizeRef = computed(() => {\n            const { value: containerWidth } = containerWidthRef;\n            const { value: contentWidth } = contentWidthRef;\n            const { value: xRailSize } = xRailSizeRef;\n            if (containerWidth === null ||\n                contentWidth === null ||\n                xRailSize === null) {\n                return 0;\n            }\n            else {\n                return (xRailSize * containerWidth) / contentWidth + props.size * 1.5;\n            }\n        });\n        const xBarSizePxRef = computed(() => {\n            return `${xBarSizeRef.value}px`;\n        });\n        const yBarTopRef = computed(() => {\n            const { value: containerHeight } = containerHeightRef;\n            const { value: containerScrollTop } = containerScrollTopRef;\n            const { value: contentHeight } = contentHeightRef;\n            const { value: yRailSize } = yRailSizeRef;\n            if (containerHeight === null ||\n                contentHeight === null ||\n                yRailSize === null) {\n                return 0;\n            }\n            else {\n                return ((containerScrollTop / (contentHeight - containerHeight)) *\n                    (yRailSize - yBarSizeRef.value));\n            }\n        });\n        const yBarTopPxRef = computed(() => {\n            return `${yBarTopRef.value}px`;\n        });\n        const xBarLeftRef = computed(() => {\n            const { value: containerWidth } = containerWidthRef;\n            const { value: containerScrollLeft } = containerScrollLeftRef;\n            const { value: contentWidth } = contentWidthRef;\n            const { value: xRailSize } = xRailSizeRef;\n            if (containerWidth === null ||\n                contentWidth === null ||\n                xRailSize === null) {\n                return 0;\n            }\n            else {\n                return ((containerScrollLeft / (contentWidth - containerWidth)) *\n                    (xRailSize - xBarSizeRef.value));\n            }\n        });\n        const xBarLeftPxRef = computed(() => {\n            return `${xBarLeftRef.value}px`;\n        });\n        const needYBarRef = computed(() => {\n            const { value: containerHeight } = containerHeightRef;\n            const { value: contentHeight } = contentHeightRef;\n            return (containerHeight !== null &&\n                contentHeight !== null &&\n                contentHeight > containerHeight);\n        });\n        const needXBarRef = computed(() => {\n            const { value: containerWidth } = containerWidthRef;\n            const { value: contentWidth } = contentWidthRef;\n            return (containerWidth !== null &&\n                contentWidth !== null &&\n                contentWidth > containerWidth);\n        });\n        const mergedContainerRef = computed(() => {\n            const { container } = props;\n            if (container)\n                return container();\n            return containerRef.value;\n        });\n        const mergedContentRef = computed(() => {\n            const { content } = props;\n            if (content)\n                return content();\n            return contentRef.value;\n        });\n        // methods\n        const handleContentResize = sync;\n        const handleContainerResize = (e) => {\n            const { onResize } = props;\n            if (onResize)\n                onResize(e);\n            sync();\n        };\n        const scrollTo = (options, y) => {\n            if (!props.scrollable)\n                return;\n            if (typeof options === 'number') {\n                scrollToPosition(options, y !== null && y !== void 0 ? y : 0, 0, false, 'auto');\n                return;\n            }\n            const { left, top, index, elSize, position, behavior, el, debounce = true } = options;\n            if (left !== undefined || top !== undefined) {\n                scrollToPosition(left !== null && left !== void 0 ? left : 0, top !== null && top !== void 0 ? top : 0, 0, false, behavior);\n            }\n            if (el !== undefined) {\n                scrollToPosition(0, el.offsetTop, el.offsetHeight, debounce, behavior);\n            }\n            else if (index !== undefined && elSize !== undefined) {\n                scrollToPosition(0, index * elSize, elSize, debounce, behavior);\n            }\n            else if (position === 'bottom') {\n                scrollToPosition(0, Number.MAX_SAFE_INTEGER, 0, false, behavior);\n            }\n            else if (position === 'top') {\n                scrollToPosition(0, 0, 0, false, behavior);\n            }\n        };\n        function scrollToPosition(left, top, elSize, debounce, behavior) {\n            const { value: container } = mergedContainerRef;\n            if (!container)\n                return;\n            if (debounce) {\n                const { scrollTop, offsetHeight } = container;\n                if (top > scrollTop) {\n                    if (top + elSize <= scrollTop + offsetHeight) {\n                        // do nothing\n                    }\n                    else {\n                        container.scrollTo({\n                            left,\n                            top: top + elSize - offsetHeight,\n                            behavior\n                        });\n                    }\n                    return;\n                }\n            }\n            container.scrollTo({\n                left,\n                top,\n                behavior\n            });\n        }\n        function handleMouseEnterWrapper() {\n            showXBar();\n            showYBar();\n            sync();\n        }\n        function handleMouseLeaveWrapper() {\n            hideBar();\n        }\n        function hideBar() {\n            hideYBar();\n            hideXBar();\n        }\n        function hideYBar() {\n            if (yBarVanishTimerId !== undefined) {\n                window.clearTimeout(yBarVanishTimerId);\n            }\n            yBarVanishTimerId = window.setTimeout(() => {\n                isShowYBarRef.value = false;\n            }, props.duration);\n        }\n        function hideXBar() {\n            if (xBarVanishTimerId !== undefined) {\n                window.clearTimeout(xBarVanishTimerId);\n            }\n            xBarVanishTimerId = window.setTimeout(() => {\n                isShowXBarRef.value = false;\n            }, props.duration);\n        }\n        function showXBar() {\n            if (xBarVanishTimerId !== undefined) {\n                window.clearTimeout(xBarVanishTimerId);\n            }\n            isShowXBarRef.value = true;\n        }\n        function showYBar() {\n            if (yBarVanishTimerId !== undefined) {\n                window.clearTimeout(yBarVanishTimerId);\n            }\n            isShowYBarRef.value = true;\n        }\n        function handleScroll(e) {\n            const { onScroll } = props;\n            if (onScroll)\n                onScroll(e);\n            syncScrollState();\n        }\n        function syncScrollState() {\n            // only collect scroll state, do not trigger any dom event\n            const { value: container } = mergedContainerRef;\n            if (container) {\n                containerScrollTopRef.value = container.scrollTop;\n                containerScrollLeftRef.value = container.scrollLeft;\n            }\n        }\n        function syncPositionState() {\n            // only collect position state, do not trigger any dom event\n            // Don't use getClientBoundingRect because element may be scale transformed\n            const { value: content } = mergedContentRef;\n            if (content) {\n                contentHeightRef.value = content.offsetHeight;\n                contentWidthRef.value = content.offsetWidth;\n            }\n            const { value: container } = mergedContainerRef;\n            if (container) {\n                containerHeightRef.value = container.offsetHeight;\n                containerWidthRef.value = container.offsetWidth;\n            }\n            const { value: xRailEl } = xRailRef;\n            const { value: yRailEl } = yRailRef;\n            if (xRailEl) {\n                xRailSizeRef.value = xRailEl.offsetWidth;\n            }\n            if (yRailEl) {\n                yRailSizeRef.value = yRailEl.offsetHeight;\n            }\n        }\n        function sync() {\n            if (!props.scrollable)\n                return;\n            syncPositionState();\n            syncScrollState();\n        }\n        function handleXScrollMouseDown(e) {\n            e.preventDefault();\n            e.stopPropagation();\n            xBarPressed = true;\n            on('mousemove', window, handleXScrollMouseMove, true);\n            on('mouseup', window, handleXScrollMouseUp, true);\n            memoXLeft = containerScrollLeftRef.value;\n            memoMouseX = e.clientX;\n        }\n        function handleXScrollMouseMove(e) {\n            if (!xBarPressed)\n                return;\n            if (xBarVanishTimerId !== undefined) {\n                window.clearTimeout(xBarVanishTimerId);\n            }\n            if (yBarVanishTimerId !== undefined) {\n                window.clearTimeout(yBarVanishTimerId);\n            }\n            const { value: containerWidth } = containerWidthRef;\n            const { value: contentWidth } = contentWidthRef;\n            const { value: xBarSize } = xBarSizeRef;\n            if (containerWidth === null || contentWidth === null)\n                return;\n            const dX = e.clientX - memoMouseX;\n            const dScrollLeft = (dX * (contentWidth - containerWidth)) / (containerWidth - xBarSize);\n            const toScrollLeftUpperBound = contentWidth - containerWidth;\n            let toScrollLeft = memoXLeft + dScrollLeft;\n            toScrollLeft = Math.min(toScrollLeftUpperBound, toScrollLeft);\n            toScrollLeft = Math.max(toScrollLeft, 0);\n            const { value: container } = mergedContainerRef;\n            if (container) {\n                container.scrollLeft = toScrollLeft;\n                const { internalOnUpdateScrollLeft } = props;\n                if (internalOnUpdateScrollLeft)\n                    internalOnUpdateScrollLeft(toScrollLeft);\n            }\n        }\n        function handleXScrollMouseUp(e) {\n            e.preventDefault();\n            e.stopPropagation();\n            off('mousemove', window, handleXScrollMouseMove, true);\n            off('mouseup', window, handleXScrollMouseUp, true);\n            xBarPressed = false;\n            sync();\n            const { value: container } = mergedContainerRef;\n            if (!(container === null || container === void 0 ? void 0 : container.contains(e.target))) {\n                hideBar();\n            }\n        }\n        function handleYScrollMouseDown(e) {\n            e.preventDefault();\n            e.stopPropagation();\n            yBarPressed = true;\n            on('mousemove', window, handleYScrollMouseMove, true);\n            on('mouseup', window, handleYScrollMouseUp, true);\n            memoYTop = containerScrollTopRef.value;\n            memoMouseY = e.clientY;\n        }\n        function handleYScrollMouseMove(e) {\n            if (!yBarPressed)\n                return;\n            if (xBarVanishTimerId !== undefined) {\n                window.clearTimeout(xBarVanishTimerId);\n            }\n            if (yBarVanishTimerId !== undefined) {\n                window.clearTimeout(yBarVanishTimerId);\n            }\n            const { value: containerHeight } = containerHeightRef;\n            const { value: contentHeight } = contentHeightRef;\n            const { value: yBarSize } = yBarSizeRef;\n            if (containerHeight === null || contentHeight === null)\n                return;\n            const dY = e.clientY - memoMouseY;\n            const dScrollTop = (dY * (contentHeight - containerHeight)) / (containerHeight - yBarSize);\n            const toScrollTopUpperBound = contentHeight - containerHeight;\n            let toScrollTop = memoYTop + dScrollTop;\n            toScrollTop = Math.min(toScrollTopUpperBound, toScrollTop);\n            toScrollTop = Math.max(toScrollTop, 0);\n            const { value: container } = mergedContainerRef;\n            if (container) {\n                container.scrollTop = toScrollTop;\n            }\n        }\n        function handleYScrollMouseUp(e) {\n            e.preventDefault();\n            e.stopPropagation();\n            off('mousemove', window, handleYScrollMouseMove, true);\n            off('mouseup', window, handleYScrollMouseUp, true);\n            yBarPressed = false;\n            sync();\n            const { value: container } = mergedContainerRef;\n            if (!(container === null || container === void 0 ? void 0 : container.contains(e.target))) {\n                hideBar();\n            }\n        }\n        watchEffect(() => {\n            const { value: needXBar } = needXBarRef;\n            const { value: needYBar } = needYBarRef;\n            const { value: mergedClsPrefix } = mergedClsPrefixRef;\n            const { value: xRailEl } = xRailRef;\n            const { value: yRailEl } = yRailRef;\n            if (xRailEl) {\n                if (!needXBar) {\n                    xRailEl.classList.add(`${mergedClsPrefix}-scrollbar-rail--disabled`);\n                }\n                else {\n                    xRailEl.classList.remove(`${mergedClsPrefix}-scrollbar-rail--disabled`);\n                }\n            }\n            if (yRailEl) {\n                if (!needYBar) {\n                    yRailEl.classList.add(`${mergedClsPrefix}-scrollbar-rail--disabled`);\n                }\n                else {\n                    yRailEl.classList.remove(`${mergedClsPrefix}-scrollbar-rail--disabled`);\n                }\n            }\n        });\n        onMounted(() => {\n            // if container exist, it always can't be resolved when scrollbar is mounted\n            // for example:\n            // - component\n            //   - scrollbar\n            //     - inner\n            // if you pass inner to scrollbar, you may use a ref inside component\n            // however, when scrollbar is mounted, ref is not ready at component\n            // you need to init by yourself\n            if (props.container)\n                return;\n            sync();\n        });\n        onBeforeUnmount(() => {\n            if (xBarVanishTimerId !== undefined) {\n                window.clearTimeout(xBarVanishTimerId);\n            }\n            if (yBarVanishTimerId !== undefined) {\n                window.clearTimeout(yBarVanishTimerId);\n            }\n            off('mousemove', window, handleYScrollMouseMove, true);\n            off('mouseup', window, handleYScrollMouseUp, true);\n        });\n        const themeRef = useTheme('Scrollbar', 'Scrollbar', style, scrollbarLight, props, mergedClsPrefixRef);\n        return {\n            sync,\n            scrollTo,\n            mergedClsPrefix: mergedClsPrefixRef,\n            containerScrollTop: containerScrollTopRef,\n            containerRef,\n            contentRef,\n            yRailRef,\n            xRailRef,\n            needYBar: needYBarRef,\n            needXBar: needXBarRef,\n            yBarSizePx: yBarSizePxRef,\n            xBarSizePx: xBarSizePxRef,\n            yBarTopPx: yBarTopPxRef,\n            xBarLeftPx: xBarLeftPxRef,\n            isShowXBar: isShowXBarRef,\n            isShowYBar: isShowYBarRef,\n            isIos,\n            handleScroll,\n            handleContentResize,\n            handleContainerResize,\n            handleMouseEnterWrapper,\n            handleMouseLeaveWrapper,\n            handleYScrollMouseDown,\n            handleXScrollMouseDown,\n            cssVars: computed(() => {\n                const { common: { cubicBezierEaseInOut, scrollbarBorderRadius, scrollbarHeight, scrollbarWidth }, self: { color, colorHover } } = themeRef.value;\n                return {\n                    '--scrollbar-bezier': cubicBezierEaseInOut,\n                    '--scrollbar-color': color,\n                    '--scrollbar-color-hover': colorHover,\n                    '--scrollbar-border-radius': scrollbarBorderRadius,\n                    '--scrollbar-width': scrollbarWidth,\n                    '--scrollbar-height': scrollbarHeight\n                };\n            })\n        };\n    },\n    render() {\n        const { $slots, mergedClsPrefix } = this;\n        if (!this.scrollable)\n            return renderSlot($slots, 'default');\n        const createChildren = () => h('div', mergeProps(this.$attrs, {\n            class: `${mergedClsPrefix}-scrollbar`,\n            style: this.cssVars,\n            onMouseenter: this.handleMouseEnterWrapper,\n            onMouseleave: this.handleMouseLeaveWrapper\n        }), [\n            this.container ? (renderSlot($slots, 'default')) : (h(\"div\", { ref: \"containerRef\", class: `${mergedClsPrefix}-scrollbar-container`, style: this.containerStyle, onScroll: this.handleScroll, onWheel: this.onWheel },\n                h(VResizeObserver, { onResize: this.handleContentResize }, {\n                    default: () => (h(\"div\", { ref: \"contentRef\", style: [\n                            {\n                                width: this.xScrollable ? 'fit-content' : null\n                            },\n                            this.contentStyle\n                        ], class: [\n                            `${mergedClsPrefix}-scrollbar-content`,\n                            this.contentClass\n                        ] }, $slots))\n                }))),\n            h(\"div\", { ref: \"yRailRef\", class: `${mergedClsPrefix}-scrollbar-rail ${mergedClsPrefix}-scrollbar-rail--vertical`, style: [this.horizontalRailStyle] },\n                h(Transition, { name: \"fade-in-transition\" }, {\n                    default: () => this.needYBar && this.isShowYBar && !this.isIos ? (h(\"div\", { class: `${mergedClsPrefix}-scrollbar-rail__scrollbar`, style: {\n                            height: this.yBarSizePx,\n                            top: this.yBarTopPx\n                        }, onMousedown: this.handleYScrollMouseDown })) : null\n                })),\n            h(\"div\", { ref: \"xRailRef\", class: `${mergedClsPrefix}-scrollbar-rail ${mergedClsPrefix}-scrollbar-rail--horizontal`, style: [this.verticalRailStyle] },\n                h(Transition, { name: \"fade-in-transition\" }, {\n                    default: () => this.needXBar && this.isShowXBar && !this.isIos ? (h(\"div\", { class: `${mergedClsPrefix}-scrollbar-rail__scrollbar`, style: {\n                            width: this.xBarSizePx,\n                            left: this.xBarLeftPx\n                        }, onMousedown: this.handleXScrollMouseDown })) : null\n                }))\n        ]);\n        return this.container ? (createChildren()) : (h(VResizeObserver, { onResize: this.handleContainerResize }, {\n            default: createChildren\n        }));\n    }\n});\nexport default Scrollbar;\nexport const XScrollbar = Scrollbar;\n","import { h, inject, defineComponent, Transition } from 'vue';\nimport { useMemo } from 'vooks';\nimport { CheckmarkIcon } from '../../icons';\nimport NBaseIcon from '../../icon';\nimport { render } from '../../../_utils';\nimport { internalSelectionMenuInjectionKey } from './interface';\nconst checkMarkIcon = h(CheckmarkIcon);\nfunction renderCheckMark(show, clsPrefix) {\n    return (h(Transition, { name: \"fade-in-scale-up-transition\" }, {\n        default: () => show ? (h(NBaseIcon, { clsPrefix: clsPrefix, class: `${clsPrefix}-base-select-option__check` }, {\n            default: () => checkMarkIcon\n        })) : null\n    }));\n}\nexport default defineComponent({\n    name: 'NBaseSelectOption',\n    props: {\n        clsPrefix: {\n            type: String,\n            required: true\n        },\n        tmNode: {\n            type: Object,\n            required: true\n        }\n    },\n    setup(props) {\n        const { valueRef, pendingTmNodeRef, multipleRef, valueSetRef, renderLabelRef, renderOptionRef, handleOptionClick, handleOptionMouseEnter\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n         } = inject(internalSelectionMenuInjectionKey);\n        const isPendingRef = useMemo(() => {\n            const { value: pendingTmNode } = pendingTmNodeRef;\n            if (!pendingTmNode)\n                return false;\n            return props.tmNode.key === pendingTmNode.key;\n        });\n        function handleClick(e) {\n            const { tmNode } = props;\n            if (tmNode.disabled)\n                return;\n            handleOptionClick(e, tmNode);\n        }\n        function handleMouseEnter(e) {\n            const { tmNode } = props;\n            if (tmNode.disabled)\n                return;\n            handleOptionMouseEnter(e, tmNode);\n        }\n        function handleMouseMove(e) {\n            const { tmNode } = props;\n            const { value: isPending } = isPendingRef;\n            if (tmNode.disabled || isPending)\n                return;\n            handleOptionMouseEnter(e, tmNode);\n        }\n        return {\n            multiple: multipleRef,\n            isGrouped: useMemo(() => {\n                const { tmNode } = props;\n                const { parent } = tmNode;\n                return parent && parent.rawNode.type === 'group';\n            }),\n            isPending: isPendingRef,\n            isSelected: useMemo(() => {\n                const { value } = valueRef;\n                const { value: multiple } = multipleRef;\n                if (value === null)\n                    return false;\n                const optionValue = props.tmNode.rawNode.value;\n                if (multiple) {\n                    const { value: valueSet } = valueSetRef;\n                    return valueSet.has(optionValue);\n                }\n                else {\n                    return value === optionValue;\n                }\n            }),\n            renderLabel: renderLabelRef,\n            renderOption: renderOptionRef,\n            handleMouseMove,\n            handleMouseEnter,\n            handleClick\n        };\n    },\n    render() {\n        const { clsPrefix, tmNode: { rawNode }, isSelected, isPending, isGrouped, multiple, renderOption, renderLabel, handleClick, handleMouseEnter, handleMouseMove } = this;\n        const showCheckMark = multiple && isSelected;\n        const checkmark = renderCheckMark(showCheckMark, clsPrefix);\n        const children = renderLabel\n            ? [renderLabel(rawNode, isSelected), checkmark]\n            : [render(rawNode.label, rawNode, isSelected), checkmark];\n        const node = (h(\"div\", { class: [\n                `${clsPrefix}-base-select-option`,\n                rawNode.class,\n                {\n                    [`${clsPrefix}-base-select-option--disabled`]: rawNode.disabled,\n                    [`${clsPrefix}-base-select-option--selected`]: isSelected,\n                    [`${clsPrefix}-base-select-option--grouped`]: isGrouped,\n                    [`${clsPrefix}-base-select-option--pending`]: isPending\n                }\n            ], style: rawNode.style, onClick: handleClick, onMouseenter: handleMouseEnter, onMousemove: handleMouseMove },\n            h(\"div\", { class: `${clsPrefix}-base-select-option__content` }, children)));\n        return rawNode.render\n            ? rawNode.render({ node, option: rawNode, selected: isSelected })\n            : renderOption\n                ? renderOption({ node, option: rawNode, selected: isSelected })\n                : node;\n    }\n});\n","import { h, defineComponent, inject } from 'vue';\nimport { render } from '../../../_utils';\nimport { internalSelectionMenuInjectionKey } from './interface';\nexport default defineComponent({\n    name: 'NBaseSelectGroupHeader',\n    props: {\n        clsPrefix: {\n            type: String,\n            required: true\n        },\n        tmNode: {\n            type: Object,\n            required: true\n        }\n    },\n    setup() {\n        const { renderLabelRef, renderOptionRef\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n         } = inject(internalSelectionMenuInjectionKey);\n        return {\n            renderLabel: renderLabelRef,\n            renderOption: renderOptionRef\n        };\n    },\n    render() {\n        const { clsPrefix, renderLabel, renderOption, tmNode: { rawNode } } = this;\n        const children = renderLabel\n            ? renderLabel(rawNode, false)\n            : render(rawNode.label, rawNode, false);\n        const node = (h(\"div\", { class: `${clsPrefix}-base-select-group-header` }, children));\n        return rawNode.render\n            ? rawNode.render({ node, option: rawNode })\n            : renderOption\n                ? renderOption({ node, option: rawNode, selected: false })\n                : node;\n    }\n});\n","import { c } from '../../_utils/cssr';\nimport commonVariables from '../common/_common';\nconst {\n  cubicBezierEaseIn,\n  cubicBezierEaseOut,\n  transformDebounceScale\n} = commonVariables;\nexport default function ({\n  transformOrigin = 'inherit',\n  duration = '.2s',\n  enterScale = '.9',\n  originalTransform = '',\n  originalTransition = ''\n} = {}) {\n  return [c('&.fade-in-scale-up-transition-leave-active', {\n    transformOrigin,\n    transition: `opacity ${duration} ${cubicBezierEaseIn}, transform ${duration} ${cubicBezierEaseIn} ${originalTransition && ',' + originalTransition}`\n  }), c('&.fade-in-scale-up-transition-enter-active', {\n    transformOrigin,\n    transition: `opacity ${duration} ${cubicBezierEaseOut}, transform ${duration} ${cubicBezierEaseOut} ${originalTransition && ',' + originalTransition}`\n  }), c('&.fade-in-scale-up-transition-enter-from, &.fade-in-scale-up-transition-leave-to', {\n    opacity: 0,\n    transform: `${originalTransform} scale(${enterScale})`\n  }), c('&.fade-in-scale-up-transition-leave-from, &.fade-in-scale-up-transition-enter-to', {\n    opacity: 1,\n    transform: `${originalTransform} scale(${transformDebounceScale})`\n  })];\n}","import { c, cB, cE, cM, cNotM } from '../../../../_utils/cssr';\nimport fadeInScaleUpTransition from '../../../../_styles/transitions/fade-in-scale-up.cssr'; // --loading-color\n// --loading-size\n\nexport default cB('base-select-menu', `\n line-height: 1.5;\n outline: none;\n z-index: 0;\n position: relative;\n border-radius: var(--border-radius);\n transition:\n background-color .3s var(--bezier),\n box-shadow .3s var(--bezier);\n background-color: var(--color);\n`, [cM('multiple', [cB('base-select-option', `\n padding-right: 28px;\n `)]), cB('scrollbar', `\n max-height: var(--height);\n `), cB('virtual-list', `\n max-height: var(--height);\n `), cB('base-select-option', `\n min-height: var(--option-height);\n font-size: var(--option-font-size);\n display: flex;\n align-items: center;\n `, [cE('content', `\n white-space: nowrap;\n text-overflow: ellipsis;\n overflow: hidden;\n `)]), cB('base-select-group-header', `\n min-height: var(--option-height);\n font-size: .93em;\n display: flex;\n align-items: center;\n `), cB('base-select-menu-option-wrapper', `\n position: relative;\n width: 100%;\n `), cE('loading, empty', `\n display: flex;\n padding: 12px 32px;\n flex: 1;\n justify-content: center;\n `), cE('loading', `\n color: var(--loading-color);\n font-size: var(--loading-size);\n `), cE('action', `\n padding: 8px var(--option-padding-left);\n font-size: var(--option-font-size);\n transition: \n color .3s var(--bezier);\n border-color .3s var(--bezier);\n border-top: 1px solid var(--action-divider-color);\n color: var(--action-text-color);\n `), cB('base-select-group-header', `\n position: relative;\n cursor: default;\n padding: var(--option-padding);\n color: var(--group-header-text-color);\n `), cB('base-select-option', `\n cursor: pointer;\n position: relative;\n padding: var(--option-padding);\n transition:\n background-color .3s var(--bezier),\n color .3s var(--bezier),\n opacity .3s var(--bezier);\n box-sizing: border-box;\n color: var(--option-text-color);\n opacity: 1;\n `, [c('&:active', `\n color: var(--option-text-color-pressed);\n `), cM('grouped', `\n padding-left: calc(var(--option-padding-left) * 1.5);\n `), cM('pending', `\n background-color: var(--option-color-pending);\n `), cM('selected', `\n color: var(--option-text-color-active);\n background-color: var(--option-color-active);\n `), cM('disabled', `\n cursor: not-allowed;\n `, [cNotM('selected', `\n color: var(--option-text-color-disabled);\n `), cM('selected', `\n opacity: var(--option-opacity-disabled);\n `)]), cE('check', `\n font-size: 16px;\n position: absolute;\n right: 8px;\n top: calc(50% - 7px);\n color: var(--option-check-color);\n transition: color .3s var(--bezier);\n `, [fadeInScaleUpTransition({\n  enterScale: '0.5'\n})])])]);","export default {\n    height: 'calc(var(--option-height) * 7.6)',\n    paddingSmall: '4px 0',\n    paddingMedium: '4px 0',\n    paddingLarge: '4px 0',\n    paddingHuge: '4px 0',\n    optionPaddingSmall: '0 12px',\n    optionPaddingMedium: '0 12px',\n    optionPaddingLarge: '0 12px',\n    optionPaddingHuge: '0 12px',\n    loadingSize: '18px'\n};\n","import { emptyLight } from '../../../empty/styles';\nimport { scrollbarLight } from '../../scrollbar/styles';\nimport { commonLight } from '../../../_styles/common';\nimport commonVariables from './_common';\nimport { createTheme } from '../../../_mixins';\nexport const self = (vars) => {\n    const { borderRadius, popoverColor, textColor3, dividerColor, textColor2, primaryColorPressed, textColorDisabled, primaryColor, opacityDisabled, hoverColor, fontSizeSmall, fontSizeMedium, fontSizeLarge, fontSizeHuge, heightSmall, heightMedium, heightLarge, heightHuge } = vars;\n    return Object.assign(Object.assign({}, commonVariables), { optionFontSizeSmall: fontSizeSmall, optionFontSizeMedium: fontSizeMedium, optionFontSizeLarge: fontSizeLarge, optionFontSizeHuge: fontSizeHuge, optionHeightSmall: heightSmall, optionHeightMedium: heightMedium, optionHeightLarge: heightLarge, optionHeightHuge: heightHuge, borderRadius: borderRadius, color: popoverColor, groupHeaderTextColor: textColor3, actionDividerColor: dividerColor, optionTextColor: textColor2, optionTextColorPressed: primaryColorPressed, optionTextColorDisabled: textColorDisabled, optionTextColorActive: primaryColor, optionOpacityDisabled: opacityDisabled, optionCheckColor: primaryColor, optionColorPending: hoverColor, optionColorActive: hoverColor, actionTextColor: textColor2, loadingColor: primaryColor });\n};\nconst internalSelectMenuLight = createTheme({\n    name: 'InternalSelectMenu',\n    common: commonLight,\n    peers: {\n        Scrollbar: scrollbarLight,\n        Empty: emptyLight\n    },\n    self\n});\nexport default internalSelectMenuLight;\n","import { h, ref, onMounted, computed, defineComponent, watch, toRef, renderSlot, provide, nextTick, watchEffect } from 'vue';\nimport { createIndexGetter } from 'treemate';\nimport { VirtualList } from 'vueuc';\nimport { depx, getPadding, happensIn } from 'seemly';\nimport { NEmpty } from '../../../empty';\nimport { NScrollbar } from '../../scrollbar';\nimport { formatLength } from '../../../_utils';\nimport { createKey } from '../../../_utils/cssr';\nimport { useTheme } from '../../../_mixins';\nimport NInternalLoading from '../../loading';\nimport NFocusDetector from '../../focus-detector';\nimport NSelectOption from './SelectOption';\nimport NSelectGroupHeader from './SelectGroupHeader';\nimport style from './styles/index.cssr';\nimport { internalSelectMenuLight } from '../styles';\nimport { internalSelectionMenuInjectionKey, internalSelectionMenuBodyInjectionKey } from './interface';\nexport default defineComponent({\n    name: 'InternalSelectMenu',\n    props: Object.assign(Object.assign({}, useTheme.props), { clsPrefix: {\n            type: String,\n            required: true\n        }, scrollable: {\n            type: Boolean,\n            default: true\n        }, treeMate: {\n            type: Object,\n            required: true\n        }, multiple: Boolean, size: {\n            type: String,\n            default: 'medium'\n        }, value: {\n            type: [String, Number, Array],\n            default: null\n        }, width: [Number, String], autoPending: Boolean, virtualScroll: {\n            type: Boolean,\n            default: true\n        }, \n        // show is used to toggle pending state initialization\n        show: {\n            type: Boolean,\n            default: true\n        }, loading: Boolean, focusable: Boolean, renderLabel: Function, renderOption: Function, onMousedown: Function, onScroll: Function, onFocus: Function, onBlur: Function, onKeyup: Function, onKeydown: Function, onTabOut: Function, onMouseenter: Function, onMouseleave: Function, \n        // deprecated\n        onToggle: Function }),\n    setup(props) {\n        const themeRef = useTheme('InternalSelectMenu', 'InternalSelectMenu', style, internalSelectMenuLight, props, toRef(props, 'clsPrefix'));\n        const selfRef = ref(null);\n        const virtualListRef = ref(null);\n        const scrollbarRef = ref(null);\n        const flattenedNodesRef = computed(() => props.treeMate.getFlattenedNodes());\n        const fIndexGetterRef = computed(() => createIndexGetter(flattenedNodesRef.value));\n        const pendingNodeRef = ref(null);\n        function initPendingNode() {\n            const { treeMate } = props;\n            setPendingTmNode(props.autoPending\n                ? props.value === null\n                    ? treeMate.getFirstAvailableNode()\n                    : props.multiple\n                        ? treeMate.getNode((props.value || [])[(props.value || [])\n                            .length - 1]) || treeMate.getFirstAvailableNode()\n                        : treeMate.getNode(props.value) ||\n                            treeMate.getFirstAvailableNode()\n                : null);\n        }\n        initPendingNode();\n        onMounted(() => {\n            watchEffect(() => {\n                if (props.show) {\n                    initPendingNode();\n                    void nextTick(scrollToPendingNode);\n                }\n            });\n        });\n        const itemSizeRef = computed(() => {\n            return depx(themeRef.value.self[createKey('optionHeight', props.size)]);\n        });\n        const paddingRef = computed(() => {\n            return getPadding(themeRef.value.self[createKey('padding', props.size)]);\n        });\n        const valueSetRef = computed(() => {\n            if (props.multiple && Array.isArray(props.value)) {\n                return new Set(props.value);\n            }\n            return new Set();\n        });\n        const emptyRef = computed(() => {\n            const tmNodes = flattenedNodesRef.value;\n            return tmNodes && tmNodes.length === 0;\n        });\n        const styleRef = computed(() => {\n            return [{ width: formatLength(props.width) }, cssVarsRef.value];\n        });\n        watch(toRef(props, 'treeMate'), () => {\n            if (props.autoPending) {\n                const tmNode = props.treeMate.getFirstAvailableNode();\n                setPendingTmNode(tmNode);\n            }\n            else {\n                setPendingTmNode(null);\n            }\n        });\n        function doToggle(tmNode) {\n            const { onToggle } = props;\n            if (onToggle)\n                onToggle(tmNode);\n        }\n        function doScroll(e) {\n            const { onScroll } = props;\n            if (onScroll)\n                onScroll(e);\n        }\n        // required, scroller sync need to be triggered manually\n        function handleVirtualListScroll(e) {\n            var _a;\n            (_a = scrollbarRef.value) === null || _a === void 0 ? void 0 : _a.sync();\n            doScroll(e);\n        }\n        function handleVirtualListResize() {\n            var _a;\n            (_a = scrollbarRef.value) === null || _a === void 0 ? void 0 : _a.sync();\n        }\n        function getPendingTmNode() {\n            const { value: pendingTmNode } = pendingNodeRef;\n            if (pendingTmNode)\n                return pendingTmNode;\n            return null;\n        }\n        function handleOptionMouseEnter(e, tmNode) {\n            if (tmNode.disabled)\n                return;\n            setPendingTmNode(tmNode, false);\n        }\n        function handleOptionClick(e, tmNode) {\n            if (tmNode.disabled)\n                return;\n            doToggle(tmNode);\n        }\n        // keyboard related methods\n        function handleKeyUp(e) {\n            var _a;\n            if (happensIn(e, 'action'))\n                return;\n            (_a = props.onKeyup) === null || _a === void 0 ? void 0 : _a.call(props, e);\n        }\n        function handleKeyDown(e) {\n            var _a;\n            if (happensIn(e, 'action'))\n                return;\n            (_a = props.onKeydown) === null || _a === void 0 ? void 0 : _a.call(props, e);\n        }\n        function handleMouseDown(e) {\n            var _a;\n            (_a = props.onMousedown) === null || _a === void 0 ? void 0 : _a.call(props, e);\n            if (props.focusable)\n                return;\n            e.preventDefault();\n        }\n        function next() {\n            const { value: pendingTmNode } = pendingNodeRef;\n            if (pendingTmNode) {\n                setPendingTmNode(pendingTmNode.getNext({ loop: true }), true);\n            }\n        }\n        function prev() {\n            const { value: pendingTmNode } = pendingNodeRef;\n            if (pendingTmNode) {\n                setPendingTmNode(pendingTmNode.getPrev({ loop: true }), true);\n            }\n        }\n        function setPendingTmNode(tmNode, doScroll = false) {\n            pendingNodeRef.value = tmNode;\n            if (doScroll)\n                scrollToPendingNode();\n        }\n        function scrollToPendingNode() {\n            var _a, _b;\n            const tmNode = pendingNodeRef.value;\n            if (!tmNode)\n                return;\n            const fIndex = fIndexGetterRef.value(tmNode.key);\n            if (fIndex === null)\n                return;\n            if (props.virtualScroll) {\n                (_a = virtualListRef.value) === null || _a === void 0 ? void 0 : _a.scrollTo({ index: fIndex });\n            }\n            else {\n                (_b = scrollbarRef.value) === null || _b === void 0 ? void 0 : _b.scrollTo({\n                    index: fIndex,\n                    elSize: itemSizeRef.value\n                });\n            }\n        }\n        function handleFocusin(e) {\n            var _a, _b;\n            if ((_a = selfRef.value) === null || _a === void 0 ? void 0 : _a.contains(e.target)) {\n                (_b = props.onFocus) === null || _b === void 0 ? void 0 : _b.call(props, e);\n            }\n        }\n        function handleFocusout(e) {\n            var _a, _b;\n            if (!((_a = selfRef.value) === null || _a === void 0 ? void 0 : _a.contains(e.relatedTarget))) {\n                (_b = props.onBlur) === null || _b === void 0 ? void 0 : _b.call(props, e);\n            }\n        }\n        provide(internalSelectionMenuInjectionKey, {\n            handleOptionMouseEnter,\n            handleOptionClick,\n            valueSetRef,\n            multipleRef: toRef(props, 'multiple'),\n            valueRef: toRef(props, 'value'),\n            renderLabelRef: toRef(props, 'renderLabel'),\n            renderOptionRef: toRef(props, 'renderOption'),\n            pendingTmNodeRef: pendingNodeRef\n        });\n        provide(internalSelectionMenuBodyInjectionKey, selfRef);\n        onMounted(() => {\n            const { value } = scrollbarRef;\n            if (value)\n                value.sync();\n        });\n        const cssVarsRef = computed(() => {\n            const { size } = props;\n            const { common: { cubicBezierEaseInOut }, self: { height, borderRadius, color, groupHeaderTextColor, actionDividerColor, optionTextColorPressed, optionTextColor, optionTextColorDisabled, optionTextColorActive, optionOpacityDisabled, optionCheckColor, actionTextColor, optionColorPending, optionColorActive, loadingColor, loadingSize, [createKey('optionFontSize', size)]: fontSize, [createKey('optionHeight', size)]: optionHeight, [createKey('optionPadding', size)]: optionPadding } } = themeRef.value;\n            return {\n                '--height': height,\n                '--action-divider-color': actionDividerColor,\n                '--action-text-color': actionTextColor,\n                '--bezier': cubicBezierEaseInOut,\n                '--border-radius': borderRadius,\n                '--color': color,\n                '--option-font-size': fontSize,\n                '--group-header-text-color': groupHeaderTextColor,\n                '--option-check-color': optionCheckColor,\n                '--option-color-pending': optionColorPending,\n                '--option-color-active': optionColorActive,\n                '--option-height': optionHeight,\n                '--option-opacity-disabled': optionOpacityDisabled,\n                '--option-text-color': optionTextColor,\n                '--option-text-color-active': optionTextColorActive,\n                '--option-text-color-disabled': optionTextColorDisabled,\n                '--option-text-color-pressed': optionTextColorPressed,\n                '--option-padding': optionPadding,\n                '--option-padding-left': getPadding(optionPadding, 'left'),\n                '--loading-color': loadingColor,\n                '--loading-size': loadingSize\n            };\n        });\n        const exposedProps = {\n            selfRef,\n            next,\n            prev,\n            getPendingTmNode\n        };\n        return Object.assign({ mergedTheme: themeRef, virtualListRef,\n            scrollbarRef, style: styleRef, itemSize: itemSizeRef, padding: paddingRef, flattenedNodes: flattenedNodesRef, empty: emptyRef, virtualListContainer() {\n                const { value } = virtualListRef;\n                return value === null || value === void 0 ? void 0 : value.listElRef;\n            },\n            virtualListContent() {\n                const { value } = virtualListRef;\n                return value === null || value === void 0 ? void 0 : value.itemsElRef;\n            },\n            doScroll,\n            handleFocusin,\n            handleFocusout,\n            handleKeyUp,\n            handleKeyDown,\n            handleMouseDown,\n            handleVirtualListResize,\n            handleVirtualListScroll }, exposedProps);\n    },\n    render() {\n        const { $slots, virtualScroll, clsPrefix, mergedTheme } = this;\n        return (h(\"div\", { ref: \"selfRef\", tabindex: this.focusable ? 0 : -1, class: [\n                `${clsPrefix}-base-select-menu`,\n                this.multiple && `${clsPrefix}-base-select-menu--multiple`\n            ], style: this.style, onFocusin: this.handleFocusin, onFocusout: this.handleFocusout, onKeyup: this.handleKeyUp, onKeydown: this.handleKeyDown, onMousedown: this.handleMouseDown, onMouseenter: this.onMouseenter, onMouseleave: this.onMouseleave },\n            this.loading ? (h(\"div\", { class: `${clsPrefix}-base-select-menu__loading` },\n                h(NInternalLoading, { clsPrefix: clsPrefix, strokeWidth: 20 }))) : !this.empty ? (h(NScrollbar, { ref: \"scrollbarRef\", theme: mergedTheme.peers.Scrollbar, themeOverrides: mergedTheme.peerOverrides.Scrollbar, scrollable: this.scrollable, container: virtualScroll ? this.virtualListContainer : undefined, content: virtualScroll ? this.virtualListContent : undefined, onScroll: virtualScroll ? undefined : this.doScroll }, {\n                default: () => {\n                    return virtualScroll ? (h(VirtualList, { ref: \"virtualListRef\", class: `${clsPrefix}-virtual-list`, items: this.flattenedNodes, itemSize: this.itemSize, showScrollbar: false, paddingTop: this.padding.top, paddingBottom: this.padding.bottom, onResize: this.handleVirtualListResize, onScroll: this.handleVirtualListScroll, itemResizable: true }, {\n                        default: ({ item: tmNode }) => {\n                            return tmNode.isGroup ? (h(NSelectGroupHeader, { key: tmNode.key, clsPrefix: clsPrefix, tmNode: tmNode })) : tmNode.ignored ? null : (h(NSelectOption, { clsPrefix: clsPrefix, key: tmNode.key, tmNode: tmNode }));\n                        }\n                    })) : (h(\"div\", { class: `${clsPrefix}-base-select-menu-option-wrapper`, style: {\n                            paddingTop: this.padding.top,\n                            paddingBottom: this.padding.bottom\n                        } }, this.flattenedNodes.map((tmNode) => tmNode.isGroup ? (h(NSelectGroupHeader, { key: tmNode.key, clsPrefix: clsPrefix, tmNode: tmNode })) : (h(NSelectOption, { clsPrefix: clsPrefix, key: tmNode.key, tmNode: tmNode })))));\n                }\n            })) : (h(\"div\", { class: `${clsPrefix}-base-select-menu__empty` }, renderSlot($slots, 'empty', undefined, () => [\n                h(NEmpty, { theme: mergedTheme.peers.Empty, themeOverrides: mergedTheme.peerOverrides.Empty })\n            ]))),\n            $slots.action && (h(\"div\", { class: `${clsPrefix}-base-select-menu__action`, \"data-action\": true }, renderSlot($slots, 'action'))),\n            $slots.action && h(NFocusDetector, { onFocus: this.onTabOut })));\n    }\n});\n","export default {\n    space: '6px',\n    spaceArrow: '10px',\n    arrowOffset: '10px',\n    arrowOffsetVertical: '10px',\n    arrowHeight: '6px',\n    padding: '8px 14px'\n};\n","import { commonLight } from '../../_styles/common';\nimport commonVariables from './_common';\nexport const self = (vars) => {\n    const { boxShadow2, popoverColor, textColor2, borderRadius, fontSize, dividerColor } = vars;\n    return Object.assign(Object.assign({}, commonVariables), { fontSize,\n        borderRadius, color: popoverColor, dividerColor, textColor: textColor2, boxShadow: boxShadow2 });\n};\nconst popoverLight = {\n    name: 'Popover',\n    common: commonLight,\n    self\n};\nexport default popoverLight;\n","import { c, cB, cM, cNotM, cE, cCB } from '../../../_utils/cssr';\nconst oppositePlacement = {\n  top: 'bottom',\n  bottom: 'top',\n  left: 'right',\n  right: 'left'\n}; // vars:\n// --bezier\n// --bezier-ease-in\n// --bezier-ease-out\n// --font-size\n// --text-color\n// --color\n// --border-radius\n// --arrow-height\n// --arrow-offset\n// --arrow-offset-vertical\n// --padding\n// --space\n// --space-arrow\n// --divider-color\n\nexport default c([cB('popover', `\n transition:\n box-shadow .3s var(--bezier),\n background-color .3s var(--bezier),\n color .3s var(--bezier);\n transform-origin: inherit;\n position: relative;\n font-size: var(--font-size);\n color: var(--text-color);\n box-shadow: var(--box-shadow);\n `, [// body transition\nc('&.popover-transition-enter-from, &.popover-transition-leave-to', `\n opacity: 0;\n transform: scale(.85);\n `), c('&.popover-transition-enter-to, &.popover-transition-leave-from', `\n transform: scale(1);\n opacity: 1;\n `), c('&.popover-transition-enter-active', `\n transition:\n opacity .15s var(--bezier-ease-out),\n transform .15s var(--bezier-ease-out);\n `), c('&.popover-transition-leave-active', `\n transition:\n opacity .15s var(--bezier-ease-in),\n transform .15s var(--bezier-ease-in);\n `), cNotM('raw', `\n background-color: var(--color);\n border-radius: var(--border-radius);\n var(--padding);\n `, [cNotM('show-header', 'padding: var(--padding);')]), cE('header', `\n padding: var(--padding);\n border-bottom: 1px solid var(--divider-color);\n transition: border-color .3s var(--bezier);\n `), cE('content', `\n padding: var(--padding);\n `), cB('popover-arrow-wrapper', `\n position: absolute;\n overflow: hidden;\n pointer-events: none;\n `, [cB('popover-arrow', `\n transition: background-color .3s var(--bezier);\n position: absolute;\n display: block;\n width: calc(var(--arrow-height) * 1.414);\n height: calc(var(--arrow-height) * 1.414);\n box-shadow: 0 0 8px 0 rgba(0, 0, 0, .12);\n transform: rotate(45deg);\n background-color: var(--color);\n pointer-events: all;\n `)])]), placementStyle('top-start', `\n top: calc(-0.707 * var(--arrow-height));\n left: var(--arrow-offset);\n `), placementStyle('top', `\n top: calc(-0.707 * var(--arrow-height));\n transform: translateX(calc(-0.707 * var(--arrow-height))) rotate(45deg);\n left: 50%;\n `), placementStyle('top-end', `\n top: calc(-0.707 * var(--arrow-height));\n right: var(--arrow-offset);\n `), placementStyle('bottom-start', `\n bottom: calc(-0.707 * var(--arrow-height));\n left: var(--arrow-offset);\n `), placementStyle('bottom', `\n bottom: calc(-0.707 * var(--arrow-height));\n transform: translateX(calc(-0.707 * var(--arrow-height))) rotate(45deg);\n left: 50%;\n `), placementStyle('bottom-end', `\n bottom: calc(-0.707 * var(--arrow-height));\n right: var(--arrow-offset);\n `), placementStyle('left-start', `\n left: calc(-0.707 * var(--arrow-height));\n top: var(--arrow-offset-vertical);\n `), placementStyle('left', `\n left: calc(-0.707 * var(--arrow-height));\n transform: translateY(calc(-0.707 * var(--arrow-height))) rotate(45deg);\n top: 50%;\n `), placementStyle('left-end', `\n left: calc(-0.707 * var(--arrow-height));\n bottom: var(--arrow-offset-vertical);\n `), placementStyle('right-start', `\n right: calc(-0.707 * var(--arrow-height));\n top: var(--arrow-offset-vertical);\n `), placementStyle('right', `\n right: calc(-0.707 * var(--arrow-height));\n transform: translateY(calc(-0.707 * var(--arrow-height))) rotate(45deg);\n top: 50%;\n `), placementStyle('right-end', `\n right: calc(-0.707 * var(--arrow-height));\n bottom: var(--arrow-offset-vertical);\n `)]);\n\nfunction placementStyle(placement, arrowStyleLiteral) {\n  const position = placement.split('-')[0];\n  const sizeStyle = ['top', 'bottom'].includes(position) ? 'height: var(--space-arrow);' : 'width: var(--space-arrow);';\n  return c(`[v-placement=\"${placement}\"] >`, [cB('popover', `\n margin-${oppositePlacement[position]}: var(--space);\n `, [cM('show-arrow', `\n margin-${oppositePlacement[position]}: var(--space-arrow);\n `), cM('overlap', `\n margin: 0;\n `), cCB('popover-arrow-wrapper', `\n right: 0;\n left: 0;\n top: 0;\n bottom: 0;\n ${position}: 100%;\n ${oppositePlacement[position]}: auto;\n ${sizeStyle}\n `, [cB('popover-arrow', arrowStyleLiteral)])])]);\n}","import { h, vShow, withDirectives, Transition, ref, defineComponent, computed, mergeProps, inject, onBeforeUnmount, watch, toRef, provide, renderSlot, Fragment } from 'vue';\nimport { VFollower } from 'vueuc';\nimport { clickoutside, mousemoveoutside } from 'vdirs';\nimport { useTheme, useConfig } from '../../_mixins';\nimport { formatLength, useAdjustedTo } from '../../_utils';\nimport { popoverLight } from '../styles';\nimport style from './styles/index.cssr';\nimport { popoverBodyInjectionKey } from './interface';\nimport { drawerBodyInjectionKey } from '../../drawer/src/interface';\nimport { modalBodyInjectionKey } from '../../modal/src/interface';\nexport const popoverBodyProps = Object.assign(Object.assign({}, useTheme.props), { to: useAdjustedTo.propTo, show: Boolean, trigger: String, showArrow: Boolean, delay: Number, duration: Number, raw: Boolean, arrowStyle: [String, Object], displayDirective: String, x: Number, y: Number, filp: Boolean, overlap: Boolean, placement: String, width: [Number, String], \n    // private\n    animated: Boolean, onClickoutside: Function, \n    /** @deprecated */\n    minWidth: Number, maxWidth: Number });\nexport const renderArrow = ({ arrowStyle, clsPrefix }) => {\n    return (h(\"div\", { key: \"__popover-arrow__\", class: `${clsPrefix}-popover-arrow-wrapper` },\n        h(\"div\", { class: `${clsPrefix}-popover-arrow`, style: arrowStyle })));\n};\nexport default defineComponent({\n    name: 'PopoverBody',\n    inheritAttrs: false,\n    props: popoverBodyProps,\n    setup(props, { slots, attrs }) {\n        const { namespaceRef, mergedClsPrefixRef } = useConfig(props);\n        const themeRef = useTheme('Popover', 'Popover', style, popoverLight, props, mergedClsPrefixRef);\n        const followerRef = ref(null);\n        const NPopover = inject('NPopover');\n        const bodyRef = ref(null);\n        const followerEnabledRef = ref(props.show);\n        const directivesRef = computed(() => {\n            const { trigger, onClickoutside } = props;\n            const directives = [];\n            const { positionManuallyRef: { value: positionManually } } = NPopover;\n            if (!positionManually) {\n                if (trigger === 'click' && !onClickoutside) {\n                    directives.push([clickoutside, handleClickOutside]);\n                }\n                if (trigger === 'hover') {\n                    directives.push([mousemoveoutside, handleMouseMoveOutside]);\n                }\n            }\n            if (onClickoutside) {\n                directives.push([clickoutside, handleClickOutside]);\n            }\n            if (props.displayDirective === 'show') {\n                directives.push([vShow, props.show]);\n            }\n            return directives;\n        });\n        const styleRef = computed(() => {\n            return [\n                {\n                    width: props.width === 'trigger' ? '' : formatLength(props.width),\n                    maxWidth: formatLength(props.maxWidth),\n                    minWidth: formatLength(props.minWidth)\n                },\n                cssVarsRef.value\n            ];\n        });\n        const cssVarsRef = computed(() => {\n            const { common: { cubicBezierEaseInOut, cubicBezierEaseIn, cubicBezierEaseOut }, self: { space, spaceArrow, padding, fontSize, textColor, dividerColor, color, boxShadow, borderRadius, arrowHeight, arrowOffset, arrowOffsetVertical } } = themeRef.value;\n            return {\n                '--box-shadow': boxShadow,\n                '--bezier': cubicBezierEaseInOut,\n                '--bezier-ease-in': cubicBezierEaseIn,\n                '--bezier-ease-out': cubicBezierEaseOut,\n                '--font-size': fontSize,\n                '--text-color': textColor,\n                '--color': color,\n                '--divider-color': dividerColor,\n                '--border-radius': borderRadius,\n                '--arrow-height': arrowHeight,\n                '--arrow-offset': arrowOffset,\n                '--arrow-offset-vertical': arrowOffsetVertical,\n                '--padding': padding,\n                '--space': space,\n                '--space-arrow': spaceArrow\n            };\n        });\n        NPopover.setBodyInstance({\n            syncPosition\n        });\n        onBeforeUnmount(() => {\n            NPopover.setBodyInstance(null);\n        });\n        watch(toRef(props, 'show'), (value) => {\n            // If no animation, no transition component will be applied to the\n            // component. So we need to trigger follower manaully.\n            if (props.animated)\n                return;\n            if (value) {\n                followerEnabledRef.value = true;\n            }\n            else {\n                followerEnabledRef.value = false;\n            }\n        });\n        function syncPosition() {\n            var _a;\n            // eslint-disable-next-line no-unused-expressions\n            (_a = followerRef.value) === null || _a === void 0 ? void 0 : _a.syncPosition();\n        }\n        function handleMouseEnter(e) {\n            if (props.trigger === 'hover') {\n                NPopover.handleMouseEnter(e);\n            }\n        }\n        function handleMouseLeave(e) {\n            if (props.trigger === 'hover') {\n                NPopover.handleMouseLeave(e);\n            }\n        }\n        function handleMouseMoveOutside(e) {\n            if (props.trigger === 'hover' &&\n                !getTriggerElement().contains(e.target)) {\n                NPopover.handleMouseMoveOutside(e);\n            }\n        }\n        function handleClickOutside(e) {\n            if ((props.trigger === 'click' &&\n                !getTriggerElement().contains(e.target)) ||\n                props.onClickoutside) {\n                NPopover.handleClickOutside(e);\n            }\n        }\n        function getTriggerElement() {\n            return NPopover.getTriggerElement();\n        }\n        provide(popoverBodyInjectionKey, bodyRef);\n        provide(drawerBodyInjectionKey, null);\n        provide(modalBodyInjectionKey, null);\n        function renderContentNode() {\n            let contentNode;\n            const { internalRenderBodyRef: { value: renderBody } } = NPopover;\n            const { value: mergedClsPrefix } = mergedClsPrefixRef;\n            if (!renderBody) {\n                const { value: extraClass } = NPopover.extraClassRef;\n                contentNode = h('div', mergeProps({\n                    class: [\n                        `${mergedClsPrefix}-popover`,\n                        extraClass.map((v) => `${mergedClsPrefix}-${v}`),\n                        {\n                            [`${mergedClsPrefix}-popover--overlap`]: props.overlap,\n                            [`${mergedClsPrefix}-popover--show-arrow`]: props.showArrow,\n                            [`${mergedClsPrefix}-popover--show-header`]: !!slots.header,\n                            [`${mergedClsPrefix}-popover--raw`]: props.raw\n                        }\n                    ],\n                    ref: bodyRef,\n                    style: styleRef.value,\n                    onMouseenter: handleMouseEnter,\n                    onMouseleave: handleMouseLeave\n                }, attrs), [\n                    slots.header ? (h(Fragment, null,\n                        h(\"div\", { class: `${mergedClsPrefix}-popover__header` }, slots.header()),\n                        h(\"div\", { class: `${mergedClsPrefix}-popover__content` }, slots))) : (renderSlot(slots, 'default')),\n                    props.showArrow\n                        ? renderArrow({\n                            arrowStyle: props.arrowStyle,\n                            clsPrefix: mergedClsPrefix\n                        })\n                        : null\n                ]);\n            }\n            else {\n                contentNode = renderBody(\n                // The popover class and overlap class must exists, they will be used\n                // to place the body & transition animation.\n                // Shadow class exists for reuse box-shadow.\n                [\n                    `${mergedClsPrefix}-popover`,\n                    props.overlap && `${mergedClsPrefix}-popover--overlap`\n                ], bodyRef, styleRef.value, handleMouseEnter, handleMouseLeave);\n            }\n            return props.displayDirective === 'show' || props.show\n                ? withDirectives(contentNode, directivesRef.value)\n                : null;\n        }\n        return {\n            namespace: namespaceRef,\n            isMounted: NPopover.isMountedRef,\n            zIndex: NPopover.zIndexRef,\n            followerRef,\n            adjustedTo: useAdjustedTo(props),\n            followerEnabled: followerEnabledRef,\n            renderContentNode\n        };\n    },\n    render() {\n        return h(VFollower, {\n            zIndex: this.zIndex,\n            show: this.show,\n            enabled: this.followerEnabled,\n            to: this.adjustedTo,\n            x: this.x,\n            y: this.y,\n            placement: this.placement,\n            containerClass: this.namespace,\n            ref: 'followerRef',\n            overlap: this.overlap,\n            width: this.width === 'trigger' ? 'target' : undefined,\n            teleportDisabled: this.adjustedTo === useAdjustedTo.tdkey\n        }, {\n            default: () => {\n                return this.animated\n                    ? h(Transition, {\n                        name: 'popover-transition',\n                        appear: this.isMounted,\n                        // Don't use watch to enable follower, since the transition may\n                        // make position sync timing very subtle and buggy.\n                        onEnter: () => {\n                            this.followerEnabled = true;\n                        },\n                        onAfterLeave: () => {\n                            this.followerEnabled = false;\n                        }\n                    }, {\n                        default: this.renderContentNode\n                    })\n                    : this.renderContentNode();\n            }\n        });\n    }\n});\n","import { h, ref, computed, createTextVNode, defineComponent, provide, toRef, cloneVNode, watchEffect } from 'vue';\nimport { VBinder, VTarget } from 'vueuc';\nimport { useMergedState, useCompitable, useIsMounted, useMemo } from 'vooks';\nimport { call, keep, getFirstSlotVNode, warnOnce, useAdjustedTo } from '../../_utils';\nimport { useTheme } from '../../_mixins';\nimport NPopoverBody, { popoverBodyProps } from './PopoverBody';\nconst bodyPropKeys = Object.keys(popoverBodyProps);\nconst triggerEventMap = {\n    focus: ['onFocus', 'onBlur'],\n    click: ['onClick'],\n    hover: ['onMouseenter', 'onMouseleave'],\n    manual: [],\n    nested: ['onFocus', 'onBlur', 'onMouseenter', 'onMouseleave', 'onClick']\n};\nfunction appendEvents(vNode, trigger, events) {\n    triggerEventMap[trigger].forEach((eventName) => {\n        if (!vNode.props)\n            vNode.props = {};\n        else {\n            vNode.props = Object.assign({}, vNode.props);\n        }\n        const originalHandler = vNode.props[eventName];\n        const handler = events[eventName];\n        if (!originalHandler)\n            vNode.props[eventName] = handler;\n        else {\n            vNode.props[eventName] = (...args) => {\n                originalHandler(...args);\n                handler(...args);\n            };\n        }\n    });\n}\nconst textVNodeType = createTextVNode('').type;\nexport const popoverBaseProps = {\n    show: {\n        type: Boolean,\n        default: undefined\n    },\n    defaultShow: Boolean,\n    showArrow: {\n        type: Boolean,\n        default: true\n    },\n    trigger: {\n        type: String,\n        default: 'hover'\n    },\n    delay: {\n        type: Number,\n        default: 100\n    },\n    duration: {\n        type: Number,\n        default: 100\n    },\n    raw: Boolean,\n    placement: {\n        type: String,\n        default: 'top'\n    },\n    x: Number,\n    y: Number,\n    disabled: Boolean,\n    getDisabled: Function,\n    displayDirective: {\n        type: String,\n        default: 'if'\n    },\n    arrowStyle: [String, Object],\n    filp: {\n        type: Boolean,\n        default: true\n    },\n    animated: {\n        type: Boolean,\n        default: true\n    },\n    width: {\n        type: [Number, String],\n        default: undefined\n    },\n    overlap: Boolean,\n    internalExtraClass: {\n        type: Array,\n        default: () => []\n    },\n    onClickoutside: Function,\n    // events\n    'onUpdate:show': [Function, Array],\n    onUpdateShow: [Function, Array],\n    zIndex: Number,\n    to: useAdjustedTo.propTo,\n    internalSyncTargetWithParent: Boolean,\n    internalInheritedEventHandlers: {\n        type: Array,\n        default: () => []\n    },\n    /** @deprecated */\n    onShow: [Function, Array],\n    /** @deprecated */\n    onHide: [Function, Array],\n    /** @deprecated */\n    arrow: {\n        type: Boolean,\n        default: undefined\n    },\n    /** @deprecated */\n    minWidth: Number,\n    /** @deprecated */\n    maxWidth: Number\n};\nconst popoverProps = Object.assign(Object.assign(Object.assign({}, useTheme.props), popoverBaseProps), { internalRenderBody: Function });\nexport default defineComponent({\n    name: 'Popover',\n    inheritAttrs: false,\n    props: popoverProps,\n    __popover__: true,\n    setup(props) {\n        if (process.env.NODE_ENV !== 'production') {\n            watchEffect(() => {\n                if (props.maxWidth !== undefined) {\n                    warnOnce('popover', '`max-width` is deprecated, please use `style` instead.');\n                }\n                if (props.minWidth !== undefined) {\n                    warnOnce('popover', '`max-width` is deprecated, please use `style` instead.');\n                }\n                if (props.arrow !== undefined) {\n                    warnOnce('popover', '`arrow` is deprecated, please use `showArrow` instead.');\n                }\n                if (props.onHide !== undefined) {\n                    warnOnce('popover', '`on-hide` is deprecated, please use `on-update:show` instead.');\n                }\n                if (props.onShow !== undefined) {\n                    warnOnce('popover', '`on-show` is deprecated, please use `on-update:show` instead.');\n                }\n            });\n        }\n        const isMountedRef = useIsMounted();\n        const binderInstRef = ref(null);\n        // setup show\n        const controlledShowRef = computed(() => props.show);\n        const uncontrolledShowRef = ref(props.defaultShow);\n        const mergedShowWithoutDisabledRef = useMergedState(controlledShowRef, uncontrolledShowRef);\n        const mergedShowConsideringDisabledPropRef = useMemo(() => {\n            if (props.disabled)\n                return false;\n            return mergedShowWithoutDisabledRef.value;\n        });\n        const getMergedDisabled = () => {\n            if (props.disabled)\n                return true;\n            const { getDisabled } = props;\n            if (getDisabled === null || getDisabled === void 0 ? void 0 : getDisabled())\n                return true;\n            return false;\n        };\n        const getMergedShow = () => {\n            if (getMergedDisabled())\n                return false;\n            return mergedShowWithoutDisabledRef.value;\n        };\n        // setup show-arrow\n        const compatibleShowArrowRef = useCompitable(props, ['arrow', 'showArrow']);\n        const mergedShowArrowRef = computed(() => {\n            if (props.overlap)\n                return false;\n            return compatibleShowArrowRef.value;\n        });\n        // bodyInstance\n        let bodyInstance = null;\n        const showTimerIdRef = ref(null);\n        const hideTimerIdRef = ref(null);\n        const positionManuallyRef = useMemo(() => {\n            return props.x !== undefined && props.y !== undefined;\n        });\n        // methods\n        function doUpdateShow(value) {\n            const { 'onUpdate:show': _onUpdateShow, onUpdateShow, onShow, onHide } = props;\n            uncontrolledShowRef.value = value;\n            if (_onUpdateShow) {\n                call(_onUpdateShow, value);\n            }\n            if (onUpdateShow) {\n                call(onUpdateShow, value);\n            }\n            if (value && onShow) {\n                call(onShow, true);\n            }\n            if (value && onHide) {\n                call(onHide, false);\n            }\n        }\n        function syncPosition() {\n            if (bodyInstance) {\n                bodyInstance.syncPosition();\n            }\n        }\n        function clearShowTimer() {\n            const { value: showTimerId } = showTimerIdRef;\n            if (showTimerId) {\n                window.clearTimeout(showTimerId);\n                showTimerIdRef.value = null;\n            }\n        }\n        function clearHideTimer() {\n            const { value: hideTimerId } = hideTimerIdRef;\n            if (hideTimerId) {\n                window.clearTimeout(hideTimerId);\n                hideTimerIdRef.value = null;\n            }\n        }\n        function handleFocus() {\n            const mergedDisabled = getMergedDisabled();\n            if (props.trigger === 'focus' && !mergedDisabled) {\n                if (getMergedShow())\n                    return;\n                doUpdateShow(true);\n            }\n        }\n        function handleBlur() {\n            const mergedDisabled = getMergedDisabled();\n            if (props.trigger === 'focus' && !mergedDisabled) {\n                if (!getMergedShow())\n                    return;\n                doUpdateShow(false);\n            }\n        }\n        function handleMouseEnter() {\n            const mergedDisabled = getMergedDisabled();\n            if (props.trigger === 'hover' && !mergedDisabled) {\n                clearHideTimer();\n                if (showTimerIdRef.value !== null)\n                    return;\n                if (getMergedShow())\n                    return;\n                const delayCallback = () => {\n                    doUpdateShow(true);\n                    showTimerIdRef.value = null;\n                };\n                const { delay } = props;\n                if (delay === 0) {\n                    delayCallback();\n                }\n                else {\n                    showTimerIdRef.value = window.setTimeout(delayCallback, delay);\n                }\n            }\n        }\n        function handleMouseLeave() {\n            const mergedDisabled = getMergedDisabled();\n            if (props.trigger === 'hover' && !mergedDisabled) {\n                clearShowTimer();\n                if (hideTimerIdRef.value !== null)\n                    return;\n                if (!getMergedShow())\n                    return;\n                const delayedCallback = () => {\n                    doUpdateShow(false);\n                    hideTimerIdRef.value = null;\n                };\n                const { duration } = props;\n                if (duration === 0) {\n                    delayedCallback();\n                }\n                else {\n                    hideTimerIdRef.value = window.setTimeout(delayedCallback, duration);\n                }\n            }\n        }\n        // will be called in popover-content\n        function handleMouseMoveOutside() {\n            handleMouseLeave();\n        }\n        // will be called in popover-content\n        function handleClickOutside(e) {\n            var _a;\n            if (!getMergedShow())\n                return;\n            if (props.trigger === 'click') {\n                clearShowTimer();\n                clearHideTimer();\n                doUpdateShow(false);\n            }\n            (_a = props.onClickoutside) === null || _a === void 0 ? void 0 : _a.call(props, e);\n        }\n        function handleClick() {\n            if (props.trigger === 'click' && !getMergedDisabled()) {\n                clearShowTimer();\n                clearHideTimer();\n                const nextShow = !getMergedShow();\n                doUpdateShow(nextShow);\n            }\n        }\n        function setShow(value) {\n            uncontrolledShowRef.value = value;\n        }\n        function getTriggerElement() {\n            var _a;\n            return (_a = binderInstRef.value) === null || _a === void 0 ? void 0 : _a.targetRef;\n        }\n        function setBodyInstance(value) {\n            bodyInstance = value;\n        }\n        provide('NPopover', {\n            getTriggerElement,\n            handleMouseEnter,\n            handleMouseLeave,\n            handleClickOutside,\n            handleMouseMoveOutside,\n            setBodyInstance,\n            positionManuallyRef: positionManuallyRef,\n            isMountedRef: isMountedRef,\n            zIndexRef: toRef(props, 'zIndex'),\n            extraClassRef: toRef(props, 'internalExtraClass'),\n            internalRenderBodyRef: toRef(props, 'internalRenderBody')\n        });\n        return {\n            binderInstRef,\n            positionManually: positionManuallyRef,\n            mergedShowConsideringDisabledProp: mergedShowConsideringDisabledPropRef,\n            // if to show popover body\n            uncontrolledShow: uncontrolledShowRef,\n            mergedShowArrow: mergedShowArrowRef,\n            getMergedShow,\n            setShow,\n            handleClick,\n            handleMouseEnter,\n            handleMouseLeave,\n            handleFocus,\n            handleBlur,\n            syncPosition\n        };\n    },\n    render() {\n        var _a;\n        const { positionManually, $slots: slots } = this;\n        let triggerVNode;\n        let popoverInside = false;\n        if (!positionManually) {\n            if (slots.activator) {\n                triggerVNode = getFirstSlotVNode(slots, 'activator');\n            }\n            else {\n                triggerVNode = getFirstSlotVNode(slots, 'trigger');\n            }\n            if (triggerVNode) {\n                triggerVNode = cloneVNode(triggerVNode);\n                triggerVNode =\n                    triggerVNode.type === textVNodeType\n                        ? h('span', [triggerVNode])\n                        : triggerVNode;\n                const handlers = {\n                    onClick: this.handleClick,\n                    onMouseenter: this.handleMouseEnter,\n                    onMouseleave: this.handleMouseLeave,\n                    onFocus: this.handleFocus,\n                    onBlur: this.handleBlur\n                };\n                if ((_a = triggerVNode.type) === null || _a === void 0 ? void 0 : _a.__popover__) {\n                    popoverInside = true;\n                    // We assume that there's no DOM event handlers on popover element\n                    if (!triggerVNode.props) {\n                        triggerVNode.props = {\n                            internalSyncTargetWithParent: true,\n                            internalInheritedEventHandlers: []\n                        };\n                    }\n                    triggerVNode.props.internalSyncTargetWithParent = true;\n                    if (!triggerVNode.props.internalInheritedEventHandlers) {\n                        triggerVNode.props.internalInheritedEventHandlers = [handlers];\n                    }\n                    else {\n                        triggerVNode.props.internalInheritedEventHandlers = [\n                            handlers,\n                            ...triggerVNode.props.internalInheritedEventHandlers\n                        ];\n                    }\n                }\n                else {\n                    const { internalInheritedEventHandlers } = this;\n                    const ascendantAndCurrentHandlers = [\n                        handlers,\n                        ...internalInheritedEventHandlers\n                    ];\n                    const mergedHandlers = {\n                        onBlur: (e) => {\n                            ascendantAndCurrentHandlers.forEach((_handlers) => {\n                                _handlers.onBlur(e);\n                            });\n                        },\n                        onFocus: (e) => {\n                            ascendantAndCurrentHandlers.forEach((_handlers) => {\n                                _handlers.onBlur(e);\n                            });\n                        },\n                        onClick: (e) => {\n                            ascendantAndCurrentHandlers.forEach((_handlers) => {\n                                _handlers.onClick(e);\n                            });\n                        },\n                        onMouseenter: (e) => {\n                            ascendantAndCurrentHandlers.forEach((_handlers) => {\n                                _handlers.onMouseenter(e);\n                            });\n                        },\n                        onMouseleave: (e) => {\n                            ascendantAndCurrentHandlers.forEach((_handlers) => {\n                                _handlers.onMouseleave(e);\n                            });\n                        }\n                    };\n                    appendEvents(triggerVNode, internalInheritedEventHandlers\n                        ? 'nested'\n                        : positionManually\n                            ? 'manual'\n                            : this.trigger, mergedHandlers);\n                }\n            }\n        }\n        return (h(VBinder, { ref: \"binderInstRef\", syncTarget: !popoverInside, syncTargetWithParent: this.internalSyncTargetWithParent }, {\n            default: () => {\n                // We need to subscribe it. Sometimes rerender won't ge triggered.\n                // `mergedShowConsideringDisabledProp` is not the final disabled status.\n                // In ellpisis it's dynamic.\n                void this.mergedShowConsideringDisabledProp;\n                const mergedShow = this.getMergedShow();\n                return [\n                    positionManually\n                        ? null\n                        : h(VTarget, null, {\n                            default: () => triggerVNode\n                        }),\n                    h(NPopoverBody, keep(this.$props, bodyPropKeys, Object.assign(Object.assign({}, this.$attrs), { showArrow: this.mergedShowArrow, show: mergedShow })), slots)\n                ];\n            }\n        }));\n    }\n});\n","export default {\n    closeSizeSmall: '14px',\n    closeSizeMedium: '14px',\n    closeSizeLarge: '14px',\n    // closeSize\n    padding: '0 7px',\n    closeMargin: '0 0 0 3px',\n    closeMarginRtl: '0 3px 0 0'\n};\n","import commonVariables from './_common';\nimport { changeColor } from 'seemly';\nimport { commonLight } from '../../_styles/common';\nconst self = (vars) => {\n    const { textColor2, primaryColorHover, primaryColorPressed, primaryColor, infoColor, successColor, warningColor, errorColor, baseColor, borderColor, opacityDisabled, tagColor, closeColor, closeColorHover, closeColorPressed, borderRadiusSmall: borderRadius, fontSizeTiny, fontSizeSmall, fontSizeMedium, heightTiny, heightSmall, heightMedium } = vars;\n    return Object.assign(Object.assign({}, commonVariables), { heightSmall: heightTiny, heightMedium: heightSmall, heightLarge: heightMedium, borderRadius,\n        opacityDisabled, fontSizeSmall: fontSizeTiny, fontSizeMedium: fontSizeSmall, fontSizeLarge: fontSizeMedium, \n        // checked\n        textColorCheckable: textColor2, textColorHoverCheckable: primaryColorHover, textColorPressedCheckable: primaryColorPressed, textColorChecked: baseColor, colorCheckable: '#0000', colorHoverCheckable: '#0000', colorPressedCheckable: '#0000', colorChecked: primaryColor, colorCheckedHover: primaryColorHover, colorCheckedPressed: primaryColorPressed, \n        // default\n        border: `1px solid ${borderColor}`, textColor: textColor2, color: tagColor, closeColor: closeColor, closeColorHover: closeColorHover, closeColorPressed: closeColorPressed, borderPrimary: `1px solid ${changeColor(primaryColor, { alpha: 0.3 })}`, textColorPrimary: primaryColor, colorPrimary: changeColor(primaryColor, { alpha: 0.1 }), closeColorPrimary: changeColor(primaryColor, { alpha: 0.75 }), closeColorHoverPrimary: changeColor(primaryColor, { alpha: 0.6 }), closeColorPressedPrimary: changeColor(primaryColor, { alpha: 0.9 }), borderInfo: `1px solid ${changeColor(infoColor, { alpha: 0.3 })}`, textColorInfo: infoColor, colorInfo: changeColor(infoColor, { alpha: 0.1 }), closeColorInfo: changeColor(infoColor, { alpha: 0.75 }), closeColorHoverInfo: changeColor(infoColor, { alpha: 0.6 }), closeColorPressedInfo: changeColor(infoColor, { alpha: 0.9 }), borderSuccess: `1px solid ${changeColor(successColor, { alpha: 0.3 })}`, textColorSuccess: successColor, colorSuccess: changeColor(successColor, { alpha: 0.1 }), closeColorSuccess: changeColor(successColor, { alpha: 0.75 }), closeColorHoverSuccess: changeColor(successColor, { alpha: 0.6 }), closeColorPressedSuccess: changeColor(successColor, { alpha: 0.9 }), borderWarning: `1px solid ${changeColor(warningColor, { alpha: 0.35 })}`, textColorWarning: warningColor, colorWarning: changeColor(warningColor, { alpha: 0.12 }), closeColorWarning: changeColor(warningColor, { alpha: 0.75 }), closeColorHoverWarning: changeColor(warningColor, { alpha: 0.6 }), closeColorPressedWarning: changeColor(warningColor, { alpha: 0.9 }), borderError: `1px solid ${changeColor(errorColor, { alpha: 0.23 })}`, textColorError: errorColor, colorError: changeColor(errorColor, { alpha: 0.08 }), closeColorError: changeColor(errorColor, { alpha: 0.65 }), closeColorHoverError: changeColor(errorColor, { alpha: 0.5 }), closeColorPressedError: changeColor(errorColor, { alpha: 0.8 }) });\n};\nconst tagLight = {\n    name: 'Tag',\n    common: commonLight,\n    self\n};\nexport default tagLight;\n","export default {\n    color: Object,\n    type: {\n        type: String,\n        default: 'default'\n    },\n    round: Boolean,\n    size: {\n        type: String,\n        default: 'medium'\n    },\n    closable: Boolean,\n    disabled: {\n        type: Boolean,\n        default: undefined\n    }\n};\n","import { c, cB, cE, cM, cNotM } from '../../../_utils/cssr'; // vars:\n// --bezier\n// --border-radius\n// --border\n// --close-color\n// --close-color-hover\n// --close-color-pressed\n// --close-margin\n// --close-size\n// --color\n// --color-checkable\n// --color-checked\n// --color-checked-hover\n// --color-checked-pressed\n// --color-hover-checkable\n// --color-pressed-checkable\n// --font-size\n// --height\n// --opacity-disabled\n// --padding\n// --text-color\n// --text-color-checkable\n// --text-color-checked\n// --text-color-hover-checkable\n// --text-color-pressed-checkable\n\nexport default cB('tag', `\n white-space: nowrap;\n position: relative;\n box-sizing: border-box;\n cursor: default;\n display: inline-flex;\n align-items: center;\n flex-wrap: nowrap;\n padding: var(--padding);\n border-radius: var(--border-radius);\n color: var(--text-color);\n background-color: var(--color);\n transition: \n border-color .3s var(--bezier),\n background-color .3s var(--bezier),\n color .3s var(--bezier),\n box-shadow .3s var(--bezier),\n opacity .3s var(--bezier);\n line-height: 1;\n height: var(--height);\n font-size: var(--font-size);\n`, [cE('border', `\n pointer-events: none;\n position: absolute;\n left: 0;\n right: 0;\n top: 0;\n bottom: 0;\n border-radius: inherit;\n border: var(--border);\n transition: border-color .3s var(--bezier);\n `), cE('avatar', `\n display: flex;\n margin-right: 6px;\n `), cE('close', `\n font-size: var(--close-size);\n margin: var(--close-margin);\n transition: color .3s var(--bezier);\n cursor: pointer;\n `), cM('round', `\n padding: 0 calc(var(--height) / 2);\n border-radius: calc(var(--height) / 2);\n `, [cE('avatar', `\n margin-left: calc((var(--height) - 8px) / -2);\n `)]), cM('disabled', `\n cursor: not-allowed !important;\n opacity: var(--opacity-disabled);\n `), cM('checkable', `\n cursor: pointer;\n box-shadow: none;\n color: var(--text-color-checkable);\n background-color: var(--color-checkable);\n `, [cNotM('disabled', [c('&:hover', {\n  backgroundColor: 'var(--color-hover-checkable)'\n}, [cNotM('checked', {\n  color: 'var(--text-color-hover-checkable)'\n})]), c('&:active', {\n  backgroundColor: 'var(--color-pressed-checkable)'\n}, [cNotM('checked', {\n  color: 'var(--text-color-pressed-checkable)'\n})])]), cM('checked', {\n  color: 'var(--text-color-checked)',\n  backgroundColor: 'var(--color-checked)'\n}, [cNotM('disabled', [c('&:hover', {\n  backgroundColor: 'var(--color-checked-hover)'\n}), c('&:active', {\n  backgroundColor: 'var(--color-checked-pressed)'\n})])])])]);","import { h, defineComponent, computed, ref, provide, toRef } from 'vue';\nimport { useConfig, useTheme } from '../../_mixins';\nimport { NBaseClose } from '../../_internal';\nimport { warn, createKey, call } from '../../_utils';\nimport { tagLight } from '../styles';\nimport commonProps from './common-props';\nimport style from './styles/index.cssr';\nimport useRtl from '../../_mixins/use-rtl';\nconst tagProps = Object.assign(Object.assign(Object.assign({}, useTheme.props), commonProps), { bordered: {\n        type: Boolean,\n        default: undefined\n    }, checked: Boolean, checkable: Boolean, onClose: [Array, Function], onMouseenter: Function, onMouseleave: Function, 'onUpdate:checked': Function, onUpdateChecked: Function, \n    // private\n    internalStopClickPropagation: Boolean, \n    // deprecated\n    onCheckedChange: {\n        type: Function,\n        validator: () => {\n            if (process.env.NODE_ENV !== 'production') {\n                warn('tag', '`on-checked-change` is deprecated, please use `on-update:checked` instead');\n            }\n            return true;\n        },\n        default: undefined\n    } });\nexport const tagInjectionKey = Symbol('tag');\nexport default defineComponent({\n    name: 'Tag',\n    props: tagProps,\n    setup(props) {\n        const contentRef = ref(null);\n        const { mergedBorderedRef, mergedClsPrefixRef, NConfigProvider } = useConfig(props);\n        const themeRef = useTheme('Tag', 'Tag', style, tagLight, props, mergedClsPrefixRef);\n        provide(tagInjectionKey, {\n            roundRef: toRef(props, 'round')\n        });\n        function handleClick(e) {\n            if (!props.disabled) {\n                if (props.checkable) {\n                    const { checked, onCheckedChange, onUpdateChecked, 'onUpdate:checked': _onUpdateChecked } = props;\n                    if (onUpdateChecked)\n                        onUpdateChecked(!checked);\n                    if (_onUpdateChecked)\n                        _onUpdateChecked(!checked);\n                    // deprecated\n                    if (onCheckedChange)\n                        onCheckedChange(!checked);\n                }\n            }\n        }\n        function handleCloseClick(e) {\n            if (props.internalStopClickPropagation) {\n                e.stopPropagation();\n            }\n            if (!props.disabled) {\n                const { onClose } = props;\n                if (onClose)\n                    call(onClose, e);\n            }\n        }\n        const tagPublicMethods = {\n            setTextContent(textContent) {\n                const { value } = contentRef;\n                if (value)\n                    value.textContent = textContent;\n            }\n        };\n        const rtlEnabledRef = useRtl('Tag', NConfigProvider === null || NConfigProvider === void 0 ? void 0 : NConfigProvider.mergedRtlRef, mergedClsPrefixRef);\n        return Object.assign(Object.assign({}, tagPublicMethods), { rtlEnabled: rtlEnabledRef, mergedClsPrefix: mergedClsPrefixRef, contentRef, mergedBordered: mergedBorderedRef, handleClick,\n            handleCloseClick, cssVars: computed(() => {\n                const { type, size, color: { color, textColor } = {} } = props;\n                const { common: { cubicBezierEaseInOut }, self: { padding, closeMargin, closeMarginRtl, borderRadius, opacityDisabled, textColorCheckable, textColorHoverCheckable, textColorPressedCheckable, textColorChecked, colorCheckable, colorHoverCheckable, colorPressedCheckable, colorChecked, colorCheckedHover, colorCheckedPressed, [createKey('closeSize', size)]: closeSize, [createKey('fontSize', size)]: fontSize, [createKey('height', size)]: height, [createKey('color', type)]: typedColor, [createKey('textColor', type)]: typeTextColor, [createKey('border', type)]: border, [createKey('closeColor', type)]: closeColor, [createKey('closeColorHover', type)]: closeColorHover, [createKey('closeColorPressed', type)]: closeColorPressed } } = themeRef.value;\n                return {\n                    '--avatar-size-override': `calc(${height} - 8px)`,\n                    '--bezier': cubicBezierEaseInOut,\n                    '--border-radius': borderRadius,\n                    '--border': border,\n                    '--close-color': closeColor,\n                    '--close-color-hover': closeColorHover,\n                    '--close-color-pressed': closeColorPressed,\n                    '--close-margin': closeMargin,\n                    '--close-margin-rtl': closeMarginRtl,\n                    '--close-size': closeSize,\n                    '--color': color || typedColor,\n                    '--color-checkable': colorCheckable,\n                    '--color-checked': colorChecked,\n                    '--color-checked-hover': colorCheckedHover,\n                    '--color-checked-pressed': colorCheckedPressed,\n                    '--color-hover-checkable': colorHoverCheckable,\n                    '--color-pressed-checkable': colorPressedCheckable,\n                    '--font-size': fontSize,\n                    '--height': height,\n                    '--opacity-disabled': opacityDisabled,\n                    '--padding': padding,\n                    '--text-color': textColor || typeTextColor,\n                    '--text-color-checkable': textColorCheckable,\n                    '--text-color-checked': textColorChecked,\n                    '--text-color-hover-checkable': textColorHoverCheckable,\n                    '--text-color-pressed-checkable': textColorPressedCheckable\n                };\n            }) });\n    },\n    render() {\n        const { mergedClsPrefix, rtlEnabled, color: { borderColor } = {}, $slots } = this;\n        return (h(\"div\", { class: [\n                `${mergedClsPrefix}-tag`,\n                {\n                    [`${mergedClsPrefix}-tag--rtl`]: rtlEnabled,\n                    [`${mergedClsPrefix}-tag--disabled`]: this.disabled,\n                    [`${mergedClsPrefix}-tag--checkable`]: this.checkable,\n                    [`${mergedClsPrefix}-tag--checked`]: this.checkable && this.checked,\n                    [`${mergedClsPrefix}-tag--round`]: this.round\n                }\n            ], style: this.cssVars, onClick: this.handleClick, onMouseenter: this.onMouseenter, onMouseleave: this.onMouseleave },\n            $slots.avatar && (h(\"div\", { class: `${mergedClsPrefix}-tag__avatar` }, {\n                default: $slots.avatar\n            })),\n            h(\"span\", { class: `${mergedClsPrefix}-tag__content`, ref: \"contentRef\" }, this.$slots),\n            !this.checkable && this.closable ? (h(NBaseClose, { clsPrefix: mergedClsPrefix, class: `${mergedClsPrefix}-tag__close`, disabled: this.disabled, onClick: this.handleCloseClick })) : null,\n            !this.checkable && this.mergedBordered ? (h(\"div\", { class: `${mergedClsPrefix}-tag__border`, style: { borderColor } })) : null));\n    }\n});\n","export default {\n    paddingSingle: '0 26px 0 14px',\n    clearSize: '16px',\n    arrowSize: '16px'\n};\n","import { changeColor } from 'seemly';\nimport { commonLight } from '../../../_styles/common';\nimport { popoverLight } from '../../../popover/styles';\nimport commonVariables from './_common';\nimport { createTheme } from '../../../_mixins';\nconst self = (vars) => {\n    const { borderRadius, textColor2, textColorDisabled, inputColor, inputColorDisabled, primaryColor, primaryColorHover, warningColor, warningColorHover, errorColor, errorColorHover, borderColor, iconColor, iconColorDisabled, clearColor, clearColorHover, clearColorPressed, placeholderColor, placeholderColorDisabled, fontSizeTiny, fontSizeSmall, fontSizeMedium, fontSizeLarge, heightTiny, heightSmall, heightMedium, heightLarge } = vars;\n    return Object.assign(Object.assign({}, commonVariables), { fontSizeTiny,\n        fontSizeSmall,\n        fontSizeMedium,\n        fontSizeLarge,\n        heightTiny,\n        heightSmall,\n        heightMedium,\n        heightLarge,\n        borderRadius, \n        // default\n        textColor: textColor2, textColorDisabled,\n        placeholderColor,\n        placeholderColorDisabled, color: inputColor, colorDisabled: inputColorDisabled, colorActive: inputColor, border: `1px solid ${borderColor}`, borderHover: `1px solid ${primaryColorHover}`, borderActive: `1px solid ${primaryColor}`, borderFocus: `1px solid ${primaryColorHover}`, boxShadowHover: null, boxShadowActive: `0 0 0 2px ${changeColor(primaryColor, {\n            alpha: 0.2\n        })}`, boxShadowFocus: `0 0 0 2px ${changeColor(primaryColor, {\n            alpha: 0.2\n        })}`, caretColor: primaryColor, arrowColor: iconColor, arrowColorDisabled: iconColorDisabled, loadingColor: primaryColor, \n        // warning\n        borderWarning: `1px solid ${warningColor}`, borderHoverWarning: `1px solid ${warningColorHover}`, borderActiveWarning: `1px solid ${warningColor}`, borderFocusWarning: `1px solid ${warningColorHover}`, boxShadowHoverWarning: null, boxShadowActiveWarning: `0 0 0 2px ${changeColor(warningColor, {\n            alpha: 0.2\n        })}`, boxShadowFocusWarning: `0 0 0 2px ${changeColor(warningColor, {\n            alpha: 0.2\n        })}`, colorActiveWarning: inputColor, caretColorWarning: warningColor, \n        // error\n        borderError: `1px solid ${errorColor}`, borderHoverError: `1px solid ${errorColorHover}`, borderActiveError: `1px solid ${errorColor}`, borderFocusError: `1px solid ${errorColorHover}`, boxShadowHoverError: null, boxShadowActiveError: `0 0 0 2px ${changeColor(errorColor, {\n            alpha: 0.2\n        })}`, boxShadowFocusError: `0 0 0 2px ${changeColor(errorColor, {\n            alpha: 0.2\n        })}`, colorActiveError: inputColor, caretColorError: errorColor, clearColor,\n        clearColorHover,\n        clearColorPressed });\n};\nconst internalSelectionLight = createTheme({\n    name: 'InternalSelection',\n    common: commonLight,\n    peers: {\n        Popover: popoverLight\n    },\n    self\n});\nexport default internalSelectionLight;\n","import { c, cB, cE, cM, cNotM, insideFormItem } from '../../../../_utils/cssr'; // vars:\n// --bezier\n// --border\n// --border-active\n// --border-focus\n// --border-hover\n// --border-radius\n// --box-shadow-active\n// --box-shadow-focus\n// --box-shadow-hover\n// --caret-color\n// --color\n// --color-active\n// --color-disabled\n// --font-size\n// --height\n// --padding-single\n// --placeholder-color\n// --placeholder-color-disabled\n// --text-color\n// --text-color-disabled\n// --arrow-color\n// --arrow-size\n// --loading-color\n// ...clear vars\n// ...form item vars\n\nexport default c([cB('base-selection', `\n position: relative;\n z-index: auto;\n box-shadow: none;\n width: 100%;\n max-width: 100%;\n display: inline-block;\n vertical-align: bottom;\n border-radius: var(--border-radius);\n min-height: var(--height);\n line-height: 1.5;\n font-size: var(--font-size);\n `, [cB('base-loading', `\n color: var(--loading-color);\n `), cB('base-selection-tags', {\n  minHeight: 'var(--height)'\n}), cE('border, state-border', `\n position: absolute;\n left: 0;\n right: 0;\n top: 0;\n bottom: 0;\n pointer-events: none;\n border: var(--border);\n border-radius: inherit;\n transition:\n box-shadow .3s var(--bezier),\n border-color .3s var(--bezier);\n `), cE('state-border', `\n z-index: 1;\n border-color: #0000;\n `), cB('base-suffix', `\n cursor: pointer;\n position: absolute;\n top: 50%;\n transform: translateY(-50%);\n right: 10px;\n `, [cE('arrow', `\n font-size: var(--arrow-size);\n color: var(--arrow-color);\n transition: color .3s var(--bezier);\n `)]), cB('base-selection-overlay', `\n display: flex;\n align-items: center;\n white-space: nowrap;\n overflow: hidden;\n pointer-events: none;\n position: absolute;\n top: 0;\n right: 0;\n bottom: 0;\n left: 0;\n padding: var(--padding-single);\n transition: color .3s var(--bezier);\n `), cB('base-selection-placeholder', `\n color: var(--placeholder-color);\n `), cB('base-selection-tags', `\n cursor: pointer;\n outline: none;\n box-sizing: border-box;\n position: relative;\n z-index: auto;\n display: flex;\n padding: 3px 26px 0 14px;\n flex-wrap: wrap;\n align-items: center;\n width: 100%;\n vertical-align: bottom;\n background-color: var(--color);\n border-radius: inherit;\n transition:\n color .3s var(--bezier),\n box-shadow .3s var(--bezier),\n background-color .3s var(--bezier);\n `), cB('base-selection-label', `\n height: var(--height);\n display: inline-flex;\n width: 100%;\n vertical-align: bottom;\n cursor: pointer;\n outline: none;\n z-index: auto;\n box-sizing: border-box;\n position: relative;\n transition:\n color .3s var(--bezier),\n box-shadow .3s var(--bezier),\n background-color .3s var(--bezier);\n border-radius: inherit;\n background-color: var(--color);\n align-items: center;\n `, [cB('base-selection-input', `\n line-height: inherit;\n outline: none;\n cursor: pointer;\n box-sizing: border-box;\n border:none;\n width: 100%;\n padding: var(--padding-single);\n background-color: #0000;\n color: var(--text-color);\n transition: color .3s var(--bezier);\n caret-color: var(--caret-color);\n `, [cE('content', `\n text-overflow: ellipsis;\n overflow: hidden;\n white-space: nowrap; \n `)]), cE('render-label', `\n color: var(--text-color);\n `)]), cNotM('disabled', [c('&:hover', [cE('state-border', `\n box-shadow: var(--box-shadow-hover);\n border: var(--border-hover);\n `)]), cM('focus', [cE('state-border', `\n box-shadow: var(--box-shadow-focus);\n border: var(--border-focus);\n `)]), cM('active', [cE('state-border', `\n box-shadow: var(--box-shadow-active);\n border: var(--border-active);\n `), cB('base-selection-label', {\n  backgroundColor: 'var(--color-active)'\n}), cB('base-selection-tags', {\n  backgroundColor: 'var(--color-active)'\n})])]), cM('disabled', {\n  cursor: 'not-allowed'\n}, [cE('arrow', `\n color: var(--arrow-color-disabled);\n `), cB('base-selection-label', `\n cursor: not-allowed;\n background-color: var(--color-disabled);\n `, [cB('base-selection-input', `\n cursor: not-allowed;\n color: var(--text-color-disabled);\n `), cE('render-label', `\n color: var(--text-color-disabled);\n `)]), cB('base-selection-tags', `\n cursor: not-allowed;\n background-color: var(--color-disabled);\n `), cB('base-selection-placeholder', `\n cursor: not-allowed;\n color: var(--placeholder-color-disabled);\n `)]), cB('base-selection-input-tag', `\n height: calc(var(--height) - 6px);\n line-height: calc(var(--height) - 6px);\n outline: none;\n display: none;\n position: relative;\n margin-bottom: 3px;\n max-width: 100%;\n vertical-align: bottom;\n `, [cE('input', `\n min-width: 1px;\n padding: 0;\n background-color: #0000;\n outline: none;\n border: none;\n max-width: 100%;\n overflow: hidden;\n width: 1em;\n line-height: inherit;\n cursor: pointer;\n color: var(--text-color);\n caret-color: var(--caret-color);\n `), cE('mirror', `\n position: absolute;\n left: 0;\n top: 0;\n white-space: pre;\n visibility: hidden;\n user-select: none;\n opacity: 0;\n `)])]), cB('base-selection-popover', `\n margin-bottom: -3px;\n display: flex;\n flex-wrap: wrap;\n `), cB('base-selection-tag-wrapper', `\n max-width: 100%;\n display: inline-flex;\n padding: 0 7px 3px 0;\n `, [c('&:last-child', {\n  paddingRight: 0\n}), cB('tag', `\n font-size: 14px;\n max-width: 100%;\n `, [cE('content', `\n text-overflow: ellipsis;\n overflow: hidden;\n `)])]), ['warning', 'error'].map(status => insideFormItem(status, cB('base-selection', [cE('state-border', {\n  border: `var(--border-${status})`\n}), cNotM('disabled', [c('&:hover', [cE('state-border', `\n box-shadow: var(--box-shadow-hover-${status});\n border: var(--border-hover-${status});\n `)]), cM('active', [cE('state-border', `\n box-shadow: var(--box-shadow-active-${status});\n border: var(--border-active-${status});\n `), cB('base-selection-label', {\n  backgroundColor: `var(--color-active-${status})`\n}), cB('base-selection-tags', {\n  backgroundColor: `var(--box-shadow-active-${status})`\n})]), cM('focus', [cE('state-border', `\n box-shadow: var(--box-shadow-focus-${status});\n border: var(--border-focus-${status});\n `)])])])))]);","/* eslint-disable @typescript-eslint/no-non-null-assertion */\nimport { h, defineComponent, Fragment, ref, computed, watch, toRef, nextTick, watchEffect, onMounted } from 'vue';\nimport { VOverflow } from 'vueuc';\nimport { NPopover } from '../../../popover';\nimport { NTag } from '../../../tag';\nimport { useTheme } from '../../../_mixins';\nimport { createKey, getTitleAttribute, render } from '../../../_utils';\nimport Suffix from '../../suffix';\nimport { internalSelectionLight } from '../styles';\nimport style from './styles/index.cssr';\nexport default defineComponent({\n    name: 'InternalSelection',\n    props: Object.assign(Object.assign({}, useTheme.props), { clsPrefix: {\n            type: String,\n            required: true\n        }, bordered: {\n            type: Boolean,\n            default: undefined\n        }, active: Boolean, pattern: {\n            type: String,\n            default: null\n        }, placeholder: String, selectedOption: {\n            type: Object,\n            default: null\n        }, selectedOptions: {\n            type: Array,\n            default: null\n        }, multiple: Boolean, filterable: Boolean, clearable: Boolean, disabled: Boolean, size: {\n            type: String,\n            default: 'medium'\n        }, loading: Boolean, autofocus: Boolean, showArrow: {\n            type: Boolean,\n            default: true\n        }, inputProps: Object, focused: Boolean, renderTag: Function, onKeyup: Function, onKeydown: Function, onClick: Function, onBlur: Function, onFocus: Function, onDeleteOption: Function, maxTagCount: [String, Number], onClear: Function, onPatternInput: Function, renderLabel: Function }),\n    setup(props) {\n        const patternInputMirrorRef = ref(null);\n        const patternInputRef = ref(null);\n        const selfRef = ref(null);\n        const multipleElRef = ref(null);\n        const singleElRef = ref(null);\n        const patternInputWrapperRef = ref(null);\n        const counterRef = ref(null);\n        const counterWrapperRef = ref(null);\n        const overflowRef = ref(null);\n        const inputTagElRef = ref(null);\n        const showTagsPopoverRef = ref(false);\n        const patternInputFocusedRef = ref(false);\n        const hoverRef = ref(false);\n        const themeRef = useTheme('InternalSelection', 'InternalSelection', style, internalSelectionLight, props, toRef(props, 'clsPrefix'));\n        const mergedClearableRef = computed(() => {\n            return (props.clearable && !props.disabled && (hoverRef.value || props.active));\n        });\n        const filterablePlaceholderRef = computed(() => {\n            return props.selectedOption\n                ? props.renderTag\n                    ? props.renderTag({\n                        option: props.selectedOption,\n                        handleClose: () => { }\n                    })\n                    : props.renderLabel\n                        ? props.renderLabel(props.selectedOption, true)\n                        : render(props.selectedOption.label, props.selectedOption, true)\n                : props.placeholder;\n        });\n        const labelRef = computed(() => {\n            const option = props.selectedOption;\n            if (!option)\n                return undefined;\n            return option.label;\n        });\n        const selectedRef = computed(() => {\n            if (props.multiple) {\n                return !!(Array.isArray(props.selectedOptions) && props.selectedOptions.length);\n            }\n            else {\n                return props.selectedOption !== null;\n            }\n        });\n        function syncMirrorWidth() {\n            var _a;\n            const { value: patternInputMirrorEl } = patternInputMirrorRef;\n            if (patternInputMirrorEl) {\n                const { value: patternInputEl } = patternInputRef;\n                if (patternInputEl) {\n                    patternInputEl.style.width = `${patternInputMirrorEl.offsetWidth}px`;\n                    if (props.maxTagCount !== 'responsive') {\n                        (_a = overflowRef.value) === null || _a === void 0 ? void 0 : _a.sync();\n                    }\n                }\n            }\n        }\n        function hideInputTag() {\n            const { value: inputTagEl } = inputTagElRef;\n            if (inputTagEl)\n                inputTagEl.style.display = 'none';\n        }\n        function showInputTag() {\n            const { value: inputTagEl } = inputTagElRef;\n            if (inputTagEl)\n                inputTagEl.style.display = 'inline-block';\n        }\n        watch(toRef(props, 'active'), (value) => {\n            if (!value)\n                hideInputTag();\n        });\n        watch(toRef(props, 'pattern'), () => {\n            if (props.multiple) {\n                void nextTick(syncMirrorWidth);\n            }\n        });\n        function doFocus(e) {\n            const { onFocus } = props;\n            if (onFocus)\n                onFocus(e);\n        }\n        function doBlur(e) {\n            const { onBlur } = props;\n            if (onBlur)\n                onBlur(e);\n        }\n        function doDeleteOption(value) {\n            const { onDeleteOption } = props;\n            if (onDeleteOption)\n                onDeleteOption(value);\n        }\n        function doClear(e) {\n            const { onClear } = props;\n            if (onClear)\n                onClear(e);\n        }\n        function doPatternInput(value) {\n            const { onPatternInput } = props;\n            if (onPatternInput)\n                onPatternInput(value);\n        }\n        function handleFocusin(e) {\n            var _a;\n            if (!e.relatedTarget ||\n                !((_a = selfRef.value) === null || _a === void 0 ? void 0 : _a.contains(e.relatedTarget))) {\n                doFocus(e);\n            }\n        }\n        function handleFocusout(e) {\n            var _a;\n            if ((_a = selfRef.value) === null || _a === void 0 ? void 0 : _a.contains(e.relatedTarget))\n                return;\n            doBlur(e);\n        }\n        function handleClear(e) {\n            doClear(e);\n        }\n        function handleMouseEnter() {\n            hoverRef.value = true;\n        }\n        function handleMouseLeave() {\n            hoverRef.value = false;\n        }\n        function handleMouseDown(e) {\n            if (!props.active || !props.filterable)\n                return;\n            if (e.target === patternInputRef.value)\n                return;\n            e.preventDefault();\n        }\n        function handleDeleteOption(option) {\n            doDeleteOption(option);\n        }\n        function handlePatternKeyDown(e) {\n            if (e.code === 'Backspace') {\n                if (!props.pattern.length) {\n                    const { selectedOptions } = props;\n                    if (selectedOptions === null || selectedOptions === void 0 ? void 0 : selectedOptions.length) {\n                        handleDeleteOption(selectedOptions[selectedOptions.length - 1]);\n                    }\n                }\n            }\n        }\n        const isCompositingRef = ref(false);\n        // the composition end is later than its input so we can cached the event\n        // and return the input event\n        let cachedInputEvent = null;\n        function handlePatternInputInput(e) {\n            // we should sync mirror width here\n            const { value: patternInputMirrorEl } = patternInputMirrorRef;\n            if (patternInputMirrorEl) {\n                const inputText = e.target.value;\n                patternInputMirrorEl.textContent = inputText;\n                syncMirrorWidth();\n            }\n            if (!isCompositingRef.value) {\n                doPatternInput(e);\n            }\n            else {\n                cachedInputEvent = e;\n            }\n        }\n        function handleCompositionStart() {\n            isCompositingRef.value = true;\n        }\n        function handleCompositionEnd() {\n            isCompositingRef.value = false;\n            doPatternInput(cachedInputEvent);\n            cachedInputEvent = null;\n        }\n        function handlePatternInputFocus() {\n            patternInputFocusedRef.value = true;\n        }\n        function handlePatternInputBlur(e) {\n            patternInputFocusedRef.value = false;\n        }\n        function focus() {\n            if (props.filterable) {\n                patternInputFocusedRef.value = false;\n                const { value: patternInputWrapperEl } = patternInputWrapperRef;\n                if (patternInputWrapperEl)\n                    patternInputWrapperEl.focus();\n            }\n            else if (props.multiple) {\n                const { value: multipleEl } = multipleElRef;\n                multipleEl === null || multipleEl === void 0 ? void 0 : multipleEl.focus();\n            }\n            else {\n                const { value: singleEl } = singleElRef;\n                singleEl === null || singleEl === void 0 ? void 0 : singleEl.focus();\n            }\n        }\n        function focusInput() {\n            const { value: patternInputEl } = patternInputRef;\n            if (patternInputEl) {\n                showInputTag();\n                patternInputEl.focus();\n            }\n        }\n        function blurInput() {\n            const { value: patternInputEl } = patternInputRef;\n            if (patternInputEl) {\n                patternInputEl.blur();\n            }\n        }\n        function updateCounter(count) {\n            const { value } = counterRef;\n            if (value) {\n                value.setTextContent(`+${count}`);\n            }\n        }\n        function getCounter() {\n            const { value } = counterWrapperRef;\n            return value;\n        }\n        function getTail() {\n            return patternInputRef.value;\n        }\n        let enterTimerId = null;\n        function clearEnterTimer() {\n            if (enterTimerId !== null)\n                window.clearTimeout(enterTimerId);\n        }\n        function handleMouseEnterCounter() {\n            if (props.disabled || props.active)\n                return;\n            clearEnterTimer();\n            enterTimerId = window.setTimeout(() => {\n                showTagsPopoverRef.value = true;\n            }, 100);\n        }\n        function handleMouseLeaveCounter() {\n            clearEnterTimer();\n        }\n        function onPopoverUpdateShow(show) {\n            if (!show) {\n                clearEnterTimer();\n                showTagsPopoverRef.value = false;\n            }\n        }\n        onMounted(() => {\n            watchEffect(() => {\n                const patternInputWrapperEl = patternInputWrapperRef.value;\n                if (!patternInputWrapperEl)\n                    return;\n                patternInputWrapperEl.tabIndex =\n                    props.disabled || patternInputFocusedRef.value ? -1 : 0;\n            });\n        });\n        return {\n            mergedTheme: themeRef,\n            mergedClearable: mergedClearableRef,\n            patternInputFocused: patternInputFocusedRef,\n            filterablePlaceholder: filterablePlaceholderRef,\n            label: labelRef,\n            selected: selectedRef,\n            showTagsPanel: showTagsPopoverRef,\n            isCompositing: isCompositingRef,\n            // dom ref\n            counterRef,\n            counterWrapperRef,\n            patternInputMirrorRef,\n            patternInputRef,\n            selfRef,\n            multipleElRef,\n            singleElRef,\n            patternInputWrapperRef,\n            overflowRef,\n            inputTagElRef,\n            handleMouseDown,\n            handleFocusin,\n            handleClear,\n            handleMouseEnter,\n            handleMouseLeave,\n            handleDeleteOption,\n            handlePatternKeyDown,\n            handlePatternInputInput,\n            handlePatternInputBlur,\n            handlePatternInputFocus,\n            handleMouseEnterCounter,\n            handleMouseLeaveCounter,\n            handleFocusout,\n            handleCompositionEnd,\n            handleCompositionStart,\n            onPopoverUpdateShow,\n            focus,\n            focusInput,\n            blurInput,\n            updateCounter,\n            getCounter,\n            getTail,\n            renderLabel: props.renderLabel,\n            cssVars: computed(() => {\n                const { size } = props;\n                const { common: { cubicBezierEaseInOut }, self: { borderRadius, color, placeholderColor, textColor, paddingSingle, caretColor, colorDisabled, textColorDisabled, placeholderColorDisabled, colorActive, boxShadowFocus, boxShadowActive, boxShadowHover, border, borderFocus, borderHover, borderActive, arrowColor, arrowColorDisabled, loadingColor, \n                // form warning\n                colorActiveWarning, boxShadowFocusWarning, boxShadowActiveWarning, boxShadowHoverWarning, borderWarning, borderFocusWarning, borderHoverWarning, borderActiveWarning, \n                // form error\n                colorActiveError, boxShadowFocusError, boxShadowActiveError, boxShadowHoverError, borderError, borderFocusError, borderHoverError, borderActiveError, \n                // clear\n                clearColor, clearColorHover, clearColorPressed, clearSize, \n                // arrow\n                arrowSize, [createKey('height', size)]: height, [createKey('fontSize', size)]: fontSize } } = themeRef.value;\n                return {\n                    '--bezier': cubicBezierEaseInOut,\n                    '--border': border,\n                    '--border-active': borderActive,\n                    '--border-focus': borderFocus,\n                    '--border-hover': borderHover,\n                    '--border-radius': borderRadius,\n                    '--box-shadow-active': boxShadowActive,\n                    '--box-shadow-focus': boxShadowFocus,\n                    '--box-shadow-hover': boxShadowHover,\n                    '--caret-color': caretColor,\n                    '--color': color,\n                    '--color-active': colorActive,\n                    '--color-disabled': colorDisabled,\n                    '--font-size': fontSize,\n                    '--height': height,\n                    '--padding-single': paddingSingle,\n                    '--placeholder-color': placeholderColor,\n                    '--placeholder-color-disabled': placeholderColorDisabled,\n                    '--text-color': textColor,\n                    '--text-color-disabled': textColorDisabled,\n                    '--arrow-color': arrowColor,\n                    '--arrow-color-disabled': arrowColorDisabled,\n                    '--loading-color': loadingColor,\n                    // form warning\n                    '--color-active-warning': colorActiveWarning,\n                    '--box-shadow-focus-warning': boxShadowFocusWarning,\n                    '--box-shadow-active-warning': boxShadowActiveWarning,\n                    '--box-shadow-hover-warning': boxShadowHoverWarning,\n                    '--border-warning': borderWarning,\n                    '--border-focus-warning': borderFocusWarning,\n                    '--border-hover-warning': borderHoverWarning,\n                    '--border-active-warning': borderActiveWarning,\n                    // form error\n                    '--color-active-error': colorActiveError,\n                    '--box-shadow-focus-error': boxShadowFocusError,\n                    '--box-shadow-active-error': boxShadowActiveError,\n                    '--box-shadow-hover-error': boxShadowHoverError,\n                    '--border-error': borderError,\n                    '--border-focus-error': borderFocusError,\n                    '--border-hover-error': borderHoverError,\n                    '--border-active-error': borderActiveError,\n                    // clear\n                    '--clear-size': clearSize,\n                    '--clear-color': clearColor,\n                    '--clear-color-hover': clearColorHover,\n                    '--clear-color-pressed': clearColorPressed,\n                    // arrow-size\n                    '--arrow-size': arrowSize\n                };\n            })\n        };\n    },\n    render() {\n        const { multiple, size, disabled, filterable, maxTagCount, bordered, clsPrefix, renderTag, renderLabel } = this;\n        const maxTagCountResponsive = maxTagCount === 'responsive';\n        const maxTagCountNumeric = typeof maxTagCount === 'number';\n        const useMaxTagCount = maxTagCountResponsive || maxTagCountNumeric;\n        const suffix = (h(Suffix, { clsPrefix: clsPrefix, loading: this.loading, showArrow: this.showArrow, showClear: this.mergedClearable && this.selected, onClear: this.handleClear }));\n        let body;\n        if (multiple) {\n            const createTag = (option) => (h(\"div\", { class: `${clsPrefix}-base-selection-tag-wrapper`, key: option.value }, renderTag ? (renderTag({\n                option,\n                handleClose: () => this.handleDeleteOption(option)\n            })) : (h(NTag, { size: size, closable: !option.disabled, disabled: disabled, internalStopClickPropagation: true, onClose: () => this.handleDeleteOption(option) }, {\n                default: () => renderLabel\n                    ? renderLabel(option, true)\n                    : render(option.label, option, true)\n            }))));\n            const originalTags = (maxTagCountNumeric\n                ? this.selectedOptions.slice(0, maxTagCount)\n                : this.selectedOptions).map(createTag);\n            const input = filterable ? (h(\"div\", { class: `${clsPrefix}-base-selection-input-tag`, ref: \"inputTagElRef\", key: \"__input-tag__\" },\n                h(\"input\", Object.assign({}, this.inputProps, { ref: \"patternInputRef\", tabindex: -1, disabled: disabled, value: this.pattern, autofocus: this.autofocus, class: `${clsPrefix}-base-selection-input-tag__input`, onBlur: this.handlePatternInputBlur, onFocus: this.handlePatternInputFocus, onKeydown: this.handlePatternKeyDown, onInput: this.handlePatternInputInput, onCompositionstart: this.handleCompositionStart, onCompositionend: this.handleCompositionEnd })),\n                h(\"span\", { ref: \"patternInputMirrorRef\", class: `${clsPrefix}-base-selection-input-tag__mirror` }, this.pattern ? this.pattern : ''))) : null;\n            // May Overflow\n            const renderCounter = maxTagCountResponsive\n                ? () => (h(\"div\", { class: `${clsPrefix}-base-selection-tag-wrapper`, ref: \"counterWrapperRef\" },\n                    h(NTag, { ref: \"counterRef\", onMouseenter: this.handleMouseEnterCounter, onMouseleave: this.handleMouseLeaveCounter, disabled: disabled })))\n                : undefined;\n            let counter;\n            if (maxTagCountNumeric) {\n                const rest = this.selectedOptions.length - maxTagCount;\n                if (rest > 0) {\n                    counter = (h(\"div\", { class: `${clsPrefix}-base-selection-tag-wrapper`, key: \"__counter__\" },\n                        h(NTag, { ref: \"counterRef\", onMouseenter: this.handleMouseEnterCounter, disabled: disabled }, {\n                            default: () => `+${rest}`\n                        })));\n                }\n            }\n            const tags = maxTagCountResponsive ? (filterable ? (h(VOverflow, { ref: \"overflowRef\", updateCounter: this.updateCounter, getCounter: this.getCounter, getTail: this.getTail, style: {\n                    width: '100%',\n                    display: 'flex',\n                    overflow: 'hidden'\n                } }, {\n                default: () => originalTags,\n                counter: renderCounter,\n                tail: () => input\n            })) : (h(VOverflow, { ref: \"overflowRef\", updateCounter: this.updateCounter, getCounter: this.getCounter, style: {\n                    width: '100%',\n                    display: 'flex',\n                    overflow: 'hidden'\n                } }, {\n                default: () => originalTags,\n                counter: renderCounter\n            }))) : maxTagCountNumeric ? (originalTags.concat(counter)) : (originalTags);\n            const renderPopover = useMaxTagCount\n                ? () => (h(\"div\", { class: `${clsPrefix}-base-selection-popover` }, maxTagCountResponsive\n                    ? originalTags\n                    : this.selectedOptions.map(createTag)))\n                : undefined;\n            const popoverProps = useMaxTagCount\n                ? {\n                    show: this.showTagsPanel,\n                    trigger: 'hover',\n                    overlap: true,\n                    placement: 'top',\n                    width: 'trigger',\n                    onUpdateShow: this.onPopoverUpdateShow,\n                    theme: this.mergedTheme.peers.Popover,\n                    themeOverrides: this.mergedTheme.peerOverrides.Popover\n                }\n                : null;\n            const placeholder = !this.selected && !this.pattern && !this.isCompositing ? (h(\"div\", { class: `${clsPrefix}-base-selection-placeholder ${clsPrefix}-base-selection-overlay` }, this.placeholder)) : null;\n            if (filterable) {\n                const popoverTrigger = (h(\"div\", { ref: \"patternInputWrapperRef\", class: `${clsPrefix}-base-selection-tags` },\n                    tags,\n                    maxTagCountResponsive ? null : input,\n                    suffix));\n                body = (h(Fragment, null,\n                    useMaxTagCount ? (h(NPopover, Object.assign({}, popoverProps), {\n                        trigger: () => popoverTrigger,\n                        default: renderPopover\n                    })) : (popoverTrigger),\n                    placeholder));\n            }\n            else {\n                const popoverTrigger = (h(\"div\", { ref: \"multipleElRef\", class: `${clsPrefix}-base-selection-tags`, tabindex: disabled ? undefined : 0 },\n                    tags,\n                    suffix));\n                body = (h(Fragment, null,\n                    useMaxTagCount ? (h(NPopover, Object.assign({}, popoverProps), {\n                        trigger: () => popoverTrigger,\n                        default: renderPopover\n                    })) : (popoverTrigger),\n                    placeholder));\n            }\n        }\n        else {\n            if (filterable) {\n                const showPlaceholder = !this.pattern &&\n                    (this.active || !this.selected) &&\n                    !this.isCompositing;\n                body = (h(\"div\", { ref: \"patternInputWrapperRef\", class: `${clsPrefix}-base-selection-label` },\n                    h(\"input\", Object.assign({}, this.inputProps, { ref: \"patternInputRef\", class: `${clsPrefix}-base-selection-input`, value: this.patternInputFocused && this.active ? this.pattern : '', placeholder: \"\", readonly: disabled, disabled: disabled, tabindex: -1, autofocus: this.autofocus, onFocus: this.handlePatternInputFocus, onBlur: this.handlePatternInputBlur, onInput: this.handlePatternInputInput, onCompositionstart: this.handleCompositionStart, onCompositionend: this.handleCompositionEnd })),\n                    showPlaceholder ? null : this.patternInputFocused &&\n                        this.active ? null : (h(\"div\", { class: `${clsPrefix}-base-selection-label__render-label ${clsPrefix}-base-selection-overlay`, key: \"input\" }, renderTag\n                        ? renderTag({\n                            option: this.selectedOption,\n                            handleClose: () => { }\n                        })\n                        : renderLabel\n                            ? renderLabel(this.selectedOption, true)\n                            : render(this.label, this.selectedOption, true))),\n                    showPlaceholder ? (h(\"div\", { class: `${clsPrefix}-base-selection-placeholder ${clsPrefix}-base-selection-overlay`, key: \"placeholder\" }, this.filterablePlaceholder)) : null,\n                    suffix));\n            }\n            else {\n                body = (h(\"div\", { ref: \"singleElRef\", class: `${clsPrefix}-base-selection-label`, tabindex: this.disabled ? undefined : 0 },\n                    this.label !== undefined ? (h(\"div\", { class: `${clsPrefix}-base-selection-input`, title: getTitleAttribute(this.label), key: \"input\" },\n                        h(\"div\", { class: `${clsPrefix}-base-selection-input__content` }, renderTag\n                            ? renderTag({\n                                option: this.selectedOption,\n                                handleClose: () => { }\n                            })\n                            : renderLabel\n                                ? renderLabel(this.selectedOption, true)\n                                : render(this.label, this.selectedOption, true)))) : (h(\"div\", { class: `${clsPrefix}-base-selection-placeholder ${clsPrefix}-base-selection-overlay`, key: \"placeholder\" }, this.placeholder)),\n                    suffix));\n            }\n        }\n        return (h(\"div\", { ref: \"selfRef\", class: [\n                `${clsPrefix}-base-selection`,\n                {\n                    [`${clsPrefix}-base-selection--active`]: this.active,\n                    [`${clsPrefix}-base-selection--selected`]: this.selected || (this.active && this.pattern),\n                    [`${clsPrefix}-base-selection--disabled`]: this.disabled,\n                    [`${clsPrefix}-base-selection--multiple`]: this.multiple,\n                    // focus is not controlled by selection itself since it always need\n                    // to be managed together with menu. provide :focus style will cause\n                    // many redundant codes.\n                    [`${clsPrefix}-base-selection--focus`]: this.focused\n                }\n            ], style: this.cssVars, onClick: this.onClick, onMouseenter: this.handleMouseEnter, onMouseleave: this.handleMouseLeave, onKeyup: this.onKeyup, onKeydown: this.onKeydown, onFocusin: this.handleFocusin, onFocusout: this.handleFocusout, onMousedown: this.handleMouseDown },\n            body,\n            bordered ? (h(\"div\", { class: `${clsPrefix}-base-selection__border` })) : null,\n            bordered ? (h(\"div\", { class: `${clsPrefix}-base-selection__state-border` })) : null));\n    }\n});\n","export function getKey(option) {\n    if (getIsGroup(option)) {\n        return (option.name ||\n            option.key ||\n            'key-required');\n    }\n    return option.value;\n}\nexport function getIsGroup(option) {\n    return option.type === 'group';\n}\nexport function getIgnored(option) {\n    return option.type === 'ignored';\n}\nexport const tmOptions = {\n    getKey,\n    getIsGroup,\n    getIgnored\n};\nexport function patternMatched(pattern, value) {\n    try {\n        return !!(1 + value.toString().toLowerCase().indexOf(pattern.trim().toLowerCase()));\n    }\n    catch (err) {\n        return false;\n    }\n}\nexport function filterOptions(originalOpts, filter, pattern) {\n    if (!filter)\n        return originalOpts;\n    function traverse(options) {\n        if (!Array.isArray(options))\n            return [];\n        const filteredOptions = [];\n        for (const option of options) {\n            if (getIsGroup(option)) {\n                const children = traverse(option.children);\n                if (children.length) {\n                    filteredOptions.push(Object.assign({}, option, {\n                        children\n                    }));\n                }\n            }\n            else if (getIgnored(option)) {\n                continue;\n            }\n            else if (filter(pattern, option)) {\n                filteredOptions.push(option);\n            }\n        }\n        return filteredOptions;\n    }\n    return traverse(originalOpts);\n}\nexport function createValOptMap(options) {\n    const valOptMap = new Map();\n    options.forEach((option) => {\n        if (getIsGroup(option)) {\n            ;\n            option.children.forEach((SelectGroupOption) => {\n                valOptMap.set(SelectGroupOption.value, SelectGroupOption);\n            });\n        }\n        else {\n            valOptMap.set(option.value, option);\n        }\n    });\n    return valOptMap;\n}\nexport function defaultFilter(pattern, option) {\n    if (!option)\n        return false;\n    if (typeof option.label === 'string') {\n        return patternMatched(pattern, option.label);\n    }\n    else if (option.value !== undefined) {\n        return patternMatched(pattern, String(option.value));\n    }\n    return false;\n}\n","import { internalSelectionLight } from '../../_internal/selection/styles';\nimport { internalSelectMenuLight } from '../../_internal/select-menu/styles';\nimport { commonLight } from '../../_styles/common';\nimport { createTheme } from '../../_mixins';\nexport function self(vars) {\n    const { boxShadow2 } = vars;\n    return {\n        menuBoxShadow: boxShadow2\n    };\n}\nconst selectLight = createTheme({\n    name: 'Select',\n    common: commonLight,\n    peers: {\n        InternalSelection: internalSelectionLight,\n        InternalSelectMenu: internalSelectMenuLight\n    },\n    self\n});\nexport default selectLight;\n","import { cB, c } from '../../../_utils/cssr';\nimport fadeInScaleUpTransition from '../../../_styles/transitions/fade-in-scale-up.cssr'; // --menu-box-shadow\n\nexport default c([cB('select', `\n z-index: auto;\n outline: none;\n width: 100%;\n position: relative;\n `), cB('select-menu', `\n margin: 4px 0;\n box-shadow: var(--menu-box-shadow);\n `, [fadeInScaleUpTransition()])]);","import { h, ref, computed, toRef, defineComponent, nextTick, watch, Transition, withDirectives, vShow } from 'vue';\nimport { happensIn } from 'seemly';\nimport { createTreeMate } from 'treemate';\nimport { VBinder, VFollower, VTarget } from 'vueuc';\nimport { useIsMounted, useMergedState, useCompitable } from 'vooks';\nimport { clickoutside } from 'vdirs';\nimport { useTheme, useConfig, useLocale, useFormItem } from '../../_mixins';\nimport { warn, call, useAdjustedTo } from '../../_utils';\nimport { NInternalSelectMenu, NInternalSelection } from '../../_internal';\nimport { selectLight } from '../styles';\nimport { tmOptions, createValOptMap, filterOptions, defaultFilter } from './utils';\nimport style from './styles/index.cssr';\nconst selectProps = Object.assign(Object.assign({}, useTheme.props), { to: useAdjustedTo.propTo, bordered: {\n        type: Boolean,\n        default: undefined\n    }, clearable: Boolean, options: {\n        type: Array,\n        default: () => []\n    }, defaultValue: {\n        type: [String, Number, Array],\n        default: null\n    }, value: [String, Number, Array], placeholder: String, menuProps: Object, multiple: Boolean, size: String, filterable: Boolean, disabled: {\n        type: Boolean,\n        default: undefined\n    }, remote: Boolean, loading: Boolean, filter: {\n        type: Function,\n        default: defaultFilter\n    }, placement: {\n        type: String,\n        default: 'bottom-start'\n    }, widthMode: {\n        type: String,\n        default: 'trigger'\n    }, tag: Boolean, onCreate: {\n        type: Function,\n        default: (label) => ({\n            label: label,\n            value: label\n        })\n    }, fallbackOption: {\n        type: [Function, Boolean],\n        default: () => (value) => ({\n            label: String(value),\n            value\n        })\n    }, show: {\n        type: Boolean,\n        default: undefined\n    }, showArrow: {\n        type: Boolean,\n        default: true\n    }, maxTagCount: [Number, String], consistentMenuWidth: {\n        type: Boolean,\n        default: true\n    }, virtualScroll: {\n        type: Boolean,\n        default: true\n    }, renderLabel: Function, renderOption: Function, renderTag: Function, 'onUpdate:value': [Function, Array], inputProps: Object, \n    // for jsx\n    onUpdateValue: [Function, Array], onBlur: [Function, Array], onClear: [Function, Array], onFocus: [Function, Array], onScroll: [Function, Array], onSearch: [Function, Array], onUpdateShow: [Function, Array], 'onUpdate:show': [Function, Array], \n    /** deprecated */\n    onChange: {\n        type: [Function, Array],\n        validator: () => {\n            if (process.env.NODE_ENV !== 'production') {\n                warn('select', '`on-change` is deprecated, please use `on-update:value` instead.');\n            }\n            return true;\n        },\n        default: undefined\n    }, items: {\n        type: Array,\n        validator: () => {\n            if (process.env.NODE_ENV !== 'production') {\n                warn('select', '`items` is deprecated, please use `options` instead.');\n            }\n            return true;\n        },\n        default: undefined\n    }, displayDirective: {\n        type: String,\n        default: 'show'\n    } });\nexport default defineComponent({\n    name: 'Select',\n    props: selectProps,\n    setup(props) {\n        const { mergedClsPrefixRef, mergedBorderedRef, namespaceRef } = useConfig(props);\n        const themeRef = useTheme('Select', 'Select', style, selectLight, props, mergedClsPrefixRef);\n        const uncontrolledValueRef = ref(props.defaultValue);\n        const controlledValueRef = toRef(props, 'value');\n        const mergedValueRef = useMergedState(controlledValueRef, uncontrolledValueRef);\n        const focusedRef = ref(false);\n        const patternRef = ref('');\n        const treeMateRef = computed(() => createTreeMate(filteredOptionsRef.value, tmOptions));\n        const valOptMapRef = computed(() => createValOptMap(localOptionsRef.value));\n        const uncontrolledShowRef = ref(false);\n        const mergedShowRef = useMergedState(toRef(props, 'show'), uncontrolledShowRef);\n        const triggerRef = ref(null);\n        const followerRef = ref(null);\n        const menuRef = ref(null);\n        const { localeRef } = useLocale('Select');\n        const localizedPlaceholderRef = computed(() => {\n            var _a;\n            return (_a = props.placeholder) !== null && _a !== void 0 ? _a : localeRef.value.placeholder;\n        });\n        const compitableOptionsRef = useCompitable(props, ['items', 'options']);\n        const createdOptionsRef = ref([]);\n        const beingCreatedOptionsRef = ref([]);\n        const memoValOptMapRef = ref(new Map());\n        const wrappedFallbackOptionRef = computed(() => {\n            const { fallbackOption } = props;\n            if (!fallbackOption)\n                return false;\n            return (value) => {\n                return Object.assign(fallbackOption(value), {\n                    value\n                });\n            };\n        });\n        const localOptionsRef = computed(() => {\n            return beingCreatedOptionsRef.value.concat(createdOptionsRef.value).concat(compitableOptionsRef.value);\n        });\n        const filteredOptionsRef = computed(() => {\n            if (props.remote) {\n                return compitableOptionsRef.value;\n            }\n            else {\n                const { value: localOptions } = localOptionsRef;\n                const { value: pattern } = patternRef;\n                if (!pattern.length || !props.filterable) {\n                    return localOptions;\n                }\n                else {\n                    const { filter } = props;\n                    return filterOptions(localOptions, filter, pattern);\n                }\n            }\n        });\n        function getMergedOptions(values) {\n            const remote = props.remote;\n            const { value: memoValOptMap } = memoValOptMapRef;\n            const { value: valOptMap } = valOptMapRef;\n            const { value: wrappedFallbackOption } = wrappedFallbackOptionRef;\n            const options = [];\n            values.forEach((value) => {\n                if (valOptMap.has(value)) {\n                    // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n                    options.push(valOptMap.get(value));\n                }\n                else if (remote && memoValOptMap.has(value)) {\n                    // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n                    options.push(memoValOptMap.get(value));\n                }\n                else if (wrappedFallbackOption) {\n                    const option = wrappedFallbackOption(value);\n                    if (option) {\n                        options.push(option);\n                    }\n                }\n            });\n            return options;\n        }\n        const selectedOptionsRef = computed(() => {\n            if (props.multiple) {\n                const { value: values } = mergedValueRef;\n                if (!Array.isArray(values))\n                    return [];\n                return getMergedOptions(values);\n            }\n            return null;\n        });\n        const selectedOptionRef = computed(() => {\n            const { value: mergedValue } = mergedValueRef;\n            if (!props.multiple && !Array.isArray(mergedValue)) {\n                if (mergedValue === null)\n                    return null;\n                return getMergedOptions([mergedValue])[0] || null;\n            }\n            return null;\n        });\n        const formItem = useFormItem(props);\n        const { mergedSizeRef, mergedDisabledRef } = formItem;\n        function doUpdateValue(value, option) {\n            const { onChange, 'onUpdate:value': _onUpdateValue, onUpdateValue } = props;\n            const { nTriggerFormChange, nTriggerFormInput } = formItem;\n            if (onChange)\n                call(onChange, value, option);\n            if (onUpdateValue)\n                call(onUpdateValue, value, option);\n            if (_onUpdateValue) {\n                call(_onUpdateValue, value, option);\n            }\n            uncontrolledValueRef.value = value;\n            nTriggerFormChange();\n            nTriggerFormInput();\n        }\n        function doBlur(e) {\n            const { onBlur } = props;\n            const { nTriggerFormBlur } = formItem;\n            if (onBlur)\n                call(onBlur, e);\n            nTriggerFormBlur();\n        }\n        function doClear() {\n            const { onClear } = props;\n            if (onClear)\n                call(onClear);\n        }\n        function doFocus(e) {\n            const { onFocus } = props;\n            const { nTriggerFormFocus } = formItem;\n            if (onFocus)\n                call(onFocus, e);\n            nTriggerFormFocus();\n        }\n        function doSearch(value) {\n            const { onSearch } = props;\n            if (onSearch)\n                call(onSearch, value);\n        }\n        function doScroll(e) {\n            const { onScroll } = props;\n            if (onScroll)\n                call(onScroll, e);\n        }\n        // remote related methods\n        function updateMemorizedOptions() {\n            var _a;\n            const { remote, multiple } = props;\n            if (remote) {\n                const { value: memoValOptMap } = memoValOptMapRef;\n                if (multiple) {\n                    (_a = selectedOptionsRef.value) === null || _a === void 0 ? void 0 : _a.forEach((option) => {\n                        memoValOptMap.set(option.value, option);\n                    });\n                }\n                else {\n                    const option = selectedOptionRef.value;\n                    if (option) {\n                        memoValOptMap.set(option.value, option);\n                    }\n                }\n            }\n        }\n        // menu related methods\n        function doUpdateShow(value) {\n            const { onUpdateShow, 'onUpdate:show': _onUpdateShow } = props;\n            if (onUpdateShow)\n                call(onUpdateShow, value);\n            if (_onUpdateShow)\n                call(_onUpdateShow, value);\n            uncontrolledShowRef.value = value;\n        }\n        function openMenu() {\n            if (!mergedDisabledRef.value) {\n                patternRef.value = '';\n                doUpdateShow(true);\n                uncontrolledShowRef.value = true;\n                if (props.filterable) {\n                    focusSelectionInput();\n                }\n            }\n        }\n        function closeMenu() {\n            doUpdateShow(false);\n        }\n        function handleMenuAfterLeave() {\n            patternRef.value = '';\n        }\n        function handleTriggerClick() {\n            if (mergedDisabledRef.value)\n                return;\n            if (!mergedShowRef.value) {\n                openMenu();\n            }\n            else {\n                if (!props.filterable) {\n                    // already focused, don't need to return focus\n                    closeMenu();\n                }\n            }\n        }\n        function handleTriggerBlur(e) {\n            var _a, _b;\n            if ((_b = (_a = menuRef.value) === null || _a === void 0 ? void 0 : _a.selfRef) === null || _b === void 0 ? void 0 : _b.contains(e.relatedTarget)) {\n                return;\n            }\n            focusedRef.value = false;\n            doBlur(e);\n            // outside select, don't need to return focus\n            closeMenu();\n        }\n        function handleTriggerFocus(e) {\n            doFocus(e);\n            focusedRef.value = true;\n        }\n        function handleMenuFocus(e) {\n            focusedRef.value = true;\n        }\n        function handleMenuBlur(e) {\n            var _a;\n            if ((_a = triggerRef.value) === null || _a === void 0 ? void 0 : _a.$el.contains(e.relatedTarget))\n                return;\n            focusedRef.value = false;\n            doBlur(e);\n            // outside select, don't need to return focus\n            closeMenu();\n        }\n        function handleMenuTabOut() {\n            var _a;\n            (_a = triggerRef.value) === null || _a === void 0 ? void 0 : _a.focus();\n            closeMenu();\n        }\n        function handleMenuClickOutside(e) {\n            var _a;\n            if (mergedShowRef.value) {\n                if (!((_a = triggerRef.value) === null || _a === void 0 ? void 0 : _a.$el.contains(e.target))) {\n                    // outside select, don't need to return focus\n                    closeMenu();\n                }\n            }\n        }\n        function createClearedMultipleSelectValue(value) {\n            if (!Array.isArray(value))\n                return [];\n            if (wrappedFallbackOptionRef.value) {\n                // if option has a fallback, I can't help user to clear some unknown value\n                return Array.from(value);\n            }\n            else {\n                // if there's no option fallback, unappeared options are treated as invalid\n                const { remote } = props;\n                const { value: valOptMap } = valOptMapRef;\n                if (remote) {\n                    const { value: memoValOptMap } = memoValOptMapRef;\n                    return value.filter((v) => valOptMap.has(v) || memoValOptMap.has(v));\n                }\n                else {\n                    return value.filter((v) => valOptMap.has(v));\n                }\n            }\n        }\n        function handleToggleByTmNode(tmNode) {\n            handleToggleByOption(tmNode.rawNode);\n        }\n        function handleToggleByOption(option) {\n            if (mergedDisabledRef.value)\n                return;\n            const { tag, remote } = props;\n            if (tag && !remote) {\n                const { value: beingCreatedOptions } = beingCreatedOptionsRef;\n                const beingCreatedOption = beingCreatedOptions[0] || null;\n                if (beingCreatedOption) {\n                    createdOptionsRef.value.push(beingCreatedOption);\n                    beingCreatedOptionsRef.value = [];\n                }\n            }\n            if (remote) {\n                memoValOptMapRef.value.set(option.value, option);\n            }\n            if (props.multiple) {\n                const changedValue = createClearedMultipleSelectValue(mergedValueRef.value);\n                const index = changedValue.findIndex((value) => value === option.value);\n                if (~index) {\n                    changedValue.splice(index, 1);\n                    if (tag && !remote) {\n                        const createdOptionIndex = getCreatedOptionIndex(option.value);\n                        if (~createdOptionIndex) {\n                            createdOptionsRef.value.splice(createdOptionIndex, 1);\n                            patternRef.value = '';\n                        }\n                    }\n                }\n                else {\n                    changedValue.push(option.value);\n                    patternRef.value = '';\n                }\n                doUpdateValue(changedValue, getMergedOptions(changedValue));\n            }\n            else {\n                if (tag && !remote) {\n                    const createdOptionIndex = getCreatedOptionIndex(option.value);\n                    if (~createdOptionIndex) {\n                        createdOptionsRef.value = [\n                            createdOptionsRef.value[createdOptionIndex]\n                        ];\n                    }\n                    else {\n                        createdOptionsRef.value = [];\n                    }\n                }\n                focusSelection();\n                closeMenu();\n                doUpdateValue(option.value, option);\n            }\n        }\n        function getCreatedOptionIndex(optionValue) {\n            const createdOptions = createdOptionsRef.value;\n            return createdOptions.findIndex((createdOption) => createdOption.value === optionValue);\n        }\n        function handlePatternInput(e) {\n            if (!mergedShowRef.value) {\n                openMenu();\n            }\n            const { value } = e.target;\n            patternRef.value = value;\n            const { tag, remote } = props;\n            doSearch(value);\n            if (tag && !remote) {\n                if (!value) {\n                    beingCreatedOptionsRef.value = [];\n                    return;\n                }\n                const optionBeingCreated = props.onCreate(value);\n                if (compitableOptionsRef.value.some((option) => option.value === optionBeingCreated.value) ||\n                    createdOptionsRef.value.some((option) => option.value === optionBeingCreated.value)) {\n                    beingCreatedOptionsRef.value = [];\n                }\n                else {\n                    beingCreatedOptionsRef.value = [optionBeingCreated];\n                }\n            }\n        }\n        function handleClear(e) {\n            e.stopPropagation();\n            const { multiple } = props;\n            if (!multiple && props.filterable) {\n                closeMenu();\n            }\n            doClear();\n            if (multiple) {\n                doUpdateValue([], []);\n            }\n            else {\n                doUpdateValue(null, null);\n            }\n        }\n        function handleMenuMousedown(e) {\n            if (!happensIn(e, 'action'))\n                e.preventDefault();\n        }\n        // scroll events on menu\n        function handleMenuScroll(e) {\n            doScroll(e);\n        }\n        // keyboard events\n        // also for menu keyup\n        function handleKeyUp(e) {\n            var _a, _b, _c, _d;\n            switch (e.code) {\n                case 'Space':\n                    if (props.filterable)\n                        break;\n                // eslint-disable-next-line no-fallthrough\n                case 'Enter':\n                case 'NumpadEnter':\n                    if (mergedShowRef.value) {\n                        const pendingTmNode = (_a = menuRef.value) === null || _a === void 0 ? void 0 : _a.getPendingTmNode();\n                        if (pendingTmNode) {\n                            handleToggleByTmNode(pendingTmNode);\n                        }\n                        else if (!props.filterable) {\n                            closeMenu();\n                            focusSelection();\n                        }\n                    }\n                    else {\n                        openMenu();\n                    }\n                    e.preventDefault();\n                    break;\n                case 'ArrowUp':\n                    if (props.loading)\n                        return;\n                    if (mergedShowRef.value) {\n                        (_b = menuRef.value) === null || _b === void 0 ? void 0 : _b.prev();\n                    }\n                    break;\n                case 'ArrowDown':\n                    if (props.loading)\n                        return;\n                    if (mergedShowRef.value) {\n                        (_c = menuRef.value) === null || _c === void 0 ? void 0 : _c.next();\n                    }\n                    else {\n                        openMenu();\n                    }\n                    break;\n                case 'Escape':\n                    closeMenu();\n                    (_d = triggerRef.value) === null || _d === void 0 ? void 0 : _d.focus();\n                    break;\n            }\n        }\n        // also for menu\n        function handleKeyDown(e) {\n            switch (e.code) {\n                case 'Space':\n                    if (!props.filterable) {\n                        e.preventDefault();\n                    }\n                    break;\n                case 'ArrowUp':\n                case 'ArrowDown':\n                    e.preventDefault();\n                    break;\n            }\n        }\n        function focusSelection() {\n            var _a;\n            (_a = triggerRef.value) === null || _a === void 0 ? void 0 : _a.focus();\n        }\n        function focusSelectionInput() {\n            var _a;\n            (_a = triggerRef.value) === null || _a === void 0 ? void 0 : _a.focusInput();\n        }\n        function syncPosition() {\n            var _a;\n            (_a = followerRef.value) === null || _a === void 0 ? void 0 : _a.syncPosition();\n        }\n        updateMemorizedOptions();\n        watch(toRef(props, 'options'), updateMemorizedOptions);\n        watch(filteredOptionsRef, () => {\n            if (!mergedShowRef.value)\n                return;\n            void nextTick(syncPosition);\n        });\n        watch(mergedValueRef, () => {\n            if (!mergedShowRef.value)\n                return;\n            void nextTick(syncPosition);\n        });\n        return {\n            mergedClsPrefix: mergedClsPrefixRef,\n            mergedBordered: mergedBorderedRef,\n            namespace: namespaceRef,\n            treeMate: treeMateRef,\n            isMounted: useIsMounted(),\n            triggerRef,\n            menuRef,\n            pattern: patternRef,\n            uncontrolledShow: uncontrolledShowRef,\n            mergedShow: mergedShowRef,\n            adjustedTo: useAdjustedTo(props),\n            uncontrolledValue: uncontrolledValueRef,\n            mergedValue: mergedValueRef,\n            followerRef,\n            localizedPlaceholder: localizedPlaceholderRef,\n            selectedOption: selectedOptionRef,\n            selectedOptions: selectedOptionsRef,\n            mergedSize: mergedSizeRef,\n            mergedDisabled: mergedDisabledRef,\n            focused: focusedRef,\n            handleMenuFocus,\n            handleMenuBlur,\n            handleMenuTabOut,\n            handleTriggerClick,\n            handleToggle: handleToggleByTmNode,\n            handleDeleteOption: handleToggleByOption,\n            handlePatternInput,\n            handleClear,\n            handleTriggerBlur,\n            handleTriggerFocus,\n            handleKeyDown,\n            handleKeyUp,\n            syncPosition,\n            handleMenuAfterLeave,\n            handleMenuClickOutside,\n            handleMenuScroll,\n            handleMenuKeyup: handleKeyUp,\n            handleMenuKeydown: handleKeyDown,\n            handleMenuMousedown,\n            mergedTheme: themeRef,\n            cssVars: computed(() => {\n                const { self: { menuBoxShadow } } = themeRef.value;\n                return {\n                    '--menu-box-shadow': menuBoxShadow\n                };\n            })\n        };\n    },\n    render() {\n        const { $slots, mergedClsPrefix } = this;\n        return (h(\"div\", { class: `${mergedClsPrefix}-select` },\n            h(VBinder, null, {\n                default: () => [\n                    h(VTarget, null, {\n                        default: () => (h(NInternalSelection, { ref: \"triggerRef\", inputProps: this.inputProps, clsPrefix: mergedClsPrefix, showArrow: this.showArrow, maxTagCount: this.maxTagCount, bordered: this.mergedBordered, active: this.mergedShow, pattern: this.pattern, placeholder: this.localizedPlaceholder, selectedOption: this.selectedOption, selectedOptions: this.selectedOptions, multiple: this.multiple, renderTag: this.renderTag, renderLabel: this.renderLabel, filterable: this.filterable, clearable: this.clearable, disabled: this.mergedDisabled, size: this.mergedSize, theme: this.mergedTheme.peers.InternalSelection, themeOverrides: this.mergedTheme.peerOverrides.InternalSelection, loading: this.loading, focused: this.focused, onClick: this.handleTriggerClick, onDeleteOption: this.handleDeleteOption, onPatternInput: this.handlePatternInput, onClear: this.handleClear, onBlur: this.handleTriggerBlur, onFocus: this.handleTriggerFocus, onKeydown: this.handleKeyDown, onKeyup: this.handleKeyUp }))\n                    }),\n                    h(VFollower, { ref: \"followerRef\", show: this.mergedShow, to: this.adjustedTo, teleportDisabled: this.adjustedTo === useAdjustedTo.tdkey, containerClass: this.namespace, width: this.consistentMenuWidth ? 'target' : undefined, minWidth: \"target\", placement: this.placement }, {\n                        default: () => (h(Transition, { name: \"fade-in-scale-up-transition\", appear: this.isMounted, onAfterLeave: this.handleMenuAfterLeave }, {\n                            default: () => {\n                                var _a, _b;\n                                return (this.mergedShow ||\n                                    this.displayDirective === 'show') &&\n                                    withDirectives(h(NInternalSelectMenu, Object.assign({}, this.menuProps, { ref: \"menuRef\", virtualScroll: this.consistentMenuWidth && this.virtualScroll, class: [\n                                            `${mergedClsPrefix}-select-menu`,\n                                            (_a = this.menuProps) === null || _a === void 0 ? void 0 : _a.class\n                                        ], clsPrefix: mergedClsPrefix, focusable: true, autoPending: true, theme: this.mergedTheme.peers.InternalSelectMenu, themeOverrides: this.mergedTheme.peerOverrides\n                                            .InternalSelectMenu, treeMate: this.treeMate, multiple: this.multiple, size: 'medium', renderOption: this.renderOption, renderLabel: this.renderLabel, value: this.mergedValue, style: [(_b = this.menuProps) === null || _b === void 0 ? void 0 : _b.style, this.cssVars], onToggle: this.handleToggle, onScroll: this.handleMenuScroll, onFocus: this.handleMenuFocus, onBlur: this.handleMenuBlur, onKeyup: this.handleMenuKeyup, onKeydown: this.handleMenuKeydown, onTabOut: this.handleMenuTabOut, onMousedown: this.handleMenuMousedown, show: this.mergedShow }), $slots), this.displayDirective === 'show'\n                                        ? [\n                                            [vShow, this.mergedShow],\n                                            [clickoutside, this.handleMenuClickOutside]\n                                        ]\n                                        : [[clickoutside, this.handleMenuClickOutside]]);\n                            }\n                        }))\n                    })\n                ]\n            })));\n    }\n});\n","import { commonLight } from '../../_styles/common';\nexport const self = (vars) => {\n    const { textColorBase, opacity1, opacity2, opacity3, opacity4, opacity5 } = vars;\n    return {\n        color: textColorBase,\n        opacity1Depth: opacity1,\n        opacity2Depth: opacity2,\n        opacity3Depth: opacity3,\n        opacity4Depth: opacity4,\n        opacity5Depth: opacity5\n    };\n};\nconst iconLight = {\n    name: 'Icon',\n    common: commonLight,\n    self\n};\nexport default iconLight;\n","import { c, cB, cM } from '../../../_utils/cssr'; // vars:\n// --bezier\n// --color\n// --opacity\n\nexport default cB('icon', `\n height: 1em;\n width: 1em;\n line-height: 1em;\n text-align: center;\n display: inline-block;\n position: relative;\n fill: currentColor;\n transform: translateZ(0);\n`, [cM('color-transition', {\n  transition: 'color .3s var(--bezier)'\n}), cM('depth', {\n  color: 'var(--color)'\n}, [c('svg', {\n  opacity: 'var(--opacity)',\n  transition: 'opacity .3s var(--bezier)'\n})]), c('svg', {\n  height: '1em',\n  width: '1em'\n})]);","import { h, defineComponent, computed, mergeProps } from 'vue';\nimport { useConfig, useTheme } from '../../_mixins';\nimport { formatLength, warn } from '../../_utils';\nimport { iconLight } from '../styles';\nimport style from './styles/index.cssr';\nexport default defineComponent({\n    _n_icon__: true,\n    name: 'Icon',\n    inheritAttrs: false,\n    props: Object.assign(Object.assign({}, useTheme.props), { depth: [String, Number], size: [Number, String], color: String }),\n    setup(props) {\n        const { mergedClsPrefixRef } = useConfig(props);\n        const themeRef = useTheme('Icon', 'Icon', style, iconLight, props, mergedClsPrefixRef);\n        return {\n            mergedClsPrefix: mergedClsPrefixRef,\n            mergedStyle: computed(() => {\n                const { size, color } = props;\n                return {\n                    fontSize: formatLength(size),\n                    color\n                };\n            }),\n            cssVars: computed(() => {\n                const { depth } = props;\n                const { common: { cubicBezierEaseInOut }, self } = themeRef.value;\n                if (depth !== undefined) {\n                    const { color, [`opacity${depth}Depth`]: opacity } = self;\n                    return {\n                        '--bezier': cubicBezierEaseInOut,\n                        '--color': color,\n                        '--opacity': opacity\n                    };\n                }\n                return {\n                    '--bezier': cubicBezierEaseInOut\n                };\n            })\n        };\n    },\n    render() {\n        var _a;\n        const { $parent, depth, mergedClsPrefix } = this;\n        if ((_a = $parent === null || $parent === void 0 ? void 0 : $parent.$options) === null || _a === void 0 ? void 0 : _a._n_icon__) {\n            warn('icon', \"don't wrap `n-icon` inside `n-icon`\");\n        }\n        return h('i', mergeProps(this.$attrs, {\n            role: 'img',\n            class: [\n                `${mergedClsPrefix}-icon`,\n                {\n                    [`${mergedClsPrefix}-icon--depth`]: depth,\n                    [`${mergedClsPrefix}-icon--color-transition`]: depth !== undefined\n                }\n            ],\n            style: Object.assign(this.cssVars, this.mergedStyle)\n        }), this.$slots);\n    }\n});\n","export default {\n    iconSize: '22px'\n};\n","import { buttonLight } from '../../button/styles';\nimport { popoverLight } from '../../popover/styles';\nimport { createTheme } from '../../_mixins';\nimport { commonLight } from '../../_styles/common';\nimport commonVars from './_common';\nexport const self = (vars) => {\n    const { fontSize, warningColor } = vars;\n    return Object.assign(Object.assign({}, commonVars), { fontSize, iconColor: warningColor });\n};\nconst popconfirmLight = createTheme({\n    name: 'Popconfirm',\n    common: commonLight,\n    peers: {\n        Button: buttonLight,\n        Popover: popoverLight\n    },\n    self\n});\nexport default popconfirmLight;\n","export const popconfirmInjectionKey = Symbol('popconfirm');\n","import { h, defineComponent, computed, inject, renderSlot } from 'vue';\nimport { NButton } from '../../button';\nimport { NBaseIcon } from '../../_internal';\nimport { WarningIcon } from '../../_internal/icons';\nimport { useLocale } from '../../_mixins';\nimport { keysOf } from '../../_utils';\nimport { popconfirmInjectionKey } from './interface';\nexport const panelProps = {\n    positiveText: String,\n    negativeText: String,\n    showIcon: {\n        type: Boolean,\n        default: true\n    },\n    onPositiveClick: {\n        type: Function,\n        required: true\n    },\n    onNegativeClick: {\n        type: Function,\n        required: true\n    }\n};\nexport const panelPropKeys = keysOf(panelProps);\nexport default defineComponent({\n    name: 'NPopconfirmPanel',\n    props: panelProps,\n    setup(props) {\n        const { localeRef } = useLocale('Popconfirm');\n        // eslint-disable-next-line @typescript-eslint/no-non-null-assertion\n        const { mergedClsPrefixRef, mergedThemeRef } = inject(popconfirmInjectionKey);\n        return Object.assign(Object.assign({}, useLocale('Popconfirm')), { mergedClsPrefix: mergedClsPrefixRef, cssVars: computed(() => {\n                const { common: { cubicBezierEaseInOut }, self: { fontSize, iconSize, iconColor } } = mergedThemeRef.value;\n                return {\n                    '--bezier': cubicBezierEaseInOut,\n                    '--font-size': fontSize,\n                    '--icon-size': iconSize,\n                    '--icon-color': iconColor\n                };\n            }), localizedPositiveText: computed(() => {\n                return props.positiveText || localeRef.value.positiveText;\n            }), localizedNegativeText: computed(() => {\n                return props.negativeText || localeRef.value.negativeText;\n            }), handlePositiveClick(e) {\n                props.onPositiveClick(e);\n            },\n            handleNegativeClick(e) {\n                props.onNegativeClick(e);\n            } });\n    },\n    render() {\n        const { mergedClsPrefix, $slots } = this;\n        const actionContentNode = $slots.action\n            ? $slots.action()\n            : this.negativeText === null && this.positiveText === null\n                ? null\n                : [\n                    this.negativeText !== null && (h(NButton, { size: \"small\", onClick: this.handleNegativeClick }, { default: () => this.localizedNegativeText })),\n                    this.positiveText !== null && (h(NButton, { size: \"small\", type: \"primary\", onClick: this.handlePositiveClick }, { default: () => this.localizedPositiveText }))\n                ];\n        return (h(\"div\", { style: this.cssVars },\n            h(\"div\", { class: `${mergedClsPrefix}-popconfirm__body` },\n                this.showIcon ? (h(\"div\", { class: `${mergedClsPrefix}-popconfirm__icon` }, renderSlot($slots, 'icon', undefined, () => [\n                    h(NBaseIcon, { clsPrefix: mergedClsPrefix }, { default: () => h(WarningIcon, null) })\n                ]))) : null,\n                renderSlot($slots, 'default')),\n            actionContentNode ? (h(\"div\", { class: `${mergedClsPrefix}-popconfirm__action` }, actionContentNode)) : null));\n    }\n});\n","import { c, cB, cE } from '../../../_utils/cssr'; // vars:\n// --font-size\n// --icon-size\n// --bezier\n// --icon-color\n\nexport default cB('popconfirm', [cE('body', `\n font-size: var(--font-size);\n display: flex;\n align-items: center;\n flex-wrap: nowrap;\n position: relative;\n `, [cE('icon', `\n display: flex;\n font-size: var(--icon-size);\n color: var(--icon-color);\n transition: color .3s var(--bezier);\n margin: 0 8px 0 0;\n `)]), cE('action', `\n margin-top: 8px;\n display: flex;\n justify-content: flex-end;\n `, [cB('button', [c('&:not(:last-child)', {\n  marginRight: '8px'\n})])])]);","import { h, ref, defineComponent, provide } from 'vue';\nimport { NPopover } from '../../popover';\nimport { popoverBaseProps } from '../../popover/src/Popover';\nimport { omit, keep, call } from '../../_utils';\nimport { useConfig, useTheme } from '../../_mixins';\nimport { popconfirmLight } from '../styles';\nimport PopconfirmPanel, { panelPropKeys } from './PopconfirmPanel';\nimport style from './styles/index.cssr';\nimport { popconfirmInjectionKey } from './interface';\nconst popconfirmProps = Object.assign(Object.assign(Object.assign({}, useTheme.props), popoverBaseProps), { positiveText: String, negativeText: String, showIcon: {\n        type: Boolean,\n        default: true\n    }, trigger: {\n        type: String,\n        default: 'click'\n    }, onPositiveClick: Function, onNegativeClick: Function });\nexport default defineComponent({\n    name: 'Popconfirm',\n    props: popconfirmProps,\n    __popover__: true,\n    setup(props) {\n        const { mergedClsPrefixRef } = useConfig();\n        const themeRef = useTheme('Popconfirm', 'Popconfirm', style, popconfirmLight, props, mergedClsPrefixRef);\n        const popoverInstRef = ref(null);\n        function handlePositiveClick(e) {\n            const { onPositiveClick, 'onUpdate:show': onUpdateShow } = props;\n            void Promise.resolve(onPositiveClick ? onPositiveClick(e) : true).then((value) => {\n                var _a;\n                if (value === false)\n                    return;\n                (_a = popoverInstRef.value) === null || _a === void 0 ? void 0 : _a.setShow(false);\n                if (onUpdateShow)\n                    call(onUpdateShow, false);\n            });\n        }\n        function handleNegativeClick(e) {\n            const { onNegativeClick, 'onUpdate:show': onUpdateShow } = props;\n            void Promise.resolve(onNegativeClick ? onNegativeClick(e) : true).then((value) => {\n                var _a;\n                if (value === false)\n                    return;\n                (_a = popoverInstRef.value) === null || _a === void 0 ? void 0 : _a.setShow(false);\n                if (onUpdateShow)\n                    call(onUpdateShow, false);\n            });\n        }\n        provide(popconfirmInjectionKey, {\n            mergedThemeRef: themeRef,\n            mergedClsPrefixRef\n        });\n        return {\n            mergedTheme: themeRef,\n            popoverInstRef,\n            handlePositiveClick,\n            handleNegativeClick\n        };\n    },\n    render() {\n        const { $slots: slots, $props: props, mergedTheme } = this;\n        return h(NPopover, omit(props, panelPropKeys, {\n            theme: mergedTheme.peers.Popover,\n            themeOverrides: mergedTheme.peerOverrides.Popover,\n            internalExtraClass: ['popconfirm'],\n            ref: 'popoverInstRef'\n        }), {\n            trigger: slots.activator || slots.trigger,\n            default: () => {\n                const panelProps = keep(props, panelPropKeys);\n                return h(PopconfirmPanel, Object.assign(Object.assign({}, panelProps), { onPositiveClick: this.handlePositiveClick, onNegativeClick: this.handleNegativeClick }), slots);\n            }\n        });\n    }\n});\n","export enum BodyPart {\r\n    trunk = 'trunk',\r\n    head = 'head',\r\n    leftUpperArm = 'leftUpperArm',\r\n    leftLowerArm = 'leftLowerArm',\r\n    leftHand = 'leftHand',\r\n    leftThigh = 'leftThigh',\r\n    leftCalf = 'leftCalf',\r\n    leftFoot = 'leftFoot',\r\n    rightUpperArm = 'rightUpperArm',\r\n    rightLowerArm = 'rightLowerArm',\r\n    rightHand = 'rightHand',\r\n    rightThigh = 'rightThigh',\r\n    rightCalf = 'rightCalf',\r\n    rightFoot = 'rightFoot',\r\n}","import Geometry from '../../utils/render/Geometry';\r\n\r\nexport default class ObjLoader {\r\n\r\n    private vertexArr: [number, number, number][] = [];\r\n    private normalArr: [number, number, number][] = [];\r\n    private indexArr: [number, number][][] = [];\r\n\r\n    private _lowerX: number = 0;\r\n    private _lowerY: number = 0;\r\n    private _lowerZ: number = 0;\r\n    private _upperX: number = 0;\r\n    private _upperY: number = 0;\r\n    private _upperZ: number = 0;\r\n    private _xRange: number = 0;\r\n    private _yRange: number = 0;\r\n    private _zRange: number = 0;\r\n\r\n    load(src: string) {\r\n        const vertexArr = this.vertexArr;\r\n        const normalArr = this.normalArr;\r\n        const indexArr = this.indexArr;\r\n        const lines = src.split('\\n');\r\n        let lowerX: number = Infinity;\r\n        let lowerY: number = Infinity;\r\n        let lowerZ: number = Infinity;\r\n        let upperX: number = -Infinity;\r\n        let upperY: number = -Infinity;\r\n        let upperZ: number = -Infinity;\r\n        for (let i = 0, len = lines.length; i < len; ++i) {\r\n            const line = lines[i].trim();\r\n            if (!line) {\r\n                continue;\r\n            }\r\n            const parts = line.split(' ');\r\n            switch (parts[0]) {\r\n                case 'v': {\r\n                    const x = Number(parts[1]) || 0;\r\n                    const y = Number(parts[2]) || 0;\r\n                    const z = Number(parts[3]) || 0;\r\n                    vertexArr.push([x, y, z]);\r\n                    lowerX = Math.min(lowerX, x);\r\n                    lowerY = Math.min(lowerY, y);\r\n                    lowerZ = Math.min(lowerZ, z);\r\n                    upperX = Math.max(upperX, x);\r\n                    upperY = Math.max(upperY, y);\r\n                    upperZ = Math.max(upperZ, z);\r\n                }\r\n                    break;\r\n                case 'vn': {\r\n                    const x = Number(parts[1]) || 0;\r\n                    const y = Number(parts[2]) || 0;\r\n                    const z = Number(parts[3]) || 0;\r\n                    normalArr.push([x, y, z]);\r\n                }\r\n                    break;\r\n                case 'f': {\r\n                    const face: [number, number][] = [];\r\n                    for (let j = 1, len = parts.length; j < len; ++j) {\r\n                        const vertexIndices = parts[j].split('/');\r\n                        face.push([\r\n                            Number(vertexIndices[0]) - 1,\r\n                            vertexIndices[2] ? Number(vertexIndices[2]) - 1 : -1\r\n                        ]);\r\n                    }\r\n                    indexArr.push(face);\r\n                }\r\n                    break;\r\n            }\r\n        }\r\n        this._lowerX = lowerX;\r\n        this._lowerY = lowerY;\r\n        this._lowerZ = lowerZ;\r\n        this._upperX = upperX;\r\n        this._upperY = upperY;\r\n        this._upperZ = upperZ;\r\n        this._xRange = upperX - lowerX;\r\n        this._yRange = upperY - lowerY;\r\n        this._zRange = upperZ - lowerZ;\r\n        return this;\r\n    }\r\n\r\n    translate(dx: number, dy: number, dz: number) {\r\n        const vertexArr = this.vertexArr;\r\n        for (let i = 0, len = vertexArr.length; i < len; ++i) {\r\n            const vertex = vertexArr[i];\r\n            vertex[0] += dx;\r\n            vertex[1] += dy;\r\n            vertex[2] += dz;\r\n        }\r\n        this._lowerX += dx;\r\n        this._upperX += dx;\r\n        this._lowerY += dy;\r\n        this._upperY += dy;\r\n        this._lowerZ += dz;\r\n        this._upperZ += dz;\r\n        return this;\r\n    }\r\n\r\n    setGeometryVertices(geometry: Geometry, color: number[] = [1, 1, 1, 1]) {\r\n        const vertices: { 'a_color': number[], 'a_position': number[], 'a_normal': number[] }[] = [];\r\n        const indices: number[] = [];\r\n\r\n        const vertexArr = this.vertexArr;\r\n        const normalArr = this.normalArr;\r\n        const indexArr = this.indexArr;\r\n        for (let i = 0, len = indexArr.length; i < len; ++i) {\r\n            const face = indexArr[i];\r\n            if (face.length !== 3 && face.length !== 4) {\r\n                throw new Error('Illegal face vertices num');\r\n            }\r\n            const index0 = vertices.length;\r\n            let needsCalculateNormal = false;\r\n            for (let j = 0, len = face.length; j < len; ++j) {\r\n                const vertexIndices = face[j];\r\n                const positionIndex = vertexIndices[0];\r\n                const normalIndex = vertexIndices[1];\r\n                const position = vertexArr[positionIndex];\r\n                if (normalIndex < 0) {\r\n                    needsCalculateNormal = true;\r\n                }\r\n                const normal = normalIndex < 0 ? [0, 0, 0] : normalArr[normalIndex];\r\n                vertices.push({'a_color': color, 'a_position': position, 'a_normal': normal});\r\n            }\r\n            if (needsCalculateNormal) {\r\n                // todo\r\n            }\r\n            if (face.length === 3) {\r\n                indices.push(index0, index0 + 1, index0 + 2);\r\n            } else {\r\n                indices.push(\r\n                    index0, index0 + 1, index0 + 2,\r\n                    index0, index0 + 2, index0 + 3,\r\n                );\r\n            }\r\n        }\r\n\r\n        geometry.setVertices(vertices);\r\n        geometry.indices = indices;\r\n    }\r\n\r\n    get lowerX(): number {\r\n        return this._lowerX;\r\n    }\r\n\r\n    get lowerY(): number {\r\n        return this._lowerY;\r\n    }\r\n\r\n    get lowerZ(): number {\r\n        return this._lowerZ;\r\n    }\r\n\r\n    get upperX(): number {\r\n        return this._upperX;\r\n    }\r\n\r\n    get upperY(): number {\r\n        return this._upperY;\r\n    }\r\n\r\n    get upperZ(): number {\r\n        return this._upperZ;\r\n    }\r\n\r\n    get xRange(): number {\r\n        return this._xRange;\r\n    }\r\n\r\n    get yRange(): number {\r\n        return this._yRange;\r\n    }\r\n\r\n    get zRange(): number {\r\n        return this._zRange;\r\n    }\r\n}","class Attribute {\r\n    name: string;\r\n    componentSize: number;\r\n    vertices: Float32Array;\r\n    vbo?: WebGLBuffer;\r\n\r\n    constructor(name: string, componentSize: number, vertices: Float32Array) {\r\n        this.name = name;\r\n        this.componentSize = componentSize;\r\n        this.vertices = vertices;\r\n    }\r\n}\r\n\r\nenum PrimitiveType {\r\n    TRIANGLES, LINES\r\n}\r\n\r\nexport default class Geometry {\r\n\r\n    static readonly TYPE_TRIANGLES = PrimitiveType.TRIANGLES;\r\n    static readonly TYPE_LINES = PrimitiveType.LINES;\r\n\r\n    type: PrimitiveType = PrimitiveType.TRIANGLES;\r\n    attributes: Attribute[] = [];\r\n    indices: number[] = [];\r\n    ibo?: WebGLBuffer;\r\n    vao?: WebGLVertexArrayObject;\r\n\r\n    constructor(type: PrimitiveType = PrimitiveType.TRIANGLES) {\r\n        this.type = type;\r\n    }\r\n\r\n    setVertices(vertices: { [name: string]: number[] }[]) {\r\n        const len = vertices.length;\r\n        const attributes: { [name: string]: Attribute } = {};\r\n        for (let attrName in vertices[0]) {\r\n            if (vertices[0].hasOwnProperty(attrName)) {\r\n                const size = vertices[0][attrName].length;\r\n                attributes[attrName] = new Attribute(\r\n                    attrName,\r\n                    size,\r\n                    new Float32Array(size * len)\r\n                );\r\n            }\r\n        }\r\n        for (let i = 0; i < len; ++i) {\r\n            const vertex = vertices[i];\r\n            for (let attrName in vertex) {\r\n                if (vertex.hasOwnProperty(attrName)) {\r\n                    const pointArr = vertex[attrName];\r\n                    attributes[attrName].vertices.set(pointArr, pointArr.length * i);\r\n                }\r\n            }\r\n        }\r\n        this.attributes = Object.values(attributes);\r\n    }\r\n\r\n}\r\n","import {mat4, quat, vec3} from 'gl-matrix';\r\nimport Geometry from '../../../utils/render/Geometry';\r\nimport Renderer from '../../../utils/render/Renderer';\r\n\r\nconst ACTIVE_COLOR = [1, 1, 1, 1];\r\nconst INACTIVE_COLOR = [1, 1, 1, 0.1];\r\n\r\nexport default class SkeletonModelNode {\r\n\r\n    translation: [number, number, number] = [0, 0, 0];\r\n    forward: [number, number, number] = [0, 0, 1];\r\n    up: [number, number, number] = [0, 1, 0];\r\n    controlPoint?: [number, number, number];\r\n    landmarks: [number, number, number][] = [];\r\n\r\n    parent?: SkeletonModelNode;\r\n    children: SkeletonModelNode[] = [];\r\n\r\n    active: boolean = true;\r\n\r\n    localRotation = quat.create();\r\n    localMatrix = mat4.create();\r\n    worldMatrix = mat4.create();\r\n\r\n    originWorldPosition = vec3.create();\r\n    originViewPosition = vec3.create();\r\n    controlPointWorldPosition = vec3.create();\r\n    controlPointViewPosition = vec3.create();\r\n    controlPointScreenPosition = vec3.create();\r\n    landmarksWorldPositions: [number, number, number][] = [];\r\n    landmarksViewPosition: [number, number, number][] = [];\r\n\r\n    geometry = new Geometry();\r\n\r\n    render(renderer: Renderer) {\r\n        renderer.uniform('u_mMatrix', this.worldMatrix);\r\n        renderer.uniform('u_color', this.active ? ACTIVE_COLOR : INACTIVE_COLOR);\r\n        renderer.drawGeometry(this.geometry);\r\n    }\r\n\r\n    dispose(renderer: Renderer) {\r\n        renderer.drawGeometry(this.geometry);\r\n    }\r\n\r\n}","import {mat4, ReadonlyVec3, vec3} from 'gl-matrix';\r\nimport {quatLookRotation} from '../../../utils/math/math';\r\nimport Camera3D from '../../../utils/render/camera/Camera3D';\r\nimport Renderer from '../../../utils/render/Renderer';\r\nimport ObjLoader from '../ObjLoader';\r\nimport {BodyPart} from './BodyPart';\r\nimport SkeletonModelNode from './SkeletonModelNode';\r\n\r\nconst ZERO: ReadonlyVec3 = [0, 0, 0];\r\n\r\nexport default class SkeletonModel {\r\n\r\n    root = new SkeletonModelNode();\r\n\r\n    [BodyPart.trunk] = this.root;\r\n    [BodyPart.head] = new SkeletonModelNode();\r\n    [BodyPart.leftUpperArm] = new SkeletonModelNode();\r\n    [BodyPart.leftLowerArm] = new SkeletonModelNode();\r\n    [BodyPart.leftHand] = new SkeletonModelNode();\r\n    [BodyPart.leftThigh] = new SkeletonModelNode();\r\n    [BodyPart.leftCalf] = new SkeletonModelNode();\r\n    [BodyPart.leftFoot] = new SkeletonModelNode();\r\n    [BodyPart.rightUpperArm] = new SkeletonModelNode();\r\n    [BodyPart.rightLowerArm] = new SkeletonModelNode();\r\n    [BodyPart.rightHand] = new SkeletonModelNode();\r\n    [BodyPart.rightThigh] = new SkeletonModelNode();\r\n    [BodyPart.rightCalf] = new SkeletonModelNode();\r\n    [BodyPart.rightFoot] = new SkeletonModelNode();\r\n\r\n    update(camera: Camera3D, node: SkeletonModelNode = this.root) {\r\n        const stack: SkeletonModelNode[] = [node];\r\n        for (; ;) {\r\n            const node = stack.pop();\r\n            if (!node) {\r\n                break;\r\n            }\r\n            stack.push(...node.children);\r\n\r\n            quatLookRotation(node.localRotation, node.forward, node.up);\r\n            mat4.fromRotationTranslation(node.localMatrix, node.localRotation, node.translation);\r\n            if (node.parent) {\r\n                mat4.mul(node.worldMatrix, node.parent.worldMatrix, node.localMatrix);\r\n            } else {\r\n                mat4.copy(node.worldMatrix, node.localMatrix);\r\n            }\r\n\r\n            vec3.transformMat4(node.originWorldPosition, ZERO, node.worldMatrix);\r\n            vec3.transformMat4(node.originViewPosition, node.originWorldPosition, camera.viewMatrix);\r\n            if (node.controlPoint) {\r\n                vec3.transformMat4(node.controlPointWorldPosition, node.controlPoint, node.worldMatrix);\r\n                vec3.transformMat4(node.controlPointViewPosition, node.controlPointWorldPosition, camera.viewMatrix);\r\n                vec3.transformMat4(node.controlPointScreenPosition, node.controlPointWorldPosition, camera.pvMatrix);\r\n            }\r\n\r\n            if (node.landmarks.length !== node.landmarksWorldPositions.length) {\r\n                node.landmarksWorldPositions = node.landmarks.map(_ => [0, 0, 0]);\r\n                node.landmarksViewPosition = node.landmarks.map(_ => [0, 0, 0]);\r\n            }\r\n            for (let i = 0, len = node.landmarks.length; i < len; ++i) {\r\n                vec3.transformMat4(node.landmarksWorldPositions[i], node.landmarks[i], node.worldMatrix);\r\n                vec3.transformMat4(node.landmarksViewPosition[i], node.landmarksWorldPositions[i], camera.viewMatrix);\r\n            }\r\n        }\r\n    }\r\n\r\n    render(renderer: Renderer) {\r\n        const stack: SkeletonModelNode[] = [this.root];\r\n        for (; ;) {\r\n            const node = stack.pop();\r\n            if (!node) {\r\n                break;\r\n            }\r\n            stack.push(...node.children);\r\n            node.render(renderer);\r\n        }\r\n    }\r\n\r\n    async init() {\r\n        // =============== load objs ===============\r\n        const headObjPromise = import('./obj/head.obj');\r\n        const trunkObjPromise = import('./obj/trunk.obj');\r\n        const leftUpperArmObjPromise = import('./obj/left-upper-arm.obj');\r\n        const leftLowerArmObjPromise = import('./obj/left-lower-arm.obj');\r\n        const leftHandObjPromise = import('./obj/left-hand.obj');\r\n        const rightUpperArmObjPromise = import('./obj/right-upper-arm.obj');\r\n        const rightLowerArmObjPromise = import('./obj/right-lower-arm.obj');\r\n        const rightHandObjPromise = import('./obj/right-hand.obj');\r\n        const leftThighObjPromise = import('./obj/left-thigh.obj');\r\n        const leftCalfObjPromise = import('./obj/left-calf.obj');\r\n        const leftFootObjPromise = import('./obj/left-foot.obj');\r\n        const rightThighObjPromise = import('./obj/right-thigh.obj');\r\n        const rightCalfObjPromise = import('./obj/right-calf.obj');\r\n        const rightFootObjPromise = import('./obj/right-foot.obj');\r\n\r\n        await Promise.all([\r\n            headObjPromise,\r\n            trunkObjPromise,\r\n            leftUpperArmObjPromise,\r\n            leftLowerArmObjPromise,\r\n            leftHandObjPromise,\r\n            rightUpperArmObjPromise,\r\n            rightLowerArmObjPromise,\r\n            rightHandObjPromise,\r\n            leftThighObjPromise,\r\n            leftCalfObjPromise,\r\n            leftFootObjPromise,\r\n            rightThighObjPromise,\r\n            rightCalfObjPromise,\r\n            rightFootObjPromise,\r\n        ]);\r\n\r\n        const headVertices = new ObjLoader().load((await headObjPromise).default);\r\n        const trunkVertices = new ObjLoader().load((await trunkObjPromise).default);\r\n        const leftUpperArmVertices = new ObjLoader().load((await leftUpperArmObjPromise).default);\r\n        const leftLowerArmVertices = new ObjLoader().load((await leftLowerArmObjPromise).default);\r\n        const leftHandVertices = new ObjLoader().load((await leftHandObjPromise).default);\r\n        const rightUpperArmVertices = new ObjLoader().load((await rightUpperArmObjPromise).default);\r\n        const rightLowerArmVertices = new ObjLoader().load((await rightLowerArmObjPromise).default);\r\n        const rightHandVertices = new ObjLoader().load((await rightHandObjPromise).default);\r\n        const leftThighVertices = new ObjLoader().load((await leftThighObjPromise).default);\r\n        const leftCalfVertices = new ObjLoader().load((await leftCalfObjPromise).default);\r\n        const leftFootVertices = new ObjLoader().load((await leftFootObjPromise).default);\r\n        const rightThighVertices = new ObjLoader().load((await rightThighObjPromise).default);\r\n        const rightCalfVertices = new ObjLoader().load((await rightCalfObjPromise).default);\r\n        const rightFootVertices = new ObjLoader().load((await rightFootObjPromise).default);\r\n\r\n        // =============== move rotation origins to joint connection points ===============\r\n        const headOffset: [number, number, number] = [\r\n            0,\r\n            headVertices.lowerY + headVertices.yRange * 0.35,\r\n            headVertices.zRange * -0.1,\r\n        ];\r\n        const leftUpperArmOffset: [number, number, number] = [\r\n            leftUpperArmVertices.lowerX + leftUpperArmVertices.xRange * 0.3,\r\n            leftUpperArmVertices.lowerY + leftUpperArmVertices.yRange * (1 - 0.075),\r\n            leftUpperArmVertices.zRange * -0.1,\r\n        ];\r\n        const leftLowerArmOffset: [number, number, number] = [\r\n            leftLowerArmVertices.lowerX - leftUpperArmOffset[0] + leftLowerArmVertices.xRange * 0.5,\r\n            leftLowerArmVertices.lowerY - leftUpperArmOffset[1] + leftLowerArmVertices.yRange * (1 - 0.05),\r\n            leftLowerArmVertices.lowerZ - leftUpperArmOffset[2] + leftLowerArmVertices.zRange * 0.3,\r\n        ];\r\n        const leftHandOffset: [number, number, number] = [\r\n            leftHandVertices.lowerX - leftLowerArmOffset[0] - leftUpperArmOffset[0] + leftHandVertices.xRange * 0.85,\r\n            leftHandVertices.lowerY - leftLowerArmOffset[1] - leftUpperArmOffset[1] + leftHandVertices.yRange * (1 - 0.05),\r\n            leftHandVertices.lowerZ - leftLowerArmOffset[2] - leftUpperArmOffset[2] + leftHandVertices.zRange * 0.65,\r\n        ];\r\n        const leftThighOffset: [number, number, number] = [\r\n            leftThighVertices.lowerX + leftThighVertices.xRange * 0.5,\r\n            leftThighVertices.lowerY + leftThighVertices.yRange * (1 - 0.05),\r\n            leftThighVertices.zRange * 0.05,\r\n        ];\r\n        const leftCalfOffset: [number, number, number] = [\r\n            leftCalfVertices.lowerX - leftThighOffset[0] + leftCalfVertices.xRange * 0.5,\r\n            leftCalfVertices.lowerY - leftThighOffset[1] + leftCalfVertices.yRange * (1 - 0.05),\r\n            leftCalfVertices.lowerZ - leftThighOffset[2] + leftCalfVertices.zRange * 0.65,\r\n        ];\r\n        const leftFootOffset: [number, number, number] = [\r\n            leftFootVertices.lowerX - leftThighOffset[0] - leftCalfOffset[0] + leftFootVertices.xRange * 0.3,\r\n            leftFootVertices.lowerY - leftThighOffset[1] - leftCalfOffset[1] + leftFootVertices.yRange * (1 - 0.25),\r\n            leftFootVertices.lowerZ - leftThighOffset[2] - leftCalfOffset[2] + leftFootVertices.zRange * 0.25,\r\n        ];\r\n\r\n        // =============== control points positions ===============\r\n        const trunkControlPoint: [number, number, number] = [0, trunkVertices.yRange * 0.75, 0];\r\n        const headControlPoint: [number, number, number] = [0, 0, headVertices.yRange * 0.5];\r\n        const leftUpperArmControlPoint: [number, number, number] = [\r\n            leftUpperArmVertices.xRange * 0.3,\r\n            leftUpperArmVertices.yRange * -0.85,\r\n            leftUpperArmVertices.zRange * -0.3,\r\n        ];\r\n        const leftLowerArmControlPoint: [number, number, number] = [\r\n            0,\r\n            leftLowerArmVertices.yRange * -0.9,\r\n            leftLowerArmVertices.zRange * 0.4,\r\n        ];\r\n        const leftHandControlPoint: [number, number, number] = [\r\n            leftHandVertices.xRange * -0.2,\r\n            leftHandVertices.yRange * -0.8,\r\n            leftHandVertices.zRange * -0.1,\r\n        ];\r\n        const leftThighControlPoint: [number, number, number] = [\r\n            leftThighVertices.xRange * -0.15,\r\n            leftThighVertices.yRange * -0.87,\r\n            leftThighVertices.zRange * -0.25,\r\n        ];\r\n        const leftCalfControlPoint: [number, number, number] = [\r\n            0,\r\n            leftCalfVertices.yRange * -0.85,\r\n            leftCalfVertices.zRange * -0.3,\r\n        ];\r\n        const leftFootControlPoint: [number, number, number] = [\r\n            leftFootVertices.xRange * 0.25,\r\n            leftFootVertices.yRange * -0.5,\r\n            leftFootVertices.zRange * 0.6,\r\n        ];\r\n\r\n        // =============== create nodes ===============\r\n        function mirror(vec: [number, number, number]): [number, number, number] {\r\n            return [-vec[0], vec[1], vec[2]];\r\n        }\r\n\r\n        const trunk = this.root;\r\n        trunkVertices.setGeometryVertices(trunk.geometry);\r\n        trunk.controlPoint = trunkControlPoint;\r\n\r\n        const head = this.addChild(this.root, this.head);\r\n        head.landmarks = [\r\n            // left ear\r\n            [-headVertices.lowerX, headVertices.yRange * .05, headVertices.zRange * .15],\r\n            // right ear\r\n            [-headVertices.upperX, headVertices.yRange * .05, headVertices.zRange * .15],\r\n        ];\r\n        headVertices.translate(-headOffset[0], -headOffset[1], -headOffset[2]);\r\n        headVertices.setGeometryVertices(head.geometry);\r\n        head.translation = headOffset;\r\n        head.controlPoint = headControlPoint;\r\n\r\n        const leftUpperArm = this.addChild(this.root, this.leftUpperArm);\r\n        leftUpperArmVertices.translate(-leftUpperArmOffset[0], -leftUpperArmOffset[1], -leftUpperArmOffset[2]);\r\n        leftUpperArmVertices.setGeometryVertices(leftUpperArm.geometry);\r\n        leftUpperArm.translation = leftUpperArmOffset;\r\n        leftUpperArm.controlPoint = leftUpperArmControlPoint;\r\n\r\n        const rightUpperArm = this.addChild(this.root, this.rightUpperArm);\r\n        rightUpperArmVertices.translate(+leftUpperArmOffset[0], -leftUpperArmOffset[1], -leftUpperArmOffset[2]);\r\n        rightUpperArmVertices.setGeometryVertices(rightUpperArm.geometry);\r\n        rightUpperArm.translation = mirror(leftUpperArmOffset);\r\n        rightUpperArm.controlPoint = mirror(leftUpperArmControlPoint);\r\n\r\n        const leftLowerArm = this.addChild(leftUpperArm, this.leftLowerArm);\r\n        leftLowerArmVertices.translate(\r\n            -leftLowerArmOffset[0] - leftUpperArmOffset[0],\r\n            -leftLowerArmOffset[1] - leftUpperArmOffset[1],\r\n            -leftLowerArmOffset[2] - leftUpperArmOffset[2],\r\n        );\r\n        leftLowerArmVertices.setGeometryVertices(leftLowerArm.geometry);\r\n        leftLowerArm.translation = leftLowerArmOffset;\r\n        leftLowerArm.controlPoint = leftLowerArmControlPoint;\r\n\r\n        const rightLowerArm = this.addChild(rightUpperArm, this.rightLowerArm);\r\n        rightLowerArmVertices.translate(\r\n            +leftLowerArmOffset[0] + leftUpperArmOffset[0],\r\n            -leftLowerArmOffset[1] - leftUpperArmOffset[1],\r\n            -leftLowerArmOffset[2] - leftUpperArmOffset[2],\r\n        );\r\n        rightLowerArmVertices.setGeometryVertices(rightLowerArm.geometry);\r\n        rightLowerArm.translation = mirror(leftLowerArmOffset);\r\n        rightLowerArm.controlPoint = mirror(leftLowerArmControlPoint);\r\n\r\n        const leftHand = this.addChild(leftLowerArm, this.leftHand);\r\n        leftHandVertices.translate(\r\n            -leftHandOffset[0] - leftLowerArmOffset[0] - leftUpperArmOffset[0],\r\n            -leftHandOffset[1] - leftLowerArmOffset[1] - leftUpperArmOffset[1],\r\n            -leftHandOffset[2] - leftLowerArmOffset[2] - leftUpperArmOffset[2],\r\n        );\r\n        leftHandVertices.setGeometryVertices(leftHand.geometry);\r\n        leftHand.translation = leftHandOffset;\r\n        leftHand.controlPoint = leftHandControlPoint;\r\n\r\n        const rightHand = this.addChild(rightLowerArm, this.rightHand);\r\n        rightHandVertices.translate(\r\n            +leftHandOffset[0] + leftLowerArmOffset[0] + leftUpperArmOffset[0],\r\n            -leftHandOffset[1] - leftLowerArmOffset[1] - leftUpperArmOffset[1],\r\n            -leftHandOffset[2] - leftLowerArmOffset[2] - leftUpperArmOffset[2],\r\n        );\r\n        rightHandVertices.setGeometryVertices(rightHand.geometry);\r\n        rightHand.translation = mirror(leftHandOffset);\r\n        rightHand.controlPoint = mirror(leftHandControlPoint);\r\n\r\n        const leftThigh = this.addChild(trunk, this.leftThigh);\r\n        leftThighVertices.translate(\r\n            -leftThighOffset[0],\r\n            -leftThighOffset[1],\r\n            -leftThighOffset[2],\r\n        );\r\n        leftThighVertices.setGeometryVertices(leftThigh.geometry);\r\n        leftThigh.translation = leftThighOffset;\r\n        leftThigh.controlPoint = leftThighControlPoint;\r\n\r\n        const rightThigh = this.addChild(trunk, this.rightThigh);\r\n        rightThighVertices.translate(\r\n            +leftThighOffset[0],\r\n            -leftThighOffset[1],\r\n            -leftThighOffset[2],\r\n        );\r\n        rightThighVertices.setGeometryVertices(rightThigh.geometry);\r\n        rightThigh.translation = mirror(leftThighOffset);\r\n        rightThigh.controlPoint = mirror(leftThighControlPoint);\r\n\r\n        const leftCalf = this.addChild(leftThigh, this.leftCalf);\r\n        leftCalfVertices.translate(\r\n            -leftCalfOffset[0] - leftThighOffset[0],\r\n            -leftCalfOffset[1] - leftThighOffset[1],\r\n            -leftCalfOffset[2] - leftThighOffset[2],\r\n        );\r\n        leftCalfVertices.setGeometryVertices(leftCalf.geometry);\r\n        leftCalf.translation = leftCalfOffset;\r\n        leftCalf.controlPoint = leftCalfControlPoint;\r\n\r\n        const rightCalf = this.addChild(rightThigh, this.rightCalf);\r\n        rightCalfVertices.translate(\r\n            +leftCalfOffset[0] + leftThighOffset[0],\r\n            -leftCalfOffset[1] - leftThighOffset[1],\r\n            -leftCalfOffset[2] - leftThighOffset[2],\r\n        );\r\n        rightCalfVertices.setGeometryVertices(rightCalf.geometry);\r\n        rightCalf.translation = mirror(leftCalfOffset);\r\n        rightCalf.controlPoint = mirror(leftCalfControlPoint);\r\n\r\n        const leftFoot = this.addChild(leftCalf, this.leftFoot);\r\n        leftFootVertices.translate(\r\n            -leftFootOffset[0] - leftCalfOffset[0] - leftThighOffset[0],\r\n            -leftFootOffset[1] - leftCalfOffset[1] - leftThighOffset[1],\r\n            -leftFootOffset[2] - leftCalfOffset[2] - leftThighOffset[2],\r\n        );\r\n        leftFootVertices.setGeometryVertices(leftFoot.geometry);\r\n        leftFoot.translation = leftFootOffset;\r\n        leftFoot.controlPoint = leftFootControlPoint;\r\n\r\n        const rightFoot = this.addChild(rightCalf, this.rightFoot);\r\n        rightFootVertices.translate(\r\n            +leftFootOffset[0] + leftCalfOffset[0] + leftThighOffset[0],\r\n            -leftFootOffset[1] - leftCalfOffset[1] - leftThighOffset[1],\r\n            -leftFootOffset[2] - leftCalfOffset[2] - leftThighOffset[2],\r\n        );\r\n        rightFootVertices.setGeometryVertices(rightFoot.geometry);\r\n        rightFoot.translation = mirror(leftFootOffset);\r\n        rightFoot.controlPoint = mirror(leftFootControlPoint);\r\n    }\r\n\r\n    private addChild(parent: SkeletonModelNode, node?: SkeletonModelNode) {\r\n        node = node || new SkeletonModelNode();\r\n        parent.children.push(node);\r\n        node.parent = parent;\r\n        return node;\r\n    }\r\n\r\n}","import {vec3} from 'gl-matrix';\r\n\r\nexport function raycastPlane(\r\n    out: vec3,\r\n    ray0x: number,\r\n    ray0y: number,\r\n    ray0z: number,\r\n    ray1x: number,\r\n    ray1y: number,\r\n    ray1z: number,\r\n    p0x: number,\r\n    p0y: number,\r\n    p0z: number,\r\n    nx: number,\r\n    ny: number,\r\n    nz: number,\r\n) {\r\n    const detX = ray1x - ray0x;\r\n    const detY = ray1y - ray0y;\r\n    const detZ = ray1z - ray0z;\r\n    const len = Math.sqrt(detX ** 2 + detY ** 2 + detZ ** 2);\r\n    if (len <= 1e-8) {\r\n        return false;\r\n    }\r\n    const lx = detX / len;\r\n    const ly = detY / len;\r\n    const lz = detZ / len;\r\n    const nLen = Math.sqrt(nx ** 2 + ny ** 2 + nz ** 2);\r\n    if (nLen <= 1e-8) {\r\n        return false;\r\n    }\r\n    const invNLen = 1 / nLen;\r\n    nx *= invNLen;\r\n    ny *= invNLen;\r\n    nz *= invNLen;\r\n    const ln = lx * nx + ly * ny + lz * nz;\r\n    if (Math.abs(ln) <= 1e-8) {\r\n        return false;\r\n    }\r\n    const p0r0x = -ray0x + p0x;\r\n    const p0r0y = -ray0y + p0y;\r\n    const p0r0z = -ray0z + p0z;\r\n    const t = (p0r0x * nx + p0r0y * ny + p0r0z * nz) / ln;\r\n    const px = ray0x + t * lx;\r\n    const py = ray0y + t * ly;\r\n    const pz = ray0z + t * lz;\r\n    vec3.set(out, px, py, pz);\r\n    return t >= 0;\r\n}\r\n\r\nexport function raycastSphere(\r\n    out: vec3,\r\n    ray0x: number,\r\n    ray0y: number,\r\n    ray0z: number,\r\n    ray1x: number,\r\n    ray1y: number,\r\n    ray1z: number,\r\n    cx: number,\r\n    cy: number,\r\n    cz: number,\r\n    r: number\r\n) {\r\n    let vx = ray1x - ray0x;\r\n    let vy = ray1y - ray0y;\r\n    let vz = ray1z - ray0z;\r\n    const dx = ray0x - cx;\r\n    const dy = ray0y - cy;\r\n    const dz = ray0z - cz;\r\n    const a = vx ** 2 + vy ** 2 + vz ** 2;\r\n    const b = 2 * (vx * dx + vy * dy + vz * dz);\r\n    const c = (dx ** 2 + dy ** 2 + dz ** 2) - r ** 2;\r\n    const delta = b ** 2 - 4 * a * c;\r\n    if (delta < 0) {\r\n        return false;\r\n    }\r\n    const sqrtDelta = Math.sqrt(delta);\r\n    const t1 = (-b + sqrtDelta) / (2 * a);\r\n    const t2 = (-b - sqrtDelta) / (2 * a);\r\n    const t = Math.min(t1, t2);\r\n    out[0] = ray0x + vx * t;\r\n    out[1] = ray0y + vy * t;\r\n    out[2] = ray0z + vz * t;\r\n    return true;\r\n}\r\n","import {vec3} from 'gl-matrix';\r\nimport {raycastPlane, raycastSphere} from '../math/raycast';\r\nimport Camera3D from '../render/camera/Camera3D';\r\n\r\nexport class MouseDragContext3D {\r\n    dragStartMousePosition = vec3.create();\r\n    dragStartOriginPosition = vec3.create();\r\n    dragStartTargetPosition = vec3.create();\r\n    mousePosition = vec3.create();\r\n    mouseRay0 = vec3.create();\r\n    mouseRay1 = vec3.create();\r\n    rayResult0 = vec3.create();\r\n    rayResult1 = vec3.create();\r\n    normal = vec3.create();\r\n    radius = 0;\r\n    offset = vec3.create();\r\n}\r\n\r\nexport function raycastViewPlaneDragStart(\r\n    context: MouseDragContext3D,\r\n    projectedMouseX: number, projectedMouseY: number,\r\n    targetX: number, targetY: number, targetZ: number,\r\n    camera: Camera3D\r\n) {\r\n    vec3.set(context.dragStartMousePosition, projectedMouseX, projectedMouseY, 0);\r\n    vec3.set(context.dragStartTargetPosition, targetX, targetY, targetZ);\r\n    vec3.sub(context.normal, camera.target, camera.position);\r\n}\r\n\r\nexport function raycastViewPlaneDragMove(\r\n    context: MouseDragContext3D,\r\n    projectedMouseX: number, projectedMouseY: number,\r\n    camera: Camera3D\r\n): boolean {\r\n    context.dragStartMousePosition[2] = -1;\r\n    camera.screenToView(context.mouseRay0, context.dragStartMousePosition);\r\n    context.dragStartMousePosition[2] = 1;\r\n    camera.screenToView(context.mouseRay1, context.dragStartMousePosition);\r\n    if (!raycastPlane(\r\n        context.rayResult0,\r\n        context.mouseRay0[0], context.mouseRay0[1], context.mouseRay0[2],\r\n        context.mouseRay1[0], context.mouseRay1[1], context.mouseRay1[2],\r\n        context.dragStartTargetPosition[0], context.dragStartTargetPosition[1], context.dragStartTargetPosition[2],\r\n        context.normal[0], context.normal[1], context.normal[2],\r\n    )) {\r\n        return false;\r\n    }\r\n    vec3.set(context.mousePosition, projectedMouseX, projectedMouseY, -1);\r\n    camera.screenToView(context.mouseRay0, context.mousePosition);\r\n    vec3.set(context.mousePosition, projectedMouseX, projectedMouseY, +1);\r\n    camera.screenToView(context.mouseRay1, context.mousePosition);\r\n    if (!raycastPlane(\r\n        context.rayResult1,\r\n        context.mouseRay0[0], context.mouseRay0[1], context.mouseRay0[2],\r\n        context.mouseRay1[0], context.mouseRay1[1], context.mouseRay1[2],\r\n        context.dragStartTargetPosition[0], context.dragStartTargetPosition[1], context.dragStartTargetPosition[2],\r\n        context.normal[0], context.normal[1], context.normal[2],\r\n    )) {\r\n        return false;\r\n    }\r\n    vec3.sub(context.offset, context.rayResult1, context.rayResult0);\r\n    return true;\r\n}\r\n\r\nexport function raycastSphereDragStart(\r\n    context: MouseDragContext3D,\r\n    projectedMouseX: number, projectedMouseY: number,\r\n    originX: number, originY: number, originZ: number,\r\n    targetX: number, targetY: number, targetZ: number,\r\n    camera: Camera3D\r\n) {\r\n    vec3.set(context.dragStartMousePosition, projectedMouseX, projectedMouseY, 0);\r\n    vec3.set(context.dragStartOriginPosition, originX, originY, originZ);\r\n    vec3.set(context.dragStartTargetPosition, targetX, targetY, targetZ);\r\n    vec3.sub(context.normal, context.dragStartTargetPosition, camera.position);\r\n    context.radius = vec3.distance(context.dragStartOriginPosition, context.dragStartTargetPosition);\r\n}\r\n\r\nexport function raycastSphereDragMove(\r\n    context: MouseDragContext3D,\r\n    projectedMouseX: number, projectedMouseY: number,\r\n    camera: Camera3D\r\n): boolean {\r\n    const zOrigin = vec3.dot(context.normal, context.dragStartOriginPosition);\r\n    const zTarget = vec3.dot(context.normal, context.dragStartTargetPosition);\r\n    if (zTarget - zOrigin <= 0) {\r\n        vec3.set(context.mousePosition, projectedMouseX, projectedMouseY, -1);\r\n        camera.screenToView(context.mouseRay0, context.mousePosition);\r\n        vec3.set(context.mousePosition, projectedMouseX, projectedMouseY, +1);\r\n        camera.screenToView(context.mouseRay1, context.mousePosition);\r\n        if (raycastSphere(\r\n            context.rayResult1,\r\n            context.mouseRay0[0], context.mouseRay0[1], context.mouseRay0[2],\r\n            context.mouseRay1[0], context.mouseRay1[1], context.mouseRay1[2],\r\n            context.dragStartOriginPosition[0], context.dragStartOriginPosition[1], context.dragStartOriginPosition[2],\r\n            context.radius,\r\n        )) {\r\n            return true;\r\n        }\r\n        return raycastPlane(\r\n            context.rayResult1,\r\n            context.mouseRay0[0], context.mouseRay0[1], context.mouseRay0[2],\r\n            context.mouseRay1[0], context.mouseRay1[1], context.mouseRay1[2],\r\n            context.dragStartOriginPosition[0], context.dragStartOriginPosition[1], context.dragStartOriginPosition[2],\r\n            context.normal[0], context.normal[1], context.normal[2],\r\n        );\r\n    }\r\n    return raycastViewPlaneDragMove(context, projectedMouseX, projectedMouseY, camera);\r\n}","import {mat4, ReadonlyMat4, ReadonlyVec3, vec3} from 'gl-matrix';\r\nimport Camera3D from './Camera3D';\r\n\r\nexport default class OrthographicCamera implements Camera3D {\r\n\r\n    readonly perspective = false;\r\n\r\n    private _pvMatrix: Float32Array = new Float32Array(16);\r\n    private _invPvMatrix: Float32Array = new Float32Array(16);\r\n    private _projectionMatrix: Float32Array = new Float32Array(16);\r\n    private _viewMatrix: Float32Array = new Float32Array(16);\r\n\r\n    private _position: Float32Array = new Float32Array(3);\r\n    private _target: Float32Array = new Float32Array(3);\r\n    private _up: Float32Array = new Float32Array([0, 1, 0]);\r\n\r\n    private _left: number;\r\n    private _right: number;\r\n    private _bottom: number;\r\n    private _top: number;\r\n    private _near: number;\r\n    private _far: number;\r\n\r\n    private matrixNeedsUpdate: boolean = true;\r\n\r\n    constructor(left: number, right: number, bottom: number, top: number, near: number, far: number) {\r\n        this._left = left;\r\n        this._right = right;\r\n        this._bottom = bottom;\r\n        this._top = top;\r\n        this._near = near;\r\n        this._far = far;\r\n    }\r\n\r\n    fitViewport(width: number, height: number) {\r\n        this.left = -width / 2;\r\n        this.right = width / 2;\r\n        this.bottom = -height / 2;\r\n        this.top = height / 2;\r\n    }\r\n\r\n    screenToView(out: vec3, point: ReadonlyVec3) {\r\n        vec3.transformMat4(out, point, this._invPvMatrix);\r\n    }\r\n\r\n    private updateMatrix() {\r\n        mat4.ortho(this._projectionMatrix, this._left, this._right, this._bottom, this._top, this._near, this._far);\r\n        mat4.lookAt(this._viewMatrix, this._position, this._target, this._up);\r\n        mat4.mul(this._pvMatrix, this._projectionMatrix, this._viewMatrix);\r\n        mat4.invert(this._invPvMatrix, this._pvMatrix);\r\n        this.matrixNeedsUpdate = false;\r\n    }\r\n\r\n    get pvMatrix(): ReadonlyMat4 {\r\n        if (this.matrixNeedsUpdate) {\r\n            this.updateMatrix();\r\n        }\r\n        return this._pvMatrix;\r\n    }\r\n\r\n    get invPvMatrix(): ReadonlyMat4 {\r\n        if (this.matrixNeedsUpdate) {\r\n            this.updateMatrix();\r\n        }\r\n        return this._invPvMatrix;\r\n    }\r\n\r\n    get projectionMatrix(): ReadonlyMat4 {\r\n        if (this.matrixNeedsUpdate) {\r\n            this.updateMatrix();\r\n        }\r\n        return this._projectionMatrix;\r\n    }\r\n\r\n    get viewMatrix(): ReadonlyMat4 {\r\n        if (this.matrixNeedsUpdate) {\r\n            this.updateMatrix();\r\n        }\r\n        return this._viewMatrix;\r\n    }\r\n\r\n    get position(): ReadonlyVec3 {\r\n        return this._position;\r\n    }\r\n\r\n    set position(value: ReadonlyVec3) {\r\n        if (vec3.exactEquals(value, this._position)) {\r\n            return;\r\n        }\r\n        this.matrixNeedsUpdate = true;\r\n        this._position.set(value);\r\n    }\r\n\r\n    get target(): ReadonlyVec3 {\r\n        return this._target;\r\n    }\r\n\r\n    set target(value: ReadonlyVec3) {\r\n        if (vec3.exactEquals(value, this._target)) {\r\n            return;\r\n        }\r\n        this.matrixNeedsUpdate = true;\r\n        this._target.set(value);\r\n    }\r\n\r\n    get up(): ReadonlyVec3 {\r\n        return this._up;\r\n    }\r\n\r\n    set up(value: ReadonlyVec3) {\r\n        if (vec3.exactEquals(value, this._up)) {\r\n            return;\r\n        }\r\n        this.matrixNeedsUpdate = true;\r\n        this._up.set(value);\r\n    }\r\n\r\n    get left(): number {\r\n        return this._left;\r\n    }\r\n\r\n    set left(value: number) {\r\n        if (value === this._left) {\r\n            return;\r\n        }\r\n        this.matrixNeedsUpdate = true;\r\n        this._left = value;\r\n    }\r\n\r\n    get right(): number {\r\n        return this._right;\r\n    }\r\n\r\n    set right(value: number) {\r\n        if (value === this._right) {\r\n            return;\r\n        }\r\n        this.matrixNeedsUpdate = true;\r\n        this._right = value;\r\n    }\r\n\r\n    get bottom(): number {\r\n        return this._bottom;\r\n    }\r\n\r\n    set bottom(value: number) {\r\n        if (value === this._bottom) {\r\n            return;\r\n        }\r\n        this.matrixNeedsUpdate = true;\r\n        this._bottom = value;\r\n    }\r\n\r\n    get top(): number {\r\n        return this._top;\r\n    }\r\n\r\n    set top(value: number) {\r\n        if (value === this._top) {\r\n            return;\r\n        }\r\n        this.matrixNeedsUpdate = true;\r\n        this._top = value;\r\n    }\r\n\r\n    get near(): number {\r\n        return this._near;\r\n    }\r\n\r\n    set near(value: number) {\r\n        if (value === this._near) {\r\n            return;\r\n        }\r\n        this.matrixNeedsUpdate = true;\r\n        this._near = value;\r\n    }\r\n\r\n    get far(): number {\r\n        return this._far;\r\n    }\r\n\r\n    set far(value: number) {\r\n        if (value === this._far) {\r\n            return;\r\n        }\r\n        this.matrixNeedsUpdate = true;\r\n        this._far = value;\r\n    }\r\n}\r\n","import {mat4, ReadonlyMat4, ReadonlyVec3, vec3} from 'gl-matrix';\r\nimport Camera3D from './Camera3D';\r\n\r\nexport default class PerspectiveCamera implements Camera3D {\r\n\r\n    readonly perspective = true;\r\n\r\n    private _pvMatrix: Float32Array = new Float32Array(16);\r\n    private _invPvMatrix: Float32Array = new Float32Array(16);\r\n    private _projectionMatrix: Float32Array = new Float32Array(16);\r\n    private _viewMatrix: Float32Array = new Float32Array(16);\r\n\r\n    private _position: Float32Array = new Float32Array(3);\r\n    private _target: Float32Array = new Float32Array(3);\r\n    private _up: Float32Array = new Float32Array([0, 1, 0]);\r\n\r\n    private _fovYRad: number;\r\n    private _aspect: number;\r\n    private _near: number;\r\n    private _far: number;\r\n\r\n    private matrixNeedsUpdate: boolean = true;\r\n\r\n    constructor(fovYRad: number, aspect: number, near: number, far: number) {\r\n        this._fovYRad = fovYRad;\r\n        this._aspect = aspect;\r\n        this._near = near;\r\n        this._far = far;\r\n    }\r\n\r\n    fitViewport(width: number, height: number) {\r\n        this.aspect = width / height;\r\n    }\r\n\r\n    screenToView(out: vec3, point: ReadonlyVec3) {\r\n        vec3.transformMat4(out, point, this._invPvMatrix);\r\n    }\r\n\r\n    private updateMatrix() {\r\n        mat4.perspective(this._projectionMatrix, this._fovYRad, this._aspect, this._near, this._far);\r\n        mat4.lookAt(this._viewMatrix, this._position, this._target, this._up);\r\n        mat4.mul(this._pvMatrix, this._projectionMatrix, this._viewMatrix);\r\n        mat4.invert(this._invPvMatrix, this._pvMatrix);\r\n        this.matrixNeedsUpdate = false;\r\n    }\r\n\r\n    get pvMatrix(): ReadonlyMat4 {\r\n        if (this.matrixNeedsUpdate) {\r\n            this.updateMatrix();\r\n        }\r\n        return this._pvMatrix;\r\n    }\r\n\r\n    get invPvMatrix(): ReadonlyMat4 {\r\n        if (this.matrixNeedsUpdate) {\r\n            this.updateMatrix();\r\n        }\r\n        return this._invPvMatrix;\r\n    }\r\n\r\n    get projectionMatrix(): ReadonlyMat4 {\r\n        if (this.matrixNeedsUpdate) {\r\n            this.updateMatrix();\r\n        }\r\n        return this._projectionMatrix;\r\n    }\r\n\r\n    get viewMatrix(): ReadonlyMat4 {\r\n        if (this.matrixNeedsUpdate) {\r\n            this.updateMatrix();\r\n        }\r\n        return this._viewMatrix;\r\n    }\r\n\r\n    get position(): ReadonlyVec3 {\r\n        return this._position;\r\n    }\r\n\r\n    set position(value: ReadonlyVec3) {\r\n        if (vec3.exactEquals(value, this._position)) {\r\n            return;\r\n        }\r\n        this.matrixNeedsUpdate = true;\r\n        this._position.set(value);\r\n    }\r\n\r\n    get target(): ReadonlyVec3 {\r\n        return this._target;\r\n    }\r\n\r\n    set target(value: ReadonlyVec3) {\r\n        if (vec3.exactEquals(value, this._target)) {\r\n            return;\r\n        }\r\n        this.matrixNeedsUpdate = true;\r\n        this._target.set(value);\r\n    }\r\n\r\n    get up(): ReadonlyVec3 {\r\n        return this._up;\r\n    }\r\n\r\n    set up(value: ReadonlyVec3) {\r\n        if (vec3.exactEquals(value, this._up)) {\r\n            return;\r\n        }\r\n        this.matrixNeedsUpdate = true;\r\n        this._up.set(value);\r\n    }\r\n\r\n    get fovYRad(): number {\r\n        return this._fovYRad;\r\n    }\r\n\r\n    set fovYRad(value: number) {\r\n        if (this._fovYRad === value) {\r\n            return;\r\n        }\r\n        this.matrixNeedsUpdate = true;\r\n        this._fovYRad = value;\r\n    }\r\n\r\n    get aspect(): number {\r\n        return this._aspect;\r\n    }\r\n\r\n    set aspect(value: number) {\r\n        if (this._aspect === value) {\r\n            return;\r\n        }\r\n        this.matrixNeedsUpdate = true;\r\n        this._aspect = value;\r\n    }\r\n\r\n    get near(): number {\r\n        return this._near;\r\n    }\r\n\r\n    set near(value: number) {\r\n        if (this._near === value) {\r\n            return;\r\n        }\r\n        this.matrixNeedsUpdate = true;\r\n        this._near = value;\r\n    }\r\n\r\n    get far(): number {\r\n        return this._far;\r\n    }\r\n\r\n    set far(value: number) {\r\n        if (this._far === value) {\r\n            return;\r\n        }\r\n        this.matrixNeedsUpdate = true;\r\n        this._far = value;\r\n    }\r\n\r\n}\r\n","import {quat, ReadonlyMat4, ReadonlyVec3, vec3} from 'gl-matrix';\r\nimport Input from './input/Input';\r\nimport {MouseDragContext3D, raycastViewPlaneDragMove, raycastViewPlaneDragStart} from './input/mouse-drag';\r\nimport Camera3D from './render/camera/Camera3D';\r\nimport OrthographicCamera from './render/camera/OrthographicCamera';\r\nimport PerspectiveCamera from './render/camera/PerspectiveCamera';\r\n\r\nconst CAMERA_ZOOM_IN_STEP = 0.9;\r\nconst CAMERA_ZOOM_MIN = -12;\r\nconst CAMERA_ZOOM_OUT_STEP = 1.2;\r\nconst CAMERA_ZOOM_MAX = 4;\r\n\r\nexport default class DraggableCamera {\r\n\r\n    private viewportWidth: number = 1;\r\n    private viewportHeight: number = 1;\r\n\r\n    private readonly perspectiveCamera: PerspectiveCamera;\r\n    private readonly orthographicCamera: OrthographicCamera;\r\n\r\n    perspective: boolean = true;\r\n    far: number = 2;\r\n    target: vec3 = vec3.fromValues(0, 0, 0);\r\n    rotateX: number = 0;\r\n    rotateY: number = 0;\r\n    zoom: number = 1;\r\n    private position: vec3 = vec3.fromValues(0, 0, 0);\r\n    private orthographicZoomRatio: number = 1.6;\r\n\r\n    private defaultPosition = vec3.fromValues(0, 0, 1);\r\n    private defaultUp = vec3.fromValues(0, 1, 0);\r\n    private up = vec3.fromValues(0, 0, 0);\r\n    private rotationQuat = quat.create();\r\n\r\n    private draggingRotation: boolean = false;\r\n    private draggingPosition: boolean = false;\r\n    private dragStartProjectedMouseX: number = 0;\r\n    private dragStartProjectedMouseY: number = 0;\r\n    private dragStartRotateX = 0;\r\n    private dragStartRotateY = 0;\r\n    private positionDragContext = new MouseDragContext3D();\r\n\r\n    constructor(fovYRad: number = 45 / 180 * Math.PI, near: number = 0.1, far: number = 1000) {\r\n        this.perspectiveCamera = new PerspectiveCamera(fovYRad, 1, near, far);\r\n        this.orthographicCamera = new OrthographicCamera(-1, 1, -1, 1, near, far);\r\n    }\r\n\r\n    screenToView(out: vec3, point: ReadonlyVec3) {\r\n        const camera = this.perspective ? this.perspectiveCamera : this.orthographicCamera;\r\n        camera.screenToView(out, point);\r\n        return out;\r\n    }\r\n\r\n    get pvMatrix(): ReadonlyMat4 {\r\n        const camera = this.perspective ? this.perspectiveCamera : this.orthographicCamera;\r\n        return camera.pvMatrix;\r\n    }\r\n\r\n    get viewMatrix(): ReadonlyMat4 {\r\n        const camera = this.perspective ? this.perspectiveCamera : this.orthographicCamera;\r\n        return camera.viewMatrix;\r\n    }\r\n\r\n    get camera(): Camera3D {\r\n        return this.perspective ? this.perspectiveCamera : this.orthographicCamera;\r\n    }\r\n\r\n    fitViewport(width: number, height: number) {\r\n        this.viewportWidth = width;\r\n        this.viewportHeight = height;\r\n        this.update();\r\n    }\r\n\r\n    update() {\r\n        const camera = this.camera;\r\n        const zoom = this.zoom <= 0 ? CAMERA_ZOOM_IN_STEP ** (-this.zoom) : CAMERA_ZOOM_OUT_STEP ** this.zoom;\r\n        const viewPortZoom = zoom / 25 * (this.perspective ? 1 : this.orthographicZoomRatio);\r\n        camera.fitViewport(this.viewportWidth * viewPortZoom, this.viewportHeight * viewPortZoom);\r\n        vec3.scale(this.position, this.defaultPosition, this.far * zoom * 2);\r\n        quat.fromEuler(this.rotationQuat, this.rotateX, this.rotateY, 0);\r\n        vec3.transformQuat(this.position, this.position, this.rotationQuat);\r\n        vec3.add(this.position, this.position, this.target);\r\n        camera.position = this.position;\r\n        if (this.rotateX === 90 || this.rotateX === -90) {\r\n            vec3.transformQuat(this.up, this.defaultUp, this.rotationQuat);\r\n            camera.up = this.up;\r\n        } else {\r\n            camera.up = this.defaultUp;\r\n        }\r\n        camera.target = this.target;\r\n    }\r\n\r\n    onInput(input: Input) {\r\n        const projectedMouseX = (-this.viewportWidth / 2 + input.mouseX) / this.viewportWidth * 2;\r\n        const projectedMouseY = (+this.viewportHeight / 2 - input.mouseY) / this.viewportHeight * 2;\r\n\r\n        // rotation\r\n        if (input.mouseMiddle) {\r\n            if (this.draggingRotation) {\r\n                const dx = projectedMouseX - this.dragStartProjectedMouseX;\r\n                const dy = projectedMouseY - this.dragStartProjectedMouseY;\r\n                this.rotateX = Math.max(-90, Math.min(90, this.dragStartRotateX + dy * 90));\r\n                this.rotateY = (this.dragStartRotateY - dx * 90) % 360;\r\n            } else {\r\n                this.draggingRotation = true;\r\n                this.dragStartProjectedMouseX = projectedMouseX;\r\n                this.dragStartProjectedMouseY = projectedMouseY;\r\n                this.dragStartRotateX = this.rotateX;\r\n                this.dragStartRotateY = this.rotateY;\r\n            }\r\n        } else {\r\n            this.draggingRotation = false;\r\n        }\r\n\r\n        // position\r\n        if (input.mouseRight) {\r\n            if (this.draggingPosition) {\r\n                if (raycastViewPlaneDragMove(\r\n                    this.positionDragContext,\r\n                    projectedMouseX, projectedMouseY,\r\n                    this.camera\r\n                )) {\r\n                    vec3.sub(this.target, this.positionDragContext.dragStartTargetPosition, this.positionDragContext.offset);\r\n                }\r\n            } else if (!this.draggingRotation) {\r\n                this.draggingPosition = true;\r\n                raycastViewPlaneDragStart(\r\n                    this.positionDragContext,\r\n                    projectedMouseX, projectedMouseY,\r\n                    this.target[0], this.target[1], this.target[2],\r\n                    this.camera\r\n                );\r\n            }\r\n        } else {\r\n            this.draggingPosition = false;\r\n        }\r\n\r\n        // zoom\r\n        if (input.wheelDetY) {\r\n            this.zoom = Math.max(CAMERA_ZOOM_MIN, Math.min(CAMERA_ZOOM_MAX, this.zoom + input.wheelDetY));\r\n        }\r\n\r\n        this.update();\r\n    }\r\n\r\n}","export const enum MouseButton {\r\n    LEFT, MIDDLE, RIGHT\r\n}","import {MouseButton} from './MouseButton';\r\n\r\nexport default class Input {\r\n\r\n    callback?: (input: Input) => void;\r\n    private needsUpdate: boolean = false;\r\n\r\n    mouseOver: boolean = false;\r\n    mouseX: number = 0;\r\n    mouseY: number = 0;\r\n    mouseLeft: boolean = false;\r\n    mouseLeftDownThisFrame: boolean = false;\r\n    mouseRight: boolean = false;\r\n    mouseRightDownThisFrame: boolean = false;\r\n    mouseMiddle: boolean = false;\r\n    mouseMiddleDownThisFrame: boolean = false;\r\n    wheelDetX: number = 0;\r\n    wheelDetY: number = 0;\r\n\r\n    private readonly onContextmenu: (e: MouseEvent) => void;\r\n    private readonly onMouseMove: (e: MouseEvent) => void;\r\n    private readonly onMouseDown: (e: MouseEvent) => void;\r\n    private readonly onMouseUp: (e: MouseEvent) => void;\r\n    private readonly onMouseLeave: () => void;\r\n    private readonly onMouseOut: (e: MouseEvent) => void;\r\n    private readonly onWheel: (e: WheelEvent) => void;\r\n    private readonly onKeyDown: (e: KeyboardEvent) => void;\r\n    private readonly onKeyUp: (e: KeyboardEvent) => void;\r\n    private readonly onBlur: () => void;\r\n\r\n    private readonly keyMap: Map<string, number> = new Map();\r\n\r\n    private timestamp: number = 0;\r\n\r\n    constructor() {\r\n        this.onContextmenu = (e: MouseEvent) => {\r\n            e.preventDefault();\r\n        };\r\n        this.onMouseMove = (e: MouseEvent) => {\r\n            this.mouseOver = true;\r\n            this.mouseX = e.offsetX;\r\n            this.mouseY = e.offsetY;\r\n            this.triggerCallback();\r\n        };\r\n        this.onMouseDown = (e: MouseEvent) => {\r\n            switch (e.button) {\r\n                case MouseButton.LEFT:\r\n                    this.mouseLeft = true;\r\n                    this.mouseLeftDownThisFrame = true;\r\n                    break;\r\n                case MouseButton.MIDDLE:\r\n                    this.mouseMiddle = true;\r\n                    this.mouseMiddleDownThisFrame = true;\r\n                    break;\r\n                case MouseButton.RIGHT:\r\n                    this.mouseRight = true;\r\n                    this.mouseRightDownThisFrame = true;\r\n                    break;\r\n            }\r\n            this.triggerCallback();\r\n        };\r\n        this.onMouseUp = (e: MouseEvent) => {\r\n            switch (e.button) {\r\n                case MouseButton.LEFT:\r\n                    this.mouseLeft = false;\r\n                    this.mouseLeftDownThisFrame = false;\r\n                    break;\r\n                case MouseButton.MIDDLE:\r\n                    this.mouseMiddle = false;\r\n                    this.mouseMiddleDownThisFrame = false;\r\n                    break;\r\n                case MouseButton.RIGHT:\r\n                    this.mouseRight = false;\r\n                    this.mouseLeftDownThisFrame = false;\r\n                    break;\r\n            }\r\n            this.triggerCallback();\r\n        };\r\n        this.onMouseLeave = () => {\r\n            this.mouseOver = false;\r\n            this.triggerCallback();\r\n        };\r\n        this.onMouseOut = (e) => {\r\n            if (e.clientY <= 0 || e.clientX <= 0 || (e.clientX >= window.innerWidth || e.clientY >= window.innerHeight)) {\r\n                this.mouseLeft = false;\r\n                this.mouseLeftDownThisFrame = false;\r\n                this.mouseRight = false;\r\n                this.mouseLeftDownThisFrame = false;\r\n            }\r\n            this.triggerCallback();\r\n        };\r\n        this.onWheel = (e: WheelEvent) => {\r\n            e.preventDefault();\r\n            this.wheelDetX += Math.round(e.deltaX / 100);\r\n            this.wheelDetY += Math.round(e.deltaY / 100);\r\n            this.triggerCallback();\r\n        };\r\n        this.onKeyDown = (e: KeyboardEvent) => {\r\n            const target = e.target;\r\n            if (target && 'tagName' in target && (target as HTMLElement).tagName === 'INPUT') {\r\n                return;\r\n            }\r\n            if (e.ctrlKey) {\r\n                e.preventDefault();\r\n            }\r\n            this.keyMap.set(e.key, this.timestamp);\r\n            this.triggerCallback();\r\n        };\r\n        this.onKeyUp = (e: KeyboardEvent) => {\r\n            const target = e.target;\r\n            if (target && 'tagName' in target && (target as HTMLElement).tagName === 'INPUT') {\r\n                return;\r\n            }\r\n            this.keyMap.delete(e.key);\r\n            this.triggerCallback();\r\n        };\r\n        this.onBlur = () => {\r\n            this.keyMap.clear();\r\n            this.triggerCallback();\r\n        };\r\n    }\r\n\r\n    setup(element: HTMLElement) {\r\n        element.addEventListener('contextmenu', this.onContextmenu);\r\n        element.addEventListener('mousemove', this.onMouseMove);\r\n        element.addEventListener('mousedown', this.onMouseDown);\r\n        element.addEventListener('mouseleave', this.onMouseLeave);\r\n        document.addEventListener('mouseup', this.onMouseUp);\r\n        document.addEventListener('mouseout', this.onMouseOut);\r\n        element.addEventListener('wheel', this.onWheel);\r\n        window.addEventListener('keydown', this.onKeyDown);\r\n        window.addEventListener('keyup', this.onKeyUp);\r\n        window.addEventListener('blur', this.onBlur);\r\n    }\r\n\r\n    unload(element: HTMLElement) {\r\n        element.removeEventListener('contextmenu', this.onContextmenu);\r\n        element.removeEventListener('mousemove', this.onMouseMove);\r\n        element.removeEventListener('mousedown', this.onMouseDown);\r\n        element.removeEventListener('mouseleave', this.onMouseLeave);\r\n        document.removeEventListener('mouseup', this.onMouseUp);\r\n        document.removeEventListener('mouseout', this.onMouseOut);\r\n        element.removeEventListener('wheel', this.onWheel);\r\n        window.removeEventListener('keydown', this.onKeyDown);\r\n        window.removeEventListener('keyup', this.onKeyUp);\r\n        window.removeEventListener('blur', this.onBlur);\r\n    }\r\n\r\n    update() {\r\n        this.mouseLeftDownThisFrame = false;\r\n        this.mouseRightDownThisFrame = false;\r\n        this.mouseMiddleDownThisFrame = false;\r\n        this.wheelDetX = 0;\r\n        this.wheelDetY = 0;\r\n        this.timestamp += 1;\r\n    }\r\n\r\n    isKeyPressed(key: string): boolean {\r\n        return this.keyMap.has(key);\r\n    }\r\n\r\n    isKeyPressedThisFrame(key: string): boolean {\r\n        return this.keyMap.get(key) === this.timestamp;\r\n    }\r\n\r\n    private triggerCallback() {\r\n        this.needsUpdate = true;\r\n        requestAnimationFrame(() => {\r\n            if (!this.needsUpdate) {\r\n                return;\r\n            }\r\n            this.needsUpdate = false;\r\n            this.callback && this.callback(this);\r\n            this.update();\r\n        });\r\n    }\r\n\r\n}\r\n","export function isPointInCircle(px: number, py: number, cx: number, cy: number, radius: number): boolean {\r\n    return (px - cx) ** 2 + (py - cy) ** 2 <= radius ** 2;\r\n}\r\n\r\nexport function isPointInTriangle(\r\n    x: number,\r\n    y: number,\r\n    ax: number,\r\n    ay: number,\r\n    bx: number,\r\n    by: number,\r\n    cx: number,\r\n    cy: number\r\n): boolean {\r\n    const v0x = cx - ax;\r\n    const v0y = cy - ay;\r\n    const v1x = cx - bx;\r\n    const v1y = cy - by;\r\n    const v2x = cx - x;\r\n    const v2y = cy - y;\r\n    const d00 = v0x * v0x + v0y * v0y;\r\n    const d01 = v0x * v1x + v0y * v1y;\r\n    const d02 = v0x * v2x + v0y * v2y;\r\n    const d11 = v1x * v1x + v1y * v1y;\r\n    const d12 = v1x * v2x + v1y * v2y;\r\n    const inv = 1 / (d00 * d11 - d01 * d01);\r\n    const u = (d11 * d02 - d01 * d12) * inv;\r\n    const v = (d00 * d12 - d01 * d02) * inv;\r\n    if (u < 0 || u > 1 || v < 0 || v > 1) {\r\n        return false;\r\n    }\r\n    return u + v <= 1;\r\n}\r\n\r\nexport function isCircleInRect(\r\n    cx: number,\r\n    cy: number,\r\n    radius: number,\r\n    x0: number,\r\n    y0: number,\r\n    x1: number,\r\n    y1: number\r\n): boolean {\r\n    if (x0 > x1) {\r\n        [x0, x1] = [x1, x0];\r\n    }\r\n    if (y0 > y1) {\r\n        [y0, y1] = [y1, y0];\r\n    }\r\n    return !(\r\n        cx + radius < x0\r\n        || cx - radius > x1\r\n        || cy + radius < y0\r\n        || cy - radius > y1\r\n    );\r\n}","export const A_POSITION = 'a_position';\r\nexport const A_TEX_COORD = 'a_texCoord';\r\nexport const A_COLOR = 'a_color';\r\n\r\nexport const U_TEXTURE = 'u_texture';\r\n","import Texture from './Texture';\r\n\r\nexport default class FrameBuffer {\r\n\r\n    glFrameBuffer?: WebGLFramebuffer;\r\n    textures: Texture[] = [];\r\n    depthTexture?: Texture;\r\n    stencilTexture?: Texture;\r\n\r\n    constructor(glFrameBuffer: WebGLFramebuffer) {\r\n        this.glFrameBuffer = glFrameBuffer;\r\n    }\r\n\r\n    get texture(): Texture | undefined {\r\n        return this.textures[0];\r\n    }\r\n\r\n}\r\n","export default class Texture {\r\n    glTexture?: WebGLTexture;\r\n\r\n    level: GLint;\r\n    internalFormat: GLint;\r\n    width: number;\r\n    height: number;\r\n    border: GLint;\r\n    format: GLenum;\r\n    type: GLenum;\r\n\r\n    flipY: boolean = false;\r\n    image?: HTMLImageElement;\r\n\r\n    constructor(glTexture: WebGLTexture,\r\n                level: number,\r\n                internalformat: number,\r\n                width: number,\r\n                height: number,\r\n                border: number,\r\n                format: number,\r\n                type: number\r\n    ) {\r\n        this.glTexture = glTexture;\r\n        this.level = level;\r\n        this.internalFormat = internalformat;\r\n        this.width = width;\r\n        this.height = height;\r\n        this.border = border;\r\n        this.format = format;\r\n        this.type = type;\r\n    }\r\n\r\n}\r\n","import Texture from './Texture';\r\n\r\nexport default function getUniformSetter(\r\n    gl: WebGL2RenderingContext,\r\n    name: string,\r\n    size: GLint,\r\n    type: GLenum,\r\n    location: WebGLUniformLocation,\r\n    samplerCounter: { count: number }\r\n): (val: any) => void {\r\n    if (name.substr(-3) === '[0]') {\r\n        switch (type) {\r\n            case gl.FLOAT:\r\n                return function (val: Float32List) {\r\n                    gl.uniform1fv(location, val);\r\n                };\r\n            case gl.INT:\r\n                return function (val: Int32List) {\r\n                    gl.uniform1iv(location, val);\r\n                };\r\n            case gl.UNSIGNED_INT:\r\n                return function (val: Uint32List) {\r\n                    gl.uniform1uiv(location, val);\r\n                };\r\n            case gl.SAMPLER_2D:\r\n                const units = new Int32Array(size);\r\n                for (let ii = 0; ii < size; ++ii) {\r\n                    units[ii] = samplerCounter.count++;\r\n                }\r\n                return function (textures: (WebGLTexture | Texture | null | undefined)[]) {\r\n                    gl.uniform1iv(location, units);\r\n                    for (let ii = 0; ii < size; ++ii) {\r\n                        let texture = textures[ii];\r\n                        if (texture instanceof Texture) {\r\n                            texture = texture.glTexture;\r\n                        }\r\n                        gl.activeTexture(gl.TEXTURE0 + units[ii]);\r\n                        gl.bindTexture(gl.TEXTURE_2D, texture || null);\r\n                    }\r\n                };\r\n            default:\r\n                throw new Error(`Unimplemented setter type (uniform: ${name}, type: ${type})`);\r\n        }\r\n    }\r\n    switch (type) {\r\n        case gl.FLOAT:\r\n            return function (val: GLfloat) {\r\n                gl.uniform1f(location, val);\r\n            };\r\n        case gl.FLOAT_VEC2:\r\n            return function (val: Float32List) {\r\n                gl.uniform2fv(location, val);\r\n            };\r\n        case gl.FLOAT_VEC3:\r\n            return function (val: Float32List) {\r\n                gl.uniform3fv(location, val);\r\n            };\r\n        case gl.FLOAT_VEC4:\r\n            return function (val: Float32List) {\r\n                gl.uniform4fv(location, val);\r\n            };\r\n        case gl.BOOL:\r\n        case gl.INT:\r\n            return function (val: GLint) {\r\n                gl.uniform1i(location, val);\r\n            };\r\n        case gl.BOOL_VEC2:\r\n        case gl.INT_VEC2:\r\n            return function (val: Int32List) {\r\n                gl.uniform2iv(location, val);\r\n            };\r\n        case gl.BOOL_VEC3:\r\n        case gl.INT_VEC3:\r\n            return function (val: Int32List) {\r\n                gl.uniform3iv(location, val);\r\n            };\r\n        case gl.BOOL_VEC4:\r\n        case gl.INT_VEC4:\r\n            return function (val: Int32List) {\r\n                gl.uniform4iv(location, val);\r\n            };\r\n        case gl.FLOAT_MAT2:\r\n            return function (val: Float32List) {\r\n                gl.uniformMatrix2fv(location, false, val);\r\n            };\r\n        case gl.FLOAT_MAT3:\r\n            return function (val: Float32List) {\r\n                gl.uniformMatrix3fv(location, false, val);\r\n            };\r\n        case gl.FLOAT_MAT4:\r\n            return function (val: Float32List) {\r\n                gl.uniformMatrix4fv(location, false, val);\r\n            };\r\n        case gl.SAMPLER_2D:\r\n            const ii = samplerCounter.count++;\r\n            return function (val: WebGLTexture | Texture | null | undefined) {\r\n                if (val instanceof Texture) {\r\n                    val = val.glTexture;\r\n                }\r\n                gl.uniform1i(location, ii);\r\n                gl.activeTexture(gl.TEXTURE0 + ii);\r\n                gl.bindTexture(gl.TEXTURE_2D, val || null);\r\n            };\r\n        default:\r\n            throw new Error(`Unimplemented setter type (uniform: ${name}, type: ${type})`);\r\n    }\r\n}\r\n","class AttributeInfo {\r\n    name: string;\r\n    size: GLint;\r\n    type: GLenum;\r\n    location: GLint;\r\n\r\n    constructor(name: string, size: GLint, type: GLenum, location: GLint) {\r\n        this.name = name;\r\n        this.size = size;\r\n        this.type = type;\r\n        this.location = location;\r\n    }\r\n}\r\n\r\nclass UniformInfo {\r\n    name: string;\r\n    size: GLint;\r\n    type: GLenum;\r\n    location: WebGLUniformLocation;\r\n    setter: (val: any) => void;\r\n\r\n    constructor(name: string, size: GLint, type: GLenum, location: WebGLUniformLocation, setter: (val: any) => void) {\r\n        this.name = name;\r\n        this.size = size;\r\n        this.type = type;\r\n        this.location = location;\r\n        this.setter = setter;\r\n    }\r\n}\r\n\r\nexport default class Shader {\r\n    vertShader?: WebGLShader;\r\n    fragShader?: WebGLShader;\r\n    program?: WebGLProgram;\r\n\r\n    attributes: { [name: string]: AttributeInfo } = {};\r\n    uniforms: { [name: string]: UniformInfo } = {};\r\n\r\n    constructor(vertShader: WebGLShader, fragShader: WebGLShader, program: WebGLProgram) {\r\n        this.vertShader = vertShader;\r\n        this.fragShader = fragShader;\r\n        this.program = program;\r\n    }\r\n\r\n    registerAttribute(name: string, size: GLint, type: GLenum, location: GLint) {\r\n        this.attributes[name] = new AttributeInfo(name, size, type, location);\r\n    }\r\n\r\n    registerUniform(name: string, size: GLint, type: GLenum, location: WebGLUniformLocation, setter: (val: any) => void) {\r\n        if (name.endsWith('[0]')) {\r\n            name = name.substr(0, name.length - '[0]'.length);\r\n        }\r\n        this.uniforms[name] = new UniformInfo(name, size, type, location, setter);\r\n    }\r\n}\r\n","import {A_COLOR, A_POSITION, A_TEX_COORD, U_TEXTURE} from './constants';\r\nimport FrameBuffer from './FrameBuffer';\r\nimport Geometry from './Geometry';\r\nimport getUniformSetter from './get-uniform-setter';\r\nimport Label from './Label';\r\nimport Shader from './Shader';\r\nimport color2dFrag from './shaders/color-2d.frag';\r\nimport color2dVert from './shaders/color-2d.vert';\r\nimport image2dFrag from './shaders/image-2d.frag';\r\nimport image2dVert from './shaders/image-2d.vert';\r\nimport Texture from './Texture';\r\n\r\nenum Side {\r\n    NONE, FRONT, BACK\r\n}\r\n\r\nenum BatchType {\r\n    MESH, LINES\r\n}\r\n\r\nenum BlendMode {\r\n    OVERLAP, LIGHT, PIGMENT\r\n}\r\n\r\ninterface RendererState {\r\n    /** Viewport width. */\r\n    width: number;\r\n    /** Viewport height. */\r\n    height: number;\r\n    /** 2D draw color. */\r\n    color: { r: number, g: number, b: number, a: number };\r\n    /** 2D camera x. */\r\n    cameraX: number;\r\n    /** 2D camera y. */\r\n    cameraY: number;\r\n    /** 2D camera zoom. */\r\n    zoom: number;\r\n    blendMode: BlendMode;\r\n}\r\n\r\nexport default class Renderer {\r\n\r\n    private static _sharedInstance?: Renderer;\r\n\r\n    static sharedInstance(): Renderer {\r\n        if (!Renderer._sharedInstance) {\r\n            Renderer._sharedInstance = new Renderer();\r\n        }\r\n        return Renderer._sharedInstance;\r\n    }\r\n\r\n    readonly SIDE_NONE = Side.NONE;\r\n    readonly SIDE_FRONT = Side.FRONT;\r\n    readonly SIDE_BACK = Side.BACK;\r\n\r\n    readonly BLEND_MODE_OVERLAP = BlendMode.OVERLAP;\r\n    readonly BLEND_MODE_LIGHT = BlendMode.LIGHT;\r\n    readonly BLEND_MODE_PIGMENT = BlendMode.PIGMENT;\r\n\r\n    readonly canvas: HTMLCanvasElement;\r\n    readonly gl: WebGL2RenderingContext;\r\n    attribLocations?: { [name: string]: number };\r\n\r\n    /** An 1x1 0xfff pixel. */\r\n    readonly BLANK_WHITE: Texture;\r\n    readonly IMAGE_2D_SHADER: Shader;\r\n    readonly COLOR_2D_SHADER: Shader;\r\n\r\n    private currentShader?: Shader;\r\n    private readonly frameBufferStack: FrameBuffer[] = [];\r\n    private currentFrameBuffer?: FrameBuffer;\r\n\r\n    private readonly batchSize: number;\r\n    private readonly batchPositionVertices: Float32Array;\r\n    private readonly batchTexCoordVertices: Float32Array;\r\n    private readonly batchColorVertices: Float32Array;\r\n    private readonly batchPositionBuffer: WebGLBuffer;\r\n    private readonly batchTexCoordBuffer: WebGLBuffer;\r\n    private readonly batchColorBuffer: WebGLBuffer;\r\n    private batchType: BatchType = BatchType.MESH;\r\n    private batchTexture?: Texture;\r\n    private batchIndex: number = 0;\r\n    private drawing2D: boolean = false;\r\n\r\n    public state: RendererState = {\r\n        width: 0,\r\n        height: 0,\r\n        color: {r: 1, g: 1, b: 1, a: 1},\r\n        cameraX: 0,\r\n        cameraY: 0,\r\n        zoom: 1,\r\n        blendMode: BlendMode.OVERLAP\r\n    };\r\n    private stateStack: RendererState[] = [];\r\n\r\n    constructor(target?: HTMLCanvasElement | WebGL2RenderingContext, batchSize: number = 2000) {\r\n        let canvas: HTMLCanvasElement;\r\n        let gl: WebGL2RenderingContext | null = null;\r\n        if (!target) {\r\n            canvas = document.createElement('canvas');\r\n        } else {\r\n            if (target instanceof HTMLCanvasElement) {\r\n                canvas = target;\r\n            } else {\r\n                canvas = target.canvas as HTMLCanvasElement;\r\n                gl = target;\r\n            }\r\n        }\r\n        if (!gl) {\r\n            gl = canvas.getContext('webgl2',\r\n                {\r\n                    alpha: true,\r\n                    antialias: false,\r\n                    depth: true,\r\n                    premultipliedAlpha: false,\r\n                    preserveDrawingBuffer: false,\r\n                    stencil: false\r\n                }\r\n            );\r\n            if (!gl) {\r\n                throw new Error('Failed to create WebGL2 rendering context');\r\n            }\r\n        }\r\n        this.canvas = canvas;\r\n        this.gl = gl;\r\n        this.state.width = canvas.width;\r\n        this.state.height = canvas.height;\r\n        gl.viewport(0, 0, this.state.width, this.state.height);\r\n        gl.enable(gl.BLEND);\r\n\r\n        this.BLANK_WHITE = this.createTextureFromRgbaPixels(1, 1, new Uint8Array([0xff, 0xff, 0xff, 0xff]));\r\n\r\n        this.IMAGE_2D_SHADER = this.createShader(image2dVert, image2dFrag);\r\n        this.COLOR_2D_SHADER = this.createShader(color2dVert, color2dFrag);\r\n\r\n        this.batchSize = batchSize;\r\n        this.batchPositionVertices = new Float32Array(batchSize * 3 * 2 * 2);\r\n        this.batchPositionBuffer = this.createDynamicDrawBuffer(this.batchPositionVertices);\r\n        this.batchTexCoordVertices = new Float32Array(batchSize * 3 * 2 * 2);\r\n        this.batchTexCoordBuffer = this.createDynamicDrawBuffer(this.batchTexCoordVertices);\r\n        this.batchColorVertices = new Float32Array(batchSize * 3 * 2 * 4);\r\n        this.batchColorBuffer = this.createDynamicDrawBuffer(this.batchColorVertices);\r\n    }\r\n\r\n    copyTo(\r\n        ctx: CanvasRenderingContext2D,\r\n        dx: number = 0,\r\n        dy: number = 0,\r\n        dw: number = this.state.width,\r\n        dh: number = this.state.height,\r\n        sx: number = 0,\r\n        sy: number = 0,\r\n        sw: number = this.state.width,\r\n        sh: number = this.state.height\r\n    ) {\r\n        ctx.drawImage(this.canvas, sx, sy, sw, sh, dx, dy, dw, dh);\r\n    }\r\n\r\n    viewport(width: number, height: number) {\r\n        this.state.width = width;\r\n        this.state.height = height;\r\n        this.gl.viewport(0, 0, this.state.width, this.state.height);\r\n    }\r\n\r\n    resizeCanvas(width: number, height: number) {\r\n        if (this.canvas.width !== width || this.canvas.height !== height) {\r\n            this.canvas.width = width;\r\n            this.canvas.height = height;\r\n        }\r\n        this.viewport(width, height);\r\n    }\r\n\r\n    clearColor(r: number = 0, g: number = 0, b: number = 0, a: number = 0) {\r\n        const gl = this.gl;\r\n        gl.clearColor(r, g, b, a);\r\n    }\r\n\r\n    clear(color: boolean, depth: boolean, stencil: boolean) {\r\n        this.flush2D();\r\n        this.switchFrameBuffer();\r\n        const gl = this.gl;\r\n        let mask = 0;\r\n        if (color) {\r\n            mask |= gl.COLOR_BUFFER_BIT;\r\n        }\r\n        if (depth) {\r\n            mask |= gl.DEPTH_BUFFER_BIT;\r\n        }\r\n        if (stencil) {\r\n            mask |= gl.STENCIL_BUFFER_BIT;\r\n        }\r\n        gl.clear(mask);\r\n    }\r\n\r\n    depthTest(enabled: boolean) {\r\n        const gl = this.gl;\r\n        if (enabled) {\r\n            gl.enable(gl.DEPTH_TEST);\r\n            gl.depthFunc(gl.LEQUAL);\r\n        } else {\r\n            gl.disable(gl.DEPTH_TEST);\r\n        }\r\n    }\r\n\r\n    depthMask(enabled: boolean) {\r\n        this.gl.depthMask(enabled);\r\n    }\r\n\r\n    cullFace(side: Side) {\r\n        const gl = this.gl;\r\n        switch (side) {\r\n            case Side.NONE:\r\n                gl.disable(gl.CULL_FACE);\r\n                break;\r\n            case Side.FRONT:\r\n                gl.enable(gl.CULL_FACE);\r\n                gl.cullFace(gl.FRONT);\r\n                break;\r\n            case Side.BACK:\r\n                gl.enable(gl.CULL_FACE);\r\n                gl.cullFace(gl.BACK);\r\n                break;\r\n        }\r\n    }\r\n\r\n    blendMode(blendMode: BlendMode) {\r\n        if (blendMode === this.state.blendMode) {\r\n            return;\r\n        }\r\n        this.state.blendMode = blendMode;\r\n        this.flush2D();\r\n        const gl = this.gl;\r\n        switch (blendMode) {\r\n            case BlendMode.OVERLAP:\r\n                gl.blendEquation(gl.FUNC_ADD);\r\n                gl.blendFunc(gl.ONE, gl.ZERO);\r\n                break;\r\n            case BlendMode.LIGHT:\r\n                gl.blendEquation(gl.FUNC_ADD);\r\n                gl.blendFunc(gl.SRC_ALPHA, gl.ONE);\r\n                break;\r\n            case BlendMode.PIGMENT: {\r\n                gl.blendEquationSeparate(gl.FUNC_ADD, gl.MAX);\r\n                gl.blendFunc(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA);\r\n            }\r\n                break;\r\n        }\r\n    }\r\n\r\n    useShader(shader?: Shader) {\r\n        if (shader !== this.currentShader) {\r\n            this.flush2D();\r\n            this.currentShader = shader;\r\n            if (shader) {\r\n                const gl = this.gl;\r\n                gl.useProgram(shader.program!);\r\n            }\r\n        }\r\n    }\r\n\r\n    uniform(name: string, value: any) {\r\n        const shader = this.currentShader;\r\n        if (!shader) {\r\n            return;\r\n        }\r\n        this.flush2D();\r\n        const uniform = shader.uniforms[name];\r\n        uniform?.setter(value);\r\n    }\r\n\r\n    save() {\r\n        if (this.stateStack.length > 999) {\r\n            throw new Error('State stack has reach a max size of 999');\r\n        }\r\n        const state = this.state;\r\n        const color = state.color;\r\n        this.stateStack.push({\r\n            width: state.width,\r\n            height: state.height,\r\n            color: {r: color.r, g: color.g, b: color.b, a: color.a},\r\n            cameraX: state.cameraX,\r\n            cameraY: state.cameraY,\r\n            zoom: state.zoom,\r\n            blendMode: state.blendMode\r\n        });\r\n    }\r\n\r\n    restore() {\r\n        const state = this.stateStack.pop();\r\n        if (!state) {\r\n            throw new Error('State stack is empty');\r\n        }\r\n        this.state.color.r = state.color.r;\r\n        this.state.color.g = state.color.g;\r\n        this.state.color.b = state.color.b;\r\n        this.state.color.a = state.color.a;\r\n        this.state.cameraX = state.cameraX;\r\n        this.state.cameraY = state.cameraY;\r\n        this.state.zoom = state.zoom;\r\n        this.viewport(state.width, state.height);\r\n        this.blendMode(state.blendMode);\r\n    }\r\n\r\n    private createDynamicDrawBuffer(vertices: Float32Array) {\r\n        const gl = this.gl;\r\n        const buffer = gl.createBuffer();\r\n        if (!buffer) {\r\n            throw new Error('Failed to create WebGL buffer');\r\n        }\r\n        gl.bindBuffer(gl.ARRAY_BUFFER, buffer);\r\n        gl.bufferData(gl.ARRAY_BUFFER, vertices, gl.DYNAMIC_DRAW);\r\n        gl.bindBuffer(gl.ARRAY_BUFFER, null);\r\n        return buffer;\r\n    }\r\n\r\n    private createVBO(vertices: Float32Array) {\r\n        const gl = this.gl;\r\n        const vbo = gl.createBuffer();\r\n        if (!vbo) {\r\n            throw new Error('Failed to create WebGL buffer');\r\n        }\r\n        gl.bindBuffer(gl.ARRAY_BUFFER, vbo);\r\n        gl.bufferData(gl.ARRAY_BUFFER, vertices, gl.STATIC_DRAW);\r\n        gl.bindBuffer(gl.ARRAY_BUFFER, null);\r\n        return vbo;\r\n    }\r\n\r\n    private createIBO(indices: number[]) {\r\n        const gl = this.gl;\r\n        const ibo = gl.createBuffer();\r\n        if (!ibo) {\r\n            throw new Error('Failed to create WebGL buffer');\r\n        }\r\n        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, ibo);\r\n        gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, new Uint16Array(indices), gl.STATIC_DRAW);\r\n        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, null);\r\n        return ibo;\r\n    }\r\n\r\n    private bindVertexArrayAttribute(\r\n        location: GLint,\r\n        buffer: WebGLBuffer,\r\n        componentSize: GLint = 4,\r\n        type: GLenum = this.gl.FLOAT,\r\n        normalized: GLboolean = false,\r\n        stride: GLsizei = 0,\r\n        offset: GLintptr = 0\r\n    ) {\r\n        const gl = this.gl;\r\n        gl.bindBuffer(gl.ARRAY_BUFFER, buffer);\r\n        gl.enableVertexAttribArray(location);\r\n        gl.vertexAttribPointer(location, componentSize, type, normalized, stride, offset);\r\n        gl.bindBuffer(gl.ARRAY_BUFFER, null);\r\n    }\r\n\r\n    // ====================== texture ======================\r\n\r\n    createEmptyTexture(width: number = this.state.width, height: number = this.state.height, flipY: boolean = false): Texture {\r\n        if (width < 0 || height < 0) {\r\n            throw new Error('Negative width/height');\r\n        }\r\n        const gl = this.gl;\r\n        const texture = gl.createTexture();\r\n        if (!texture) {\r\n            throw new Error('Failed to create WebGL texture');\r\n        }\r\n        gl.bindTexture(gl.TEXTURE_2D, texture);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\r\n        gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, width, height, 0, gl.RGBA, gl.UNSIGNED_BYTE, null);\r\n        gl.bindTexture(gl.TEXTURE_2D, null);\r\n        const ret = new Texture(texture, 0, gl.RGBA, width, height, 0, gl.RGBA, gl.UNSIGNED_BYTE);\r\n        ret.flipY = flipY;\r\n        return ret;\r\n    }\r\n\r\n    createTexture(image: TexImageSource): Texture {\r\n        const texture = this.createEmptyTexture(image.width, image.height);\r\n        const gl = this.gl;\r\n        gl.bindTexture(gl.TEXTURE_2D, texture.glTexture!);\r\n        gl.texImage2D(gl.TEXTURE_2D, texture.level, texture.internalFormat, texture.format, texture.type, image);\r\n        gl.bindTexture(gl.TEXTURE_2D, null);\r\n        return texture;\r\n    }\r\n\r\n    createTextureFromImageUrl(url: string): Promise<Texture> {\r\n        return new Promise((resolve, reject) => {\r\n            try {\r\n                const image = new Image();\r\n                image.onload = () => {\r\n                    try {\r\n                        const texture = this.createTexture(image);\r\n                        texture.image = image;\r\n                        resolve(texture);\r\n                    } catch (e) {\r\n                        reject(e);\r\n                    }\r\n                };\r\n                image.onabort = image.onerror = (e: string | Event) => {\r\n                    reject(e);\r\n                };\r\n                image.src = url;\r\n            } catch (e) {\r\n                reject(e);\r\n            }\r\n        });\r\n    }\r\n\r\n    createDepthTexture(width: number = this.state.width, height: number = this.state.height) {\r\n        if (width < 0 || height < 0) {\r\n            throw new Error('Negative width/height');\r\n        }\r\n        const gl = this.gl;\r\n        const texture = gl.createTexture();\r\n        if (!texture) {\r\n            throw new Error('Failed to create WebGL texture');\r\n        }\r\n        gl.bindTexture(gl.TEXTURE_2D, texture);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\r\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\r\n        gl.texImage2D(gl.TEXTURE_2D, 0, gl.DEPTH_COMPONENT32F, width, height, 0, gl.DEPTH_COMPONENT, gl.FLOAT, null);\r\n        gl.bindTexture(gl.TEXTURE_2D, null);\r\n        return new Texture(texture, 0, gl.DEPTH_COMPONENT32F, width, height, 0, gl.DEPTH_COMPONENT, gl.FLOAT);\r\n    }\r\n\r\n    createTextureFromRgbaPixels(width: number, height: number, pixels: ArrayBufferView) {\r\n        const texture = this.createEmptyTexture(width, height);\r\n        const gl = this.gl;\r\n        gl.bindTexture(gl.TEXTURE_2D, texture.glTexture!);\r\n        gl.texImage2D(gl.TEXTURE_2D, texture.level, texture.internalFormat, width, height, texture.border, texture.format, texture.type, pixels);\r\n        gl.bindTexture(gl.TEXTURE_2D, null);\r\n        return texture;\r\n    }\r\n\r\n    setTextureFromPixels(texture: Texture, width: number, height: number, pixels: ArrayBufferView) {\r\n        const gl = this.gl;\r\n        if (!texture.glTexture) {\r\n            throw new Error('Texture has been deleted');\r\n        }\r\n        gl.bindTexture(gl.TEXTURE_2D, texture.glTexture);\r\n        gl.texImage2D(gl.TEXTURE_2D, texture.level, texture.internalFormat, width, height, texture.border, texture.format, texture.type, pixels);\r\n        gl.bindTexture(gl.TEXTURE_2D, null);\r\n        texture.width = width;\r\n        texture.height = height;\r\n    }\r\n\r\n    deleteTexture(texture: Texture) {\r\n        if (texture.glTexture) {\r\n            this.gl.deleteTexture(texture.glTexture);\r\n            texture.glTexture = undefined;\r\n        }\r\n        texture.width = 0;\r\n        texture.height = 0;\r\n    }\r\n\r\n    resizeTexture(texture: Texture,\r\n                  width: number = this.state.width,\r\n                  height: number = this.state.height,\r\n                  recreate: boolean = false\r\n    ) {\r\n        if (width < 0 || height < 0) {\r\n            throw new Error('Negative width/height');\r\n        }\r\n        if (texture.width === width && texture.height === height) {\r\n            return;\r\n        }\r\n        const gl = this.gl;\r\n        if (!texture.glTexture) {\r\n            throw new Error('Texture has been deleted');\r\n        }\r\n        gl.bindTexture(gl.TEXTURE_2D, texture.glTexture);\r\n        gl.texImage2D(gl.TEXTURE_2D, texture.level, texture.internalFormat, width, height, texture.border, texture.format, texture.type, null);\r\n        gl.bindTexture(gl.TEXTURE_2D, null);\r\n        texture.width = width;\r\n        texture.height = height;\r\n    }\r\n\r\n    // ====================== shader ======================\r\n\r\n    private createGlShader(src: string, type: GLenum): WebGLShader {\r\n        const gl = this.gl;\r\n        const shader = gl.createShader(type);\r\n        if (!shader) {\r\n            throw new Error('Failed to create WebGL shader');\r\n        }\r\n        gl.shaderSource(shader, src);\r\n        gl.compileShader(shader);\r\n        if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\r\n            throw new Error('Failed to compile WebGL shader:\\n\\n' + gl.getShaderInfoLog(shader));\r\n        }\r\n        return shader;\r\n    }\r\n\r\n    createShader(vertSrc: string, fragSrc: string): Shader {\r\n        const gl = this.gl;\r\n        const vertShader = this.createGlShader(vertSrc, gl.VERTEX_SHADER);\r\n        const fragShader = this.createGlShader(fragSrc, gl.FRAGMENT_SHADER);\r\n        const program = gl.createProgram();\r\n        if (!program) {\r\n            throw new Error('Failed to create WebGL program');\r\n        }\r\n        gl.attachShader(program, vertShader);\r\n        gl.attachShader(program, fragShader);\r\n        const attribLocations = this.attribLocations;\r\n        if (attribLocations) {\r\n            for (let attrName in attribLocations) {\r\n                if (attribLocations.hasOwnProperty(attrName)) {\r\n                    gl.bindAttribLocation(program, attribLocations[attrName], attrName);\r\n                }\r\n            }\r\n        }\r\n        gl.linkProgram(program);\r\n        if (!gl.getProgramParameter(program, gl.LINK_STATUS)) {\r\n            throw new Error('Failed to link WebGL program:\\n\\n' + gl.getProgramInfoLog(program));\r\n        }\r\n\r\n        const shader = new Shader(vertShader, fragShader, program);\r\n\r\n        const numOfAttrs = gl.getProgramParameter(program, gl.ACTIVE_ATTRIBUTES);\r\n        for (let i = 0; i < numOfAttrs; ++i) {\r\n            const info = gl.getActiveAttrib(program, i);\r\n            if (!info) {\r\n                throw new Error('Failed to get WebGL attribute info');\r\n            }\r\n            const location = gl.getAttribLocation(program, info.name);\r\n            shader.registerAttribute(info.name, info.size, info.type, location);\r\n        }\r\n\r\n        const numOfUniforms = gl.getProgramParameter(program, gl.ACTIVE_UNIFORMS);\r\n        const samplerCounter = {count: 0};\r\n        for (let i = 0; i < numOfUniforms; ++i) {\r\n            const info = gl.getActiveUniform(program, i);\r\n            if (!info) {\r\n                throw new Error('Failed to get WebGL uniform info');\r\n            }\r\n            const location = gl.getUniformLocation(program, info.name);\r\n            if (location == null) {\r\n                throw new Error('Failed to get uniform location');\r\n            }\r\n            shader.registerUniform(\r\n                info.name,\r\n                info.size,\r\n                info.type,\r\n                location,\r\n                getUniformSetter(gl, info.name, info.size, info.type, location, samplerCounter)\r\n            );\r\n        }\r\n\r\n        return shader;\r\n    }\r\n\r\n    deleteShader(shader: Shader) {\r\n        const gl = this.gl;\r\n        if (shader.program) {\r\n            gl.deleteProgram(shader.program);\r\n            shader.program = undefined;\r\n        }\r\n        if (shader.vertShader) {\r\n            gl.deleteShader(shader.vertShader);\r\n            shader.vertShader = undefined;\r\n        }\r\n        if (shader.fragShader) {\r\n            gl.deleteShader(shader.fragShader);\r\n            shader.fragShader = undefined;\r\n        }\r\n        shader.uniforms = {};\r\n        shader.attributes = {};\r\n    }\r\n\r\n    // ====================== frame buffer ======================\r\n\r\n    createFrameBuffer(): FrameBuffer {\r\n        const gl = this.gl;\r\n        const frameBuffer = gl.createFramebuffer();\r\n        if (!frameBuffer) {\r\n            throw new Error('Failed to create WebGL frame buffer');\r\n        }\r\n        return new FrameBuffer(frameBuffer);\r\n    }\r\n\r\n    attachColorTexture(frameBuffer: FrameBuffer, texture: Texture | null) {\r\n        this.attachColorTextures(frameBuffer, texture ? [texture] : []);\r\n    }\r\n\r\n    attachColorTextures(frameBuffer: FrameBuffer, textures: Texture[]) {\r\n        const gl = this.gl;\r\n        if (!frameBuffer.glFrameBuffer) {\r\n            throw new Error('Frame buffer has been deleted');\r\n        }\r\n        gl.bindFramebuffer(gl.FRAMEBUFFER, frameBuffer.glFrameBuffer);\r\n        frameBuffer.textures.length = textures.length;\r\n        textures.forEach((texture, index) => {\r\n            if (!texture.glTexture) {\r\n                throw new Error('Texture has been deleted');\r\n            }\r\n            gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0 + index, gl.TEXTURE_2D, texture.glTexture, texture.level);\r\n\r\n            frameBuffer.textures[index] = texture;\r\n        });\r\n        gl.drawBuffers(textures.map((texture, index) => (gl.COLOR_ATTACHMENT0 + index)));\r\n        gl.bindFramebuffer(gl.FRAMEBUFFER, null);\r\n        this.currentFrameBuffer = undefined;\r\n    }\r\n\r\n    attachDepthTexture(frameBuffer: FrameBuffer, texture: Texture | null) {\r\n        const gl = this.gl;\r\n        if (!frameBuffer.glFrameBuffer) {\r\n            throw new Error('Frame buffer has been deleted');\r\n        }\r\n        gl.bindFramebuffer(gl.FRAMEBUFFER, frameBuffer.glFrameBuffer);\r\n        if (texture) {\r\n            if (!texture.glTexture) {\r\n                throw new Error('Texture has been deleted');\r\n            }\r\n            gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.DEPTH_ATTACHMENT, gl.TEXTURE_2D, texture.glTexture, texture.level);\r\n            frameBuffer.depthTexture = texture;\r\n        } else {\r\n            gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.DEPTH_ATTACHMENT, gl.TEXTURE_2D, null, 0);\r\n            frameBuffer.depthTexture = undefined;\r\n        }\r\n        gl.bindFramebuffer(gl.FRAMEBUFFER, null);\r\n        this.currentFrameBuffer = undefined;\r\n    }\r\n\r\n    attachStencilTexture(frameBuffer: FrameBuffer, texture: Texture | null) {\r\n        const gl = this.gl;\r\n        if (!frameBuffer.glFrameBuffer) {\r\n            throw new Error('Frame buffer has been deleted');\r\n        }\r\n        gl.bindFramebuffer(gl.FRAMEBUFFER, frameBuffer.glFrameBuffer);\r\n        if (texture) {\r\n            if (!texture.glTexture) {\r\n                throw new Error('Texture has been deleted');\r\n            }\r\n            gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.STENCIL_ATTACHMENT, gl.TEXTURE_2D, texture.glTexture, texture.level);\r\n            frameBuffer.stencilTexture = texture;\r\n        } else {\r\n            gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.STENCIL_ATTACHMENT, gl.TEXTURE_2D, null, 0);\r\n            frameBuffer.stencilTexture = undefined;\r\n        }\r\n        gl.bindFramebuffer(gl.FRAMEBUFFER, null);\r\n        this.currentFrameBuffer = undefined;\r\n    }\r\n\r\n    deleteFrameBuffer(frameBuffer: FrameBuffer, deleteTexture: boolean = false) {\r\n        if (frameBuffer.glFrameBuffer) {\r\n            this.gl.deleteFramebuffer(frameBuffer.glFrameBuffer);\r\n            frameBuffer.glFrameBuffer = undefined;\r\n        }\r\n        if (deleteTexture) {\r\n            frameBuffer.textures.forEach(texture => this.deleteTexture(texture));\r\n        }\r\n    }\r\n\r\n    resizeFrameBuffer(frameBuffer: FrameBuffer, width: number = this.state.width, height: number = this.state.height) {\r\n        frameBuffer.textures.forEach(texture => this.resizeTexture(texture, width, height));\r\n        frameBuffer.depthTexture && this.resizeTexture(frameBuffer.depthTexture, width, height);\r\n        frameBuffer.stencilTexture && this.resizeTexture(frameBuffer.stencilTexture, width, height);\r\n    }\r\n\r\n    startCapture(frameBuffer: FrameBuffer) {\r\n        this.flush2D();\r\n        this.frameBufferStack.push(frameBuffer);\r\n    }\r\n\r\n    endCapture() {\r\n        this.flush2D();\r\n        this.frameBufferStack.pop();\r\n    }\r\n\r\n    private switchFrameBuffer() {\r\n        const stack = this.frameBufferStack;\r\n        const frameBuffer = stack.length ? stack[stack.length - 1] : undefined;\r\n        if (frameBuffer !== this.currentFrameBuffer) {\r\n            this.currentFrameBuffer = frameBuffer || undefined;\r\n            const gl = this.gl;\r\n            gl.bindFramebuffer(gl.FRAMEBUFFER, frameBuffer?.glFrameBuffer || null);\r\n        }\r\n    }\r\n\r\n    // ====================== 3d - geometry ======================\r\n\r\n    disposeGeometry(geometry: Geometry) {\r\n        const gl = this.gl;\r\n        if (geometry.vao) {\r\n            gl.deleteVertexArray(geometry.vao);\r\n            geometry.vao = undefined;\r\n        }\r\n        if (geometry.ibo) {\r\n            gl.deleteBuffer(geometry.ibo);\r\n            geometry.ibo = undefined;\r\n        }\r\n        geometry.attributes.forEach(attr => {\r\n            if (attr.vbo) {\r\n                gl.deleteBuffer(attr.vbo);\r\n                attr.vbo = undefined;\r\n            }\r\n        });\r\n    }\r\n\r\n    drawGeometry(geometry: Geometry) {\r\n        if (this.drawing2D) {\r\n            throw new Error('Renderer.end2D must be call before draw geometry');\r\n        }\r\n\r\n        const gl = this.gl;\r\n\r\n        if (!geometry.vao) {\r\n            const vao = gl.createVertexArray();\r\n            if (!vao) {\r\n                throw new Error('Failed to create Vertex Array Object');\r\n            }\r\n            geometry.vao = vao;\r\n            gl.bindVertexArray(vao);\r\n            const shader = this.currentShader;\r\n            if (!shader) {\r\n                throw new Error('Shader not set');\r\n            }\r\n            const attribLocations = this.attribLocations;\r\n            geometry.attributes.forEach(geoAttr => {\r\n                if (!geoAttr.vbo) {\r\n                    geoAttr.vbo = this.createVBO(geoAttr.vertices);\r\n                }\r\n                if (attribLocations && attribLocations.hasOwnProperty(geoAttr.name)) {\r\n                    this.bindVertexArrayAttribute(\r\n                        attribLocations[geoAttr.name],\r\n                        geoAttr.vbo,\r\n                        geoAttr.componentSize\r\n                    );\r\n                } else {\r\n                    const attribute = shader.attributes[geoAttr.name];\r\n                    if (attribute) {\r\n                        this.bindVertexArrayAttribute(\r\n                            attribute.location,\r\n                            geoAttr.vbo,\r\n                            geoAttr.componentSize\r\n                        );\r\n                    }\r\n                }\r\n            });\r\n        }\r\n        gl.bindVertexArray(geometry.vao);\r\n\r\n        if (!geometry.ibo) {\r\n            geometry.ibo = this.createIBO(geometry.indices);\r\n        }\r\n        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, geometry.ibo);\r\n\r\n        this.switchFrameBuffer();\r\n        switch (geometry.type) {\r\n            case Geometry.TYPE_TRIANGLES:\r\n                gl.drawElements(gl.TRIANGLES, geometry.indices.length, gl.UNSIGNED_SHORT, 0);\r\n                break;\r\n            case Geometry.TYPE_LINES:\r\n                gl.drawElements(gl.LINES, geometry.indices.length, gl.UNSIGNED_SHORT, 0);\r\n                break;\r\n        }\r\n\r\n        gl.bindVertexArray(null);\r\n    }\r\n\r\n    // ====================== 2D - instanced drawing ======================\r\n\r\n    begin2D() {\r\n        if (this.drawing2D) {\r\n            throw new Error('Renderer.end2D must be call before begin');\r\n        }\r\n        this.drawing2D = true;\r\n    }\r\n\r\n    end2D() {\r\n        if (!this.drawing2D) {\r\n            throw new Error('Renderer.begin2D must be call before end');\r\n        }\r\n        this.flush2D();\r\n        this.drawing2D = false;\r\n    }\r\n\r\n    setCameraPosition(x: number, y: number) {\r\n        this.state.cameraX = x;\r\n        this.state.cameraY = y;\r\n    }\r\n\r\n    centerCamera() {\r\n        this.setCameraPosition(this.state.width / 2, this.state.height / 2);\r\n    }\r\n\r\n    setZoom(zoom: number) {\r\n        this.state.zoom = zoom;\r\n    }\r\n\r\n    setColor(r: number, g: number, b: number, a: number = 1) {\r\n        this.state.color.r = r;\r\n        this.state.color.g = g;\r\n        this.state.color.b = b;\r\n        this.state.color.a = a;\r\n    }\r\n\r\n    private flush2D() {\r\n        if (!this.drawing2D) {\r\n            return;\r\n        }\r\n        if (this.batchIndex === 0) {\r\n            return;\r\n        }\r\n        switch (this.batchType) {\r\n            case BatchType.MESH:\r\n                this.flushMesh();\r\n                break;\r\n            case BatchType.LINES:\r\n                this.flushLines();\r\n                break;\r\n        }\r\n    }\r\n\r\n    private flushMesh() {\r\n        const texture = this.batchTexture;\r\n\r\n        const len = this.batchIndex;\r\n        this.batchIndex = 0;\r\n\r\n        const gl = this.gl;\r\n        let shader = this.currentShader;\r\n        if (!shader) {\r\n            shader = this.IMAGE_2D_SHADER;\r\n        }\r\n        if (!shader.program) {\r\n            throw new Error('Shader has been deleted');\r\n        }\r\n        gl.useProgram(shader.program);\r\n\r\n        // position\r\n        const aPosition = shader.attributes[A_POSITION];\r\n        if (aPosition) {\r\n            gl.bindBuffer(gl.ARRAY_BUFFER, this.batchPositionBuffer);\r\n            gl.bufferSubData(gl.ARRAY_BUFFER, 0, this.batchPositionVertices);\r\n            const location = aPosition.location;\r\n            gl.enableVertexAttribArray(location);\r\n            gl.vertexAttribPointer(location, 2, gl.FLOAT, false, 0, 0);\r\n        }\r\n\r\n        // tex-coord\r\n        const aTexCoord = shader.attributes[A_TEX_COORD];\r\n        if (aTexCoord) {\r\n            gl.bindBuffer(gl.ARRAY_BUFFER, this.batchTexCoordBuffer);\r\n            gl.bufferSubData(gl.ARRAY_BUFFER, 0, this.batchTexCoordVertices);\r\n            const location = aTexCoord.location;\r\n            gl.enableVertexAttribArray(location);\r\n            gl.vertexAttribPointer(location, 2, gl.FLOAT, false, 0, 0);\r\n        }\r\n\r\n        // color\r\n        const aColor = shader.attributes[A_COLOR];\r\n        if (aColor) {\r\n            gl.bindBuffer(gl.ARRAY_BUFFER, this.batchColorBuffer);\r\n            gl.bufferSubData(gl.ARRAY_BUFFER, 0, this.batchColorVertices);\r\n            const location = aColor.location;\r\n            gl.enableVertexAttribArray(location);\r\n            gl.vertexAttribPointer(location, 4, gl.FLOAT, false, 0, 0);\r\n        }\r\n\r\n        // texture\r\n        shader.uniforms[U_TEXTURE]?.setter(texture?.glTexture);\r\n\r\n        // draw\r\n        this.switchFrameBuffer();\r\n        gl.drawArrays(gl.TRIANGLES, 0, len * 6);\r\n    }\r\n\r\n    private flushLines() {\r\n        const len = this.batchIndex;\r\n        this.batchIndex = 0;\r\n\r\n        const gl = this.gl;\r\n        let shader = this.currentShader;\r\n        if (!shader) {\r\n            shader = this.COLOR_2D_SHADER;\r\n        }\r\n        if (!shader.program) {\r\n            throw new Error('Shader has been deleted');\r\n        }\r\n        gl.useProgram(shader.program);\r\n\r\n        // position\r\n        gl.bindBuffer(gl.ARRAY_BUFFER, this.batchPositionBuffer);\r\n        gl.bufferSubData(gl.ARRAY_BUFFER, 0, this.batchPositionVertices);\r\n        const positionLocation = shader.attributes[A_POSITION].location;\r\n        gl.enableVertexAttribArray(positionLocation);\r\n        gl.vertexAttribPointer(positionLocation, 2, gl.FLOAT, false, 0, 0);\r\n\r\n        // color\r\n        gl.bindBuffer(gl.ARRAY_BUFFER, this.batchColorBuffer);\r\n        gl.bufferSubData(gl.ARRAY_BUFFER, 0, this.batchColorVertices);\r\n        const colorLocation = shader.attributes[A_COLOR].location;\r\n        gl.enableVertexAttribArray(colorLocation);\r\n        gl.vertexAttribPointer(colorLocation, 4, gl.FLOAT, false, 0, 0);\r\n\r\n        // draw\r\n        this.switchFrameBuffer();\r\n        gl.drawArrays(gl.LINES, 0, len * 2);\r\n    }\r\n\r\n    drawLine(x0: number, y0: number, x1: number, y1: number) {\r\n        if (!this.drawing2D) {\r\n            throw new Error('Renderer.begin2D must be call before draw');\r\n        }\r\n        if (\r\n            this.batchIndex >= this.batchSize * 3\r\n            || this.batchType !== BatchType.LINES\r\n        ) {\r\n            this.flush2D();\r\n        }\r\n        this.batchType = BatchType.LINES;\r\n\r\n        const zoom = this.state.zoom;\r\n        const invW = 2 / this.state.width * zoom;\r\n        const invH = 2 / this.state.height * zoom;\r\n        const cameraX = this.state.cameraX;\r\n        const cameraY = this.state.cameraY;\r\n\r\n        const positionVertices = this.batchPositionVertices;\r\n        const index = this.batchIndex * 2 * 2;\r\n        positionVertices[index] = (x0 - cameraX) * invW;\r\n        positionVertices[index + 1] = (y0 - cameraY) * invH;\r\n        positionVertices[index + 2] = (x1 - cameraX) * invW;\r\n        positionVertices[index + 3] = (y1 - cameraY) * invH;\r\n\r\n        const colorIndex = this.batchIndex * 2 * 4;\r\n        const vertexColors = this.batchColorVertices;\r\n        const color = this.state.color;\r\n        for (let i = 0; i < 2; ++i) {\r\n            const offset = i * 4;\r\n            vertexColors[colorIndex + offset] = color.r;\r\n            vertexColors[colorIndex + 1 + offset] = color.g;\r\n            vertexColors[colorIndex + 2 + offset] = color.b;\r\n            vertexColors[colorIndex + 3 + offset] = color.a;\r\n        }\r\n\r\n        this.batchIndex += 1;\r\n    }\r\n\r\n    private pushCwQuadVertices(\r\n        texture: Texture,\r\n        x0: number,\r\n        y0: number,\r\n        x1: number,\r\n        y1: number,\r\n        x2: number,\r\n        y2: number,\r\n        x3: number,\r\n        y3: number,\r\n        texX0: number,\r\n        texY0: number,\r\n        texX1: number,\r\n        texY1: number,\r\n        texX2: number,\r\n        texY2: number,\r\n        texX3: number,\r\n        texY3: number\r\n    ) {\r\n        if (!this.drawing2D) {\r\n            throw new Error('Renderer.begin2D must be call before draw');\r\n        }\r\n        if (\r\n            this.batchIndex >= this.batchSize\r\n            || texture !== this.batchTexture\r\n            || this.batchType !== BatchType.MESH\r\n        ) {\r\n            this.flush2D();\r\n        }\r\n        this.batchType = BatchType.MESH;\r\n\r\n        this.batchTexture = texture;\r\n        const index = this.batchIndex * 3 * 2 * 2;\r\n        const positionVertices = this.batchPositionVertices;\r\n        const texCoordVertices = this.batchTexCoordVertices;\r\n\r\n        positionVertices[index] = x0;\r\n        positionVertices[index + 1] = y0;\r\n        positionVertices[index + 2] = x1;\r\n        positionVertices[index + 3] = y1;\r\n        positionVertices[index + 4] = x3;\r\n        positionVertices[index + 5] = y3;\r\n\r\n        positionVertices[index + 6] = x1;\r\n        positionVertices[index + 7] = y1;\r\n        positionVertices[index + 8] = x2;\r\n        positionVertices[index + 9] = y2;\r\n        positionVertices[index + 10] = x3;\r\n        positionVertices[index + 11] = y3;\r\n\r\n        if (texture.flipY) {\r\n            [texX0, texY0, texX3, texY3] = [texX3, texY3, texX0, texY0];\r\n            [texX1, texY1, texX2, texY2] = [texX2, texY2, texX1, texY1];\r\n        }\r\n\r\n        texCoordVertices[index] = texX0;\r\n        texCoordVertices[index + 1] = texY0;\r\n        texCoordVertices[index + 2] = texX1;\r\n        texCoordVertices[index + 3] = texY1;\r\n        texCoordVertices[index + 4] = texX3;\r\n        texCoordVertices[index + 5] = texY3;\r\n\r\n        texCoordVertices[index + 6] = texX1;\r\n        texCoordVertices[index + 7] = texY1;\r\n        texCoordVertices[index + 8] = texX2;\r\n        texCoordVertices[index + 9] = texY2;\r\n        texCoordVertices[index + 10] = texX3;\r\n        texCoordVertices[index + 11] = texY3;\r\n\r\n        const colorIndex = this.batchIndex * 3 * 2 * 4;\r\n        const vertexColors = this.batchColorVertices;\r\n        const color = this.state.color;\r\n        for (let i = 0; i < 2 * 3; ++i) {\r\n            const offset = i * 4;\r\n            vertexColors[colorIndex + offset] = color.r;\r\n            vertexColors[colorIndex + 1 + offset] = color.g;\r\n            vertexColors[colorIndex + 2 + offset] = color.b;\r\n            vertexColors[colorIndex + 3 + offset] = color.a;\r\n        }\r\n        this.batchIndex += 1;\r\n    }\r\n\r\n    drawCwQuad(\r\n        texture: Texture,\r\n        x0: number,\r\n        y0: number,\r\n        x1: number,\r\n        y1: number,\r\n        x2: number,\r\n        y2: number,\r\n        x3: number,\r\n        y3: number,\r\n        texX0: number = 0,\r\n        texY0: number = texture.height,\r\n        texX1: number = texture.width,\r\n        texY1: number = texture.height,\r\n        texX2: number = texture.width,\r\n        texY2: number = 0,\r\n        texX3: number = 0,\r\n        texY3: number = 0\r\n    ) {\r\n        const zoom = this.state.zoom;\r\n        const invW = 2 / this.state.width * zoom;\r\n        const invH = 2 / this.state.height * zoom;\r\n        const invSW = 1 / texture.width;\r\n        const invSH = 1 / texture.height;\r\n        const cameraX = this.state.cameraX;\r\n        const cameraY = this.state.cameraY;\r\n        this.pushCwQuadVertices(\r\n            texture,\r\n            (x0 - cameraX) * invW,\r\n            (y0 - cameraY) * invH,\r\n            (x1 - cameraX) * invW,\r\n            (y1 - cameraY) * invH,\r\n            (x2 - cameraX) * invW,\r\n            (y2 - cameraY) * invH,\r\n            (x3 - cameraX) * invW,\r\n            (y3 - cameraY) * invH,\r\n            texX0 * invSW,\r\n            texY0 * invSH,\r\n            texX1 * invSW,\r\n            texY1 * invSH,\r\n            texX2 * invSW,\r\n            texY2 * invSH,\r\n            texX3 * invSW,\r\n            texY3 * invSH\r\n        );\r\n    }\r\n\r\n    drawRect(\r\n        texture: Texture,\r\n        dx: number = 0,\r\n        dy: number = 0,\r\n        dw: number = texture.width,\r\n        dh: number = texture.height,\r\n        flipX: boolean = false,\r\n        flipY: boolean = false,\r\n        sx: number = 0,\r\n        sy: number = 0,\r\n        sw: number = texture.width,\r\n        sh: number = texture.height\r\n    ) {\r\n        const dstLeft = dx;\r\n        const dstRight = dx + dw;\r\n        const dstTop = dy + dh;\r\n        const dstBottom = dy;\r\n        let texLeft = sx;\r\n        let texRight = sx + sw;\r\n        let texTop = sy;\r\n        let texBottom = sy + sh;\r\n        if (flipX) {\r\n            [texLeft, texRight] = [texRight, texLeft];\r\n        }\r\n        if (flipY) {\r\n            [texTop, texBottom] = [texBottom, texTop];\r\n        }\r\n        this.drawCwQuad(\r\n            texture,\r\n            dstLeft,\r\n            dstBottom,\r\n            dstRight,\r\n            dstBottom,\r\n            dstRight,\r\n            dstTop,\r\n            dstLeft,\r\n            dstTop,\r\n            texLeft,\r\n            texBottom,\r\n            texRight,\r\n            texBottom,\r\n            texRight,\r\n            texTop,\r\n            texLeft,\r\n            texTop\r\n        );\r\n    }\r\n\r\n    draw(\r\n        texture: Texture,\r\n        dstX: number = 0,\r\n        dstY: number = 0,\r\n        dstW: number = texture.width,\r\n        dstH: number = texture.height,\r\n        flipX: boolean = false,\r\n        flipY: boolean = false,\r\n        srcX: number = 0,\r\n        srcY: number = 0,\r\n        srcW: number = texture.width,\r\n        srcH: number = texture.height,\r\n        dx: number = 0,\r\n        dy: number = 0,\r\n        ox: number = 0,\r\n        oy: number = 0,\r\n        rotation: number = 0,\r\n        sx: number = 1,\r\n        sy: number = 1\r\n    ) {\r\n        const left = dstX;\r\n        const right = dstX + dstW;\r\n        const top = dstY + dstH;\r\n        const bottom = dstY;\r\n\r\n        const cosR = Math.cos(rotation);\r\n        const sinR = Math.sin(rotation);\r\n\r\n        const m11 = cosR * sx;\r\n        const m12 = -sinR * sy;\r\n        const m13 = -cosR * ox * sx + dx + ox + oy * sinR * sy;\r\n        const m21 = sinR * sx;\r\n        const m22 = cosR * sy;\r\n        const m23 = -cosR * oy * sy + dy - ox * sinR * sx + oy;\r\n\r\n        const v0x = left;\r\n        const v0y = bottom;\r\n        const v1x = right;\r\n        const v1y = bottom;\r\n        const v2x = right;\r\n        const v2y = top;\r\n        const v3x = left;\r\n        const v3y = top;\r\n\r\n        let texLeft = srcX;\r\n        let texRight = srcX + srcW;\r\n        let texTop = srcY;\r\n        let texBottom = srcY + srcH;\r\n        if (flipX) {\r\n            [texLeft, texRight] = [texRight, texLeft];\r\n        }\r\n        if (flipY) {\r\n            [texTop, texBottom] = [texBottom, texTop];\r\n        }\r\n\r\n        this.drawCwQuad(\r\n            texture,\r\n            m11 * v0x + m12 * v0y + m13,\r\n            m21 * v0x + m22 * v0y + m23,\r\n            m11 * v1x + m12 * v1y + m13,\r\n            m21 * v1x + m22 * v1y + m23,\r\n            m11 * v2x + m12 * v2y + m13,\r\n            m21 * v2x + m22 * v2y + m23,\r\n            m11 * v3x + m12 * v3y + m13,\r\n            m21 * v3x + m22 * v3y + m23,\r\n            texLeft,\r\n            texBottom,\r\n            texRight,\r\n            texBottom,\r\n            texRight,\r\n            texTop,\r\n            texLeft,\r\n            texTop\r\n        );\r\n    }\r\n\r\n    drawLabel(\r\n        label: Label,\r\n        dstX: number = 0,\r\n        dstY: number = 0,\r\n        dstW: number = label.width,\r\n        dstH: number = label.height,\r\n        flipX: boolean = false,\r\n        flipY: boolean = false,\r\n        srcX: number = 0,\r\n        srcY: number = 0,\r\n        srcW: number = label.width,\r\n        srcH: number = label.height,\r\n        dx: number = 0,\r\n        dy: number = 0,\r\n        ox: number = 0,\r\n        oy: number = 0,\r\n        rotation: number = 0,\r\n        sx: number = 1,\r\n        sy: number = 1\r\n    ) {\r\n        this.draw(\r\n            label.texture(this),\r\n            dstX,\r\n            dstY,\r\n            dstW,\r\n            dstH,\r\n            flipX,\r\n            flipY,\r\n            srcX,\r\n            srcY,\r\n            srcW,\r\n            srcH,\r\n            dx,\r\n            dy,\r\n            ox,\r\n            oy,\r\n            rotation,\r\n            sx,\r\n            sy\r\n        );\r\n    }\r\n\r\n}\r\n","import Renderer from '../../utils/render/Renderer';\r\n\r\nexport function drawCircle(\r\n    renderer: Renderer,\r\n    radius: number,\r\n    cx: number,\r\n    cy: number,\r\n    precision: number = Math.min(8, radius / 2)\r\n) {\r\n    let x0 = 0;\r\n    let y0 = radius;\r\n    const num = Math.ceil(2 * Math.PI * radius / (precision / renderer.state.zoom));\r\n    const detAngle = Math.PI * 2 / num;\r\n    const cos = Math.cos(detAngle);\r\n    const sin = Math.sin(detAngle);\r\n    const px = cx;\r\n    const py = cy;\r\n    for (let i = 0; i < num; ++i) {\r\n        const x1 = x0 * cos - y0 * sin;\r\n        const y1 = x0 * sin + y0 * cos;\r\n        renderer.drawLine(\r\n            x0 + px,\r\n            y0 + py,\r\n            x1 + px,\r\n            y1 + py\r\n        );\r\n        x0 = x1;\r\n        y0 = y1;\r\n    }\r\n}","import {quat, vec3} from 'gl-matrix';\r\nimport {getVerticalInDir, quatLookRotation} from '../../utils/math/math';\r\nimport {BodyPart} from './model/BodyPart';\r\n\r\ntype Vec = [number, number, number];\r\n\r\ntype Quat = [number, number, number, number];\r\n\r\nfunction mid(p1: Vec, p2: Vec): Vec {\r\n    return [(p1[0] + p2[0]) / 2, (p1[1] + p2[1]) / 2, (p1[2] + p2[2]) / 2];\r\n}\r\n\r\nfunction sub(p1: Vec, p2: Vec): Vec {\r\n    return [p1[0] - p2[0], p1[1] - p2[1], p1[2] - p2[2]];\r\n}\r\n\r\nfunction normalize(vec: Vec): Vec {\r\n    const invLen = 1 / Math.sqrt(vec[0] ** 2 + vec[1] ** 2 + vec[2] ** 2);\r\n    return [vec[0] * invLen, vec[1] * invLen, vec[2] * invLen];\r\n}\r\n\r\nfunction vert(right: Vec, up: Vec): Vec {\r\n    let forward: Vec = [0, 0, 0];\r\n    vec3.cross(forward, right, up);\r\n    return normalize(forward);\r\n}\r\n\r\nfunction vertInDir(v: Vec, dir: Vec): Vec {\r\n    return getVerticalInDir([0, 0, 0], v, dir) as Vec;\r\n}\r\n\r\nfunction quatLook(forward: Vec, up: Vec): Quat {\r\n    return quatLookRotation([0, 0, 0, 1], forward, up) as Quat;\r\n}\r\n\r\nfunction invQuat(q: Quat): Quat {\r\n    return quat.invert([0, 0, 0, 1], q) as Quat;\r\n}\r\n\r\nfunction invQuatLook(forward: Vec, up: Vec): Quat {\r\n    return invQuat(quatLook(forward, up));\r\n}\r\n\r\nexport function landmarksToTransforms(landmarks: { point: [number, number, number], visibility: number }[]): {\r\n    [name in BodyPart]: {\r\n        up: [number, number, number],\r\n        forward: [number, number, number],\r\n        visibility: number\r\n    }\r\n} {\r\n    const points: Vec[] = landmarks.map(item => item.point);\r\n\r\n    function avgVisibility(...indices: number[]) {\r\n        return indices.reduce((visibility, index) => visibility + landmarks[index].visibility, 0) / indices.length;\r\n    }\r\n\r\n    // =============== trunk ===============\r\n    const trunkUp = normalize(\r\n        sub(\r\n            mid(points[11], points[12]),\r\n            mid(points[24], points[23])\r\n        )\r\n    );\r\n    const trunkRight = normalize(sub(\r\n        mid(points[11], points[23]),\r\n        mid(points[12], points[24])\r\n    ));\r\n    const trunkForward = vert(trunkRight, trunkUp);\r\n    const invTrunkQuat = invQuatLook(trunkForward, trunkUp);\r\n    const trunkVisibility = avgVisibility(11, 12, 23, 24);\r\n\r\n    // =============== head ===============\r\n    const headUp = sub(\r\n        mid(points[3], points[6]),\r\n        mid(points[9], points[10])\r\n    );\r\n    const headForward = vert(\r\n        sub(points[7], points[8]),\r\n        headUp\r\n    );\r\n    vec3.transformQuat(headUp, headUp, invTrunkQuat);\r\n    vec3.transformQuat(headForward, headForward, invTrunkQuat);\r\n    const headVisibility = avgVisibility(8, 6, 5, 4, 1, 2, 3, 7, 0, 9, 10);\r\n\r\n    // =============== upper arms ===============\r\n    const leftUpperArmUp = normalize(sub(points[11], points[13]));\r\n    const leftUpperArmForward = vert(trunkRight, leftUpperArmUp);\r\n    const invLeftUpperArmQuat = invQuatLook(leftUpperArmForward, leftUpperArmUp);\r\n    vec3.transformQuat(leftUpperArmUp, leftUpperArmUp, invTrunkQuat);\r\n    vec3.transformQuat(leftUpperArmForward, leftUpperArmForward, invTrunkQuat);\r\n    const leftUpperArmVisibility = avgVisibility(11, 13);\r\n\r\n    const rightUpperArmUp = normalize(sub(points[12], points[14]));\r\n    const rightUpperArmForward = vert(trunkRight, rightUpperArmUp);\r\n    const invRightUpperArmQuat = invQuatLook(rightUpperArmForward, rightUpperArmUp);\r\n    vec3.transformQuat(rightUpperArmUp, rightUpperArmUp, invTrunkQuat);\r\n    vec3.transformQuat(rightUpperArmForward, rightUpperArmForward, invTrunkQuat);\r\n    const rightUpperArmVisibility = avgVisibility(12, 14);\r\n\r\n    // =============== lower arms ===============\r\n    const leftLowerArmUp = normalize(sub(points[13], points[15]));\r\n    const leftLowerArmForward = vert(trunkRight, leftLowerArmUp);\r\n    const invLeftLowerArmQuat = invQuatLook(leftLowerArmForward, leftLowerArmUp);\r\n    vec3.transformQuat(leftLowerArmUp, leftLowerArmUp, invLeftUpperArmQuat);\r\n    vec3.transformQuat(leftLowerArmForward, leftLowerArmForward, invLeftUpperArmQuat);\r\n    const leftLowerArmVisibility = avgVisibility(13, 15);\r\n\r\n    const rightLowerArmUp = normalize(sub(points[14], points[16]));\r\n    const rightLowerArmForward = vert(trunkRight, rightLowerArmUp);\r\n    const invRightLowerArmQuat = invQuatLook(rightLowerArmForward, rightLowerArmUp);\r\n    vec3.transformQuat(rightLowerArmUp, rightLowerArmUp, invRightUpperArmQuat);\r\n    vec3.transformQuat(rightLowerArmForward, rightLowerArmForward, invRightUpperArmQuat);\r\n    const rightLowerArmVisibility = avgVisibility(14, 16);\r\n\r\n    // =============== hands ===============\r\n    const leftHandUp = normalize(sub(\r\n        points[15],\r\n        mid(points[17], points[19])\r\n    ));\r\n    const leftHandForward = vertInDir(leftHandUp, sub(points[21], points[15]));\r\n    vec3.transformQuat(leftHandUp, leftHandUp, invLeftLowerArmQuat);\r\n    vec3.transformQuat(leftHandForward, leftHandForward, invLeftLowerArmQuat);\r\n    const leftHandVisibility = avgVisibility(15, 17, 19, 21);\r\n\r\n    const rightHandUp = normalize(sub(\r\n        points[16],\r\n        mid(points[18], points[20])\r\n    ));\r\n    const rightHandForward = vertInDir(rightHandUp, sub(points[22], points[16]));\r\n    vec3.transformQuat(rightHandUp, rightHandUp, invRightLowerArmQuat);\r\n    vec3.transformQuat(rightHandForward, rightHandForward, invRightLowerArmQuat);\r\n    const rightHandVisibility = avgVisibility(16, 18, 20, 22);\r\n\r\n    // =============== thighs ===============\r\n    const leftThighUp = normalize(sub(points[23], points[25]));\r\n    const leftThighForward = vert(trunkRight, leftThighUp);\r\n    const invLeftThighQuat = invQuatLook(leftThighForward, leftThighUp);\r\n    vec3.transformQuat(leftThighUp, leftThighUp, invTrunkQuat);\r\n    vec3.transformQuat(leftThighForward, leftThighForward, invTrunkQuat);\r\n    const leftThighVisibility = avgVisibility(23, 25);\r\n\r\n    const rightThighUp = normalize(sub(points[24], points[26]));\r\n    const rightThighForward = vert(trunkRight, rightThighUp);\r\n    const invRightThighQuat = invQuatLook(rightThighForward, rightThighUp);\r\n    vec3.transformQuat(rightThighUp, rightThighUp, invTrunkQuat);\r\n    vec3.transformQuat(rightThighForward, rightThighForward, invTrunkQuat);\r\n    const rightThighVisibility = avgVisibility(24, 26);\r\n\r\n    // =============== calves ===============\r\n    const leftCalfUp = normalize(sub(points[25], points[27]));\r\n    const leftCalfForward = vert(trunkRight, leftCalfUp);\r\n    const invLeftCalfQuat = invQuatLook(leftCalfForward, leftCalfUp);\r\n    vec3.transformQuat(leftCalfUp, leftCalfUp, invLeftThighQuat);\r\n    vec3.transformQuat(leftCalfForward, leftCalfForward, invLeftThighQuat);\r\n    const leftCalfVisibility = avgVisibility(25, 27);\r\n\r\n    const rightCalfUp = normalize(sub(points[26], points[28]));\r\n    const rightCalfForward = vert(trunkRight, rightCalfUp);\r\n    const invRightCalfQuat = invQuatLook(rightCalfForward, rightCalfUp);\r\n    vec3.transformQuat(rightCalfUp, rightCalfUp, invRightThighQuat);\r\n    vec3.transformQuat(rightCalfForward, rightCalfForward, invRightThighQuat);\r\n    const rightCalfVisibility = avgVisibility(26, 28);\r\n\r\n    // =============== feet ===============\r\n    const leftFootForward = normalize(sub(points[31], points[29]));\r\n    const leftFootUp = vertInDir(leftFootForward, sub(points[27], points[31]));\r\n    vec3.transformQuat(leftFootForward, leftFootForward, invLeftCalfQuat);\r\n    vec3.transformQuat(leftFootUp, leftFootUp, invLeftCalfQuat);\r\n    const leftFootVisibility = avgVisibility(27, 29, 31);\r\n\r\n    const rightFootForward = normalize(sub(points[32], points[30]));\r\n    const rightFootUp = vertInDir(rightFootForward, sub(points[28], points[32]));\r\n    vec3.transformQuat(rightFootForward, rightFootForward, invRightCalfQuat);\r\n    vec3.transformQuat(rightFootUp, rightFootUp, invRightCalfQuat);\r\n    const rightFootVisibility = avgVisibility(28, 30, 32);\r\n\r\n    return {\r\n        trunk: {\r\n            up: trunkUp,\r\n            forward: trunkForward,\r\n            visibility: trunkVisibility,\r\n        },\r\n        head: {\r\n            up: headUp,\r\n            forward: headForward,\r\n            visibility: headVisibility,\r\n        },\r\n        leftUpperArm: {\r\n            up: leftUpperArmUp,\r\n            forward: leftUpperArmForward,\r\n            visibility: leftUpperArmVisibility,\r\n        },\r\n        leftLowerArm: {\r\n            up: leftLowerArmUp,\r\n            forward: leftLowerArmForward,\r\n            visibility: leftLowerArmVisibility,\r\n        },\r\n        leftHand: {\r\n            up: leftHandUp,\r\n            forward: leftHandForward,\r\n            visibility: leftHandVisibility,\r\n        },\r\n        leftThigh: {\r\n            up: leftThighUp,\r\n            forward: leftThighForward,\r\n            visibility: leftThighVisibility,\r\n        },\r\n        leftCalf: {\r\n            up: leftCalfUp,\r\n            forward: leftCalfForward,\r\n            visibility: leftCalfVisibility,\r\n        },\r\n        leftFoot: {\r\n            up: leftFootUp,\r\n            forward: leftFootForward,\r\n            visibility: leftFootVisibility,\r\n        },\r\n        rightUpperArm: {\r\n            up: rightUpperArmUp,\r\n            forward: rightUpperArmForward,\r\n            visibility: rightUpperArmVisibility,\r\n        },\r\n        rightLowerArm: {\r\n            up: rightLowerArmUp,\r\n            forward: rightLowerArmForward,\r\n            visibility: rightLowerArmVisibility,\r\n        },\r\n        rightHand: {\r\n            up: rightHandUp,\r\n            forward: rightHandForward,\r\n            visibility: rightHandVisibility,\r\n        },\r\n        rightThigh: {\r\n            up: rightThighUp,\r\n            forward: rightThighForward,\r\n            visibility: rightThighVisibility,\r\n        },\r\n        rightCalf: {\r\n            up: rightCalfUp,\r\n            forward: rightCalfForward,\r\n            visibility: rightCalfVisibility,\r\n        },\r\n        rightFoot: {\r\n            up: rightFootUp,\r\n            forward: rightFootForward,\r\n            visibility: rightFootVisibility,\r\n        },\r\n    };\r\n}","import {InfoCircleOutlined, UndoOutlined} from '@vicons/antd';\r\nimport {quat, vec3} from 'gl-matrix';\r\nimport {NIcon, NPopconfirm, NSpin} from 'naive-ui';\r\nimport {defineComponent, onBeforeUnmount, onMounted, PropType, ref, watch} from 'vue';\r\nimport {LANDMARK_VISIBILITY_ACCEPTABLE_THRESHOLD} from '../../config';\r\nimport DraggableCamera from '../../utils/DraggableCamera';\r\nimport Input from '../../utils/input/Input';\r\nimport {MouseDragContext3D, raycastSphereDragMove, raycastSphereDragStart} from '../../utils/input/mouse-drag';\r\nimport {isPointInCircle} from '../../utils/math/intersect';\r\nimport {quatFromTwoVec, transformInvMat4} from '../../utils/math/math';\r\nimport FrameBuffer from '../../utils/render/FrameBuffer';\r\nimport Renderer from '../../utils/render/Renderer';\r\nimport Shader from '../../utils/render/Shader';\r\nimport image2dVert from '../../utils/render/shaders/image-2d.vert';\r\nimport Texture from '../../utils/render/Texture';\r\nimport {drawCircle} from './draw-shape';\r\nimport {landmarksToTransforms} from './landmarks-to-transforms';\r\nimport {BodyPart} from './model/BodyPart';\r\nimport SkeletonModel from './model/SkeletonModel';\r\nimport SkeletonModelNode from './model/SkeletonModelNode';\r\nimport lightFrag from './shaders/light.frag';\r\nimport lightVert from './shaders/light.vert';\r\nimport outlineFrag from './shaders/outline.frag';\r\n\r\nconst CONTROL_POINT_RADIUS = 8;\r\n\r\nexport default defineComponent({\r\n    components: {\r\n        NSpin,\r\n        NIcon,\r\n        NPopconfirm,\r\n        InfoCircleOutlined,\r\n        UndoOutlined,\r\n    },\r\n    props: {\r\n        model: SkeletonModel,\r\n        camera: DraggableCamera,\r\n        landmarks: Array as PropType<{ point: [number, number, number], visibility: number }[]>,\r\n        readonly: Boolean,\r\n        highlights: Array as PropType<BodyPart[]>,\r\n    },\r\n    setup(props) {\r\n        const container = ref<HTMLDivElement>();\r\n        const canvas = ref<HTMLCanvasElement>();\r\n        const loading = ref(false);\r\n\r\n        let width = 0;\r\n        let height = 0;\r\n\r\n        let renderer: Renderer;\r\n        let lightShader: Shader;\r\n        let outlineShader: Shader;\r\n        let modelTexture: Texture;\r\n        let deepTexture: Texture;\r\n        let modelFrameBuffer: FrameBuffer;\r\n\r\n        const lightDirection = [0, -1, 0];\r\n        const camera = props.camera || new DraggableCamera();\r\n        camera.far = 5;\r\n        const input = new Input();\r\n        input.callback = onInput;\r\n\r\n        const model = props.model || new SkeletonModel();\r\n        let hoveredControlPointNode: SkeletonModelNode | null = null;\r\n        let dragging = false;\r\n        let shiftPressedLastFrame = false;\r\n        const dragContext = new MouseDragContext3D();\r\n        const dragOrigin = vec3.create();\r\n        const dragStartVec = vec3.create();\r\n        const dragEndVec = vec3.create();\r\n        const dragRotation = quat.create();\r\n        const dragStartForward = vec3.create();\r\n        const dragStartUp = vec3.create();\r\n\r\n        onMounted(async function () {\r\n            try {\r\n                loading.value = true;\r\n                await model.init();\r\n            } finally {\r\n                loading.value = false;\r\n            }\r\n\r\n            renderer = new Renderer(canvas.value!);\r\n\r\n            lightShader = renderer.createShader(lightVert, lightFrag);\r\n            outlineShader = renderer.createShader(image2dVert, outlineFrag);\r\n\r\n            modelTexture = renderer.createEmptyTexture();\r\n            modelTexture.flipY = true;\r\n            deepTexture = renderer.createDepthTexture();\r\n            deepTexture.flipY = true;\r\n            modelFrameBuffer = renderer.createFrameBuffer();\r\n            renderer.attachColorTexture(modelFrameBuffer, modelTexture);\r\n            renderer.attachDepthTexture(modelFrameBuffer, deepTexture);\r\n\r\n            resizeCanvas();\r\n            input.setup(canvas.value!);\r\n\r\n            setLandmarks(props.landmarks);\r\n        });\r\n\r\n        onBeforeUnmount(function () {\r\n            renderer.deleteShader(lightShader);\r\n            renderer.deleteShader(outlineShader);\r\n\r\n            renderer.deleteFrameBuffer(modelFrameBuffer, true);\r\n\r\n            input.unload(canvas.value!);\r\n        });\r\n\r\n        watch(() => props.landmarks, setLandmarks);\r\n\r\n        watch(() => props.highlights, function (highlights) {\r\n            Object.keys(BodyPart).forEach(name => {\r\n                const node = model[name as BodyPart];\r\n                if (highlights?.length) {\r\n                    node.active = !!highlights.includes(name as BodyPart);\r\n                } else {\r\n                    node.active = true;\r\n                }\r\n            });\r\n            render();\r\n        });\r\n\r\n        function reset() {\r\n            Object.keys(BodyPart).forEach(name => {\r\n                const node = model[name as BodyPart];\r\n                node.forward = [0, 0, 1];\r\n                node.up = [0, 1, 0];\r\n            });\r\n            camera.zoom = 1;\r\n            camera.rotateX = 0;\r\n            camera.rotateY = 0;\r\n            vec3.set(camera.target, 0, 0, 0);\r\n            camera.update();\r\n            model.update(camera.camera);\r\n            render();\r\n        }\r\n\r\n        function setLandmarks(landmarks?: { point: [number, number, number], visibility: number }[]) {\r\n            if (landmarks?.length) {\r\n                const transforms = landmarksToTransforms(landmarks);\r\n                Object.keys(BodyPart).forEach(name => {\r\n                    const node = model[name as BodyPart];\r\n                    const transform = transforms[name as keyof typeof transforms];\r\n                    node.forward = transform.forward;\r\n                    node.up = transform.up;\r\n                    node.active = transform.visibility > LANDMARK_VISIBILITY_ACCEPTABLE_THRESHOLD;\r\n                });\r\n            } else {\r\n                Object.keys(BodyPart).forEach(name => {\r\n                    const node = model[name as BodyPart];\r\n                    node.forward = [0, 0, 1];\r\n                    node.up = [0, 1, 0];\r\n                    node.active = true;\r\n                });\r\n            }\r\n            camera.zoom = 1;\r\n            camera.rotateX = 0;\r\n            camera.rotateY = 0;\r\n            vec3.set(camera.target, 0, 0, 0);\r\n            camera.update();\r\n            model.update(camera.camera);\r\n            render();\r\n        }\r\n\r\n        function resizeCanvas() {\r\n            const rect = container.value!.getBoundingClientRect();\r\n            width = rect.width;\r\n            height = rect.height;\r\n\r\n            renderer.resizeCanvas(width, height);\r\n            renderer.resizeFrameBuffer(modelFrameBuffer);\r\n\r\n            camera.fitViewport(width, height);\r\n        }\r\n\r\n        function onInput(input: Input) {\r\n            camera.onInput(input);\r\n            model.update(camera.camera);\r\n\r\n            if (!props.readonly) {\r\n                if (!input.mouseLeft) {\r\n                    dragging = false;\r\n                }\r\n                if (shiftPressedLastFrame && !input.isKeyPressed('Shift')) {\r\n                    shiftPressedLastFrame = false;\r\n                    dragging = false;\r\n                }\r\n\r\n                // find hovered\r\n                if (!dragging) {\r\n                    hoveredControlPointNode = null;\r\n                    let hoveredControlPointZ = Infinity;\r\n                    if (model.root) {\r\n                        const stack: SkeletonModelNode[] = [model.root];\r\n                        for (; ;) {\r\n                            const node = stack.pop();\r\n                            if (!node) {\r\n                                break;\r\n                            }\r\n                            stack.push(...node.children);\r\n                            if (!node.controlPoint) {\r\n                                continue;\r\n                            }\r\n                            const cx = (node.controlPointScreenPosition[0] + 1) / 2 * width;\r\n                            const cy = (node.controlPointScreenPosition[1] + 1) / 2 * height;\r\n                            if (isPointInCircle(input.mouseX, height - input.mouseY, cx, cy, CONTROL_POINT_RADIUS)\r\n                                && node.controlPointScreenPosition[2] < hoveredControlPointZ\r\n                            ) {\r\n                                hoveredControlPointNode = node;\r\n                                hoveredControlPointZ = node.controlPointScreenPosition[2];\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n\r\n                const projectedMX = (input.mouseX / width - 0.5) * 2;\r\n                const projectedMY = (-input.mouseY / height + 0.5) * 2;\r\n\r\n                if (\r\n                    (input.mouseLeft && !dragging\r\n                        || input.isKeyPressedThisFrame('Shift') && dragging)\r\n                    && hoveredControlPointNode\r\n                ) {\r\n                    // drag start\r\n                    dragging = true;\r\n                    const node = hoveredControlPointNode;\r\n                    raycastSphereDragStart(\r\n                        dragContext,\r\n                        projectedMX, projectedMY,\r\n                        node.originWorldPosition[0], node.originWorldPosition[1], node.originWorldPosition[2],\r\n                        node.controlPointWorldPosition[0], node.controlPointWorldPosition[1], node.controlPointWorldPosition[2],\r\n                        camera.camera\r\n                    );\r\n                    vec3.copy(dragOrigin, node.originWorldPosition);\r\n                    vec3.copy(dragStartVec, node.controlPointWorldPosition);\r\n                    if (node.parent) {\r\n                        transformInvMat4(dragStartVec, dragStartVec, node.parent.worldMatrix);\r\n                        transformInvMat4(dragOrigin, dragOrigin, node.parent.worldMatrix);\r\n                    }\r\n                    vec3.sub(dragStartVec, dragStartVec, dragOrigin);\r\n                    vec3.normalize(dragStartVec, dragStartVec);\r\n                    vec3.copy(dragStartForward, node.forward);\r\n                    vec3.copy(dragStartUp, node.up);\r\n                } else if (input.mouseLeft && dragging && hoveredControlPointNode) {\r\n                    // drag move\r\n                    if (input.isKeyPressed('Shift')) {\r\n                        shiftPressedLastFrame = true;\r\n                        const dx = projectedMX - dragContext.dragStartMousePosition[0];\r\n                        const dy = projectedMY - dragContext.dragStartMousePosition[1];\r\n                        const offset = dx + dy;\r\n                        quat.setAxisAngle(dragRotation, dragStartVec, offset * Math.PI * 2);\r\n                        const node = hoveredControlPointNode;\r\n                        vec3.transformQuat(node.forward, dragStartForward, dragRotation);\r\n                        vec3.normalize(node.forward, node.forward);\r\n                        vec3.transformQuat(node.up, dragStartUp, dragRotation);\r\n                        vec3.normalize(node.up, node.up);\r\n                        model.update(camera.camera, node);\r\n                    } else {\r\n                        if (raycastSphereDragMove(dragContext, projectedMX, projectedMY, camera.camera)) {\r\n                            const node = hoveredControlPointNode;\r\n                            vec3.copy(dragEndVec, dragContext.rayResult1);\r\n                            if (node.parent) {\r\n                                transformInvMat4(dragEndVec, dragEndVec, node.parent.worldMatrix);\r\n                            }\r\n                            vec3.sub(dragEndVec, dragEndVec, dragOrigin);\r\n                            quatFromTwoVec(dragRotation, dragStartVec, dragEndVec);\r\n                            vec3.transformQuat(node.forward, dragStartForward, dragRotation);\r\n                            vec3.normalize(node.forward, node.forward);\r\n                            vec3.transformQuat(node.up, dragStartUp, dragRotation);\r\n                            vec3.normalize(node.up, node.up);\r\n                            model.update(camera.camera, node);\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n\r\n            render();\r\n        }\r\n\r\n        function render() {\r\n            renderer.blendMode(renderer.BLEND_MODE_PIGMENT);\r\n\r\n            // model\r\n            renderer.depthTest(true);\r\n            renderer.cullFace(renderer.SIDE_BACK);\r\n            renderer.startCapture(modelFrameBuffer);\r\n            renderer.clearColor(0, 0, 0, 0);\r\n            renderer.clear(true, true, false);\r\n            renderer.useShader(lightShader);\r\n            renderer.uniform('u_directionalLightDirection', lightDirection);\r\n            renderer.uniform('u_pvMatrix', camera.pvMatrix);\r\n            model.render(renderer);\r\n            renderer.endCapture();\r\n\r\n            renderer.save();\r\n            renderer.depthTest(false);\r\n            renderer.clearColor(0xf2 / 0xff, 0xf2 / 0xff, 0xf2 / 0xff, 1.0);\r\n            renderer.clear(true, false, false);\r\n            renderer.centerCamera();\r\n            // begin\r\n            renderer.begin2D();\r\n            // model\r\n            renderer.setColor(1, 1, 1, 1);\r\n            renderer.useShader();\r\n            renderer.draw(modelTexture);\r\n            // outline\r\n            renderer.setColor(0, 0, 0, 0.5);\r\n            renderer.useShader(outlineShader);\r\n            renderer.uniform('u_threshold', 1 / 1000 / (camera.far / 2));\r\n            renderer.uniform('u_deep', deepTexture);\r\n            renderer.draw(modelTexture);\r\n            // end\r\n            renderer.end2D();\r\n            renderer.restore();\r\n\r\n            // control points\r\n            if (!props.readonly) {\r\n                renderer.depthTest(false);\r\n                renderer.useShader();\r\n                renderer.begin2D();\r\n                const stack: SkeletonModelNode[] = [model.root];\r\n                for (; ;) {\r\n                    const node = stack.pop();\r\n                    if (!node) {\r\n                        break;\r\n                    }\r\n                    stack.push(...node.children);\r\n\r\n                    if (node.controlPoint) {\r\n                        if (node.active) {\r\n                            renderer.setColor(1, 0, 0, node === hoveredControlPointNode ? 1 : 0.25);\r\n                        } else {\r\n                            renderer.setColor(0, 0, 0, node === hoveredControlPointNode ? 1 : 0.25);\r\n                        }\r\n                        const position = node.controlPointScreenPosition;\r\n                        drawCircle(renderer,\r\n                            CONTROL_POINT_RADIUS,\r\n                            position[0] * width / 2,\r\n                            position[1] * height / 2,\r\n                        );\r\n                        drawCircle(renderer,\r\n                            CONTROL_POINT_RADIUS - 2,\r\n                            position[0] * width / 2,\r\n                            position[1] * height / 2,\r\n                        );\r\n                    }\r\n                }\r\n                renderer.end2D();\r\n            }\r\n        }\r\n\r\n        return {\r\n            container,\r\n            canvas,\r\n            loading,\r\n            reset,\r\n        };\r\n    }\r\n});","export function isWebGL2Supported() {\r\n    return !!document.createElement('canvas')?.getContext('webgl2');\r\n}\r\n\r\nexport function isMouseSupported() {\r\n    return 'PointerEvent' in window;\r\n}","import {file} from '../../utils/file';\r\nimport {featureBuffers} from './feature/feature-buffers';\r\nimport {FeatureBuffers} from './matcher/PoseMatcher';\r\n\r\nexport default class DataLoader {\r\n\r\n    chunks: { photos: [string, string, number, number][], buffers: FeatureBuffers }[] = [];\r\n\r\n    async load(onProgress: (progress: number, total: number) => void) {\r\n        const summary = await file.readJson('dataset/summary.json') as { index: number, size: number }[];\r\n\r\n        const promises: Promise<any>[] = [];\r\n        const chunksPromises: { photos: Promise<[string, string, number, number][]>, buffers: { [name: string]: Promise<ArrayBuffer> } }[] = [];\r\n        for (let chunkInfo of summary) {\r\n            const index = chunkInfo.index;\r\n            let photos = file.readJson(`dataset/photos_${index}.json`) as Promise<[string, string, number, number][]>;\r\n            promises.push(photos);\r\n            let buffers: { [name: string]: Promise<ArrayBuffer> } = {};\r\n            for (let name in featureBuffers) {\r\n                const promise\r\n                    = buffers[name]\r\n                    = file.read(`dataset/f_${featureBuffers[name as keyof FeatureBuffers].filename}_${index}.dat`);\r\n                promises.push(promise);\r\n            }\r\n            chunksPromises.push({photos, buffers});\r\n        }\r\n\r\n        const total = promises.length;\r\n        let progress = 0;\r\n        promises.forEach(promise => promise.then(() => {\r\n            progress += 1;\r\n            onProgress(progress, total);\r\n        }));\r\n\r\n        await Promise.all(promises);\r\n\r\n        for (let chunkPromise of chunksPromises) {\r\n            const photos = await chunkPromise.photos;\r\n            const buffers: { [name: string]: Float32Array } = {};\r\n            for (let name in chunkPromise.buffers) {\r\n                buffers[name] = new Float32Array(await chunkPromise.buffers[name]);\r\n            }\r\n            this.chunks.push({\r\n                photos,\r\n                buffers: buffers as FeatureBuffers\r\n            });\r\n        }\r\n    }\r\n\r\n}","import SkeletonModel from '../../../component/SkeletonModelCanvas/model/SkeletonModel';\r\nimport {featureBuffers} from '../feature/feature-buffers';\r\nimport {getNormal, getQuatDistance, getQuatFromRightUp, getQuatMirrorX, isQuatZero, mid} from '../math';\r\nimport PoseMatcher, {FeatureBuffers, MatchResult} from './PoseMatcher';\r\n\r\nconst MAX_ERROR = Math.PI / 180 * 45;\r\n\r\nexport default class ChestMatcher implements PoseMatcher {\r\n\r\n    private rotation: [number, number, number, number] = [0, 0, 0, 0];\r\n\r\n    prepare(model: SkeletonModel): void {\r\n        const up = getNormal(\r\n            mid(model.leftThigh.originViewPosition, model.rightThigh.originViewPosition),\r\n            mid(model.leftUpperArm.originViewPosition, model.rightUpperArm.originViewPosition)\r\n        );\r\n        const right = getNormal(model.rightUpperArm.originViewPosition, model.leftUpperArm.originViewPosition);\r\n        this.rotation = getQuatFromRightUp(right, up);\r\n    }\r\n\r\n    match(result: MatchResult, buffers: FeatureBuffers, index: number): void {\r\n        const rotation = featureBuffers.chest.getChestRotation(buffers.chest, index);\r\n        if (isQuatZero(rotation)) {\r\n            return;\r\n        }\r\n        const errorP = getQuatDistance(this.rotation, rotation);\r\n        const errorF = getQuatDistance(this.rotation, getQuatMirrorX(rotation));\r\n        if (errorF > MAX_ERROR && errorP > MAX_ERROR) {\r\n            return;\r\n        }\r\n        const scoreP = Math.PI - errorP;\r\n        const scoreF = Math.PI - errorF;\r\n        result.accepted = true;\r\n        if (scoreP > scoreF) {\r\n            result.score = scoreP;\r\n        } else {\r\n            result.score = scoreF;\r\n            result.flipped = true;\r\n        }\r\n    }\r\n\r\n}","import SkeletonModel from '../../../component/SkeletonModelCanvas/model/SkeletonModel';\r\nimport {featureBuffers} from '../feature/feature-buffers';\r\nimport {getNormal, getQuatDistance, getQuatFromRightUp, getQuatMirrorX, isQuatZero, mid} from '../math';\r\nimport PoseMatcher, {FeatureBuffers, MatchResult} from './PoseMatcher';\r\n\r\nconst MAX_ERROR = Math.PI / 180 * 45;\r\n\r\nexport default class CrotchMatcher implements PoseMatcher {\r\n\r\n    private rotation: [number, number, number, number] = [0, 0, 0, 0];\r\n\r\n    prepare(model: SkeletonModel): void {\r\n        const up = getNormal(\r\n            mid(model.leftThigh.originViewPosition, model.rightThigh.originViewPosition),\r\n            mid(model.leftUpperArm.originViewPosition, model.rightUpperArm.originViewPosition)\r\n        );\r\n        const right = getNormal(model.rightThigh.originViewPosition, model.leftThigh.originViewPosition);\r\n        this.rotation = getQuatFromRightUp(right, up);\r\n    }\r\n\r\n    match(result: MatchResult, buffers: FeatureBuffers, index: number): void {\r\n        const rotation = featureBuffers.crotch.getCrotchRotation(buffers.crotch, index);\r\n        if (isQuatZero(rotation)) {\r\n            return;\r\n        }\r\n        const errorP = getQuatDistance(this.rotation, rotation);\r\n        const errorF = getQuatDistance(this.rotation, getQuatMirrorX(rotation));\r\n        if (errorF > MAX_ERROR && errorP > MAX_ERROR) {\r\n            return;\r\n        }\r\n        const scoreP = Math.PI - errorP;\r\n        const scoreF = Math.PI - errorF;\r\n        result.accepted = true;\r\n        if (scoreP > scoreF) {\r\n            result.score = scoreP;\r\n        } else {\r\n            result.score = scoreF;\r\n            result.flipped = true;\r\n        }\r\n    }\r\n\r\n}","import SkeletonModel from '../../../component/SkeletonModelCanvas/model/SkeletonModel';\r\nimport {angleBetweenVec3} from '../../../utils/math/math';\r\nimport {featureBuffers} from '../feature/feature-buffers';\r\nimport {\r\n    angle2DBetweenVec3,\r\n    getAngle2D,\r\n    getNegative,\r\n    getNormal,\r\n    getNormalInLocalSpace,\r\n    getQuatDistance,\r\n    getQuatFromRightUp,\r\n    getQuatMirrorX,\r\n    isQuatZero,\r\n    isVecZero,\r\n    mid,\r\n    simplifyAngle\r\n} from '../math';\r\nimport PoseMatcher, {FeatureBuffers, MatchResult} from './PoseMatcher';\r\n\r\nconst MAX_VIEW_ANGLE_ERROR = Math.PI / 180 * 45;\r\nconst MAX_WORLD_SPACE_ANGLE_ERROR = Math.PI / 180 * 60;\r\n\r\nconst Z_AXIS: [number, number, number] = [0, 0, 1];\r\n\r\nexport default class ElbowMatcher implements PoseMatcher {\r\n\r\n    private isLeft: boolean;\r\n\r\n    private upperArmZAxisAngle: number = 0;\r\n    private lowerArmZAxisAngle: number = 0;\r\n    private elbowAngle: number = 0;\r\n    private elbowViewAngle: number = 0;\r\n    private upperArmLocalDir: [number, number, number] = [0, 0, 0];\r\n    private upperArmLocalDirMirror: [number, number, number] = [0, 0, 0];\r\n    private chestRotation: [number, number, number, number] = [0, 0, 0, 1];\r\n\r\n    constructor(isLeft: boolean) {\r\n        this.isLeft = isLeft;\r\n    }\r\n\r\n    prepare(model: SkeletonModel): void {\r\n        let shoulder = model.rightUpperArm.originViewPosition;\r\n        let elbow = model.rightUpperArm.controlPointViewPosition;\r\n        let wrist = model.rightLowerArm.controlPointViewPosition;\r\n        if (this.isLeft) {\r\n            shoulder = model.leftUpperArm.originViewPosition;\r\n            elbow = model.leftUpperArm.controlPointViewPosition;\r\n            wrist = model.leftLowerArm.controlPointViewPosition;\r\n        }\r\n        const upperArmNormal = getNormal(shoulder, elbow);\r\n        const lowerArmNormal = getNormal(elbow, wrist);\r\n        this.upperArmZAxisAngle = angleBetweenVec3(Z_AXIS, upperArmNormal);\r\n        this.lowerArmZAxisAngle = angleBetweenVec3(Z_AXIS, lowerArmNormal);\r\n        this.elbowAngle = angleBetweenVec3(upperArmNormal, lowerArmNormal);\r\n        this.elbowViewAngle = simplifyAngle(getAngle2D(elbow, shoulder, elbow, wrist)) - Math.PI;\r\n\r\n        if (this.isLeft) {\r\n            this.upperArmLocalDir = getNormalInLocalSpace(\r\n                model.rightUpperArm.originWorldPosition,\r\n                model.leftUpperArm.originWorldPosition,\r\n                model.trunk.originWorldPosition,\r\n                model.trunk.controlPointWorldPosition,\r\n                model.leftUpperArm.originWorldPosition,\r\n                model.leftUpperArm.controlPointWorldPosition,\r\n            );\r\n            this.upperArmLocalDirMirror = getNormalInLocalSpace(\r\n                model.rightUpperArm.originWorldPosition,\r\n                model.leftUpperArm.originWorldPosition,\r\n                model.trunk.originWorldPosition,\r\n                model.trunk.controlPointWorldPosition,\r\n                model.leftUpperArm.originWorldPosition,\r\n                model.leftUpperArm.controlPointWorldPosition,\r\n                true,\r\n            );\r\n        } else {\r\n            this.upperArmLocalDir = getNormalInLocalSpace(\r\n                model.leftUpperArm.originWorldPosition,\r\n                model.rightUpperArm.originWorldPosition,\r\n                model.trunk.originWorldPosition,\r\n                model.trunk.controlPointWorldPosition,\r\n                model.rightUpperArm.originWorldPosition,\r\n                model.rightUpperArm.controlPointWorldPosition,\r\n            );\r\n            this.upperArmLocalDirMirror = getNormalInLocalSpace(\r\n                model.leftUpperArm.originWorldPosition,\r\n                model.rightUpperArm.originWorldPosition,\r\n                model.trunk.originWorldPosition,\r\n                model.trunk.controlPointWorldPosition,\r\n                model.rightUpperArm.originWorldPosition,\r\n                model.rightUpperArm.controlPointWorldPosition,\r\n                true,\r\n            );\r\n        }\r\n\r\n        const chestUp = getNormal(\r\n            mid(model.leftThigh.originViewPosition, model.rightThigh.originViewPosition),\r\n            mid(model.leftUpperArm.originViewPosition, model.rightUpperArm.originViewPosition)\r\n        );\r\n        const chestRight = getNormal(model.rightUpperArm.originViewPosition, model.leftUpperArm.originViewPosition);\r\n        this.chestRotation = getQuatFromRightUp(chestRight, chestUp);\r\n    }\r\n\r\n    match(result: MatchResult, buffers: FeatureBuffers, index: number): void {\r\n        const chestRotation = featureBuffers.chest.getChestRotation(buffers.chest, index);\r\n        if (isQuatZero(chestRotation)) {\r\n            return;\r\n        }\r\n        const leftUpperArmDir = featureBuffers.upperArm.getLeftUpperArmDir(buffers.upperArm, index);\r\n        const leftLowerArmDir = featureBuffers.lowerArm.getLeftLowerArmDir(buffers.lowerArm, index);\r\n        const rightUpperArmDir = featureBuffers.upperArm.getRightUpperArmDir(buffers.upperArm, index);\r\n        const rightLowerArmDir = featureBuffers.lowerArm.getRightLowerArmDir(buffers.lowerArm, index);\r\n\r\n        const upperArmZAxisAngleL = angleBetweenVec3(Z_AXIS, leftUpperArmDir);\r\n        const lowerArmZAxisAngleL = angleBetweenVec3(Z_AXIS, leftLowerArmDir);\r\n        const elbowAngleL = angleBetweenVec3(leftUpperArmDir, leftLowerArmDir);\r\n        const elbowViewAngleL = simplifyAngle(angle2DBetweenVec3(getNegative(leftUpperArmDir), leftLowerArmDir)) - Math.PI;\r\n\r\n        const upperArmZAngleErrL = Math.abs(this.upperArmZAxisAngle - upperArmZAxisAngleL);\r\n        const lowerArmZAngleErrL = Math.abs(this.lowerArmZAxisAngle - lowerArmZAxisAngleL);\r\n        const elbowAngleErrL = Math.abs(this.elbowAngle - elbowAngleL);\r\n        const elbowViewAngleErrL = Math.abs(this.elbowViewAngle - elbowViewAngleL * (this.isLeft ? 1 : -1));\r\n        const upperArmAngleErrL = angleBetweenVec3(leftUpperArmDir, this.isLeft ? this.upperArmLocalDir : this.upperArmLocalDirMirror);\r\n        const chestErrL = getQuatDistance(this.chestRotation, this.isLeft ? chestRotation : getQuatMirrorX(chestRotation));\r\n        let scoreL =\r\n            (Math.PI - upperArmZAngleErrL)\r\n            * (Math.PI - lowerArmZAngleErrL)\r\n            * (Math.PI - elbowAngleErrL)\r\n            * (Math.PI * 2 - elbowViewAngleErrL)\r\n            * (Math.PI - upperArmAngleErrL)\r\n            * (Math.PI - chestErrL)\r\n        ;\r\n\r\n        const upperArmZAxisAngleR = angleBetweenVec3(Z_AXIS, rightUpperArmDir);\r\n        const lowerArmZAxisAngleR = angleBetweenVec3(Z_AXIS, rightLowerArmDir);\r\n        const elbowAngleR = angleBetweenVec3(rightUpperArmDir, rightLowerArmDir);\r\n        const elbowViewAngleR = simplifyAngle(angle2DBetweenVec3(getNegative(rightUpperArmDir), rightLowerArmDir)) - Math.PI;\r\n\r\n        const upperArmZAngleErrR = Math.abs(this.upperArmZAxisAngle - upperArmZAxisAngleR);\r\n        const lowerArmZAngleErrR = Math.abs(this.lowerArmZAxisAngle - lowerArmZAxisAngleR);\r\n        const elbowAngleErrR = Math.abs(this.elbowAngle - elbowAngleR);\r\n        const elbowViewAngleErrR = Math.abs(this.elbowViewAngle - elbowViewAngleR * (!this.isLeft ? 1 : -1));\r\n        const upperArmAngleErrR = angleBetweenVec3(rightUpperArmDir, !this.isLeft ? this.upperArmLocalDir : this.upperArmLocalDirMirror);\r\n        const chestErrR = getQuatDistance(this.chestRotation, !this.isLeft ? chestRotation : getQuatMirrorX(chestRotation));\r\n        let scoreR =\r\n            (Math.PI - upperArmZAngleErrR)\r\n            * (Math.PI - lowerArmZAngleErrR)\r\n            * (Math.PI - elbowAngleErrR)\r\n            * (Math.PI * 2 - elbowViewAngleErrR)\r\n            * (Math.PI - upperArmAngleErrR)\r\n            * (Math.PI - chestErrR)\r\n        ;\r\n\r\n        if (isVecZero(leftUpperArmDir)\r\n            || isVecZero(leftLowerArmDir)\r\n            || upperArmZAngleErrL > MAX_VIEW_ANGLE_ERROR\r\n            || lowerArmZAngleErrL > MAX_VIEW_ANGLE_ERROR\r\n            || elbowAngleErrL > MAX_WORLD_SPACE_ANGLE_ERROR\r\n            || elbowViewAngleErrL > MAX_VIEW_ANGLE_ERROR\r\n            || upperArmAngleErrL > MAX_WORLD_SPACE_ANGLE_ERROR\r\n        ) {\r\n            scoreL = -Infinity;\r\n        }\r\n        if (isVecZero(rightUpperArmDir)\r\n            || isVecZero(rightLowerArmDir)\r\n            || upperArmZAngleErrR > MAX_VIEW_ANGLE_ERROR\r\n            || lowerArmZAngleErrR > MAX_VIEW_ANGLE_ERROR\r\n            || elbowAngleErrR > MAX_WORLD_SPACE_ANGLE_ERROR\r\n            || elbowViewAngleErrR > MAX_VIEW_ANGLE_ERROR\r\n            || upperArmAngleErrR > MAX_WORLD_SPACE_ANGLE_ERROR\r\n        ) {\r\n            scoreR = -Infinity;\r\n        }\r\n\r\n        if (isFinite(scoreL) && scoreL > scoreR) {\r\n            result.accepted = true;\r\n            result.score = scoreL;\r\n            result.flipped = !this.isLeft;\r\n        } else if (isFinite(scoreR)) {\r\n            result.accepted = true;\r\n            result.score = scoreR;\r\n            result.flipped = this.isLeft;\r\n        }\r\n    }\r\n\r\n}","import SkeletonModel from '../../../component/SkeletonModelCanvas/model/SkeletonModel';\r\nimport {featureBuffers} from '../feature/feature-buffers';\r\nimport {getNormal, getQuatDistance, getQuatFromRightForward, getQuatMirrorX, isQuatZero} from '../math';\r\nimport PoseMatcher, {FeatureBuffers, MatchResult} from './PoseMatcher';\r\n\r\nconst MAX_ERROR = Math.PI / 180 * 45;\r\n\r\nexport default class FaceMatcher implements PoseMatcher {\r\n\r\n    private rotation: [number, number, number, number] = [0, 0, 0, 0];\r\n\r\n    prepare(model: SkeletonModel): void {\r\n        const leftEar = model.head.landmarksViewPosition[0];\r\n        const rightEar = model.head.landmarksViewPosition[1];\r\n        const right = getNormal(rightEar, leftEar);\r\n        const forward = getNormal(model.head.originViewPosition, model.head.controlPointViewPosition);\r\n        this.rotation = getQuatFromRightForward(right, forward);\r\n    }\r\n\r\n    match(result: MatchResult, buffers: FeatureBuffers, index: number): void {\r\n        const rotation = featureBuffers.face.getFaceRotation(buffers.face, index);\r\n        if (isQuatZero(rotation)) {\r\n            return;\r\n        }\r\n        const errorP = getQuatDistance(this.rotation, rotation);\r\n        const errorF = getQuatDistance(this.rotation, getQuatMirrorX(rotation));\r\n        if (errorF > MAX_ERROR && errorP > MAX_ERROR) {\r\n            return;\r\n        }\r\n        const scoreP = Math.PI - errorP;\r\n        const scoreF = Math.PI - errorF;\r\n        result.accepted = true;\r\n        if (scoreP > scoreF) {\r\n            result.score = scoreP;\r\n        } else {\r\n            result.score = scoreF;\r\n            result.flipped = true;\r\n        }\r\n    }\r\n\r\n}","import SkeletonModel from '../../../component/SkeletonModelCanvas/model/SkeletonModel';\r\nimport {angleBetweenVec3} from '../../../utils/math/math';\r\nimport {featureBuffers} from '../feature/feature-buffers';\r\nimport {\r\n    getNormal,\r\n    getNormalInLocalSpace,\r\n    getQuatDistance,\r\n    getQuatFromRightUp,\r\n    getQuatMirrorX,\r\n    isQuatZero,\r\n    isVecZero,\r\n    mid\r\n} from '../math';\r\nimport PoseMatcher, {FeatureBuffers, MatchResult} from './PoseMatcher';\r\n\r\nconst MAX_ERROR = Math.PI / 180 * 45;\r\n\r\nexport default class HipMatcher implements PoseMatcher {\r\n\r\n    private isLeft: boolean;\r\n\r\n    private thighLocalDir: [number, number, number] = [0, 0, 0];\r\n    private thighLocalDirMirror: [number, number, number] = [0, 0, 0];\r\n    private crotchRotation: [number, number, number, number] = [0, 0, 0, 1];\r\n\r\n    constructor(isLeft: boolean) {\r\n        this.isLeft = isLeft;\r\n    }\r\n\r\n    prepare(model: SkeletonModel): void {\r\n        if (this.isLeft) {\r\n            this.thighLocalDir = getNormalInLocalSpace(\r\n                model.rightThigh.originWorldPosition,\r\n                model.leftThigh.originWorldPosition,\r\n                model.trunk.originWorldPosition,\r\n                model.trunk.controlPointWorldPosition,\r\n                model.leftThigh.originWorldPosition,\r\n                model.leftThigh.controlPointWorldPosition,\r\n            );\r\n            this.thighLocalDirMirror = getNormalInLocalSpace(\r\n                model.rightThigh.originWorldPosition,\r\n                model.leftThigh.originWorldPosition,\r\n                model.trunk.originWorldPosition,\r\n                model.trunk.controlPointWorldPosition,\r\n                model.leftThigh.originWorldPosition,\r\n                model.leftThigh.controlPointWorldPosition,\r\n                true,\r\n            );\r\n        } else {\r\n            this.thighLocalDir = getNormalInLocalSpace(\r\n                model.leftThigh.originWorldPosition,\r\n                model.rightThigh.originWorldPosition,\r\n                model.trunk.originWorldPosition,\r\n                model.trunk.controlPointWorldPosition,\r\n                model.rightThigh.originWorldPosition,\r\n                model.rightThigh.controlPointWorldPosition,\r\n            );\r\n            this.thighLocalDirMirror = getNormalInLocalSpace(\r\n                model.leftThigh.originWorldPosition,\r\n                model.rightThigh.originWorldPosition,\r\n                model.trunk.originWorldPosition,\r\n                model.trunk.controlPointWorldPosition,\r\n                model.rightThigh.originWorldPosition,\r\n                model.rightThigh.controlPointWorldPosition,\r\n                true,\r\n            );\r\n        }\r\n\r\n        const crotchUp = getNormal(\r\n            mid(model.leftThigh.originViewPosition, model.rightThigh.originViewPosition),\r\n            mid(model.leftUpperArm.originViewPosition, model.rightUpperArm.originViewPosition)\r\n        );\r\n        const crotchRight = getNormal(model.rightThigh.originViewPosition, model.leftThigh.originViewPosition);\r\n        this.crotchRotation = getQuatFromRightUp(crotchRight, crotchUp);\r\n    }\r\n\r\n    match(result: MatchResult, buffers: FeatureBuffers, index: number): void {\r\n        const crotchRotation = featureBuffers.crotch.getCrotchRotation(buffers.crotch, index);\r\n        if (isQuatZero(crotchRotation)) {\r\n            return;\r\n        }\r\n\r\n        const leftThighDir = featureBuffers.thigh.getLeftThighDir(buffers.thigh, index);\r\n        const rightThighDir = featureBuffers.thigh.getRightThighDir(buffers.thigh, index);\r\n\r\n        const thighErrL = angleBetweenVec3(leftThighDir, this.isLeft ? this.thighLocalDir : this.thighLocalDirMirror);\r\n        const crotchErrL = getQuatDistance(this.crotchRotation, this.isLeft ? crotchRotation : getQuatMirrorX(crotchRotation));\r\n        const thighErrR = angleBetweenVec3(rightThighDir, !this.isLeft ? this.thighLocalDir : this.thighLocalDirMirror);\r\n        const crotchErrR = getQuatDistance(this.crotchRotation, !this.isLeft ? crotchRotation : getQuatMirrorX(crotchRotation));\r\n\r\n        let scoreL = (Math.PI - thighErrL) * (Math.PI - crotchErrL);\r\n        let scoreR = (Math.PI - thighErrR) * (Math.PI - crotchErrR);\r\n        if (isVecZero(leftThighDir) || thighErrL > MAX_ERROR || crotchErrL > MAX_ERROR) {\r\n            scoreL = -Infinity;\r\n        }\r\n        if (isVecZero(rightThighDir) || thighErrR > MAX_ERROR || crotchErrR > MAX_ERROR) {\r\n            scoreR = -Infinity;\r\n        }\r\n\r\n        if (isFinite(scoreL) && scoreL > scoreR) {\r\n            result.accepted = true;\r\n            result.score = scoreL;\r\n            result.flipped = !this.isLeft;\r\n        } else if (isFinite(scoreR)) {\r\n            result.accepted = true;\r\n            result.score = scoreR;\r\n            result.flipped = this.isLeft;\r\n        }\r\n    }\r\n\r\n}","import SkeletonModel from '../../../component/SkeletonModelCanvas/model/SkeletonModel';\r\nimport {angleBetweenVec3} from '../../../utils/math/math';\r\nimport {featureBuffers} from '../feature/feature-buffers';\r\nimport {\r\n    angle2DBetweenVec3,\r\n    getAngle2D,\r\n    getNegative,\r\n    getNormal,\r\n    getNormalInLocalSpace,\r\n    getQuatDistance,\r\n    getQuatFromRightUp,\r\n    getQuatMirrorX,\r\n    isQuatZero,\r\n    isVecZero,\r\n    mid,\r\n    simplifyAngle\r\n} from '../math';\r\nimport PoseMatcher, {FeatureBuffers, MatchResult} from './PoseMatcher';\r\n\r\nconst MAX_VIEW_ANGLE_ERROR = Math.PI / 180 * 45;\r\nconst MAX_WORLD_SPACE_ANGLE_ERROR = Math.PI / 180 * 60;\r\n\r\nconst Z_AXIS: [number, number, number] = [0, 0, 1];\r\n\r\nexport default class KneeMatcher implements PoseMatcher {\r\n\r\n    private isLeft: boolean;\r\n\r\n    private thighZAxisAngle: number = 0;\r\n    private calfZAxisAngle: number = 0;\r\n    private kneeAngle: number = 0;\r\n    private kneeViewAngle: number = 0;\r\n    private thighLocalDir: [number, number, number] = [0, 0, 0];\r\n    private thighLocalDirMirror: [number, number, number] = [0, 0, 0];\r\n    private crotchRotation: [number, number, number, number] = [0, 0, 0, 1];\r\n\r\n    constructor(isLeft: boolean) {\r\n        this.isLeft = isLeft;\r\n    }\r\n\r\n    prepare(model: SkeletonModel): void {\r\n        let hip = model.rightThigh.originViewPosition;\r\n        let knee = model.rightThigh.controlPointViewPosition;\r\n        let ankle = model.rightCalf.controlPointViewPosition;\r\n        if (this.isLeft) {\r\n            hip = model.leftThigh.originViewPosition;\r\n            knee = model.leftThigh.controlPointViewPosition;\r\n            ankle = model.leftCalf.controlPointViewPosition;\r\n        }\r\n        const thighNormal = getNormal(hip, knee);\r\n        const calfNormal = getNormal(knee, ankle);\r\n        this.thighZAxisAngle = angleBetweenVec3(Z_AXIS, thighNormal);\r\n        this.calfZAxisAngle = angleBetweenVec3(Z_AXIS, calfNormal);\r\n        this.kneeAngle = angleBetweenVec3(thighNormal, calfNormal);\r\n        this.kneeViewAngle = simplifyAngle(getAngle2D(knee, hip, knee, ankle)) - Math.PI;\r\n\r\n        if (this.isLeft) {\r\n            this.thighLocalDir = getNormalInLocalSpace(\r\n                model.rightThigh.originWorldPosition,\r\n                model.leftThigh.originWorldPosition,\r\n                model.trunk.originWorldPosition,\r\n                model.trunk.controlPointWorldPosition,\r\n                model.leftThigh.originWorldPosition,\r\n                model.leftThigh.controlPointWorldPosition,\r\n            );\r\n            this.thighLocalDirMirror = getNormalInLocalSpace(\r\n                model.rightThigh.originWorldPosition,\r\n                model.leftThigh.originWorldPosition,\r\n                model.trunk.originWorldPosition,\r\n                model.trunk.controlPointWorldPosition,\r\n                model.leftThigh.originWorldPosition,\r\n                model.leftThigh.controlPointWorldPosition,\r\n                true,\r\n            );\r\n        } else {\r\n            this.thighLocalDir = getNormalInLocalSpace(\r\n                model.leftThigh.originWorldPosition,\r\n                model.rightThigh.originWorldPosition,\r\n                model.trunk.originWorldPosition,\r\n                model.trunk.controlPointWorldPosition,\r\n                model.rightThigh.originWorldPosition,\r\n                model.rightThigh.controlPointWorldPosition,\r\n            );\r\n            this.thighLocalDirMirror = getNormalInLocalSpace(\r\n                model.leftThigh.originWorldPosition,\r\n                model.rightThigh.originWorldPosition,\r\n                model.trunk.originWorldPosition,\r\n                model.trunk.controlPointWorldPosition,\r\n                model.rightThigh.originWorldPosition,\r\n                model.rightThigh.controlPointWorldPosition,\r\n                true,\r\n            );\r\n        }\r\n\r\n        const crotchUp = getNormal(\r\n            mid(model.leftThigh.originViewPosition, model.rightThigh.originViewPosition),\r\n            mid(model.leftUpperArm.originViewPosition, model.rightUpperArm.originViewPosition)\r\n        );\r\n        const crotchRight = getNormal(model.rightThigh.originViewPosition, model.leftThigh.originViewPosition);\r\n        this.crotchRotation = getQuatFromRightUp(crotchRight, crotchUp);\r\n    }\r\n\r\n    match(result: MatchResult, buffers: FeatureBuffers, index: number): void {\r\n        const crotchRotation = featureBuffers.crotch.getCrotchRotation(buffers.crotch, index);\r\n        if (isQuatZero(crotchRotation)) {\r\n            return;\r\n        }\r\n        const leftThighDir = featureBuffers.thigh.getLeftThighDir(buffers.thigh, index);\r\n        const leftCalfDir = featureBuffers.calf.getLeftCalfDir(buffers.calf, index);\r\n        const rightThighDir = featureBuffers.thigh.getRightThighDir(buffers.thigh, index);\r\n        const rightCalfDir = featureBuffers.calf.getRightCalfDir(buffers.calf, index);\r\n\r\n        const thighZAxisAngleL = angleBetweenVec3(Z_AXIS, leftThighDir);\r\n        const calfZAxisAngleL = angleBetweenVec3(Z_AXIS, leftCalfDir);\r\n        const kneeAngleL = angleBetweenVec3(leftThighDir, leftCalfDir);\r\n        const kneeViewAngleL = simplifyAngle(angle2DBetweenVec3(getNegative(leftThighDir), leftCalfDir)) - Math.PI;\r\n\r\n        const thighZAngleErrL = Math.abs(this.thighZAxisAngle - thighZAxisAngleL);\r\n        const calfZAngleErrL = Math.abs(this.calfZAxisAngle - calfZAxisAngleL);\r\n        const kneeAngleErrL = Math.abs(this.kneeAngle - kneeAngleL);\r\n        const kneeViewAngleErrL = Math.abs(this.kneeViewAngle - kneeViewAngleL * (this.isLeft ? 1 : -1));\r\n        const thighAngleErrL = angleBetweenVec3(leftThighDir, this.isLeft ? this.thighLocalDir : this.thighLocalDirMirror);\r\n        const crotchErrL = getQuatDistance(this.crotchRotation, this.isLeft ? crotchRotation : getQuatMirrorX(crotchRotation));\r\n        let scoreL =\r\n            (Math.PI - thighZAngleErrL)\r\n            * (Math.PI - calfZAngleErrL)\r\n            * (Math.PI - kneeAngleErrL)\r\n            * (Math.PI * 2 - kneeViewAngleErrL)\r\n            * (Math.PI - thighAngleErrL)\r\n            * (Math.PI - crotchErrL)\r\n        ;\r\n\r\n        const thighZAxisAngleR = angleBetweenVec3(Z_AXIS, rightThighDir);\r\n        const calfZAxisAngleR = angleBetweenVec3(Z_AXIS, rightCalfDir);\r\n        const kneeAngleR = angleBetweenVec3(rightThighDir, rightCalfDir);\r\n        const kneeViewAngleR = simplifyAngle(angle2DBetweenVec3(getNegative(rightThighDir), rightCalfDir)) - Math.PI;\r\n\r\n        const thighZAngleErrR = Math.abs(this.thighZAxisAngle - thighZAxisAngleR);\r\n        const calfZAngleErrR = Math.abs(this.calfZAxisAngle - calfZAxisAngleR);\r\n        const kneeAngleErrR = Math.abs(this.kneeAngle - kneeAngleR);\r\n        const kneeViewAngleErrR = Math.abs(this.kneeViewAngle - kneeViewAngleR * (!this.isLeft ? 1 : -1));\r\n        const thighAngleErrR = angleBetweenVec3(rightThighDir, !this.isLeft ? this.thighLocalDir : this.thighLocalDirMirror);\r\n        const crotchErrR = getQuatDistance(this.crotchRotation, !this.isLeft ? crotchRotation : getQuatMirrorX(crotchRotation));\r\n        let scoreR =\r\n            (Math.PI - thighZAngleErrR)\r\n            * (Math.PI - calfZAngleErrR)\r\n            * (Math.PI - kneeAngleErrR)\r\n            * (Math.PI * 2 - kneeViewAngleErrR)\r\n            * (Math.PI - thighAngleErrR)\r\n            * (Math.PI - crotchErrR)\r\n        ;\r\n\r\n        if (isVecZero(leftThighDir)\r\n            || isVecZero(leftCalfDir)\r\n            || thighZAngleErrL > MAX_VIEW_ANGLE_ERROR\r\n            || calfZAngleErrL > MAX_VIEW_ANGLE_ERROR\r\n            || kneeAngleErrL > MAX_WORLD_SPACE_ANGLE_ERROR\r\n            || kneeViewAngleErrL > MAX_VIEW_ANGLE_ERROR\r\n            || thighAngleErrL > MAX_WORLD_SPACE_ANGLE_ERROR\r\n        ) {\r\n            scoreL = -Infinity;\r\n        }\r\n        if (isVecZero(rightThighDir)\r\n            || isVecZero(rightCalfDir)\r\n            || thighZAngleErrR > MAX_VIEW_ANGLE_ERROR\r\n            || calfZAngleErrR > MAX_VIEW_ANGLE_ERROR\r\n            || kneeAngleErrR > MAX_WORLD_SPACE_ANGLE_ERROR\r\n            || kneeViewAngleErrR > MAX_VIEW_ANGLE_ERROR\r\n            || thighAngleErrR > MAX_WORLD_SPACE_ANGLE_ERROR\r\n        ) {\r\n            scoreR = -Infinity;\r\n        }\r\n\r\n        if (isFinite(scoreL) && scoreL > scoreR) {\r\n            result.accepted = true;\r\n            result.score = scoreL;\r\n            result.flipped = !this.isLeft;\r\n        } else if (isFinite(scoreR)) {\r\n            result.accepted = true;\r\n            result.score = scoreR;\r\n            result.flipped = this.isLeft;\r\n        }\r\n    }\r\n\r\n}","import SkeletonModel from '../../../component/SkeletonModelCanvas/model/SkeletonModel';\r\nimport {angleBetweenVec3} from '../../../utils/math/math';\r\nimport {featureBuffers} from '../feature/feature-buffers';\r\nimport {\r\n    getNormal,\r\n    getNormalInLocalSpace,\r\n    getQuatDistance,\r\n    getQuatFromRightUp,\r\n    getQuatMirrorX,\r\n    isQuatZero,\r\n    isVecZero,\r\n    mid\r\n} from '../math';\r\nimport PoseMatcher, {FeatureBuffers, MatchResult} from './PoseMatcher';\r\n\r\nconst MAX_ERROR = Math.PI / 180 * 45;\r\n\r\nexport default class ShoulderMatcher implements PoseMatcher {\r\n\r\n    private isLeft: boolean;\r\n\r\n    private shoulderLocalDir: [number, number, number] = [0, 0, 0];\r\n    private shoulderLocalDirMirror: [number, number, number] = [0, 0, 0];\r\n    private chestRotation: [number, number, number, number] = [0, 0, 0, 1];\r\n\r\n    constructor(isLeft: boolean) {\r\n        this.isLeft = isLeft;\r\n    }\r\n\r\n    prepare(model: SkeletonModel): void {\r\n        if (this.isLeft) {\r\n            this.shoulderLocalDir = getNormalInLocalSpace(\r\n                model.rightUpperArm.originWorldPosition,\r\n                model.leftUpperArm.originWorldPosition,\r\n                model.trunk.originWorldPosition,\r\n                model.trunk.controlPointWorldPosition,\r\n                model.leftUpperArm.originWorldPosition,\r\n                model.leftUpperArm.controlPointWorldPosition,\r\n            );\r\n            this.shoulderLocalDirMirror = getNormalInLocalSpace(\r\n                model.rightUpperArm.originWorldPosition,\r\n                model.leftUpperArm.originWorldPosition,\r\n                model.trunk.originWorldPosition,\r\n                model.trunk.controlPointWorldPosition,\r\n                model.leftUpperArm.originWorldPosition,\r\n                model.leftUpperArm.controlPointWorldPosition,\r\n                true,\r\n            );\r\n        } else {\r\n            this.shoulderLocalDir = getNormalInLocalSpace(\r\n                model.leftUpperArm.originWorldPosition,\r\n                model.rightUpperArm.originWorldPosition,\r\n                model.trunk.originWorldPosition,\r\n                model.trunk.controlPointWorldPosition,\r\n                model.rightUpperArm.originWorldPosition,\r\n                model.rightUpperArm.controlPointWorldPosition,\r\n            );\r\n            this.shoulderLocalDirMirror = getNormalInLocalSpace(\r\n                model.leftUpperArm.originWorldPosition,\r\n                model.rightUpperArm.originWorldPosition,\r\n                model.trunk.originWorldPosition,\r\n                model.trunk.controlPointWorldPosition,\r\n                model.rightUpperArm.originWorldPosition,\r\n                model.rightUpperArm.controlPointWorldPosition,\r\n                true,\r\n            );\r\n        }\r\n\r\n        const chestUp = getNormal(\r\n            mid(model.leftThigh.originViewPosition, model.rightThigh.originViewPosition),\r\n            mid(model.leftUpperArm.originViewPosition, model.rightUpperArm.originViewPosition)\r\n        );\r\n        const chestRight = getNormal(model.rightUpperArm.originViewPosition, model.leftUpperArm.originViewPosition);\r\n        this.chestRotation = getQuatFromRightUp(chestRight, chestUp);\r\n    }\r\n\r\n    match(result: MatchResult, buffers: FeatureBuffers, index: number): void {\r\n        const chestRotation = featureBuffers.chest.getChestRotation(buffers.chest, index);\r\n        if (isQuatZero(chestRotation)) {\r\n            return;\r\n        }\r\n\r\n        const leftUpperArmDir = featureBuffers.upperArm.getLeftUpperArmDir(buffers.upperArm, index);\r\n        const rightUpperArmDir = featureBuffers.upperArm.getRightUpperArmDir(buffers.upperArm, index);\r\n\r\n        const shoulderErrL = angleBetweenVec3(leftUpperArmDir, this.isLeft ? this.shoulderLocalDir : this.shoulderLocalDirMirror);\r\n        const chestErrL = getQuatDistance(this.chestRotation, this.isLeft ? chestRotation : getQuatMirrorX(chestRotation));\r\n        const shoulderErrR = angleBetweenVec3(rightUpperArmDir, !this.isLeft ? this.shoulderLocalDir : this.shoulderLocalDirMirror);\r\n        const chestErrR = getQuatDistance(this.chestRotation, !this.isLeft ? chestRotation : getQuatMirrorX(chestRotation));\r\n\r\n        let scoreL = (Math.PI - shoulderErrL) * (Math.PI - chestErrL);\r\n        let scoreR = (Math.PI - shoulderErrR) * (Math.PI - chestErrR);\r\n        if (isVecZero(leftUpperArmDir) || shoulderErrL > MAX_ERROR || chestErrL > MAX_ERROR) {\r\n            scoreL = -Infinity;\r\n        }\r\n        if (isVecZero(rightUpperArmDir) || shoulderErrR > MAX_ERROR || chestErrR > MAX_ERROR) {\r\n            scoreR = -Infinity;\r\n        }\r\n\r\n        if (isFinite(scoreL) && scoreL > scoreR) {\r\n            result.accepted = true;\r\n            result.score = scoreL;\r\n            result.flipped = !this.isLeft;\r\n        } else if (isFinite(scoreR)) {\r\n            result.accepted = true;\r\n            result.score = scoreR;\r\n            result.flipped = this.isLeft;\r\n        }\r\n    }\r\n\r\n}","import SkeletonModel from '../../component/SkeletonModelCanvas/model/SkeletonModel';\r\nimport {MAX_NUM_OF_SEARCH_RESULTS} from '../../config';\r\nimport PoseMatcher, {FeatureBuffers, MatchResult} from './matcher/PoseMatcher';\r\n\r\nexport type SearchResult = {\r\n    id: string;\r\n    url: string;\r\n    score: number;\r\n    flipped: boolean;\r\n};\r\n\r\nexport function search(\r\n    model: SkeletonModel,\r\n    chunks: { photos: [string, string, number, number][], buffers: FeatureBuffers }[],\r\n    matcher: PoseMatcher\r\n) {\r\n    matcher.prepare(model);\r\n    const matchResult: MatchResult = {score: 0, flipped: false, accepted: false};\r\n    const ret: SearchResult[] = [];\r\n    for (let chunk of chunks) {\r\n        for (let i = 0, len = chunk.photos.length; i < len; ++i) {\r\n            matchResult.score = 0;\r\n            matchResult.accepted = false;\r\n            matchResult.flipped = false;\r\n            matcher.match(matchResult, chunk.buffers, i);\r\n            if (matchResult.accepted) {\r\n                let insertIndex = ret.length;\r\n                for (let i = 0, len = ret.length; i < len; ++i) {\r\n                    if (ret[i].score <= matchResult.score) {\r\n                        insertIndex = i;\r\n                        break;\r\n                    }\r\n                }\r\n                if (insertIndex < MAX_NUM_OF_SEARCH_RESULTS) {\r\n                    const photo = chunk.photos[i];\r\n                    ret.splice(\r\n                        insertIndex,\r\n                        0,\r\n                        {\r\n                            id: photo[0],\r\n                            url: photo[1],\r\n                            score: matchResult.score,\r\n                            flipped: matchResult.flipped,\r\n                        }\r\n                    );\r\n                    if (ret.length > MAX_NUM_OF_SEARCH_RESULTS) {\r\n                        ret.pop();\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    return ret;\r\n}","import {WarningOutlined, SearchOutlined} from '@vicons/antd';\r\nimport {NButton, NIcon, NSelect} from 'naive-ui';\r\nimport {defineComponent, nextTick, onMounted, ref} from 'vue';\r\nimport {BodyPart} from '../component/SkeletonModelCanvas/model/BodyPart';\r\nimport SkeletonModel from '../component/SkeletonModelCanvas/model/SkeletonModel';\r\nimport SkeletonModelCanvas from '../component/SkeletonModelCanvas/SkeletonModelCanvas.vue';\r\nimport {isMouseSupported, isWebGL2Supported} from '../utils/browser-support';\r\nimport DataLoader from './impl/DataLoader';\r\nimport ChestMatcher from './impl/matcher/ChestMatcher';\r\nimport CrotchMatcher from './impl/matcher/CrotchMatcher';\r\nimport ElbowMatcher from './impl/matcher/ElbowMatcher';\r\nimport FaceMatcher from './impl/matcher/FaceMatcher';\r\nimport HipMatcher from './impl/matcher/HipMatcher';\r\nimport KneeMatcher from './impl/matcher/KneeMatcher';\r\nimport PoseMatcher from './impl/matcher/PoseMatcher';\r\nimport ShoulderMatcher from './impl/matcher/ShoulderMatcher';\r\nimport {search, SearchResult} from './impl/search';\r\n\r\nconst matchers: {\r\n    [name: string]: {\r\n        matcher: PoseMatcher,\r\n        highlights: BodyPart[],\r\n    }\r\n} = {\r\n    'Face': {\r\n        matcher: new FaceMatcher(),\r\n        highlights: [BodyPart.head]\r\n    },\r\n    'Chest': {\r\n        matcher: new ChestMatcher(),\r\n        highlights: [BodyPart.trunk]\r\n    },\r\n    'Left Shoulder': {\r\n        matcher: new ShoulderMatcher(true),\r\n        highlights: [BodyPart.trunk, BodyPart.leftUpperArm]\r\n    },\r\n    'Right Shoulder': {\r\n        matcher: new ShoulderMatcher(false),\r\n        highlights: [BodyPart.trunk, BodyPart.rightUpperArm]\r\n    },\r\n    'Left Elbow': {\r\n        matcher: new ElbowMatcher(true),\r\n        highlights: [BodyPart.leftUpperArm, BodyPart.leftLowerArm]\r\n    },\r\n    'Right Elbow': {\r\n        matcher: new ElbowMatcher(false),\r\n        highlights: [BodyPart.rightUpperArm, BodyPart.rightLowerArm]\r\n    },\r\n    'Crotch': {\r\n        matcher: new CrotchMatcher(),\r\n        highlights: [BodyPart.trunk]\r\n    },\r\n    'Left Hip': {\r\n        matcher: new HipMatcher(true),\r\n        highlights: [BodyPart.trunk, BodyPart.leftThigh]\r\n    },\r\n    'Right Hip': {\r\n        matcher: new HipMatcher(false),\r\n        highlights: [BodyPart.trunk, BodyPart.rightThigh]\r\n    },\r\n    'Left Knee': {\r\n        matcher: new KneeMatcher(true),\r\n        highlights: [BodyPart.leftThigh, BodyPart.leftCalf]\r\n    },\r\n    'Right Knee': {\r\n        matcher: new KneeMatcher(false),\r\n        highlights: [BodyPart.rightThigh, BodyPart.rightCalf]\r\n    },\r\n};\r\n\r\nexport default defineComponent({\r\n    components: {\r\n        NButton,\r\n        NSelect,\r\n        NIcon,\r\n\r\n        WarningOutlined,\r\n        SearchOutlined,\r\n\r\n        SkeletonModelCanvas,\r\n    },\r\n    setup() {\r\n        const supportWebGL2 = isWebGL2Supported();\r\n        const supportMouse = isMouseSupported();\r\n\r\n        const dataLoader = new DataLoader();\r\n        const model = new SkeletonModel();\r\n        const loadingData = ref(false);\r\n\r\n        const bodyPartOptions = Object.keys(matchers).map(option => ({value: option, label: option}));\r\n        const bodyPart = ref<BodyPart>();\r\n\r\n        const searchResultsContainerDom = ref<HTMLElement>();\r\n        const searchResults = ref<SearchResult[]>([]);\r\n\r\n        onMounted(async function () {\r\n            try {\r\n                loadingData.value = true;\r\n                await dataLoader.load(function (progress, total) {\r\n                });\r\n            } finally {\r\n                loadingData.value = false;\r\n            }\r\n        });\r\n\r\n        async function onSearch() {\r\n            searchResults.value = [];\r\n            searchResultsContainerDom.value!.scrollTop = 0;\r\n            await nextTick();\r\n            searchResults.value = search(\r\n                model,\r\n                dataLoader.chunks,\r\n                matchers[bodyPart.value!].matcher\r\n            );\r\n        }\r\n\r\n        return {\r\n            supportWebGL2,\r\n            supportMouse,\r\n\r\n            model,\r\n            matchers,\r\n            loadingData,\r\n\r\n            bodyPartOptions,\r\n            bodyPart,\r\n\r\n            searchResultsContainerDom,\r\n            searchResults,\r\n\r\n            onSearch,\r\n        };\r\n    }\r\n});"],"names":["_hoisted_1","_hoisted_2","_createVNode","_hoisted_3","_openBlock","_createBlock","flatten","warn","c","style","CloseIcon","ctxKey","useIsMounted","zindexable","self","commonVars","emptyLight","useLocale","scrollbarLight","CheckmarkIcon","commonVariables","internalSelectMenuLight","getPadding","NInternalLoading","VirtualList","NFocusDetector","popoverLight","clickoutside","mousemoveoutside","tagLight","internalSelectionLight","Suffix","selectLight","iconLight","popconfirmLight","quat.create","mat4.create","vec3.create","vec3.distance","vec3.dot","vec3.exactEquals","vec3.fromValues","quat.invert","MAX_ERROR","mid","MAX_VIEW_ANGLE_ERROR","MAX_WORLD_SPACE_ANGLE_ERROR","Z_AXIS"],"mappings":"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"}