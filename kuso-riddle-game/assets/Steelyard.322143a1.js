import{a as q,r as J,G as Q,H as R,I as K,J as p,f as Z,o as v,g as z,k as r,L as h,F as b,j as M,h as ee,t as X,D as te,l as ne}from"./vendor.b6c8f165.js";import{_ as oe}from"./index.98e696da.js";function ie(t,c,f){let g,y,e=s=>c(s),S=s=>(document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",g),document.removeEventListener("mouseout",y),f&&f(s));g=S,y=s=>{(!s.relatedTarget||s.relatedTarget.nodeName==="HTML")&&S(s)},document.addEventListener("mousemove",e),document.addEventListener("mouseup",g),document.addEventListener("mouseout",y),t&&e(t)}var ae=q({setup(){const t=J("");let c=!0;const f=640,g=480,y=250,e=Q({stringX:260,stringLen:160,markingSize:40,markingsNum:5,beamSize:10,beamPadding:16,markingHandlerSize:16,angle:0,angleTarget:0,plateX:0,plateY:0,plateStringLen1:60,plateStringLen2:30,plateWidth:80,plateHeight:16,hookPos:5,hookTargetPos:5,hookX:0,hookY:0,hookStringLen:40,hookSize:6,weightOnPlate:-1,weightsOnHook:[],weights:[{x:350,y:g,width:20,height:30,weight:10,text:"10",dragging:!1,hasHook:!0,speedY:0},{x:400,y:g,width:30,height:40,weight:30,text:"",dragging:!1,hasHook:!0,speedY:0},{x:450,y:g,width:40,height:50,weight:(10+30)*4,text:"",dragging:!1,hasHook:!0,speedY:0},{x:150,y:g,width:50,height:50,weight:760,text:"?",dragging:!1,hasHook:!1,speedY:0}]});R(function(){s()}),K(function(){c=!1});let S=Date.now();function s(){if(c){const o=Date.now();A(Math.max((o-S)/1e3,1/60)),S=o,requestAnimationFrame(s)}}const w=p(function(){return{width:f+"px",height:g+"px"}}),P=p(function(){return{left:e.stringX+"px",height:e.stringLen+"px"}}),O=p(function(){return{left:e.stringX-e.markingSize-e.beamPadding+"px",top:e.stringLen-e.beamSize/2+"px",width:e.markingSize*(e.markingsNum+1)+e.beamPadding*2+"px",height:e.beamSize+"px","border-radius":e.beamSize/2+"px","transform-origin":`${e.beamPadding+e.markingSize}px ${e.beamSize/2}px`,transform:`rotate(${e.angle}rad)`}}),T=function(o){return{left:e.beamPadding+e.markingSize*(o+1)-1+"px"}},_=p(function(){return{left:-e.markingHandlerSize/2+"px",top:-e.beamSize/2-1+"px",width:e.markingHandlerSize+"px",height:e.beamSize*2+"px"}}),W=p(function(){return{left:e.plateX+"px",top:e.plateY+"px"}}),D=p(function(){return{left:0,height:e.plateStringLen1+"px"}}),$=p(function(){const o=e.plateStringLen2*Math.SQRT2;return{left:0,top:e.plateStringLen1+"px",height:o+"px"}}),N=p(function(){return{top:e.plateStringLen1+e.plateStringLen2+"px",left:-e.plateWidth/2+"px",width:e.plateWidth+"px",height:e.plateHeight+"px"}}),B=p(function(){return{top:e.hookY+"px",left:e.hookX+"px"}}),E=p(function(){return{height:e.hookStringLen+"px"}}),C=p(function(){return{top:e.hookStringLen+"px",left:-e.hookSize/2+"px",width:e.hookSize+"px",height:e.hookSize+"px"}}),F=p(function(){return{width:e.hookSize+"px",height:e.hookSize+"px","margin-left":-e.hookSize/2+"px","margin-top":-e.hookSize-1+"px"}}),I=p(function(){return{width:e.hookSize+"px",height:e.hookSize+"px","margin-left":-e.hookSize/2+"px","margin-bottom":-e.hookSize-1+"px"}}),j=function(o){return{top:e.weights[o].y+"px",left:e.weights[o].x+"px",width:e.weights[o].width+"px",height:e.weights[o].height+"px"}};function A(o){{let l=0,n=0;e.weightOnPlate>=0&&(l=e.weights[e.weightOnPlate].weight);for(let a of e.weightsOnHook)n+=e.weights[a].weight;n*=e.hookTargetPos,l>n?e.angleTarget=-Math.PI/180*30:l<n?e.angleTarget=Math.PI/180*30:e.angleTarget=0,e.angle+=(e.angleTarget-e.angle)*Math.min(1,o/.3)}const k=Math.cos(e.angle),i=Math.sin(e.angle),d=e.stringX,u=e.stringLen+e.beamSize/2;{const l=e.stringX-e.markingSize,n=e.stringLen;e.plateX=(l-d)*k-(n-u)*i+d,e.plateY=(n-u)*k+(l-d)*i+u}{e.hookPos+=(e.hookTargetPos-e.hookPos)*Math.min(1,o/.15);const l=e.stringX+e.hookPos*e.markingSize,n=e.stringLen;e.hookX=(l-d)*k-(n-u)*i+d,e.hookY=(n-u)*k+(l-d)*i+u}for(let l=0,n=e.weights.length;l<n;++l){const a=e.weights[l];if(!a.dragging){if(l===e.weightOnPlate){a.x=e.plateX-a.width/2,a.y=e.plateY+e.plateStringLen1+e.plateStringLen2-a.height+e.plateHeight/2;continue}e.weightsOnHook.includes(l)||(a.y+=a.speedY*o,a.y+a.height>=g?(a.speedY=0,a.y=g-a.height):a.speedY+=y*o)}}let L=e.hookY+e.hookStringLen+e.hookSize/2;for(let l of e.weightsOnHook){const n=e.weights[l];n.x=e.hookX-n.width/2,n.y=L+e.hookSize,L=n.y+n.height+e.hookSize/2}}function U(o){e.hookTargetPos=o}function V(o,k){const i=e.weights[o],d=i.x,u=i.y,L=k.clientX,l=k.clientY;for(i.speedY=0,i.dragging=!0,o===e.weightOnPlate&&(e.weightOnPlate=-1);e.weightsOnHook.includes(o);)e.weightsOnHook.pop();ie(null,function(n){const a=n.clientX-L,m=n.clientY-l;i.x=Math.max(0,Math.min(f-i.width,d+a)),i.y=Math.max(0,Math.min(g-i.height,u+m))},function(){if(i.dragging=!1,e.weightOnPlate<0){const n=e.plateY+e.plateStringLen1+e.plateStringLen2+e.plateHeight/2,a=n-e.plateWidth,m=e.plateX-e.plateWidth/2,H=m+e.plateWidth,x=15;if(i.x>=m-x&&i.x+i.width<=H+x&&i.y>=a-x&&i.y+i.height<=n+x){e.weightOnPlate=o;return}}if(i.hasHook){let n=e.hookY+e.hookStringLen+e.hookSize/2;for(let x of e.weightsOnHook){const Y=e.weights[x];n=Y.y+Y.height+e.hookSize/2}const a=20,m=i.x+i.width/2,H=i.y-e.hookSize/2;m>=e.hookX-a&&m<=e.hookX+a&&H>=n-a&&H<=n+a&&e.weightsOnHook.push(o)}})}function G(o){return o.replace(/[\s]/g,"")}return{ans:t,steelyard:e,wrapperStyle:w,stringStyle:P,beamStyle:O,markingStyle:T,markingHandlerStyle:_,plateStyle:W,plateString1Style:D,plateString2Style:$,plateShapeStyle:N,hookStyle:B,hookStringStyle:E,hookShapeStyle:C,weightHookShapeAStyle:F,weightHookShapeBStyle:I,weightStyle:j,onSetHookPos:U,onDragWeight:V,formatter:G}}});const se={class:"riddle"},le={class:"num"},re=["onClick"],he=["onMousedown"],ge={class:"text"};function pe(t,c,f,g,y,e){const S=Z("input-ans");return v(),z("div",se,[r("div",{class:"wrapper",style:h(t.wrapperStyle)},[r("div",{class:"string",style:h(t.stringStyle)},null,4),r("div",{class:"beam",style:h(t.beamStyle)},[(v(!0),z(b,null,M(t.steelyard.markingsNum,s=>(v(),z("div",{class:"marking",key:s,style:h(t.markingStyle(s))},[r("div",le,X(s),1),r("div",{class:"handler",style:h(t.markingHandlerStyle),onClick:w=>t.onSetHookPos(s)},null,12,re)],4))),128))],4),r("div",{class:"plate",style:h(t.plateStyle)},[r("div",{class:"plate-string-1",style:h(t.plateString1Style)},null,4),r("div",{class:"plate-string-2-a",style:h(t.plateString2Style)},null,4),r("div",{class:"plate-string-2-b",style:h(t.plateString2Style)},null,4),r("div",{class:"plate-shape",style:h(t.plateShapeStyle)},null,4)],4),r("div",{class:"hook",style:h(t.hookStyle)},[r("div",{class:"hook-string",style:h(t.hookStringStyle)},null,4),r("div",{class:"hook-shape",style:h(t.hookShapeStyle)},null,4)],4),(v(!0),z(b,null,M(t.steelyard.weights,(s,w)=>(v(),z("div",{class:"weight",key:w,style:h(t.weightStyle(w)),onMousedown:te(P=>t.onDragWeight(w,P),["stop"])},[r("div",ge,X(s.text),1),s.hasHook?(v(),z(b,{key:0},[r("div",{class:"hook-shape a",style:h(t.weightHookShapeAStyle)},null,4),r("div",{class:"hook-shape b",style:h(t.weightHookShapeBStyle)},null,4)],64)):ne("",!0)],44,he))),128))],4),ee(S,{value:t.ans,"onUpdate:value":c[0]||(c[0]=s=>t.ans=s),formatter:t.formatter},null,8,["value","formatter"])])}var ce=oe(ae,[["render",pe],["__scopeId","data-v-eeb815d4"]]);export{ce as default};
